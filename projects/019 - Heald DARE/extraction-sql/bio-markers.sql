--┌────────────────┐
--│ Biomarker file │
--└────────────────┘

------------------------ RDE CHECK ---------------------
-- George Tilston  - 16 March 2022 - via pull request --
--------------------------------------------------------

-- Richard Williams - changes at 7th October 2022
-- PI requested:
--		- Removing the date restriction in order to get all possible trend data
--		-	Adding blood pressure and triglycerides

-- Richard Williams - changes at 29th February 2024
-- PI requested:
--		- Longitudinal data for slgt2 inhibitors and metformin

-- Cohort is patients included in the DARE study. The below queries produce the data
-- that is required for each patient. However, a filter needs to be applied to only
-- provide this data for patients in the DARE study. Adrian Heald will provide GraphNet
-- with a list of NHS numbers, then they will execute the below but filtered to the list
-- of NHS numbers.

-- We assume that a temporary table will exist as follows:
-- CREATE TABLE #DAREPatients (NhsNo NVARCHAR(30));

--Just want the output, not the messages
SET NOCOUNT ON;

--Create DARECohort Table
SELECT SUBSTRING(REPLACE(NHSNo, ' ', ''),1,3) + ' ' + SUBSTRING(REPLACE(NHSNo, ' ', ''),4,3) + ' ' + SUBSTRING(REPLACE(NHSNo, ' ', ''),7,4) 'NHSNo' INTO #DAREPatients FROM [dbo].[DARECohort]

-- Set the start date
--DECLARE @StartDate datetime;
--SET @StartDate = '2018-01-01';

-- Get link ids of patients
SELECT DISTINCT FK_Patient_Link_ID INTO #Patients
FROM SharedCare.Patient p
INNER JOIN #DAREPatients dp ON dp.NhsNo = p.NhsNo;

-- Get lookup between nhs number and fk_patient_link_id
SELECT DISTINCT p.NhsNo, p.FK_Patient_Link_ID INTO #NhsNoToLinkId
FROM SharedCare.Patient p
INNER JOIN #DAREPatients dp ON dp.NhsNo = p.NhsNo;

-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

--#region Clinical code sets

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
  [description] [varchar] (255) NULL 
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('metformin',1,'f41..',NULL,'METFORMIN HYDROCHLORIDE'),('metformin',1,'f41..00',NULL,'METFORMIN HYDROCHLORIDE'),('metformin',1,'f411.',NULL,'GLUCOPHAGE 500mg tablets'),('metformin',1,'f411.00',NULL,'GLUCOPHAGE 500mg tablets'),('metformin',1,'f412.',NULL,'GLUCOPHAGE 850mg tablets'),('metformin',1,'f412.00',NULL,'GLUCOPHAGE 850mg tablets'),('metformin',1,'f413.',NULL,'*ORABET 500mg tablets'),('metformin',1,'f413.00',NULL,'*ORABET 500mg tablets'),('metformin',1,'f414.',NULL,'*ORABET 850mg tablets'),('metformin',1,'f414.00',NULL,'*ORABET 850mg tablets'),('metformin',1,'f415.',NULL,'*GLUCAMET-500 tablets'),('metformin',1,'f415.00',NULL,'*GLUCAMET-500 tablets'),('metformin',1,'f416.',NULL,'*GLUCAMET-850 tablets'),('metformin',1,'f416.00',NULL,'*GLUCAMET-850 tablets'),('metformin',1,'f417.',NULL,'GLUCOPHAGE SR 500mg m/r tablets'),('metformin',1,'f417.00',NULL,'GLUCOPHAGE SR 500mg m/r tablets'),('metformin',1,'f418.',NULL,'METSOL 500mg/5mL oral solution'),('metformin',1,'f418.00',NULL,'METSOL 500mg/5mL oral solution'),('metformin',1,'f419.',NULL,'GLUCOPHAGE SR 750mg m/r tablets'),('metformin',1,'f419.00',NULL,'GLUCOPHAGE SR 750mg m/r tablets'),('metformin',1,'f41A.',NULL,'GLUCOPHAGE SR 1000mg m/r tablets'),('metformin',1,'f41A.00',NULL,'GLUCOPHAGE SR 1000mg m/r tablets'),('metformin',1,'f41B.',NULL,'BOLAMYN SR 500mg m/r tablets'),('metformin',1,'f41B.00',NULL,'BOLAMYN SR 500mg m/r tablets'),('metformin',1,'f41C.',NULL,'GLUCOPHAGE 500mg/sachet oral powder'),('metformin',1,'f41C.00',NULL,'GLUCOPHAGE 500mg/sachet oral powder'),('metformin',1,'f41D.',NULL,'GLUCOPHAGE 1000mg/sachet oral powder'),('metformin',1,'f41D.00',NULL,'GLUCOPHAGE 1000mg/sachet oral powder'),('metformin',1,'f41E.',NULL,'METABET SR 500mg m/r tablets'),('metformin',1,'f41E.00',NULL,'METABET SR 500mg m/r tablets'),('metformin',1,'f41F.',NULL,'METABET SR 1000mg m/r tablets'),('metformin',1,'f41F.00',NULL,'METABET SR 1000mg m/r tablets'),('metformin',1,'f41G.',NULL,'GLUCIENT SR 500mg m/r tablets'),('metformin',1,'f41G.00',NULL,'GLUCIENT SR 500mg m/r tablets'),('metformin',1,'f41H.',NULL,'DIAGEMET XL 500mg m/r tablets'),('metformin',1,'f41H.00',NULL,'DIAGEMET XL 500mg m/r tablets'),('metformin',1,'f41I.',NULL,'SUKKARTO SR 500mg m/r tablets'),('metformin',1,'f41I.00',NULL,'SUKKARTO SR 500mg m/r tablets'),('metformin',1,'f41J.',NULL,'SUKKARTO SR 1000mg m/r tablets'),('metformin',1,'f41J.00',NULL,'SUKKARTO SR 1000mg m/r tablets'),('metformin',1,'f41s.',NULL,'METFORMIN HYDROCHLORIDE 1000mg/sachet oral powder'),('metformin',1,'f41s.00',NULL,'METFORMIN HYDROCHLORIDE 1000mg/sachet oral powder'),('metformin',1,'f41t.',NULL,'METFORMIN HYDROCHLORIDE 500mg/sachet oral powder'),('metformin',1,'f41t.00',NULL,'METFORMIN HYDROCHLORIDE 500mg/sachet oral powder'),('metformin',1,'f41u.',NULL,'METFORMIN HYDROCHLORIDE 1000mg m/r tablets'),('metformin',1,'f41u.00',NULL,'METFORMIN HYDROCHLORIDE 1000mg m/r tablets'),('metformin',1,'f41v.',NULL,'METFORMIN HYDROCHLORIDE 750mg m/r tablets'),('metformin',1,'f41v.00',NULL,'METFORMIN HYDROCHLORIDE 750mg m/r tablets'),('metformin',1,'f41w.',NULL,'METFORMIN HYDROCHLORIDE 500mg/5mL oral solution'),('metformin',1,'f41w.00',NULL,'METFORMIN HYDROCHLORIDE 500mg/5mL oral solution'),('metformin',1,'f41x.',NULL,'METFORMIN HYDROCHLORIDE 500mg m/r tablets'),('metformin',1,'f41x.00',NULL,'METFORMIN HYDROCHLORIDE 500mg m/r tablets'),('metformin',1,'f41y.',NULL,'METFORMIN HYDROCHLORIDE 500mg tablets'),('metformin',1,'f41y.00',NULL,'METFORMIN HYDROCHLORIDE 500mg tablets'),('metformin',1,'f41z.',NULL,'METFORMIN HYDROCHLORIDE 850mg tablets'),('metformin',1,'f41z.00',NULL,'METFORMIN HYDROCHLORIDE 850mg tablets'),('metformin',1,'ft43.',NULL,'*AVANDAMET 1mg / 500mg tablets'),('metformin',1,'ft43.00',NULL,'*AVANDAMET 1mg / 500mg tablets'),('metformin',1,'ft44.',NULL,'*AVANDAMET 2mg / 500mg tablets'),('metformin',1,'ft44.00',NULL,'*AVANDAMET 2mg / 500mg tablets'),('metformin',1,'ft45.',NULL,'AVANDAMET 2mg / 1000mg tablets'),('metformin',1,'ft45.00',NULL,'AVANDAMET 2mg / 1000mg tablets'),('metformin',1,'ft46.',NULL,'AVANDAMET 4mg / 1000mg tablets'),('metformin',1,'ft46.00',NULL,'AVANDAMET 4mg / 1000mg tablets'),('metformin',1,'ft4u.',NULL,'ROSIGLITAZONE 2mg / METFORMIN 1000mg tablets'),('metformin',1,'ft4u.00',NULL,'ROSIGLITAZONE 2mg / METFORMIN 1000mg tablets'),('metformin',1,'ft4v.',NULL,'ROSIGLITAZONE 4mg / METFORMIN 1000mg tablets'),('metformin',1,'ft4v.00',NULL,'ROSIGLITAZONE 4mg / METFORMIN 1000mg tablets'),('metformin',1,'ft4w.',NULL,'ROSIGLITAZONE 2mg / METFORMIN 500mg tablets'),('metformin',1,'ft4w.00',NULL,'ROSIGLITAZONE 2mg / METFORMIN 500mg tablets'),('metformin',1,'ft4x.',NULL,'ROSIGLITAZONE 1mg / METFORMIN 500mg tablets'),('metformin',1,'ft4x.00',NULL,'ROSIGLITAZONE 1mg / METFORMIN 500mg tablets'),('metformin',1,'ft7..',NULL,'METFORMIN + PIOGLITAZONE'),('metformin',1,'ft7..00',NULL,'METFORMIN + PIOGLITAZONE'),('metformin',1,'ft71.',NULL,'COMPETACT 15mg/850mg tablets'),('metformin',1,'ft71.00',NULL,'COMPETACT 15mg/850mg tablets'),('metformin',1,'ft7z.',NULL,'METFORMIN 850mg/PIOGLITAZONE 15mg tablets'),('metformin',1,'ft7z.00',NULL,'METFORMIN 850mg/PIOGLITAZONE 15mg tablets'),('metformin',1,'ftb..',NULL,'METFORMIN + VILDAGLIPTIN'),('metformin',1,'ftb..00',NULL,'METFORMIN + VILDAGLIPTIN'),('metformin',1,'ftb1.',NULL,'EUCREAS 50mg/850mg tablets'),('metformin',1,'ftb1.00',NULL,'EUCREAS 50mg/850mg tablets'),('metformin',1,'ftb2.',NULL,'EUCREAS 50mg/1000mg tablets'),('metformin',1,'ftb2.00',NULL,'EUCREAS 50mg/1000mg tablets'),('metformin',1,'ftby.',NULL,'VILDAGLIPTIN/METFORMIN 50mg/1000mg tablets'),('metformin',1,'ftby.00',NULL,'VILDAGLIPTIN/METFORMIN 50mg/1000mg tablets'),('metformin',1,'ftbz.',NULL,'VILDAGLIPTIN/METFORMIN 50mg/850mg tablets'),('metformin',1,'ftbz.00',NULL,'VILDAGLIPTIN/METFORMIN 50mg/850mg tablets'),('metformin',1,'fte..',NULL,'METFORMIN + SITAGLIPTIN'),('metformin',1,'fte..00',NULL,'METFORMIN + SITAGLIPTIN'),('metformin',1,'fte1.',NULL,'JANUMET 50mg/1000mg tablets'),('metformin',1,'fte1.00',NULL,'JANUMET 50mg/1000mg tablets'),('metformin',1,'ftez.',NULL,'SITAGLIPTIN/METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftez.00',NULL,'SITAGLIPTIN/METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftg..',NULL,'METFORMIN + LINAGLIPTIN'),('metformin',1,'ftg..00',NULL,'METFORMIN + LINAGLIPTIN'),('metformin',1,'ftg1.',NULL,'JENTADUETO 2.5mg/850mg tablets'),('metformin',1,'ftg1.00',NULL,'JENTADUETO 2.5mg/850mg tablets'),('metformin',1,'ftg2.',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'ftg2.00',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'ftg3.',NULL,'JENTADUETO 2.5mg/1000mg tablets'),('metformin',1,'ftg3.00',NULL,'JENTADUETO 2.5mg/1000mg tablets'),('metformin',1,'ftg4.',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'ftg4.00',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'fti..',NULL,'METFORMIN + SAXAGLIPTIN'),('metformin',1,'fti..00',NULL,'METFORMIN + SAXAGLIPTIN'),('metformin',1,'fti1.',NULL,'KOMBOGLYZE 2.5mg/850mg tablets'),('metformin',1,'fti1.00',NULL,'KOMBOGLYZE 2.5mg/850mg tablets'),('metformin',1,'fti2.',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'fti2.00',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'fti3.',NULL,'KOMBOGLYZE 2.5mg/1000mg tablets'),('metformin',1,'fti3.00',NULL,'KOMBOGLYZE 2.5mg/1000mg tablets'),('metformin',1,'fti4.',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'fti4.00',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'ftl..',NULL,'METFORMIN + ALOGLIPTIN'),('metformin',1,'ftl..00',NULL,'METFORMIN + ALOGLIPTIN'),('metformin',1,'ftl1.',NULL,'VIPDOMET 12.5mg/1000mg tablets'),('metformin',1,'ftl1.00',NULL,'VIPDOMET 12.5mg/1000mg tablets'),('metformin',1,'ftl2.',NULL,'ALOGLIPTIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('metformin',1,'ftl2.00',NULL,'ALOGLIPTIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('metformin',1,'ftm..',NULL,'METFORMIN + DAPAGLIFLOZIN'),('metformin',1,'ftm..00',NULL,'METFORMIN + DAPAGLIFLOZIN'),('metformin',1,'ftm1.',NULL,'XIGDUO 5mg/850mg tablets'),('metformin',1,'ftm1.00',NULL,'XIGDUO 5mg/850mg tablets'),('metformin',1,'ftm2.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftm2.00',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftm3.',NULL,'XIGDUO 5mg/1000mg tablets'),('metformin',1,'ftm3.00',NULL,'XIGDUO 5mg/1000mg tablets'),('metformin',1,'ftm4.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftm4.00',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftp..',NULL,'METFORMIN + CANAGLIFLOZIN'),('metformin',1,'ftp..00',NULL,'METFORMIN + CANAGLIFLOZIN'),('metformin',1,'ftp1.',NULL,'VOKANAMET 50mg/850mg tablets'),('metformin',1,'ftp1.00',NULL,'VOKANAMET 50mg/850mg tablets'),('metformin',1,'ftp2.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('metformin',1,'ftp2.00',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('metformin',1,'ftp3.',NULL,'VOKANAMET 50mg/1000mg tablets'),('metformin',1,'ftp3.00',NULL,'VOKANAMET 50mg/1000mg tablets'),('metformin',1,'ftp4.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftp4.00',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftr..',NULL,'METFORMIN + EMPAGLIFLOZIN'),('metformin',1,'ftr..00',NULL,'METFORMIN + EMPAGLIFLOZIN'),('metformin',1,'ftr1.',NULL,'SYNJARDY 5mg/850mg tablets'),('metformin',1,'ftr1.00',NULL,'SYNJARDY 5mg/850mg tablets'),('metformin',1,'ftr2.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftr2.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftr3.',NULL,'SYNJARDY 5mg/1000mg tablets'),
('metformin',1,'ftr3.00',NULL,'SYNJARDY 5mg/1000mg tablets'),('metformin',1,'ftr4.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftr4.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftr5.',NULL,'SYNJARDY 12.5mg/850mg tablets'),('metformin',1,'ftr5.00',NULL,'SYNJARDY 12.5mg/850mg tablets'),('metformin',1,'ftr6.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('metformin',1,'ftr6.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('metformin',1,'ftr7.',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('metformin',1,'ftr7.00',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('metformin',1,'ftr8.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('metformin',1,'ftr8.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets');
INSERT INTO #codesreadv2
VALUES ('sglt2-inhibitors',1,'ftr..',NULL,'METFORMIN + EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftr..00',NULL,'METFORMIN + EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftr8.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr8.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr6.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr6.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr4.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr4.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr2.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr2.00',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr7.',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr7.00',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr5.',NULL,'SYNJARDY 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr5.00',NULL,'SYNJARDY 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr3.',NULL,'SYNJARDY 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr3.00',NULL,'SYNJARDY 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr1.',NULL,'SYNJARDY 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr1.00',NULL,'SYNJARDY 5mg/850mg tablets'),('sglt2-inhibitors',1,'fto..',NULL,'EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'fto..00',NULL,'EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'fto4.',NULL,'EMPAGLIFLOZIN 25mg tablets'),('sglt2-inhibitors',1,'fto4.00',NULL,'EMPAGLIFLOZIN 25mg tablets'),('sglt2-inhibitors',1,'fto2.',NULL,'EMPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'fto2.00',NULL,'EMPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'fto3.',NULL,'JARDIANCE 25mg tablets'),('sglt2-inhibitors',1,'fto3.00',NULL,'JARDIANCE 25mg tablets'),('sglt2-inhibitors',1,'fto1.',NULL,'JARDIANCE 10mg tablets'),('sglt2-inhibitors',1,'fto1.00',NULL,'JARDIANCE 10mg tablets'),('sglt2-inhibitors',1,'ftm..',NULL,'METFORMIN + DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftm..00',NULL,'METFORMIN + DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftm4.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm4.00',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm2.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftm2.00',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftm3.',NULL,'XIGDUO 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm3.00',NULL,'XIGDUO 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm1.',NULL,'XIGDUO 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftm1.00',NULL,'XIGDUO 5mg/850mg tablets'),('sglt2-inhibitors',1,'fth..',NULL,'DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'fth..00',NULL,'DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'fth4.',NULL,'DAPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'fth4.00',NULL,'DAPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'fth3.',NULL,'DAPAGLIFLOZIN 5mg tablets'),('sglt2-inhibitors',1,'fth3.00',NULL,'DAPAGLIFLOZIN 5mg tablets'),('sglt2-inhibitors',1,'fth2.',NULL,'FORXIGA 10mg tablets'),('sglt2-inhibitors',1,'fth2.00',NULL,'FORXIGA 10mg tablets'),('sglt2-inhibitors',1,'fth1.',NULL,'FORXIGA 5mg tablets'),('sglt2-inhibitors',1,'fth1.00',NULL,'FORXIGA 5mg tablets'),('sglt2-inhibitors',1,'ftp..',NULL,'METFORMIN + CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftp..00',NULL,'METFORMIN + CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftp4.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp4.00',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp2.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftp2.00',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftp3.',NULL,'VOKANAMET 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp3.00',NULL,'VOKANAMET 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp1.',NULL,'VOKANAMET 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftp1.00',NULL,'VOKANAMET 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftn..',NULL,'CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftn..00',NULL,'CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftn4.',NULL,'CANAGLIFLOZIN 300mg tablets'),('sglt2-inhibitors',1,'ftn4.00',NULL,'CANAGLIFLOZIN 300mg tablets'),('sglt2-inhibitors',1,'ftn2.',NULL,'CANAGLIFLOZIN 100mg tablets'),('sglt2-inhibitors',1,'ftn2.00',NULL,'CANAGLIFLOZIN 100mg tablets'),('sglt2-inhibitors',1,'ftn3.',NULL,'INVOKANA 300mg tablets'),('sglt2-inhibitors',1,'ftn3.00',NULL,'INVOKANA 300mg tablets'),('sglt2-inhibitors',1,'ftn1.',NULL,'INVOKANA 100mg tablets'),('sglt2-inhibitors',1,'ftn1.00',NULL,'INVOKANA 100mg tablets');
INSERT INTO #codesreadv2
VALUES ('bmi',2,'22K..',NULL,'Body Mass Index'),('bmi',2,'22K..00',NULL,'Body Mass Index'),('bmi',2,'22KB.',NULL,'Baseline body mass index'),('bmi',2,'22KB.00',NULL,'Baseline body mass index');
INSERT INTO #codesreadv2
VALUES ('cholesterol',2,'44P..',NULL,'Serum cholesterol'),('cholesterol',2,'44P..00',NULL,'Serum cholesterol'),('cholesterol',2,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',2,'44PZ.00',NULL,'Serum cholesterol NOS'),('cholesterol',2,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',2,'44PJ.00',NULL,'Serum total cholesterol level'),('cholesterol',2,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PH.00',NULL,'Total cholesterol measurement'),('cholesterol',2,'44OE.',NULL,'Plasma total cholesterol level'),('cholesterol',2,'44OE.00',NULL,'Plasma total cholesterol level'),('cholesterol',2,'44PK.',NULL,'Serum fasting total cholesterol'),('cholesterol',2,'44PK.00',NULL,'Serum fasting total cholesterol');
INSERT INTO #codesreadv2
VALUES ('diastolic-blood-pressure',1,'246o1',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246o100',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246n0',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246n000',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.00',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246f.',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246f.00',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.00',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.00',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.00',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.00',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.00',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.00',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.00',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246A.',NULL,'O/E - Diastolic BP reading'),('diastolic-blood-pressure',1,'246A.00',NULL,'O/E - Diastolic BP reading');
INSERT INTO #codesreadv2
VALUES ('egfr',1,'451E.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451E.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451G.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451G.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451K.',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451K.00',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451M.',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451M.00',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.00',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451F.',NULL,'Glomerular filtration rate'),('egfr',1,'451F.00',NULL,'Glomerular filtration rate');
INSERT INTO #codesreadv2
VALUES ('hba1c',2,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W5.00',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W4.',NULL,'HbA1c level (DCCT aligned)'),('hba1c',2,'42W4.00',NULL,'HbA1c level (DCCT aligned)');
INSERT INTO #codesreadv2
VALUES ('hdl-cholesterol',1,'44PC.',NULL,'Serum random HDL cholesterol level'),('hdl-cholesterol',1,'44PC.00',NULL,'Serum random HDL cholesterol level'),('hdl-cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44P5.00',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44dA.',NULL,'Plasma HDL cholesterol level'),('hdl-cholesterol',1,'44dA.00',NULL,'Plasma HDL cholesterol level'),('hdl-cholesterol',1,'44d2.',NULL,'Plasma random HDL cholesterol level'),('hdl-cholesterol',1,'44d2.00',NULL,'Plasma random HDL cholesterol level'),('hdl-cholesterol',1,'44d3.',NULL,'Plasma fasting HDL cholesterol level'),('hdl-cholesterol',1,'44d3.00',NULL,'Plasma fasting HDL cholesterol level'),('hdl-cholesterol',1,'44PB.',NULL,'Serum fasting HDL cholesterol level'),('hdl-cholesterol',1,'44PB.00',NULL,'Serum fasting HDL cholesterol level');
INSERT INTO #codesreadv2
VALUES ('ldl-cholesterol',1,'44PI.',NULL,'Calculated LDL cholesterol level'),('ldl-cholesterol',1,'44PI.00',NULL,'Calculated LDL cholesterol level'),('ldl-cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'44P6.00',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'44dB.',NULL,'Plasma LDL cholesterol level'),('ldl-cholesterol',1,'44dB.00',NULL,'Plasma LDL cholesterol level'),('ldl-cholesterol',1,'44d4.',NULL,'Plasma random LDL cholesterol level'),('ldl-cholesterol',1,'44d4.00',NULL,'Plasma random LDL cholesterol level'),('ldl-cholesterol',1,'44d5.',NULL,'Plasma fasting LDL cholesterol level'),('ldl-cholesterol',1,'44d5.00',NULL,'Plasma fasting LDL cholesterol level'),('ldl-cholesterol',1,'44PD.',NULL,'Serum fasting LDL cholesterol level'),('ldl-cholesterol',1,'44PD.00',NULL,'Serum fasting LDL cholesterol level'),('ldl-cholesterol',1,'44PE.',NULL,'Serum random LDL cholesterol level'),('ldl-cholesterol',1,'44PE.00',NULL,'Serum random LDL cholesterol level');
INSERT INTO #codesreadv2
VALUES ('sex-hormone-binding-globulin',1,'44CD.',NULL,'Serum sex hormone binding globulin level'),('sex-hormone-binding-globulin',1,'44CD.00',NULL,'Serum sex hormone binding globulin level');
INSERT INTO #codesreadv2
VALUES ('systolic-blood-pressure',1,'246o0',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246o000',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246n1',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246n100',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246l.',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246l.00',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246e.',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246e.00',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246d.',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246d.00',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246b.',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246b.00',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.00',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246W.',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246W.00',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246S.',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246S.00',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246Q.',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246Q.00',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246N.',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'246N.00',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'2469.',NULL,'O/E - Systolic BP reading'),('systolic-blood-pressure',1,'2469.00',NULL,'O/E - Systolic BP reading');
INSERT INTO #codesreadv2
VALUES ('testosterone',1,'4473.',NULL,'Serum testosterone'),('testosterone',1,'4473.00',NULL,'Serum testosterone'),('testosterone',1,'447G.',NULL,'Plasma testosterone level'),('testosterone',1,'447G.00',NULL,'Plasma testosterone level');
INSERT INTO #codesreadv2
VALUES ('triglycerides',1,'44Q..',NULL,'Serum triglycerides'),('triglycerides',1,'44Q..00',NULL,'Serum triglycerides'),('triglycerides',1,'44Q4.',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44Q4.00',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44Q5.',NULL,'Serum random triglyceride level'),('triglycerides',1,'44Q5.00',NULL,'Serum random triglyceride level'),('triglycerides',1,'44QZ.',NULL,'Serum triglycerides NOS'),('triglycerides',1,'44QZ.00',NULL,'Serum triglycerides NOS'),('triglycerides',1,'44e..',NULL,'Plasma triglyceride level'),('triglycerides',1,'44e..00',NULL,'Plasma triglyceride level'),('triglycerides',1,'44e0.',NULL,'Plasma random triglyceride level'),('triglycerides',1,'44e0.00',NULL,'Plasma random triglyceride level'),('triglycerides',1,'44e1.',NULL,'Plasma fasting triglyceride level'),('triglycerides',1,'44e1.00',NULL,'Plasma fasting triglyceride level'),('triglycerides',1,'4QA1.',NULL,'Triglyceride level'),('triglycerides',1,'4QA1.00',NULL,'Triglyceride level');
INSERT INTO #codesreadv2
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TC.00',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'44J7.',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'44J7.00',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.',NULL,'Urine microalbumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.00',NULL,'Urine microalbumin:creatinine ratio');
INSERT INTO #codesreadv2
VALUES ('vitamin-d',1,'4QB4.',NULL,'Vitamin D level'),('vitamin-d',1,'4QB4.00',NULL,'Vitamin D level'),('vitamin-d',1,'44LA.',NULL,'Serum vitamin D'),('vitamin-d',1,'44LA.00',NULL,'Serum vitamin D'),('vitamin-d',1,'4QB44',NULL,'Combined total vitamin D2 and D3 level'),('vitamin-d',1,'4QB4400',NULL,'Combined total vitamin D2 and D3 level'),('vitamin-d',1,'4QB45',NULL,'25-Hydroxyvitamin D level'),('vitamin-d',1,'4QB4500',NULL,'25-Hydroxyvitamin D level'),('vitamin-d',1,'4QB46',NULL,'Total 25-hydroxyvitamin D level'),('vitamin-d',1,'4QB4600',NULL,'Total 25-hydroxyvitamin D level'),('vitamin-d',1,'4QB47',NULL,'Serum total 25-hydroxy vitamin D level'),('vitamin-d',1,'4QB4700',NULL,'Serum total 25-hydroxy vitamin D level')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('metformin',1,'f41..',NULL,'Metformin hydrochloride'),('metformin',1,'f411.',NULL,'Glucophage 500mg tablet'),('metformin',1,'f412.',NULL,'Glucophage 850mg tablet'),('metformin',1,'f413.',NULL,'Orabet 500mg tablet'),('metformin',1,'f414.',NULL,'Orabet 850mg tablet'),('metformin',1,'f415.',NULL,'Glucamet 500 tablet'),('metformin',1,'f416.',NULL,'Glucamet 850 tablet'),('metformin',1,'f417.',NULL,'Glucophage SR 500mg m/r tablet'),('metformin',1,'f418.',NULL,'METSOL 500mg/5mL oral solution'),('metformin',1,'f419.',NULL,'GLUCOPHAGE SR 750mg m/r tablets'),('metformin',1,'f41A.',NULL,'GLUCOPHAGE SR 1000mg m/r tablets'),('metformin',1,'f41B.',NULL,'BOLAMYN SR 500mg m/r tablets'),('metformin',1,'f41C.',NULL,'GLUCOPHAGE 500mg/sachet oral powder'),('metformin',1,'f41D.',NULL,'GLUCOPHAGE 1000mg/sachet oral powder'),('metformin',1,'f41E.',NULL,'METABET SR 500mg m/r tablets'),('metformin',1,'f41F.',NULL,'METABET SR 1000mg m/r tablets'),('metformin',1,'f41G.',NULL,'GLUCIENT SR 500mg m/r tablets'),('metformin',1,'f41H.',NULL,'DIAGEMET XL 500mg m/r tablets'),('metformin',1,'f41I.',NULL,'SUKKARTO SR 500mg m/r tablets'),('metformin',1,'f41J.',NULL,'SUKKARTO SR 1000mg m/r tablets'),('metformin',1,'f41s.',NULL,'METFORMIN HYDROCHLORIDE 1000mg/sachet oral powder'),('metformin',1,'f41t.',NULL,'METFORMIN HYDROCHLORIDE 500mg/sachet oral powder'),('metformin',1,'f41u.',NULL,'METFORMIN HYDROCHLORIDE 1000mg m/r tablets'),('metformin',1,'f41v.',NULL,'METFORMIN HYDROCHLORIDE 750mg m/r tablets'),('metformin',1,'f41w.',NULL,'METFORMIN 500mg/5mL oral solution'),('metformin',1,'f41x.',NULL,'Metformin hydrochloride 500mg m/r tablet'),('metformin',1,'f41y.',NULL,'Metformin hydrochloride 500mg tablet'),('metformin',1,'f41z.',NULL,'Metformin hydrochloride 850mg tablet'),('metformin',1,'ft43.',NULL,'Avandamet 1mg / 500mg tablet'),('metformin',1,'ft44.',NULL,'Avandamet 2mg / 500mg tablet'),('metformin',1,'ft45.',NULL,'Avandamet 2mg / 1000mg tablet'),('metformin',1,'ft46.',NULL,'Avandamet 4mg / 1000mg tablet'),('metformin',1,'ft4u.',NULL,'Rosiglitazone 2mg / Metformin 1000mg tablet'),('metformin',1,'ft4v.',NULL,'Rosiglitazone 4mg / Metformin 1000mg tablet'),('metformin',1,'ft4w.',NULL,'Rosiglitazone 2mg / metformin 500mg tablet'),('metformin',1,'ft4x.',NULL,'Rosiglitazone 1mg / metformin 500mg tablet'),('metformin',1,'ft7..',NULL,'METFORMIN + PIOGLITAZONE'),('metformin',1,'ft71.',NULL,'COMPETACT 15mg/850mg tablets'),('metformin',1,'ft7z.',NULL,'METFORMIN 850mg/PIOGLITAZONE 15mg tablets'),('metformin',1,'ftb..',NULL,'METFORMIN + VILDAGLIPTIN'),('metformin',1,'ftb1.',NULL,'EUCREAS 50mg/850mg tablets'),('metformin',1,'ftb2.',NULL,'EUCREAS 50mg/1000mg tablets'),('metformin',1,'ftby.',NULL,'VILDAGLIPTIN/METFORMIN 50mg/1000mg tablets'),('metformin',1,'ftbz.',NULL,'VILDAGLIPTIN/METFORMIN 50mg/850mg tablets'),('metformin',1,'fte..',NULL,'METFORMIN + SITAGLIPTIN'),('metformin',1,'fte1.',NULL,'JANUMET 50mg/1000mg tablets'),('metformin',1,'ftez.',NULL,'SITAGLIPTIN/METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftg..',NULL,'METFORMIN + LINAGLIPTIN'),('metformin',1,'ftg1.',NULL,'JENTADUETO 2.5mg/850mg tablets'),('metformin',1,'ftg2.',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'ftg3.',NULL,'JENTADUETO 2.5mg/1000mg tablets'),('metformin',1,'ftg4.',NULL,'LINAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'fti..',NULL,'METFORMIN + SAXAGLIPTIN'),('metformin',1,'fti1.',NULL,'KOMBOGLYZE 2.5mg/850mg tablets'),('metformin',1,'fti2.',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/850mg tablets'),('metformin',1,'fti3.',NULL,'KOMBOGLYZE 2.5mg/1000mg tablets'),('metformin',1,'fti4.',NULL,'SAXAGLIPTIN/METFORMIN HYDROCHLORIDE 2.5mg/1000mg tablets'),('metformin',1,'ftl..',NULL,'METFORMIN + ALOGLIPTIN'),('metformin',1,'ftl1.',NULL,'VIPDOMET 12.5mg/1000mg tablets'),('metformin',1,'ftl2.',NULL,'ALOGLIPTIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('metformin',1,'ftm..',NULL,'METFORMIN + DAPAGLIFLOZIN'),('metformin',1,'ftm1.',NULL,'XIGDUO 5mg/850mg tablets'),('metformin',1,'ftm2.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftm3.',NULL,'XIGDUO 5mg/1000mg tablets'),('metformin',1,'ftm4.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftp..',NULL,'METFORMIN + CANAGLIFLOZIN'),('metformin',1,'ftp1.',NULL,'VOKANAMET 50mg/850mg tablets'),('metformin',1,'ftp2.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('metformin',1,'ftp3.',NULL,'VOKANAMET 50mg/1000mg tablets'),('metformin',1,'ftp4.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('metformin',1,'ftr..',NULL,'METFORMIN + EMPAGLIFLOZIN'),('metformin',1,'ftr1.',NULL,'SYNJARDY 5mg/850mg tablets'),('metformin',1,'ftr2.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('metformin',1,'ftr3.',NULL,'SYNJARDY 5mg/1000mg tablets'),('metformin',1,'ftr4.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('metformin',1,'ftr5.',NULL,'SYNJARDY 12.5mg/850mg tablets'),('metformin',1,'ftr6.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('metformin',1,'ftr7.',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('metformin',1,'ftr8.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('metformin',1,'x01Li',NULL,'Metformin'),('metformin',1,'x02e3',NULL,'Glucamet'),('metformin',1,'x02e6',NULL,'Glucophage'),('metformin',1,'x02m0',NULL,'Orabet'),('metformin',1,'x043H',NULL,'Glucamet 500'),('metformin',1,'x043I',NULL,'Glucamet 850'),('metformin',1,'x05ql',NULL,'Avandamet'),('metformin',1,'x05vz',NULL,'Glucophage SR');
INSERT INTO #codesctv3
VALUES ('sglt2-inhibitors',1,'ftr..',NULL,'METFORMIN + EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftr7.',NULL,'SYNJARDY 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr5.',NULL,'SYNJARDY 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr3.',NULL,'SYNJARDY 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr1.',NULL,'SYNJARDY 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr8.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr6.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 12.5mg/850mg tablets'),('sglt2-inhibitors',1,'ftr4.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftr2.',NULL,'EMPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'fto..',NULL,'EMPAGLIFLOZIN'),('sglt2-inhibitors',1,'fto3.',NULL,'JARDIANCE 25mg tablets'),('sglt2-inhibitors',1,'fto1.',NULL,'JARDIANCE 10mg tablets'),('sglt2-inhibitors',1,'fto4.',NULL,'EMPAGLIFLOZIN 25mg tablets'),('sglt2-inhibitors',1,'fto2.',NULL,'EMPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'ftm..',NULL,'METFORMIN + DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'ftm3.',NULL,'XIGDUO 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm1.',NULL,'XIGDUO 5mg/850mg tablets'),('sglt2-inhibitors',1,'ftm4.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/1000mg tablets'),('sglt2-inhibitors',1,'ftm2.',NULL,'DAPAGLIFLOZIN+METFORMIN HYDROCHLORIDE 5mg/850mg tablets'),('sglt2-inhibitors',1,'fth..',NULL,'DAPAGLIFLOZIN'),('sglt2-inhibitors',1,'fth2.',NULL,'FORXIGA 10mg tablets'),('sglt2-inhibitors',1,'fth1.',NULL,'FORXIGA 5mg tablets'),('sglt2-inhibitors',1,'fth4.',NULL,'DAPAGLIFLOZIN 10mg tablets'),('sglt2-inhibitors',1,'fth3.',NULL,'DAPAGLIFLOZIN 5mg tablets'),('sglt2-inhibitors',1,'ftp..',NULL,'METFORMIN + CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftp3.',NULL,'VOKANAMET 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp1.',NULL,'VOKANAMET 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftp4.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/1000mg tablets'),('sglt2-inhibitors',1,'ftp2.',NULL,'CANAGLIFLOZIN+METFORMIN HYDROCHLORIDE 50mg/850mg tablets'),('sglt2-inhibitors',1,'ftn..',NULL,'CANAGLIFLOZIN'),('sglt2-inhibitors',1,'ftn3.',NULL,'INVOKANA 300mg tablets'),('sglt2-inhibitors',1,'ftn1.',NULL,'INVOKANA 100mg tablets'),('sglt2-inhibitors',1,'ftn4.',NULL,'CANAGLIFLOZIN 300mg tablets'),('sglt2-inhibitors',1,'ftn2.',NULL,'CANAGLIFLOZIN 100mg tablets');
INSERT INTO #codesctv3
VALUES ('bmi',2,'22K..',NULL,'Body Mass Index'),('bmi',2,'X76CO',NULL,'Quetelet index'),('bmi',2,'Xa7wG',NULL,'Observation of body mass index'),('bmi',2,'XaZcl',NULL,'Baseline body mass index');
INSERT INTO #codesctv3
VALUES ('cholesterol',2,'XSK14',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',2,'44P..',NULL,'Serum cholesterol'),('cholesterol',2,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',2,'XE2eD',NULL,'Serum cholesterol'),('cholesterol',2,'XaJe9',NULL,'Serum total cholesterol level'),('cholesterol',2,'X772L',NULL,'Cholesterol level'),('cholesterol',2,'XaFs9',NULL,'Fasting cholesterol level'),('cholesterol',2,'XaIRd',NULL,'Plasma total cholesterol level'),('cholesterol',2,'XaLux',NULL,'Serum fasting total cholesterol');
INSERT INTO #codesctv3
VALUES ('diastolic-blood-pressure',1,'X779S',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'X779T',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'Xac5K',NULL,'Baseline diastolic BP'),('diastolic-blood-pressure',1,'Xaedp',NULL,'Non-invasive centrl diastlc BP'),('diastolic-blood-pressure',1,'XaF4a',NULL,'Ave day diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4b',NULL,'Ave 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4e',NULL,'24h diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4Q',NULL,'Min diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4R',NULL,'Max diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4S',NULL,'Ave diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4T',NULL,'Min day diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4U',NULL,'Min night diast blood pressure'),('diastolic-blood-pressure',1,'XaF4V',NULL,'Min 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4W',NULL,'Max night diast blood pressure'),('diastolic-blood-pressure',1,'XaF4X',NULL,'Max day diast blood pressure'),('diastolic-blood-pressure',1,'XaF4Y',NULL,'Max 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4Z',NULL,'Ave night diast blood pressure'),('diastolic-blood-pressure',1,'XaIwk',NULL,'Standing diastolic BP'),('diastolic-blood-pressure',1,'XaJ2F',NULL,'Sitting diastolic BP'),('diastolic-blood-pressure',1,'XaJ2H',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'XaKFw',NULL,'Average home diastolic BP'),('diastolic-blood-pressure',1,'XaKjG',NULL,'Ambulatory diastolic BP'),('diastolic-blood-pressure',1,'XM02Y',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'246o1',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246n0',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246f.',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246A.',NULL,'O/E - Diastolic BP reading');
INSERT INTO #codesctv3
VALUES ('egfr',1,'X70kK',NULL,'Tc99m-DTPA clearance - GFR'),('egfr',1,'X70kL',NULL,'Cr51- EDTA clearance - GFR'),('egfr',1,'X90kf',NULL,'With GFR'),('egfr',1,'XaK8y',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'XaMDA',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'XaZpN',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'XacUJ',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'XacUK',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'XSFyN',NULL,'Glomerular filtration rate');
INSERT INTO #codesctv3
VALUES ('hba1c',2,'XaERp',NULL,'HbA1c level (DCCT aligned)'),('hba1c',2,'XaPbt',NULL,'HbA1c levl - IFCC standardised'),('hba1c',2,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W4.',NULL,'HbA1c level (DCCT aligned)');
INSERT INTO #codesctv3
VALUES ('hdl-cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44PC.',NULL,'Ser random HDL cholesterol lev'),('hdl-cholesterol',1,'XaEVr',NULL,'Plasma HDL cholesterol level'),('hdl-cholesterol',1,'44d2.',NULL,'Plasma random HDL cholesterol level'),('hdl-cholesterol',1,'44d3.',NULL,'Plasma fasting HDL cholesterol level'),('hdl-cholesterol',1,'44PB.',NULL,'Serum fasting HDL cholesterol level');
INSERT INTO #codesctv3
VALUES ('ldl-cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'XaIp4',NULL,'Calculated LDL cholesterol lev'),('ldl-cholesterol',1,'XaEVs',NULL,'Plasma LDL cholesterol level'),('ldl-cholesterol',1,'44d4.',NULL,'Plasma random LDL cholesterol levell'),('ldl-cholesterol',1,'44d5.',NULL,'Plasma fasting LDL cholesterol level'),('ldl-cholesterol',1,'44PD.',NULL,'Serum fasting LDL cholesterol level'),('ldl-cholesterol',1,'44PE.',NULL,'Serum random LDL cholesterol level');
INSERT INTO #codesctv3
VALUES ('sex-hormone-binding-globulin',1,'44CD.',NULL,'Serum sex hormone binding globulin level');
INSERT INTO #codesctv3
VALUES ('systolic-blood-pressure',1,'X779Q',NULL,'Non-invasive systol art press'),('systolic-blood-pressure',1,'X779R',NULL,'Invasive systol arterial press'),('systolic-blood-pressure',1,'Xac5L',NULL,'Baseline systolic BP'),('systolic-blood-pressure',1,'Xaedo',NULL,'Non-invasive central systlc BP'),('systolic-blood-pressure',1,'XaF4d',NULL,'24h systolic blood pressure'),('systolic-blood-pressure',1,'XaF4D',NULL,'Min systolic blood pressure'),('systolic-blood-pressure',1,'XaF4E',NULL,'Max systolic blood pressure'),('systolic-blood-pressure',1,'XaF4F',NULL,'Ave systolic blood pressure'),('systolic-blood-pressure',1,'XaF4G',NULL,'Min day systol blood pressure'),('systolic-blood-pressure',1,'XaF4H',NULL,'Min night syst blood pressure'),('systolic-blood-pressure',1,'XaF4I',NULL,'Max night syst blood pressure'),('systolic-blood-pressure',1,'XaF4J',NULL,'Max day syst blood pressure'),('systolic-blood-pressure',1,'XaF4K',NULL,'Ave night syst blood pressure'),('systolic-blood-pressure',1,'XaF4L',NULL,'Ave day systol blood pressure'),('systolic-blood-pressure',1,'XaF4M',NULL,'Min 24h systol blood pressure'),('systolic-blood-pressure',1,'XaF4N',NULL,'Max 24h systol blood pressure'),('systolic-blood-pressure',1,'XaF4O',NULL,'Ave 24h systol blood pressure'),('systolic-blood-pressure',1,'XaIwj',NULL,'Standing systolic BP'),('systolic-blood-pressure',1,'XaJ2E',NULL,'Sitting systolic BP'),('systolic-blood-pressure',1,'XaJ2G',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'XaKFx',NULL,'Average home systolic BP'),('systolic-blood-pressure',1,'XaKjF',NULL,'Ambulatory systolic BP'),('systolic-blood-pressure',1,'XM02X',NULL,'SAP - Systol arterial pressure'),('systolic-blood-pressure',1,'246o0',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246n1',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246l.',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246e.',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246d.',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246b.',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246W.',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246S.',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246Q.',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246N.',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'2469.',NULL,'O/E - Systolic BP reading');
INSERT INTO #codesctv3
VALUES ('testosterone',1,'XE2dr',NULL,'Serum testosterone level'),('testosterone',1,'4473.',NULL,'Serum testosterone'),('testosterone',1,'XaItQ',NULL,'Plasma testosterone level');
INSERT INTO #codesctv3
VALUES ('triglycerides',1,'XE2q9',NULL,'Serum triglycerides'),('triglycerides',1,'XE2q9',NULL,'Serum triglyceride levels'),('triglycerides',1,'44Q4.',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44QZ.',NULL,'Serum triglycerides NOS'),('triglycerides',1,'44e..',NULL,'Plasma triglyceride level'),('triglycerides',1,'44e0.',NULL,'Plasma random triglyceride level'),('triglycerides',1,'44e1.',NULL,'Plasma fasting triglyceride level'),('triglycerides',1,'44Q..',NULL,'Serum triglycerides'),('triglycerides',1,'44Q5.',NULL,'Serum random triglyceride level'),('triglycerides',1,'X772O',NULL,'Triglyceride level');
INSERT INTO #codesctv3
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'XE2n3',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'X773Y',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'XE2n4',NULL,'Urine microalbumin/creatinine ratio');
INSERT INTO #codesctv3
VALUES ('vitamin-d',1,'44LA.',NULL,'Serum vitamin D'),('vitamin-d',1,'Xabo0',NULL,'Serum total 25-OH vit D level'),('vitamin-d',1,'XaY6m',NULL,'Total 25-hydroxyvitamin D levl'),('vitamin-d',1,'XE2e7',NULL,'Serum vitamin D level'),('vitamin-d',1,'XaXhN',NULL,'Vitamin D level'),('vitamin-d',1,'XaXhT',NULL,'Combined total vit D2 + D3 lvl'),('vitamin-d',1,'XaXm0',NULL,'25-Hydroxyvitamin D level')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('metformin',1,'109081006',NULL,'Metformin product'),('metformin',1,'109083009',NULL,'Metformin hydrochloride (substance)'),('metformin',1,'1097191000000106',NULL,'Metformin therapy (procedure)'),('metformin',1,'325278007',NULL,'Product containing precisely metformin hydrochloride 500 milligram/1 each conventional release oral tablet'),('metformin',1,'325279004',NULL,'Product containing precisely metformin hydrochloride 850 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'372567009',NULL,'Metformin'),('metformin',1,'376701008',NULL,'Product containing precisely metformin hydrochloride 1 gram/1 each conventional release oral tablet'),('metformin',1,'409120009',NULL,'Metformin and rosiglitazone product'),('metformin',1,'409121008',NULL,'Product containing precisely metformin hydrochloride 500 milligram and rosiglitazone (as rosiglitazone maleate) 1 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'409122001',NULL,'Metformin hydrochloride 500 mg and rosiglitazone (as rosiglitazone maleate) 2 mg oral tablet'),('metformin',1,'409123006',NULL,'Product containing precisely metformin hydrochloride 500 milligram and rosiglitazone maleate 4 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'409124000',NULL,'Metformin hydrochloride 1 g and rosiglitazone (as rosiglitazone maleate) 2 mg oral tablet'),('metformin',1,'409125004',NULL,'Product containing precisely metformin hydrochloride 1 gram and rosiglitazone (as rosiglitazone maleate) 4 milligram/1 each conventional release oral tablet'),('metformin',1,'409187009',NULL,'Product containing precisely glibenclamide 1.25 milligram and metformin hydrochloride 250 milligram/1 each conventional release oral tablet'),('metformin',1,'409188004',NULL,'Glibenclamide 2.5 mg and metformin hydrochloride 500 mg oral tablet'),('metformin',1,'409189007',NULL,'Product containing precisely glibenclamide 5 milligram and metformin hydrochloride 500 milligram/1 each conventional release oral tablet'),('metformin',1,'409197000',NULL,'Product containing precisely metformin hydrochloride 100 milligram/1 milliliter conventional release oral solution'),('metformin',1,'409363003',NULL,'Product containing precisely glipizide 2.5 milligram and metformin hydrochloride 250 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'409364009',NULL,'Product containing precisely glipizide 2.5 milligram and metformin hydrochloride 500 milligram/1 each conventional release oral tablet'),('metformin',1,'409365005',NULL,'Product containing precisely glipizide 5 milligram and metformin hydrochloride 500 milligram/1 each conventional release oral tablet'),('metformin',1,'409366006',NULL,'Product containing precisely metformin hydrochloride 625 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'418835009',NULL,'Metformin and pioglitazone product'),('metformin',1,'419575000',NULL,'Product containing precisely metformin hydrochloride 500 milligram and pioglitazone hydrochloride 15 milligram/1 each conventional release oral tablet'),('metformin',1,'419873003',NULL,'Metformin hydrochloride 850 mg and pioglitazone (as pioglitazone hydrochloride) 15 mg oral tablet'),('metformin',1,'425651000',NULL,'Product containing precisely metformin hydrochloride 1 gram and sitagliptin phosphate 50 milligram/1 each conventional release oral tablet'),('metformin',1,'426046000',NULL,'Product containing precisely metformin hydrochloride 500 milligram and sitagliptin phosphate 50 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'427522005',NULL,'Metformin and sitagliptin product'),('metformin',1,'438340003',NULL,'Metformin and repaglinide product'),('metformin',1,'441011003',NULL,'Product containing precisely metformin hydrochloride 500 milligram and repaglinide 2 milligram/1 each conventional release oral tablet'),('metformin',1,'441071009',NULL,'Product containing precisely metformin hydrochloride 500 milligram and repaglinide 1 milligram/1 each conventional release oral tablet (clinical drug)'),('metformin',1,'448802007',NULL,'Metformin hydrochloride 1000mg + Saxagliptin 2.5mg extended release tablet'),('metformin',1,'448832004',NULL,'Metformin hydrochloride 500mg + Saxagliptin 5mg extended release tablet'),('metformin',1,'448833009',NULL,'Metformin hydrochloride 1000mg + Saxagliptin 5mg extended release tablet'),('metformin',1,'714599005',NULL,'Product containing metformin in oral dosage form'),('metformin',1,'714686000',NULL,'Empagliflozin and metformin product'),('metformin',1,'714779001',NULL,'Canagliflozin and metformin product'),('metformin',1,'714780003',NULL,'Product containing canagliflozin and metformin in oral dosage form'),('metformin',1,'715702002',NULL,'Linagliptin and metformin product'),('metformin',1,'715703007',NULL,'Linagliptin and metformin in oral dosage form'),('metformin',1,'734558009',NULL,'Metformin pamoate (substance)'),('metformin',1,'765507008',NULL,'Metformin hydrochloride 500 mg prolonged-release oral tablet'),('metformin',1,'765550003',NULL,'Product containing precisely metformin hydrochloride 1 gram/1 each prolonged-release oral tablet'),('metformin',1,'765582000',NULL,'Pioglitazone 30mg + metformin 1g prolonged-release oral tablet'),('metformin',1,'765681004',NULL,'Pioglitazone 15mg + metformin 1g prolonged-release oral tablet (product)'),('metformin',1,'765703005',NULL,'Product containing precisely metformin hydrochloride 750 milligram/1 each prolonged-release oral tablet (clinical drug)'),('metformin',1,'768156002',NULL,'Product containing metformin and rosiglitazone in oral dosage form (medicinal product form)'),('metformin',1,'768291001',NULL,'Product containing metformin and pioglitazone in oral dosage form'),('metformin',1,'768500006',NULL,'Glyburide and metformin product'),('metformin',1,'768501005',NULL,'Glibenclamide and metformin in oral dosage form'),('metformin',1,'768506000',NULL,'Product containing glipizide and metformin'),('metformin',1,'768507009',NULL,'Glipizide and metformin in oral dosage form'),('metformin',1,'768920004',NULL,'Product containing metformin and sitagliptin in oral dosage form'),('metformin',1,'768921000',NULL,'Metformin and repaglinide in oral dosage form');
INSERT INTO #codessnomed
VALUES ('sglt2-inhibitors',1,'703894008',NULL,'Empagliflozin (substance)'),('sglt2-inhibitors',1,'703895009',NULL,'Empagliflozin product'),('sglt2-inhibitors',1,'703896005',NULL,'Product containing precisely empagliflozin 10 milligram/1 each conventional release oral tablet (clinical drug)'),('sglt2-inhibitors',1,'703897001',NULL,'Product containing precisely empagliflozin 25 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'714685001',NULL,'Empagliflozin and linagliptin product'),('sglt2-inhibitors',1,'714686000',NULL,'Empagliflozin and metformin product'),('sglt2-inhibitors',1,'764274008',NULL,'Ertugliflozin (substance)'),('sglt2-inhibitors',1,'764275009',NULL,'Ertugliflozin product'),('sglt2-inhibitors',1,'764276005',NULL,'Product containing ertugliflozin in oral dosage form'),('sglt2-inhibitors',1,'768137007',NULL,'Product containing empagliflozin in oral dosage form'),('sglt2-inhibitors',1,'21609511000001105',NULL,'Forxiga 5mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) (product)'),('sglt2-inhibitors',1,'21609811000001108',NULL,'Forxiga 10mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) (product)'),('sglt2-inhibitors',1,'24018111000001106',NULL,'Xigduo 5mg/850mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) (product)'),('sglt2-inhibitors',1,'24018511000001102',NULL,'Xigduo 5mg/1000mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) (product)'),('sglt2-inhibitors',1,'703674001',NULL,'Dapagliflozin'),('sglt2-inhibitors',1,'703675000',NULL,'Dapagliflozin propanediol (substance)'),('sglt2-inhibitors',1,'703678003',NULL,'Dapagliflozin product'),('sglt2-inhibitors',1,'703679006',NULL,'Product containing precisely dapagliflozin propanediol 5 milligram/1 each conventional release oral tablet (clinical drug)'),('sglt2-inhibitors',1,'703680009',NULL,'Dapagliflozin propanediol 10 mg oral tablet'),('sglt2-inhibitors',1,'767961002',NULL,'Product containing dapagliflozin in oral dosage form (medicinal product form)'),('sglt2-inhibitors',1,'24054611000001100',NULL,'Dapagliflozin 5mg / Metformin 1g tablets (product)'),('sglt2-inhibitors',1,'24054711000001109',NULL,'Dapagliflozin 5mg / Metformin 850mg tablets (product)'),('sglt2-inhibitors',1,'39689811000001104',NULL,'Dapagliflozin 10mg tablets (product)'),('sglt2-inhibitors',1,'39689911000001109',NULL,'Dapagliflozin 5mg tablets (product)'),('sglt2-inhibitors',1,'24088311000001106',NULL,'Invokana 300mg tablets (Janssen-Cilag Ltd) (product)'),('sglt2-inhibitors',1,'24088611000001101',NULL,'Invokana 100mg tablets (Janssen-Cilag Ltd) (product)'),('sglt2-inhibitors',1,'703676004',NULL,'Canagliflozin (substance)'),('sglt2-inhibitors',1,'703681008',NULL,'Canagliflozin product'),('sglt2-inhibitors',1,'703682001',NULL,'Product containing precisely canagliflozin 100 milligram/1 each conventional release oral tablet (clinical drug)'),('sglt2-inhibitors',1,'714779001',NULL,'Canagliflozin and metformin product'),('sglt2-inhibitors',1,'714780003',NULL,'Product containing canagliflozin and metformin in oral dosage form'),('sglt2-inhibitors',1,'725664009',NULL,'Canagliflozin hemihydrate'),('sglt2-inhibitors',1,'765627002',NULL,'Canagliflozin 300 mg conventional release oral tablet (product)'),('sglt2-inhibitors',1,'768045004',NULL,'Product containing canagliflozin in oral dosage form (medicinal product form)'),('sglt2-inhibitors',1,'24104511000001103',NULL,'Canagliflozin 300mg tablets (product)'),('sglt2-inhibitors',1,'28049211000001101',NULL,'Canagliflozin 50mg / Metformin 1g tablets (product)'),('sglt2-inhibitors',1,'28049311000001109',NULL,'Canagliflozin 50mg / Metformin 850mg tablets (product)'),('sglt2-inhibitors',1,'39734511000001100',NULL,'Canagliflozin 100mg tablets (product)'),('sglt2-inhibitors',1,'25238811000001107',NULL,'Jardiance 10mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'25239711000001108',NULL,'Jardiance 25mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'25290511000001101',NULL,'Empagliflozin 10mg tablets (product)'),('sglt2-inhibitors',1,'25290611000001102',NULL,'Empagliflozin 25mg tablets (product)'),('sglt2-inhibitors',1,'28022511000001109',NULL,'Vokanamet 50mg/850mg tablets (Janssen-Cilag Ltd) (product)'),('sglt2-inhibitors',1,'28024411000001103',NULL,'Vokanamet 50mg/1000mg tablets (Janssen-Cilag Ltd) (product)'),('sglt2-inhibitors',1,'30173411000001107',NULL,'Synjardy 5mg/850mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'30174111000001100',NULL,'Synjardy 5mg/1000mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'30175011000001102',NULL,'Synjardy 12.5mg/850mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'30175711000001100',NULL,'Synjardy 12.5mg/1000mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'30318111000001109',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets (product)'),('sglt2-inhibitors',1,'30318211000001103',NULL,'Empagliflozin 12.5mg / Metformin 850mg tablets (product)'),('sglt2-inhibitors',1,'30318311000001106',NULL,'Empagliflozin 5mg / Metformin 1g tablets (product)'),('sglt2-inhibitors',1,'30318411000001104',NULL,'Empagliflozin 5mg / Metformin 850mg tablets (product)'),('sglt2-inhibitors',1,'37437811000001105',NULL,'Forxiga 5mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'38135511000001105',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'38912311000001101',NULL,'Forxiga 5mg tablets (Ethigen Ltd) (product)'),('sglt2-inhibitors',1,'37989211000001109',NULL,'Forxiga 5mg tablets (Pharmaram Ltd) (product)'),('sglt2-inhibitors',1,'28425111000001103',NULL,'Forxiga 5mg tablets (Waymade Healthcare Plc) (product)'),('sglt2-inhibitors',1,'21609311000001104',NULL,'Dapagliflozin 5mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'40524311000001108',NULL,'Dapagliflozin 5mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'21609711000001100',NULL,'Dapagliflozin 10mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'36893011000001105',NULL,'Dapagliflozin 10mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'37437511000001107',NULL,'Forxiga 10mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'38135711000001100',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'37665511000001108',NULL,'Forxiga 10mg tablets (Ethigen Ltd) (product)'),('sglt2-inhibitors',1,'36893111000001106',NULL,'Forxiga 10mg tablets (Pharmaram Ltd) (product)'),('sglt2-inhibitors',1,'27990411000001100',NULL,'Forxiga 10mg tablets (Waymade Healthcare Plc) (product)'),('sglt2-inhibitors',1,'21609611000001109',NULL,'Forxiga 5mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) 28 tablet 2 x 14 tablets (product)'),('sglt2-inhibitors',1,'37437911000001100',NULL,'Forxiga 5mg tablets (CST Pharma Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'38135611000001109',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals) 28 tablet (product)'),('sglt2-inhibitors',1,'38912411000001108',NULL,'Forxiga 5mg tablets (Ethigen Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'37989311000001101',NULL,'Forxiga 5mg tablets (Pharmaram Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'28425211000001109',NULL,'Forxiga 5mg tablets (Waymade Healthcare Plc) 28 tablet (product)'),('sglt2-inhibitors',1,'40524411000001101',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals) 30 tablet (product)'),('sglt2-inhibitors',1,'21609911000001103',NULL,'Forxiga 10mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) 28 tablet 2 x 14 tablets (product)'),('sglt2-inhibitors',1,'37437611000001106',NULL,'Forxiga 10mg tablets (CST Pharma Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'38135811000001108',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals) 28 tablet (product)'),('sglt2-inhibitors',1,'37665611000001107',NULL,'Forxiga 10mg tablets (Ethigen Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'36893211000001100',NULL,'Forxiga 10mg tablets (Pharmaram Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'27990511000001101',NULL,'Forxiga 10mg tablets (Waymade Healthcare Plc) 28 tablet (product)'),('sglt2-inhibitors',1,'37437711000001102',NULL,'Forxiga 10mg tablets (CST Pharma Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'38135911000001103',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals) 30 tablet (product)'),('sglt2-inhibitors',1,'37665711000001103',NULL,'Forxiga 10mg tablets (Ethigen Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'36893311000001108',NULL,'Forxiga 10mg tablets (Pharmaram Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'37989711000001102',NULL,'Canagliflozin 100mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'24088511000001100',NULL,'Canagliflozin 100mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'38140911000001106',NULL,'Invokana 100mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'37667011000001107',NULL,'Invokana 100mg tablets (Ethigen Ltd) (product)'),('sglt2-inhibitors',1,'24088611000001101',NULL,'Invokana 100mg tablets (Janssen-Cilag Ltd) (product)'),('sglt2-inhibitors',1,'37512611000001109',NULL,'Invokana 100mg tablets (Mawdsley-Brooks & Company Ltd) (product)'),('sglt2-inhibitors',1,'37989611000001106',NULL,'Invokana 100mg tablets (Pharmaram Ltd) (product)'),('sglt2-inhibitors',1,'37989811000001105',NULL,'Invokana 100mg tablets (Pharmaram Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'38141011000001103',NULL,'Invokana 100mg tablets (DE Pharmaceuticals) 30 tablet (product)'),('sglt2-inhibitors',1,'37667111000001108',NULL,'Invokana 100mg tablets (Ethigen Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'24088711000001105',NULL,'Invokana 100mg tablets (Janssen-Cilag Ltd) 30 tablet 3 x 10 tablets (product)'),('sglt2-inhibitors',1,'37512711000001100',NULL,'Invokana 100mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'24088311000001106',NULL,'Invokana 300mg tablets (Janssen-Cilag Ltd) (product)'),
('sglt2-inhibitors',1,'37512811000001108',NULL,'Invokana 300mg tablets (Mawdsley-Brooks & Company Ltd) (product)'),('sglt2-inhibitors',1,'40298411000001108',NULL,'Invokana 300mg tablets (Pilsco Ltd) (product)'),('sglt2-inhibitors',1,'24088211000001103',NULL,'Canagliflozin 300mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'24088411000001104',NULL,'Invokana 300mg tablets (Janssen-Cilag Ltd) 30 tablet 3 x 10 tablets (product)'),('sglt2-inhibitors',1,'37512911000001103',NULL,'Invokana 300mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'40298511000001107',NULL,'Invokana 300mg tablets (Pilsco Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'25238711000001104',NULL,'Empagliflozin 10mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'36804611000001102',NULL,'Empagliflozin 10mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'37440811000001107',NULL,'Jardiance 10mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'38142111000001107',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'37668511000001100',NULL,'Jardiance 10mg tablets (Ethigen Ltd) (product)'),('sglt2-inhibitors',1,'37526411000001104',NULL,'Jardiance 10mg tablets (Mawdsley-Brooks & Company Ltd) (product)'),('sglt2-inhibitors',1,'36804511000001101',NULL,'Jardiance 10mg tablets (Originalis B.V.) (product)'),('sglt2-inhibitors',1,'25238911000001102',NULL,'Jardiance 10mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets (product)'),('sglt2-inhibitors',1,'37440911000001102',NULL,'Jardiance 10mg tablets (CST Pharma Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'38142211000001101',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals) 28 tablet (product)'),('sglt2-inhibitors',1,'40660511000001105',NULL,'Jardiance 10mg tablets (Ethigen Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'37441011000001105',NULL,'Jardiance 10mg tablets (CST Pharma Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'38142311000001109',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals) 30 tablet (product)'),('sglt2-inhibitors',1,'37668711000001105',NULL,'Jardiance 10mg tablets (Ethigen Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'37526511000001100',NULL,'Jardiance 10mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'36804711000001106',NULL,'Jardiance 10mg tablets (Originalis B.V.) 30 tablet (product)'),('sglt2-inhibitors',1,'25239411000001102',NULL,'Empagliflozin 25mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'36804911000001108',NULL,'Empagliflozin 25mg tablets 30 tablet (product)'),('sglt2-inhibitors',1,'37441111000001106',NULL,'Jardiance 25mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'38142411000001102',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'37526711000001105',NULL,'Jardiance 25mg tablets (Mawdsley-Brooks & Company Ltd) (product)'),('sglt2-inhibitors',1,'36804811000001103',NULL,'Jardiance 25mg tablets (Originalis B.V.) (product)'),('sglt2-inhibitors',1,'25240111000001103',NULL,'Jardiance 25mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets (product)'),('sglt2-inhibitors',1,'37441211000001100',NULL,'Jardiance 25mg tablets (CST Pharma Ltd) 28 tablet (product)'),('sglt2-inhibitors',1,'38142511000001103',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals) 28 tablet (product)'),('sglt2-inhibitors',1,'37441311000001108',NULL,'Jardiance 25mg tablets (CST Pharma Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'38142611000001104',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals) 30 tablet (product)'),('sglt2-inhibitors',1,'37526911000001107',NULL,'Jardiance 25mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet (product)'),('sglt2-inhibitors',1,'36805011000001108',NULL,'Jardiance 25mg tablets (Originalis B.V.) 30 tablet (product)'),('sglt2-inhibitors',1,'36529511000001109',NULL,'Ertugliflozin 5mg tablets (product)'),('sglt2-inhibitors',1,'36514711000001109',NULL,'Ertugliflozin 5mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'36514811000001101',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme (UK) Ltd) (product)'),('sglt2-inhibitors',1,'36514911000001106',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme (UK) Ltd) 28 tablet 4 x 7 tablets (product)'),('sglt2-inhibitors',1,'36529411000001105',NULL,'Ertugliflozin 15mg tablets (product)'),('sglt2-inhibitors',1,'36515011000001106',NULL,'Ertugliflozin 15mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'36515111000001107',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme (UK) Ltd) (product)'),('sglt2-inhibitors',1,'36515211000001101',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme (UK) Ltd) 28 tablet 4 x 7 tablets (product)'),('sglt2-inhibitors',1,'30173311000001100',NULL,'Empagliflozin 5mg / Metformin 850mg tablets 56 tablet (product)'),('sglt2-inhibitors',1,'30173611000001105',NULL,'Synjardy 5mg/850mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets (product)'),('sglt2-inhibitors',1,'30174711000001104',NULL,'Empagliflozin 12.5mg / Metformin 850mg tablets 56 tablet (product)'),('sglt2-inhibitors',1,'30175211000001107',NULL,'Synjardy 12.5mg/850mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets (product)'),('sglt2-inhibitors',1,'30173911000001104',NULL,'Empagliflozin 5mg / Metformin 1g tablets 56 tablet (product)'),('sglt2-inhibitors',1,'37852811000001101',NULL,'Empagliflozin 5mg / Metformin 1g tablets 60 tablet (product)'),('sglt2-inhibitors',1,'37852711000001109',NULL,'Synjardy 5mg/1000mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'30174211000001106',NULL,'Synjardy 5mg/1000mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets (product)'),('sglt2-inhibitors',1,'37853011000001103',NULL,'Synjardy 5mg/1000mg tablets (CST Pharma Ltd) 60 tablet (product)'),('sglt2-inhibitors',1,'30175611000001109',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets 56 tablet (product)'),('sglt2-inhibitors',1,'37853111000001102',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets 60 tablet (product)'),('sglt2-inhibitors',1,'37853211000001108',NULL,'Synjardy 12.5mg/1000mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'30175911000001103',NULL,'Synjardy 12.5mg/1000mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets (product)'),('sglt2-inhibitors',1,'37853311000001100',NULL,'Synjardy 12.5mg/1000mg tablets (CST Pharma Ltd) 60 tablet (product)'),('sglt2-inhibitors',1,'24018411000001101',NULL,'Dapagliflozin 5mg / Metformin 1g tablets 56 tablet (product)'),('sglt2-inhibitors',1,'37538511000001102',NULL,'Xigduo 5mg/1000mg tablets (CST Pharma Ltd) (product)'),('sglt2-inhibitors',1,'38176411000001100',NULL,'Xigduo 5mg/1000mg tablets (DE Pharmaceuticals) (product)'),('sglt2-inhibitors',1,'24018611000001103',NULL,'Xigduo 5mg/1000mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) 56 tablet 4 x 14 tablets (product)'),('sglt2-inhibitors',1,'37538611000001103',NULL,'Xigduo 5mg/1000mg tablets (CST Pharma Ltd) 56 tablet (product)'),('sglt2-inhibitors',1,'38176511000001101',NULL,'Xigduo 5mg/1000mg tablets (DE Pharmaceuticals) 56 tablet (product)'),('sglt2-inhibitors',1,'24018011000001105',NULL,'Dapagliflozin 5mg / Metformin 850mg tablets 56 tablet (product)'),('sglt2-inhibitors',1,'24018211000001100',NULL,'Xigduo 5mg/850mg tablets (Bristol-Myers Squibb Pharmaceuticals Ltd) 56 tablet 4 x 14 tablets (product)'),('sglt2-inhibitors',1,'28022211000001106',NULL,'Canagliflozin 50mg / Metformin 850mg tablets 60 tablet (product)'),('sglt2-inhibitors',1,'28022911000001102',NULL,'Vokanamet 50mg/850mg tablets (Janssen-Cilag Ltd) 60 tablet (product)'),('sglt2-inhibitors',1,'28024111000001108',NULL,'Canagliflozin 50mg / Metformin 1g tablets 60 tablet (product)'),('sglt2-inhibitors',1,'28024611000001100',NULL,'Vokanamet 50mg/1000mg tablets (Janssen-Cilag Ltd) 60 tablet (product)'),('sglt2-inhibitors',1,'33745311000001109',NULL,'Saxagliptin 5mg / Dapagliflozin 10mg tablets (product)'),('sglt2-inhibitors',1,'33682211000001106',NULL,'Saxagliptin 5mg / Dapagliflozin 10mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'33682311000001103',NULL,'Qtern 5mg/10mg tablets (AstraZeneca UK Ltd) (product)'),('sglt2-inhibitors',1,'33682411000001105',NULL,'Qtern 5mg/10mg tablets (AstraZeneca UK Ltd) 28 tablet 2 x 14 tablets (product)'),('sglt2-inhibitors',1,'37280311000001109',NULL,'Empagliflozin 10mg / Linagliptin 5mg tablets (product)'),('sglt2-inhibitors',1,'37225111000001106',NULL,'Empagliflozin 10mg / Linagliptin 5mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'37225211000001100',NULL,'Glyxambi 10mg/5mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'37225311000001108',NULL,'Glyxambi 10mg/5mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets (product)'),('sglt2-inhibitors',1,'37280511000001103',NULL,'Empagliflozin 25mg / Linagliptin 5mg tablets (product)'),('sglt2-inhibitors',1,'37225411000001101',NULL,'Empagliflozin 25mg / Linagliptin 5mg tablets 28 tablet (product)'),('sglt2-inhibitors',1,'37225511000001102',NULL,'Glyxambi 25mg/5mg tablets (Boehringer Ingelheim Ltd) (product)'),('sglt2-inhibitors',1,'37225611000001103',NULL,'Glyxambi 25mg/5mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets (product)');
INSERT INTO #codessnomed
VALUES ('bmi',2,'301331008',NULL,'Finding of body mass index (finding)'),('bmi',2,'60621009',NULL,'Body mass index (observable entity)'),('bmi',2,'846931000000101',NULL,'Baseline body mass index (observable entity)');
INSERT INTO #codessnomed
VALUES ('cholesterol',2,'1005671000000105',NULL,'Serum cholesterol level'),('cholesterol',2,'412808005',NULL,'Serum total cholesterol level'),('cholesterol',2,'121868005',NULL,'Total cholesterol measurement (procedure)'),('cholesterol',2,'994351000000103',NULL,'Serum total cholesterol level'),('cholesterol',2,'1106531000000105',NULL,'Substance concentration of cholesterol in plasma (observable entity)'),('cholesterol',2,'853681000000104',NULL,'Total cholesterol level (observable entity)'),('cholesterol',2,'850981000000101',NULL,'Cholesterol level (observable entity)'),('cholesterol',2,'1017161000000104',NULL,'Plasma total cholesterol level (observable entity)'),('cholesterol',2,'1106541000000101',NULL,'Substance concentration of cholesterol in serum (observable entity)'),('cholesterol',2,'1083761000000106',NULL,'Serum fasting total cholesterol level (observable entity)'),('cholesterol',2,'315017003',NULL,'Fasting cholesterol level (procedure)'),('cholesterol',2,'247801000000106',NULL,'Serum fasting total cholesterol (procedure)');
INSERT INTO #codessnomed
VALUES ('diastolic-blood-pressure',1,'174255007',NULL,'Non-invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'251073000',NULL,'Invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'271650006',NULL,'Diastolic arterial pressure'),('diastolic-blood-pressure',1,'314451001',NULL,'Minimum diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314452008',NULL,'Maximum diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314453003',NULL,'Average diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314454009',NULL,'Minimum day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314455005',NULL,'Minimum night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314456006',NULL,'Minimum 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314457002',NULL,'Maximum night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314458007',NULL,'Maximum day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314459004',NULL,'Maximum 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314460009',NULL,'Average night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314461008',NULL,'Average day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314462001',NULL,'Average 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314465004',NULL,'24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'400975005',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'407555005',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'407557002',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'413605002',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'446226005',NULL,'Diastolic blood pressure on admission'),('diastolic-blood-pressure',1,'716632005',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'198091000000104',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'1091811000000102',NULL,'Diastolic arterial pressure (observable entity)'),('diastolic-blood-pressure',1,'1036571000000105',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'163031004',NULL,'On examination - Diastolic BP reading'),('diastolic-blood-pressure',1,'100181000000103',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'1162735000',NULL,'Self reported diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'213051000000103',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'213061000000100',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'75141000000102',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'945851000000103',NULL,'Baseline diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'945861000000100',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'95291000000106',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'95311000000107',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'100161000000107',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'67726005',NULL,'Diastolic arterial pressure (observable entity)'),('diastolic-blood-pressure',1,'79411000000108',NULL,'Standing diastolic blood pressure');
INSERT INTO #codessnomed
VALUES ('egfr',1,'1011481000000105',NULL,'eGFR (estimated glomerular filtration rate) using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1011491000000107',NULL,'eGFR (estimated glomerular filtration rate) using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1020291000000106',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'1107411000000104',NULL,'eGFR (estimated glomerular filtration rate) by laboratory calculation'),('egfr',1,'241373003',NULL,'Technetium-99m-diethylenetriamine pentaacetic acid clearance - glomerular filtration rate (procedure)'),('egfr',1,'262300005',NULL,'With glomerular filtration rate'),('egfr',1,'737105002',NULL,'GFR (glomerular filtration rate) calculation technique'),('egfr',1,'80274001',NULL,'Glomerular filtration rate (observable entity)'),('egfr',1,'996231000000108',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'857971000000104',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula (observable entity)'),('egfr',1,'963601000000106',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation (observable entity)'),('egfr',1,'963611000000108',NULL,'Estimated glomerular filtration rate using cystatin C per 1.73 square metres'),('egfr',1,'963621000000102',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation (observable entity)'),('egfr',1,'963631000000100',NULL,'Estimated glomerular filtration rate using serum creatinine per 1.73 square metres'),('egfr',1,'857981000000102',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres');
INSERT INTO #codessnomed
VALUES ('hba1c',2,'1019431000000105',NULL,'HbA1c level (Diabetes Control and Complications Trial aligned)'),('hba1c',2,'999791000000106',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised');
INSERT INTO #codessnomed
VALUES ('hdl-cholesterol',1,'1005681000000107',NULL,'Serum high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1010581000000101',NULL,'Plasma high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1026461000000104',NULL,'Serum random high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1107661000000104',NULL,'Substance concentration of high density lipoprotein cholesterol in plasma (observable entity)'),('hdl-cholesterol',1,'1028831000000106',NULL,'Plasma random high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1107681000000108',NULL,'Substance concentration of high density lipoprotein cholesterol in serum (observable entity)'),('hdl-cholesterol',1,'1026451000000102',NULL,'Serum fasting high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1028841000000102',NULL,'Plasma fasting high density lipoprotein cholesterol level (observable entity)');
INSERT INTO #codessnomed
VALUES ('ldl-cholesterol',1,'1010591000000104',NULL,'Plasma low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1014501000000104',NULL,'Calculated low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1022191000000100',NULL,'Serum low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1026471000000106',NULL,'Serum fasting low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1026481000000108',NULL,'Serum random low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'53981000237105',NULL,'Substance concentration of low density lipoprotein cholesterol in plasma (observable entity)'),('ldl-cholesterol',1,'1108541000000100',NULL,'Substance concentration of low density lipoprotein cholesterol in plasma (observable entity)'),('ldl-cholesterol',1,'1108551000000102',NULL,'Substance concentration of low density lipoprotein cholesterol in serum (observable entity)'),('ldl-cholesterol',1,'1028861000000101',NULL,'Plasma fasting low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1028851000000104',NULL,'Plasma random low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'55621000237101',NULL,'Substance concentration of low density lipoprotein cholesterol in serum (observable entity)');
INSERT INTO #codessnomed
VALUES ('sex-hormone-binding-globulin',1,'999661000000105',NULL,'Serum sex hormone binding globulin level (observable entity)');
INSERT INTO #codessnomed
VALUES ('systolic-blood-pressure',1,'72313002',NULL,'Systolic arterial pressure (observable entity)'),('systolic-blood-pressure',1,'251070002',NULL,'Non-invasive systolic blood pressure'),('systolic-blood-pressure',1,'251071003',NULL,'Invasive systolic blood pressure'),('systolic-blood-pressure',1,'271649006',NULL,'SAP - Systolic arterial pressure'),('systolic-blood-pressure',1,'314438006',NULL,'Minimum systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314439003',NULL,'Maximum systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314440001',NULL,'Average systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314441002',NULL,'Minimum day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314442009',NULL,'Minimum night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314443004',NULL,'Maximum night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314444005',NULL,'Maximum day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314445006',NULL,'Average night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314446007',NULL,'Average day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314447003',NULL,'Minimum 24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314448008',NULL,'Maximum 24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314449000',NULL,'Average 24 hour systolic blood pressure (observable entity'),('systolic-blood-pressure',1,'314464000',NULL,'24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'399304008',NULL,'Systolic blood pressure on admission'),('systolic-blood-pressure',1,'400974009',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'407554009',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'407556006',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'413606001',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'716579001',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'198081000000101',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'1036551000000101',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'163030003',NULL,'On examination - Systolic blood pressure reading'),('systolic-blood-pressure',1,'213041000000101',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'79401000000106',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'945881000000109',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'95301000000105',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'100151000000109',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'100171000000100',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'1162737008',NULL,'Self reported systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'213031000000105',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'75131000000106',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'945871000000107',NULL,'Baseline systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'95281000000109',NULL,'Sitting systolic blood pressure');
INSERT INTO #codessnomed
VALUES ('testosterone',1,'270973006',NULL,'Serum testosterone measurement (procedure)'),('testosterone',1,'995571000000101',NULL,'Plasma testosterone level (observable entity)'),('testosterone',1,'997161000000108',NULL,'Serum testosterone level (observable entity)');
INSERT INTO #codessnomed
VALUES ('triglycerides',1,'1028871000000108',NULL,'Plasma random triglyceride level (observable entity)'),('triglycerides',1,'1031321000000109',NULL,'Plasma fasting triglyceride level (observable entity)'),('triglycerides',1,'850991000000104',NULL,'Triglyceride level (observable entity)'),('triglycerides',1,'1005691000000109',NULL,'Serum triglycerides level (observable entity)'),('triglycerides',1,'1109831000000104',NULL,'Substance concentration of triglyceride in serum (observable entity)'),('triglycerides',1,'1026491000000105',NULL,'Serum fasting triglyceride level (observable entity)'),('triglycerides',1,'1010601000000105',NULL,'Plasma triglyceride level (observable entity)'),('triglycerides',1,'1461000237101',NULL,'Substance concentration of triglyceride in serum (observable entity)'),('triglycerides',1,'1026501000000104',NULL,'Serum random triglyceride level (observable entity)'),('triglycerides',1,'1109821000000101',NULL,'Substance concentration of triglyceride in plasma (observable entity)'),('triglycerides',1,'365796000',NULL,'Finding of serum triglyceride levels (finding)'),('triglycerides',1,'271245006',NULL,'Measurement of serum triglyceride level (procedure)');
INSERT INTO #codessnomed
VALUES ('urinary-albumin-creatinine-ratio',1,'144011000',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'144765005',NULL,'Urine albumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'144766006',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'166721005',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'167540008',NULL,'Urine albumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'167541007',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'250745003',NULL,'Albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'271075006',NULL,'Urine albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'271076007',NULL,'Urine microalbumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'149861000000104',NULL,'Semi-quantitative result of albumin to creatinine ratio in urine by test strip'),('urinary-albumin-creatinine-ratio',1,'1023491000000104',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'1027791000000103',NULL,'Urine microalbumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'1028271000000109',NULL,'Albumin/creatinine ratio');
INSERT INTO #codessnomed
VALUES ('vitamin-d',1,'1007991000000105',NULL,'Serum total 25-hydroxy vitamin D level (observable entity)'),('vitamin-d',1,'1029801000000105',NULL,'Total 25-hydroxyvitamin D level (observable entity)'),('vitamin-d',1,'1031181000000107',NULL,'Serum vitamin D level (observable entity)'),('vitamin-d',1,'12199005',NULL,'Vitamin D, 25-hydroxy measurement (procedure)'),('vitamin-d',1,'270990000',NULL,'Serum vitamin D measurement (procedure)'),('vitamin-d',1,'83729008',NULL,'Vitamin D measurement (procedure)'),('vitamin-d',1,'996641000000102',NULL,'Combined total vitamin D2 and D3 level (observable entity)')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesemis
VALUES ('metformin',1,'META1787',NULL,'Metformin Hydrochloride  Tablets  500 mg'),('metformin',1,'MEM/19420NEMIS',NULL,'Metformin Hydrochloride  M/R Tablets  500 mg'),('metformin',1,'META1788',NULL,'Metformin Hydrochloride  Tablets  850 mg'),('metformin',1,'MEM/35043NEMIS',NULL,'Metformin Hydrochloride  M/R Tablets  1 gram'),('metformin',1,'META29314NEMIS',NULL,'Vildagliptin 50mg / Metformin 1g tablets'),('metformin',1,'META42230NEMIS',NULL,'Metformin And Sitagliptin  Tablets  1000 mg + 50 mg'),('metformin',1,'PITA23356NEMIS',NULL,'Pioglitazone And Metformin  Tablets  15 mg + 850 mg'),('metformin',1,'ROTA19075NEMIS',NULL,'Rosiglitazone And Metformin  Tablets  4 mg + 1 gram'),('metformin',1,'MEM/30449NEMIS',NULL,'Metformin Hydrochloride  M/R Tablets  750 mg'),('metformin',1,'ROTA19074NEMIS',NULL,'Rosiglitazone And Metformin  Tablets  2 mg + 1 gram'),('metformin',1,'SATA78212NEMIS',NULL,'Saxagliptin 2.5mg / Metformin 1g tablets'),('metformin',1,'ROTA18930NEMIS',NULL,'Rosiglitazone And Metformin  Tablets  2 mg + 500 mg'),('metformin',1,'META29313NEMIS',NULL,'Vildagliptin 50mg / Metformin 850mg tablets'),('metformin',1,'MEOR35740NEMIS',NULL,'Metformin Hydrochloride  Oral Powder Sachets Sugar Free  500 mg'),('metformin',1,'MEOR35741NEMIS',NULL,'Metformin Hydrochloride  Oral Powder Sachets Sugar Free  1 gram'),('metformin',1,'MEOR23336NEMIS',NULL,'Metformin 500mg/5ml oral solution sugar free'),('metformin',1,'EMTA104969NEMIS',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets'),('metformin',1,'META76743NEMIS',NULL,'Linagliptin 2.5mg / Metformin 1g tablets'),('metformin',1,'CATA96770NEMIS',NULL,'Canagliflozin 50mg / Metformin 1g tablets'),('metformin',1,'DATA88552NEMIS',NULL,'Dapagliflozin 5mg / Metformin 1g tablets'),('metformin',1,'ALTA86909NEMIS',NULL,'Alogliptin 12.5mg / Metformin 1g tablets'),('metformin',1,'ROTA18929NEMIS',NULL,'Rosiglitazone 1mg / Metformin 500mg tablets'),('metformin',1,'MEOR117653NEMIS',NULL,'Metformin 850mg/5ml oral solution sugar free'),('metformin',1,'MESU11377NEMIS',NULL,'Metformin 500mg/5ml oral suspension'),('metformin',1,'EMTA104967NEMIS',NULL,'Empagliflozin 5mg / Metformin 1g tablets'),('metformin',1,'GLM/19422NEMIS',NULL,'Glucophage SR 500mg tablets (Merck Serono Ltd)'),('metformin',1,'GLM/35044NEMIS',NULL,'Glucophage SR 1000mg tablets (Merck Serono Ltd)'),('metformin',1,'GLTA1307',NULL,'Glucophage 500mg tablets (Merck Serono Ltd)'),('metformin',1,'DIM/74131NEMIS',NULL,'Diagemet XL 500mg tablets (Genus Pharmaceuticals Ltd)'),('metformin',1,'GLTA1308',NULL,'Glucophage 850mg tablets (Merck Serono Ltd)'),('metformin',1,'GLM/30450NEMIS',NULL,'Glucophage SR 750mg tablets (Merck Serono Ltd)'),('metformin',1,'BOM/35196NEMIS',NULL,'Bolamyn SR 500mg tablets (Teva UK Ltd)'),('metformin',1,'JATA37230NEMIS',NULL,'Janumet 50mg/1000mg tablets (Merck Sharp & Dohme Ltd)'),('metformin',1,'MEM/49996NEMIS',NULL,'Metabet SR 1000mg tablets (Morningside Healthcare Ltd)'),('metformin',1,'VITA86911NEMIS',NULL,'Vipdomet 12.5mg/1000mg tablets (Takeda UK Ltd)'),('metformin',1,'GLOR35742NEMIS',NULL,'Glucophage 500mg oral powder sachets (Merck Serono Ltd)'),('metformin',1,'COTA23359NEMIS',NULL,'Competact  Tablets  15 mg + 850 mg'),('metformin',1,'MEM/47158NEMIS',NULL,'Metabet SR 500mg tablets (Morningside Healthcare Ltd)'),('metformin',1,'AVTA16477NEMIS',NULL,'Avandamet  Tablets  1 mg + 500 mg'),('metformin',1,'AVTA16478NEMIS',NULL,'Avandamet  Tablets  2 mg + 500 mg'),('metformin',1,'AVTA19076NEMIS',NULL,'Avandamet  Tablets  2 mg + 1 gram'),('metformin',1,'AVTA19077NEMIS',NULL,'Avandamet  Tablets  4 mg + 1 gram'),('metformin',1,'CATA96771NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 850 mg'),('metformin',1,'DATA88553NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 850 mg'),('metformin',1,'EMTA104966NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 850 mg'),('metformin',1,'EMTA104968NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 850 mg'),('metformin',1,'EUTA29316NEMIS',NULL,'Eucreas  Tablets  1 gram + 50 mg'),('metformin',1,'EUTA29317NEMIS',NULL,'Eucreas  Tablets  850 mg + 50 mg'),('metformin',1,'META76744NEMIS',NULL,'Metformin And Linagliptin  Tablets  850 mg + 2.5 mg'),('metformin',1,'SUM/90087NEMIS',NULL,'Sukkarto Sr  M/R tablets  500 mg'),('metformin',1,'SUM/90090NEMIS',NULL,'Sukkarto Sr  M/R tablets  1 gram'),('metformin',1,'SYTA104973NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 850 mg'),('metformin',1,'SYTA104974NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 1000 mg'),('metformin',1,'XITA88555NEMIS',NULL,'Xigduo  Tablets  5 mg + 1000 mg'),('metformin',1,'XITA88556NEMIS',NULL,'Xigduo  Tablets  5 mg + 850 mg'),('metformin',1,'AVTA16477NEMIS',NULL,'Avandamet  Tablets  1 mg + 500 mg'),('metformin',1,'AVTA16478NEMIS',NULL,'Avandamet  Tablets  2 mg + 500 mg'),('metformin',1,'AVTA19076NEMIS',NULL,'Avandamet  Tablets  2 mg + 1 gram'),('metformin',1,'AVTA19077NEMIS',NULL,'Avandamet  Tablets  4 mg + 1 gram'),('metformin',1,'CATA96771NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 850 mg'),('metformin',1,'DATA88553NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 850 mg'),('metformin',1,'EMTA104966NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 850 mg'),('metformin',1,'EMTA104968NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 850 mg'),('metformin',1,'EUTA29316NEMIS',NULL,'Eucreas  Tablets  1 gram + 50 mg'),('metformin',1,'EUTA29317NEMIS',NULL,'Eucreas  Tablets  850 mg + 50 mg'),('metformin',1,'MEOR46782NEMIS',NULL,'Metformin Hydrochloride  Oral solution  500 mg/5 ml'),('metformin',1,'META76744NEMIS',NULL,'Metformin And Linagliptin  Tablets  850 mg + 2.5 mg'),('metformin',1,'SUM/90087NEMIS',NULL,'Sukkarto Sr  M/R tablets  500 mg'),('metformin',1,'SUM/90090NEMIS',NULL,'Sukkarto Sr  M/R tablets  1 gram'),('metformin',1,'SYTA104973NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 850 mg'),('metformin',1,'SYTA104974NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 1000 mg'),('metformin',1,'XITA88555NEMIS',NULL,'Xigduo  Tablets  5 mg + 1000 mg'),('metformin',1,'XITA88556NEMIS',NULL,'Xigduo  Tablets  5 mg + 850 mg');
INSERT INTO #codesemis
VALUES ('sglt2-inhibitors',1,'DATA88553NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'CATA88608NEMIS',NULL,'Canagliflozin  Tablets  100 mg'),('sglt2-inhibitors',1,'EMTA104968NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 850 mg'),('sglt2-inhibitors',1,'INTA88612NEMIS',NULL,'Invokana  Tablets  100 mg'),('sglt2-inhibitors',1,'VOTA96773NEMIS',NULL,'Vokanamet  Tablets  50 mg + 850 mg'),('sglt2-inhibitors',1,'XITA88556NEMIS',NULL,'Xigduo  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'CATA96771NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA91265NEMIS',NULL,'Empagliflozin  Tablets  10 mg'),('sglt2-inhibitors',1,'INTA88612NEMIS',NULL,'Invokana  Tablets  100 mg'),('sglt2-inhibitors',1,'CATA96770NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 1000 mg'),('sglt2-inhibitors',1,'SYTA104973NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA104968NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 850 mg'),('sglt2-inhibitors',1,'CATA88610NEMIS',NULL,'Canagliflozin  Tablets  300 mg'),('sglt2-inhibitors',1,'DATA88553NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'JATA91277NEMIS',NULL,'Jardiance  Tablets  25 mg'),('sglt2-inhibitors',1,'DATA77715NEMIS',NULL,'Dapagliflozin  Tablets  10 mg'),('sglt2-inhibitors',1,'JATA91276NEMIS',NULL,'Jardiance  Tablets  10 mg'),('sglt2-inhibitors',1,'VOTA96773NEMIS',NULL,'Vokanamet  Tablets  50 mg + 850 mg'),('sglt2-inhibitors',1,'VOTA96774NEMIS',NULL,'Vokanamet  Tablets  50 mg + 1000 mg'),('sglt2-inhibitors',1,'DATA77713NEMIS',NULL,'Dapagliflozin  Tablets  5 mg'),('sglt2-inhibitors',1,'EMTA91265NEMIS',NULL,'Empagliflozin  Tablets  10 mg'),('sglt2-inhibitors',1,'EMTA91272NEMIS',NULL,'Empagliflozin  Tablets  25 mg'),('sglt2-inhibitors',1,'INTA88613NEMIS',NULL,'Invokana  Tablets  300 mg'),('sglt2-inhibitors',1,'FOTA77718NEMIS',NULL,'Forxiga  Tablets  10 mg'),('sglt2-inhibitors',1,'JATA91277NEMIS',NULL,'Jardiance  Tablets  25 mg'),('sglt2-inhibitors',1,'SYTA104971NEMIS',NULL,'Synjardy  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'SYTA104974NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 1000 mg'),('sglt2-inhibitors',1,'FOTA77718NEMIS',NULL,'Forxiga  Tablets  10 mg'),('sglt2-inhibitors',1,'DATA88552NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'EMTA104966NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA104969NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 1000 mg'),('sglt2-inhibitors',1,'CATA96771NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA91272NEMIS',NULL,'Empagliflozin  Tablets  25 mg'),('sglt2-inhibitors',1,'SYTA104971NEMIS',NULL,'Synjardy  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'VOTA96774NEMIS',NULL,'Vokanamet  Tablets  50 mg + 1000 mg'),('sglt2-inhibitors',1,'CATA88608NEMIS',NULL,'Canagliflozin  Tablets  100 mg'),('sglt2-inhibitors',1,'FOTA77717NEMIS',NULL,'Forxiga  Tablets  5 mg'),('sglt2-inhibitors',1,'EMTA104966NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA104969NEMIS',NULL,'Empagliflozin And Metformin  Tablets  12.5 mg + 1000 mg'),('sglt2-inhibitors',1,'SYTA104974NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 1000 mg'),('sglt2-inhibitors',1,'XITA88555NEMIS',NULL,'Xigduo  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'CATA88610NEMIS',NULL,'Canagliflozin  Tablets  300 mg'),('sglt2-inhibitors',1,'EMTA104967NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'INTA88613NEMIS',NULL,'Invokana  Tablets  300 mg'),('sglt2-inhibitors',1,'SYTA104972NEMIS',NULL,'Synjardy  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'XITA88556NEMIS',NULL,'Xigduo  Tablets  5 mg + 850 mg'),('sglt2-inhibitors',1,'DATA88552NEMIS',NULL,'Dapagliflozin And Metformin  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'FOTA77717NEMIS',NULL,'Forxiga  Tablets  5 mg'),('sglt2-inhibitors',1,'JATA91276NEMIS',NULL,'Jardiance  Tablets  10 mg'),('sglt2-inhibitors',1,'SYTA104972NEMIS',NULL,'Synjardy  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'CATA96770NEMIS',NULL,'Canagliflozin And Metformin  Tablets  50 mg + 1000 mg'),('sglt2-inhibitors',1,'XITA88555NEMIS',NULL,'Xigduo  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'DATA77715NEMIS',NULL,'Dapagliflozin  Tablets  10 mg'),('sglt2-inhibitors',1,'DATA77713NEMIS',NULL,'Dapagliflozin  Tablets  5 mg'),('sglt2-inhibitors',1,'SYTA104973NEMIS',NULL,'Synjardy  Tablets  12.5 mg + 850 mg'),('sglt2-inhibitors',1,'EMTA104967NEMIS',NULL,'Empagliflozin And Metformin  Tablets  5 mg + 1000 mg'),('sglt2-inhibitors',1,'^ESCT1180531',NULL,'Vokanamet 50mg/1000mg tablets (Napp Pharmaceuticals Ltd)'),('sglt2-inhibitors',1,'^ESCT1186817',NULL,'Vokanamet 50mg/850mg tablets (Napp Pharmaceuticals Ltd)'),('sglt2-inhibitors',1,'^ESCTVO1100562',NULL,'Vokanamet 50mg/850mg tablets (Janssen-Cilag Ltd)'),('sglt2-inhibitors',1,'^ESCTVO1100581',NULL,'Vokanamet 50mg/1000mg tablets (Janssen-Cilag Ltd)'),('sglt2-inhibitors',1,'^ESCT1182249',NULL,'Product containing only canagliflozin 100 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1188651',NULL,'Canagliflozin + Metformin'),('sglt2-inhibitors',1,'^ESCT1203392',NULL,'Canagliflozin 300 mg conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1206546',NULL,'Canagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1206547',NULL,'Product containing canagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1236029',NULL,'Canagliflozin'),('sglt2-inhibitors',1,'^ESCT1236030',NULL,'Canagliflozin product'),('sglt2-inhibitors',1,'^ESCT1236031',NULL,'Product containing precisely canagliflozin 100 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1236614',NULL,'Product containing canagliflozin and metformin'),('sglt2-inhibitors',1,'^ESCT1236615',NULL,'Canagliflozin and metformin product'),('sglt2-inhibitors',1,'^ESCT1385139',NULL,'Canagliflozin- and metformin-containing product in oral dose form'),('sglt2-inhibitors',1,'^ESCT1385839',NULL,'Canagliflozin 300 mg oral tablet'),('sglt2-inhibitors',1,'^ESCT1386331',NULL,'Canagliflozin-containing product in oral dose form'),('sglt2-inhibitors',1,'^ESCT1425186',NULL,'Canagliflozin 100mg tablets'),('sglt2-inhibitors',1,'^ESCTCA1063152',NULL,'Canagliflozin 300mg tablets'),('sglt2-inhibitors',1,'^ESCTCA1100793',NULL,'Canagliflozin 50mg / Metformin 1g tablets'),('sglt2-inhibitors',1,'^ESCTCA1100794',NULL,'Canagliflozin 50mg / Metformin 850mg tablets'),('sglt2-inhibitors',1,'^ESCTCA757992',NULL,'Canagliflozin'),('sglt2-inhibitors',1,'^ESCTCA758003',NULL,'Canagliflozin'),('sglt2-inhibitors',1,'^ESCTCA758005',NULL,'Canagliflozin 100mg tablets'),('sglt2-inhibitors',1,'^ESCTCA758007',NULL,'Canagliflozin 100 mg oral tablet'),('sglt2-inhibitors',1,'^ESCTCA772423',NULL,'Canagliflozin + metformin'),('sglt2-inhibitors',1,'^ESCTCA772424',NULL,'Canagliflozin and metformin in oral dosage form'),('sglt2-inhibitors',1,'^ESCTCA787194',NULL,'Canagliflozin hemihydrate'),('sglt2-inhibitors',1,'^ESCTPR758004',NULL,'Product containing canagliflozin'),('sglt2-inhibitors',1,'^ESCTPR758006',NULL,'Product containing canagliflozin 100 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCTPR772425',NULL,'Product containing canagliflozin and metformin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1182300',NULL,'Product containing only empagliflozin 25 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1183381',NULL,'Empagliflozin + Metformin'),('sglt2-inhibitors',1,'^ESCT1188433',NULL,'Product containing only empagliflozin 10 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1206715',NULL,'Empagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1206716',NULL,'Product containing empagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1236117',NULL,'Empagliflozin'),('sglt2-inhibitors',1,'^ESCT1236118',NULL,'Empagliflozin product'),('sglt2-inhibitors',1,'^ESCT1236119',NULL,'Product containing precisely empagliflozin 10 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1236120',NULL,'Product containing precisely empagliflozin 25 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1236581',NULL,'Empagliflozin + linagliptin'),('sglt2-inhibitors',1,'^ESCT1236582',NULL,'Product containing empagliflozin and linagliptin'),('sglt2-inhibitors',1,'^ESCT1236583',NULL,'Empagliflozin and linagliptin product'),('sglt2-inhibitors',1,'^ESCT1236584',NULL,'Product containing empagliflozin and metformin'),('sglt2-inhibitors',1,'^ESCT1236585',NULL,'Empagliflozin and metformin product'),('sglt2-inhibitors',1,'^ESCT1385128',NULL,'Empagliflozin- and linagliptin-containing product'),('sglt2-inhibitors',1,'^ESCT1386415',NULL,'Empagliflozin-containing product in oral dose form'),('sglt2-inhibitors',1,'^ESCTEM1074337',NULL,'Empagliflozin 10mg tablets'),('sglt2-inhibitors',1,'^ESCTEM1074338',NULL,'Empagliflozin 25mg tablets'),('sglt2-inhibitors',1,'^ESCTEM1121862',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets'),('sglt2-inhibitors',1,'^ESCTEM1121863',NULL,'Empagliflozin 12.5mg / Metformin 850mg tablets'),('sglt2-inhibitors',1,'^ESCTEM1121864',NULL,'Empagliflozin 5mg / Metformin 1g tablets'),('sglt2-inhibitors',1,'^ESCTEM1121865',NULL,'Empagliflozin 5mg / Metformin 850mg tablets'),('sglt2-inhibitors',1,'^ESCTEM758352',NULL,'Empagliflozin'),('sglt2-inhibitors',1,'^ESCTEM758353',NULL,'Empagliflozin'),('sglt2-inhibitors',1,'^ESCTEM758355',NULL,'Empagliflozin 10 mg oral tablet'),('sglt2-inhibitors',1,'^ESCTEM758357',NULL,'Empagliflozin 25 mg oral tablet'),('sglt2-inhibitors',1,'^ESCTEM772310',NULL,'Empagliflozin + linagliptin'),('sglt2-inhibitors',1,'^ESCTEM772311',NULL,'Empagliflozin + metformin'),('sglt2-inhibitors',1,'^ESCTPR758354',NULL,'Product containing empagliflozin'),
('sglt2-inhibitors',1,'^ESCTPR758356',NULL,'Product containing empagliflozin 10 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCTPR758358',NULL,'Product containing empagliflozin 25 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1185893',NULL,'Product containing only dapagliflozin 5 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1185894',NULL,'Product containing only dapagliflozin 10 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1206385',NULL,'Dapagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1206386',NULL,'Product containing dapagliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1236023',NULL,'Dapagliflozin'),('sglt2-inhibitors',1,'^ESCT1236024',NULL,'Dapagliflozin product'),('sglt2-inhibitors',1,'^ESCT1236025',NULL,'Dapagliflozin propanediol 5 mg oral tablet'),('sglt2-inhibitors',1,'^ESCT1236026',NULL,'Product containing precisely dapagliflozin propanediol 5 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1236027',NULL,'Product containing precisely dapagliflozin propanediol 10 milligram/1 each conventional release oral tablet'),('sglt2-inhibitors',1,'^ESCT1236028',NULL,'Dapagliflozin propanediol 10 mg oral tablet'),('sglt2-inhibitors',1,'^ESCT1386251',NULL,'Dapagliflozin-containing product in oral dose form'),('sglt2-inhibitors',1,'^ESCT1424749',NULL,'Dapagliflozin 10mg tablets'),('sglt2-inhibitors',1,'^ESCT1424750',NULL,'Dapagliflozin 5mg tablets'),('sglt2-inhibitors',1,'^ESCTDA1062682',NULL,'Dapagliflozin 5mg / Metformin 1g tablets'),('sglt2-inhibitors',1,'^ESCTDA1062683',NULL,'Dapagliflozin 5mg / Metformin 850mg tablets'),('sglt2-inhibitors',1,'^ESCTDA757990',NULL,'Dapagliflozin'),('sglt2-inhibitors',1,'^ESCTDA757991',NULL,'Dapagliflozin propanediol'),('sglt2-inhibitors',1,'^ESCTDA757995',NULL,'Dapagliflozin'),('sglt2-inhibitors',1,'^ESCTDA757997',NULL,'Dapagliflozin 5mg tablets'),('sglt2-inhibitors',1,'^ESCTDA757999',NULL,'Dapagliflozin 5 mg oral tablet'),('sglt2-inhibitors',1,'^ESCTDA758000',NULL,'Dapagliflozin 10mg tablets'),('sglt2-inhibitors',1,'^ESCTDA758002',NULL,'Dapagliflozin 10 mg oral tablet'),('sglt2-inhibitors',1,'^ESCTPR757996',NULL,'Product containing dapagliflozin'),('sglt2-inhibitors',1,'^ESCTPR757998',NULL,'Product containing dapagliflozin 5 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCTPR758001',NULL,'Product containing dapagliflozin 10 mg/1 each oral tablet'),('sglt2-inhibitors',1,'^ESCT1186692',NULL,'Invokana 100mg tablets (Napp Pharmaceuticals Ltd)'),('sglt2-inhibitors',1,'^ESCT1189834',NULL,'Invokana 300mg tablets (Napp Pharmaceuticals Ltd)'),('sglt2-inhibitors',1,'^ESCTIN1063007',NULL,'Invokana 300mg tablets (Janssen-Cilag Ltd)'),('sglt2-inhibitors',1,'^ESCTIN1063010',NULL,'Invokana 100mg tablets (Janssen-Cilag Ltd)'),('sglt2-inhibitors',1,'^ESCT1201406',NULL,'Ertugliflozin'),('sglt2-inhibitors',1,'^ESCT1201407',NULL,'Ertugliflozin product'),('sglt2-inhibitors',1,'^ESCT1201408',NULL,'Product containing ertugliflozin'),('sglt2-inhibitors',1,'^ESCT1201409',NULL,'Ertugliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1201410',NULL,'Product containing ertugliflozin in oral dosage form'),('sglt2-inhibitors',1,'^ESCT1385672',NULL,'Ertugliflozin-containing product'),('sglt2-inhibitors',1,'^ESCT1385673',NULL,'Ertugliflozin-containing product in oral dose form'),('sglt2-inhibitors',1,'^ESCTFO1039919',NULL,'Forxiga 5mg tablets (AstraZeneca UK Ltd)'),('sglt2-inhibitors',1,'^ESCTFO1039922',NULL,'Forxiga 10mg tablets (AstraZeneca UK Ltd)'),('sglt2-inhibitors',1,'^ESCTJA1073847',NULL,'Jardiance 10mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTJA1073856',NULL,'Jardiance 25mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTSY1120491',NULL,'Synjardy 5mg/850mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTSY1120498',NULL,'Synjardy 5mg/1000mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTSY1120507',NULL,'Synjardy 12.5mg/850mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTSY1120514',NULL,'Synjardy 12.5mg/1000mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCTXI1062326',NULL,'Xigduo 5mg/850mg tablets (AstraZeneca UK Ltd)'),('sglt2-inhibitors',1,'^ESCTXI1062329',NULL,'Xigduo 5mg/1000mg tablets (AstraZeneca UK Ltd)'),('sglt2-inhibitors',1,'^ESCT1280700',NULL,'Canagliflozin 100mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTCA1063006',NULL,'Canagliflozin 300mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCTCA1063009',NULL,'Canagliflozin 100mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCTCA1100559',NULL,'Canagliflozin 50mg / Metformin 850mg tablets 60 tablet'),('sglt2-inhibitors',1,'^ESCTCA1100578',NULL,'Canagliflozin 50mg / Metformin 1g tablets 60 tablet'),('sglt2-inhibitors',1,'^ESCT1259825',NULL,'Dapagliflozin 10mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCT1439790',NULL,'Dapagliflozin 5mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCTDA1039917',NULL,'Dapagliflozin 5mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTDA1039921',NULL,'Dapagliflozin 10mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTDA1062325',NULL,'Dapagliflozin 5mg / Metformin 850mg tablets 56 tablet'),('sglt2-inhibitors',1,'^ESCTDA1062328',NULL,'Dapagliflozin 5mg / Metformin 1g tablets 56 tablet'),('sglt2-inhibitors',1,'^ESCTSA1153703',NULL,'Saxagliptin 5mg / Dapagliflozin 10mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTSA1154285',NULL,'Saxagliptin 5mg / Dapagliflozin 10mg tablets'),('sglt2-inhibitors',1,'SATA119013NEMIS',NULL,'Saxagliptin And Dapagliflozin  Tablets  5 mg + 10 mg'),('sglt2-inhibitors',1,'^ESCT1258068',NULL,'Empagliflozin 10mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCT1258071',NULL,'Empagliflozin 25mg tablets 30 tablet'),('sglt2-inhibitors',1,'^ESCT1265478',NULL,'Empagliflozin 10mg / Linagliptin 5mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCT1265481',NULL,'Empagliflozin 25mg / Linagliptin 5mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCT1265954',NULL,'Empagliflozin 10mg / Linagliptin 5mg tablets'),('sglt2-inhibitors',1,'^ESCT1265956',NULL,'Empagliflozin 25mg / Linagliptin 5mg tablets'),('sglt2-inhibitors',1,'^ESCT1276727',NULL,'Empagliflozin 5mg / Metformin 1g tablets 60 tablet'),('sglt2-inhibitors',1,'^ESCT1276729',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets 60 tablet'),('sglt2-inhibitors',1,'^ESCTEM1073846',NULL,'Empagliflozin 10mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTEM1073853',NULL,'Empagliflozin 25mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCTEM1120490',NULL,'Empagliflozin 5mg / Metformin 850mg tablets 56 tablet'),('sglt2-inhibitors',1,'^ESCTEM1120496',NULL,'Empagliflozin 5mg / Metformin 1g tablets 56 tablet'),('sglt2-inhibitors',1,'^ESCTEM1120504',NULL,'Empagliflozin 12.5mg / Metformin 850mg tablets 56 tablet'),('sglt2-inhibitors',1,'^ESCTEM1120513',NULL,'Empagliflozin 12.5mg / Metformin 1g tablets 56 tablet'),('sglt2-inhibitors',1,'EMTA133082NEMIS',NULL,'Empagliflozin And Linagliptin  Tablets  10 mg + 5 mg'),('sglt2-inhibitors',1,'EMTA133083NEMIS',NULL,'Empagliflozin And Linagliptin  Tablets  25 mg + 5 mg'),('sglt2-inhibitors',1,'^ESCT1254503',NULL,'Ertugliflozin 5mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCT1254506',NULL,'Ertugliflozin 15mg tablets 28 tablet'),('sglt2-inhibitors',1,'^ESCT1254556',NULL,'Ertugliflozin 15mg tablets'),('sglt2-inhibitors',1,'^ESCT1254557',NULL,'Ertugliflozin 5mg tablets'),('sglt2-inhibitors',1,'ERTA130344NEMIS',NULL,'Ertugliflozin  Tablets  5 mg'),('sglt2-inhibitors',1,'ERTA130346NEMIS',NULL,'Ertugliflozin  Tablets  15 mg'),('sglt2-inhibitors',1,'^ESCT1259826',NULL,'Forxiga 10mg tablets (Pharmaram Ltd)'),('sglt2-inhibitors',1,'^ESCT1259827',NULL,'Forxiga 10mg tablets (Pharmaram Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1259828',NULL,'Forxiga 10mg tablets (Pharmaram Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267425',NULL,'Forxiga 10mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1267426',NULL,'Forxiga 10mg tablets (CST Pharma Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1267427',NULL,'Forxiga 10mg tablets (CST Pharma Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267428',NULL,'Forxiga 5mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1267429',NULL,'Forxiga 5mg tablets (CST Pharma Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1274535',NULL,'Forxiga 10mg tablets (Pilsco Ltd)'),('sglt2-inhibitors',1,'^ESCT1274536',NULL,'Forxiga 10mg tablets (Pilsco Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1274537',NULL,'Forxiga 10mg tablets (Pilsco Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1280695',NULL,'Forxiga 5mg tablets (Pharmaram Ltd)'),('sglt2-inhibitors',1,'^ESCT1280696',NULL,'Forxiga 5mg tablets (Pharmaram Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300710',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1300711',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300712',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1300713',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300714',NULL,'Forxiga 10mg tablets (DE Pharmaceuticals) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1375827',NULL,'Forxiga 5mg tablets (Ethigen Ltd)'),('sglt2-inhibitors',1,'^ESCT1375828',NULL,'Forxiga 5mg tablets (Ethigen Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1389503',NULL,'Forxiga 10mg tablets (Ethigen Ltd)'),('sglt2-inhibitors',1,'^ESCT1389504',NULL,'Forxiga 10mg tablets (Ethigen Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1389505',NULL,'Forxiga 10mg tablets (Ethigen Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1439791',NULL,'Forxiga 5mg tablets (DE Pharmaceuticals) 30 tablet'),('sglt2-inhibitors',1,'^ESCTFO1039920',NULL,'Forxiga 5mg tablets (AstraZeneca UK Ltd) 28 tablet 2 x 14 tablets'),('sglt2-inhibitors',1,'^ESCTFO1039923',NULL,'Forxiga 10mg tablets (AstraZeneca UK Ltd) 28 tablet 2 x 14 tablets'),
('sglt2-inhibitors',1,'^ESCTFO1100266',NULL,'Forxiga 10mg tablets (Waymade Healthcare Plc)'),('sglt2-inhibitors',1,'^ESCTFO1100267',NULL,'Forxiga 10mg tablets (Waymade Healthcare Plc) 28 tablet'),('sglt2-inhibitors',1,'^ESCTFO1104357',NULL,'Forxiga 5mg tablets (Waymade Healthcare Plc)'),('sglt2-inhibitors',1,'^ESCTFO1104358',NULL,'Forxiga 5mg tablets (Waymade Healthcare Plc) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1265479',NULL,'Glyxambi 10mg/5mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCT1265480',NULL,'Glyxambi 10mg/5mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCT1265482',NULL,'Glyxambi 25mg/5mg tablets (Boehringer Ingelheim Ltd)'),('sglt2-inhibitors',1,'^ESCT1265483',NULL,'Glyxambi 25mg/5mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'GLTA133085NEMIS',NULL,'Glyxambi  Tablets  10 mg + 5 mg'),('sglt2-inhibitors',1,'GLTA133086NEMIS',NULL,'Glyxambi  Tablets  25 mg + 5 mg'),('sglt2-inhibitors',1,'^ESCT1189835',NULL,'Invokana 300mg tablets (Napp Pharmaceuticals Ltd) 30 tablet 3 x 10 tablets'),('sglt2-inhibitors',1,'^ESCT1189836',NULL,'Invokana 100mg tablets (Napp Pharmaceuticals Ltd) 30 tablet 3 x 10 tablets'),('sglt2-inhibitors',1,'^ESCT1267866',NULL,'Invokana 100mg tablets (Mawdsley-Brooks & Company Ltd)'),('sglt2-inhibitors',1,'^ESCT1267867',NULL,'Invokana 100mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267868',NULL,'Invokana 300mg tablets (Mawdsley-Brooks & Company Ltd)'),('sglt2-inhibitors',1,'^ESCT1267869',NULL,'Invokana 300mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1274549',NULL,'Invokana 100mg tablets (Pilsco Ltd)'),('sglt2-inhibitors',1,'^ESCT1274550',NULL,'Invokana 100mg tablets (Pilsco Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1280699',NULL,'Invokana 100mg tablets (Pharmaram Ltd)'),('sglt2-inhibitors',1,'^ESCT1280701',NULL,'Invokana 100mg tablets (Pharmaram Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300761',NULL,'Invokana 100mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1300762',NULL,'Invokana 100mg tablets (DE Pharmaceuticals) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1389510',NULL,'Invokana 100mg tablets (Ethigen Ltd)'),('sglt2-inhibitors',1,'^ESCT1389511',NULL,'Invokana 100mg tablets (Ethigen Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1434479',NULL,'Invokana 300mg tablets (Pilsco Ltd)'),('sglt2-inhibitors',1,'^ESCT1434480',NULL,'Invokana 300mg tablets (Pilsco Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCTIN1063008',NULL,'Invokana 300mg tablets (Janssen-Cilag Ltd) 30 tablet 3 x 10 tablets'),('sglt2-inhibitors',1,'^ESCTIN1063011',NULL,'Invokana 100mg tablets (Janssen-Cilag Ltd) 30 tablet 3 x 10 tablets'),('sglt2-inhibitors',1,'^ESCT1258067',NULL,'Jardiance 10mg tablets (Originalis B.V.)'),('sglt2-inhibitors',1,'^ESCT1258069',NULL,'Jardiance 10mg tablets (Originalis B.V.) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1258070',NULL,'Jardiance 25mg tablets (Originalis B.V.)'),('sglt2-inhibitors',1,'^ESCT1258072',NULL,'Jardiance 25mg tablets (Originalis B.V.) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267458',NULL,'Jardiance 10mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1267459',NULL,'Jardiance 10mg tablets (CST Pharma Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1267460',NULL,'Jardiance 10mg tablets (CST Pharma Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267461',NULL,'Jardiance 25mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1267462',NULL,'Jardiance 25mg tablets (CST Pharma Ltd) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1267463',NULL,'Jardiance 25mg tablets (CST Pharma Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267963',NULL,'Jardiance 10mg tablets (Mawdsley-Brooks & Company Ltd)'),('sglt2-inhibitors',1,'^ESCT1267964',NULL,'Jardiance 10mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1267966',NULL,'Jardiance 25mg tablets (Mawdsley-Brooks & Company Ltd)'),('sglt2-inhibitors',1,'^ESCT1267968',NULL,'Jardiance 25mg tablets (Mawdsley-Brooks & Company Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1274564',NULL,'Jardiance 10mg tablets (Pilsco Ltd)'),('sglt2-inhibitors',1,'^ESCT1274566',NULL,'Jardiance 10mg tablets (Pilsco Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1300773',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1300774',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300775',NULL,'Jardiance 10mg tablets (DE Pharmaceuticals) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1300776',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1300777',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals) 28 tablet'),('sglt2-inhibitors',1,'^ESCT1300778',NULL,'Jardiance 25mg tablets (DE Pharmaceuticals) 30 tablet'),('sglt2-inhibitors',1,'^ESCT1389520',NULL,'Jardiance 10mg tablets (Ethigen Ltd)'),('sglt2-inhibitors',1,'^ESCT1389521',NULL,'Jardiance 10mg tablets (Ethigen Ltd) 30 tablet'),('sglt2-inhibitors',1,'^ESCTJA1073848',NULL,'Jardiance 10mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCTJA1073860',NULL,'Jardiance 25mg tablets (Boehringer Ingelheim Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCTQT1153704',NULL,'Qtern 5mg/10mg tablets (AstraZeneca UK Ltd)'),('sglt2-inhibitors',1,'^ESCTQT1153705',NULL,'Qtern 5mg/10mg tablets (AstraZeneca UK Ltd) 28 tablet 2 x 14 tablets'),('sglt2-inhibitors',1,'QTTA119016NEMIS',NULL,'Qtern  Tablets  5 mg + 10 mg'),('sglt2-inhibitors',1,'^ESCT1254504',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme Ltd)'),('sglt2-inhibitors',1,'^ESCT1254505',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCT1254507',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme Ltd)'),('sglt2-inhibitors',1,'^ESCT1254508',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCT1412576',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme (UK) Ltd)'),('sglt2-inhibitors',1,'^ESCT1412577',NULL,'Steglatro 5mg tablets (Merck Sharp & Dohme (UK) Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'^ESCT1412578',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme (UK) Ltd)'),('sglt2-inhibitors',1,'^ESCT1412579',NULL,'Steglatro 15mg tablets (Merck Sharp & Dohme (UK) Ltd) 28 tablet 4 x 7 tablets'),('sglt2-inhibitors',1,'STTA130348NEMIS',NULL,'Steglatro  Tablets  5 mg'),('sglt2-inhibitors',1,'STTA130349NEMIS',NULL,'Steglatro  Tablets  15 mg'),('sglt2-inhibitors',1,'^ESCT1276726',NULL,'Synjardy 5mg/1000mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1276728',NULL,'Synjardy 5mg/1000mg tablets (CST Pharma Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCT1276730',NULL,'Synjardy 12.5mg/1000mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1276731',NULL,'Synjardy 12.5mg/1000mg tablets (CST Pharma Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCTSY1120493',NULL,'Synjardy 5mg/850mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets'),('sglt2-inhibitors',1,'^ESCTSY1120499',NULL,'Synjardy 5mg/1000mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets'),('sglt2-inhibitors',1,'^ESCTSY1120509',NULL,'Synjardy 12.5mg/850mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets'),('sglt2-inhibitors',1,'^ESCTSY1120516',NULL,'Synjardy 12.5mg/1000mg tablets (Boehringer Ingelheim Ltd) 56 tablet 8 x 7 tablets'),('sglt2-inhibitors',1,'^ESCT1184814',NULL,'Vokanamet 50mg/850mg tablets (Napp Pharmaceuticals Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCT1186818',NULL,'Vokanamet 50mg/1000mg tablets (Napp Pharmaceuticals Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCTVO1100566',NULL,'Vokanamet 50mg/850mg tablets (Janssen-Cilag Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCTVO1100583',NULL,'Vokanamet 50mg/1000mg tablets (Janssen-Cilag Ltd) 60 tablet'),('sglt2-inhibitors',1,'^ESCT1270876',NULL,'Xigduo 5mg/1000mg tablets (CST Pharma Ltd)'),('sglt2-inhibitors',1,'^ESCT1270877',NULL,'Xigduo 5mg/1000mg tablets (CST Pharma Ltd) 56 tablet'),('sglt2-inhibitors',1,'^ESCT1301082',NULL,'Xigduo 5mg/1000mg tablets (DE Pharmaceuticals)'),('sglt2-inhibitors',1,'^ESCT1301083',NULL,'Xigduo 5mg/1000mg tablets (DE Pharmaceuticals) 56 tablet'),('sglt2-inhibitors',1,'^ESCTXI1062327',NULL,'Xigduo 5mg/850mg tablets (AstraZeneca UK Ltd) 56 tablet 4 x 14 tablets'),('sglt2-inhibitors',1,'^ESCTXI1062330',NULL,'Xigduo 5mg/1000mg tablets (AstraZeneca UK Ltd) 56 tablet 4 x 14 tablets');
INSERT INTO #codesemis
VALUES ('bmi',2,'^ESCT1192336',NULL,'Finding of body mass index'),('bmi',2,'^ESCTBA828699',NULL,'Baseline BMI (body mass index)'),('bmi',2,'^ESCTBM348480',NULL,'BMI - Body mass index'),('bmi',2,'^ESCTBO348478',NULL,'Body mass index'),('bmi',2,'^ESCTFI589221',NULL,'Finding of BMI (body mass index)'),('bmi',2,'^ESCTOB589220',NULL,'Observation of body mass index'),('bmi',2,'^ESCTQU348481',NULL,'Quetelet index');
INSERT INTO #codesemis
VALUES ('cholesterol',2,'^ESCT1192820',NULL,'Serum fasting total cholesterol'),('cholesterol',2,'^ESCT1262075',NULL,'Cholesterol substance concentration in plasma'),('cholesterol',2,'^ESCT1262076',NULL,'Cholesterol molar concentration in plasma'),('cholesterol',2,'^ESCT1262077',NULL,'Cholesterol substance concentration in serum'),('cholesterol',2,'^ESCT1262078',NULL,'Cholesterol molar concentration in serum'),('cholesterol',2,'^ESCTCH829038',NULL,'Cholesterol level'),('cholesterol',2,'^ESCTFA605293',NULL,'Fasting cholesterol level'),('cholesterol',2,'^ESCTSE683159',NULL,'Serum total cholesterol measurement'),('cholesterol',2,'^ESCTSE683160',NULL,'Serum total cholesterol level'),('cholesterol',2,'^ESCTSE846047',NULL,'Serum fasting total cholesterol level'),('cholesterol',2,'^ESCTTO829294',NULL,'Total cholesterol level'),('cholesterol',2,'EGTON456',NULL,'Fasting serum cholesterol');
INSERT INTO #codesemis
VALUES ('diastolic-blood-pressure',1,'EMISNQDI86',NULL,'Diastolic blood pressure - left arm'),('diastolic-blood-pressure',1,'EMISNQDI87',NULL,'Diastolic blood pressure - right arm'),('diastolic-blood-pressure',1,'^ESCT1192438',NULL,'O/E - Diastolic BP reading'),('diastolic-blood-pressure',1,'^ESCT24604632',NULL,'24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTAM805799',NULL,'Ambulatory diastolic BP (blood pressure)'),('diastolic-blood-pressure',1,'^ESCTDA552722',NULL,'DAP - Diastolic arterial pressure'),('diastolic-blood-pressure',1,'^ESCTDB552723',NULL,'DBP - Diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTDI552721',NULL,'Diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTDI552724',NULL,'Diastolic arterial pressure'),('diastolic-blood-pressure',1,'^ESCTDI732123',NULL,'Diastolic blood pressure on admission'),('diastolic-blood-pressure',1,'^ESCTIN529508',NULL,'Invasive diastolic arterial pressure'),('diastolic-blood-pressure',1,'^ESCTIN529509',NULL,'Invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMA604619',NULL,'Maximum diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMA604624',NULL,'Maximum night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMA604625',NULL,'Maximum day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMA604626',NULL,'Maximum 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMI604618',NULL,'Minimum diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMI604621',NULL,'Minimum day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMI604622',NULL,'Minimum night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTMI604623',NULL,'Minimum 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTNO466071',NULL,'Non-invasive diastolic arterial pressure'),('diastolic-blood-pressure',1,'^ESCTNO466072',NULL,'Non-invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'^ESCTON455662',NULL,'On examination - Diastolic blood pressure reading'),('diastolic-blood-pressure',1,'^ESCTON455663',NULL,'On examination - Diastolic BP reading');
INSERT INTO #codesemis
VALUES ('egfr',1,'^ESCT1167392',NULL,'Glomerular filtration rate calculation technique'),('egfr',1,'^ESCT1167393',NULL,'GFR - Glomerular filtration rate calculation technique'),('egfr',1,'^ESCT1237005',NULL,'GFR (glomerular filtration rate) calculation technique'),('egfr',1,'^ESCT1249126',NULL,'eGFR (estimated glomerular filtration rate) using CKD-Epi (Chronic Kidney Disease Epidemiology Collaboration) formula per 1.73 square metres'),('egfr',1,'^ESCT1262192',NULL,'Estimated glomerular filtration rate by laboratory calculation'),('egfr',1,'^ESCT1262193',NULL,'eGFR (estimated glomerular filtration rate) by laboratory calculation'),('egfr',1,'^ESCT1268044',NULL,'GFR - glomerular filtration rate'),('egfr',1,'^ESCT1437095',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'^ESCT1437099',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'^ESCT1437100',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'^ESCTEG829482',NULL,'eGFR (estimated glomerular filtration rate) using CKD-Epi (Chronic Kidney Disease Epidemiology Collaboration) formula'),('egfr',1,'^ESCTEG835295',NULL,'eGFR (estimated glomerular filtration rate) using cystatin C CKD-EPI (Chronic Kidney Disease Epidemiology Collaboration) equation'),('egfr',1,'^ESCTEG835298',NULL,'eGFR (estimated glomerular filtration rate) using creatinine CKD-EPI (Chronic Kidney Disease Epidemiology Collaboration) equation'),('egfr',1,'^ESCTES829480',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula'),('egfr',1,'^ESCTES835294',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation'),('egfr',1,'^ESCTES835297',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation'),('egfr',1,'^ESCTTC515939',NULL,'Tc99m-DTPA clearance - GFR'),('egfr',1,'^ESCTTE515940',NULL,'Technetium-99m-diethylenetriamine pentaacetic acid clearance - glomerular filtration rate'),('egfr',1,'^ESCTWI545152',NULL,'With GFR'),('egfr',1,'^ESCTWI545153',NULL,'With glomerular filtration rate');
INSERT INTO #codesemis
VALUES ('hdl-cholesterol',1,'^ESCT1262229',NULL,'HDL (high density lipoprotein) cholesterol substance concentration in plasma'),('hdl-cholesterol',1,'^ESCT1262230',NULL,'HDL (high density lipoprotein) cholesterol molar concentration in plasma'),('hdl-cholesterol',1,'^ESCT1262232',NULL,'HDL (high density lipoprotein) cholesterol substance concentration in serum'),('hdl-cholesterol',1,'^ESCT1262233',NULL,'HDL (high density lipoprotein) cholesterol molar concentration in serum'),('hdl-cholesterol',1,'^ESCTSE838573',NULL,'Serum HDL (high density lipoprotein) cholesterol level');
INSERT INTO #codesemis
VALUES ('ldl-cholesterol',1,'^ESCT1262339',NULL,'LDL-C (low density lipoprotein cholesterol) substance concentration in plasma'),('ldl-cholesterol',1,'^ESCT1262340',NULL,'LDL-C (low density lipoprotein cholesterol) molar concentration in plasma'),('ldl-cholesterol',1,'^ESCT1262341',NULL,'LDL-C (low density lipoprotein cholesterol) substance concentration in serum'),('ldl-cholesterol',1,'^ESCT1262342',NULL,'LDL-C (low density lipoprotein cholesterol) molar concentration in serum'),('ldl-cholesterol',1,'^ESCTSE840392',NULL,'Serum LDL (low density lipoprotein) cholesterol level');
INSERT INTO #codesemis
VALUES ('systolic-blood-pressure',1,'EMISNQSY8',NULL,'Systolic blood pressure - left arm'),('systolic-blood-pressure',1,'EMISNQSY9',NULL,'Systolic blood pressure - right arm'),('systolic-blood-pressure',1,'^ESCT1190337',NULL,'O/E - Systolic BP reading'),('systolic-blood-pressure',1,'^ESCT1407388',NULL,'Non-invasive SAP (systolic arterial pressure)'),('systolic-blood-pressure',1,'^ESCT1407389',NULL,'Invasive SAP (systolic arterial pressure)'),('systolic-blood-pressure',1,'^ESCT24604631',NULL,'24 hour systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTAM805797',NULL,'Ambulatory systolic BP (blood pressure)'),('systolic-blood-pressure',1,'^ESCTIN529505',NULL,'Invasive systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTIN529507',NULL,'Invasive systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMA604606',NULL,'Maximum systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMA604610',NULL,'Maximum night interval systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMA604611',NULL,'Maximum day interval systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMA604615',NULL,'Maximum 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMI604605',NULL,'Minimum systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMI604608',NULL,'Minimum day interval systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMI604609',NULL,'Minimum night interval systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTMI604614',NULL,'Minimum 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTNO529502',NULL,'Non-invasive systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTNO529504',NULL,'Non-invasive systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTON455659',NULL,'On examination - Systolic BP reading'),('systolic-blood-pressure',1,'^ESCTON455660',NULL,'On examination - Systolic blood pressure reading'),('systolic-blood-pressure',1,'^ESCTSA529503',NULL,'SAP - Systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTSA529506',NULL,'SAP - Systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTSA552720',NULL,'SAP - Systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTSY367626',NULL,'Systolic arterial pressure'),('systolic-blood-pressure',1,'^ESCTSY367627',NULL,'Systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTSY552719',NULL,'Systolic blood pressure'),('systolic-blood-pressure',1,'^ESCTSY662059',NULL,'Systolic blood pressure on admission');
INSERT INTO #codesemis
VALUES ('triglycerides',1,'^ESCT1262496',NULL,'Triglyceride substance concentration in plasma'),('triglycerides',1,'^ESCT1262497',NULL,'Triglyceride molar concentration in plasma'),('triglycerides',1,'^ESCT1262498',NULL,'Triglyceride substance concentration in serum'),('triglycerides',1,'^ESCT1262499',NULL,'Triglyceride molar concentration in serum'),('triglycerides',1,'^ESCTFI627911',NULL,'Finding of serum triglyceride levels'),('triglycerides',1,'^ESCTSE627910',NULL,'Serum triglyceride levels'),('triglycerides',1,'^ESCTME552241',NULL,'Measurement of serum triglyceride level'),('triglycerides',1,'^ESCTSE552242',NULL,'Serum triglyceride levels');
INSERT INTO #codesemis
VALUES ('urinary-albumin-creatinine-ratio',1,'^ESCT1268129',NULL,'Albumin/creatinine ratio in urine'),('urinary-albumin-creatinine-ratio',1,'^ESCT1435793',NULL,'ACR (albumin to creatinine ratio) in urine by test strip semi-quantitative result'),('urinary-albumin-creatinine-ratio',1,'^ESCT1435794',NULL,'Semi-quantitative result of albumin to creatinine ratio in urine by test strip'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL528959',NULL,'Albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL528960',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL840923',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552017',NULL,'Urine albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552018',NULL,'Urine albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552019',NULL,'Urine microalbumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552020',NULL,'Urine microalbumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552021',NULL,'Urine microalb/creatnine ratio')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL, [description] VARCHAR(255));

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version], dcr.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
AND (dcr.term IS NULL OR dcr.term = rc.Term)
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version], dcc.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL, [description] VARCHAR(255));

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version], dcs.[description]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept, [description]
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept, [description]
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

--#endregion

-- >>> Following code sets injected: bmi v2/hba1c v2/cholesterol v2/ldl-cholesterol v1/hdl-cholesterol v1/vitamin-d v1/testosterone v1/sex-hormone-binding-globulin v1/egfr v1
-- >>> Following code sets injected: diastolic-blood-pressure v1/systolic-blood-pressure v1/triglycerides v1/urinary-albumin-creatinine-ratio v1
-- >>> Following code sets injected: sglt2-inhibitors v1/metformin v1

-- First lets get all the measurements in one place to improve query speed later on
IF OBJECT_ID('tempdb..#biomarkerValues') IS NOT NULL DROP TABLE #biomarkerValues;
SELECT 
	FK_Patient_Link_ID,
	CAST(EventDate AS DATE) AS EventDate,
	FK_Reference_Coding_ID,
	FK_Reference_SnomedCT_ID,
	[Value],
	Units
INTO #biomarkerValues
FROM SharedCare.GP_Events
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets)
)
AND FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
--AND EventDate >= @StartDate
AND UPPER([Value]) NOT LIKE '%[A-Z]%' -- Remove any value that contains text. The only valid character is "e" in scientific notation e.g. 2e17 - but none of these values will be in that range
AND [Value] IS NOT NULL
AND [Value] != '0'; -- In theory none of these markers should have a 0 value so this is a sensible default to exclude

-- Get all biomarker values for the cohort
IF OBJECT_ID('tempdb..#biomarkers') IS NOT NULL DROP TABLE #biomarkers;
CREATE TABLE #biomarkers (
	FK_Patient_Link_ID BIGINT,
	Label VARCHAR(32),
	EventDate DATE,
	[Value] NVARCHAR(128),
	Units NVARCHAR(64)
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'diastolic-blood-pressure' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'diastolic-blood-pressure' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'diastolic-blood-pressure' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'systolic-blood-pressure' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'systolic-blood-pressure' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'systolic-blood-pressure' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'triglycerides' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'triglycerides' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'triglycerides' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'bmi' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'bmi' AND [Version] = 2)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'bmi' AND [Version] = 2))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'hba1c' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'hba1c' AND [Version] = 2)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'hba1c' AND [Version] = 2))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'cholesterol' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'cholesterol' AND [Version] = 2)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'cholesterol' AND [Version] = 2))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'ldl-cholesterol' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'ldl-cholesterol' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'ldl-cholesterol' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'hdl-cholesterol' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'hdl-cholesterol' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'hdl-cholesterol' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'vitamin-d' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'vitamin-d' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'vitamin-d' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'testosterone' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'testosterone' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'testosterone' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'sex-hormone-binding-globulin' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'sex-hormone-binding-globulin' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'sex-hormone-binding-globulin' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'egfr' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'egfr' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'egfr' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'urinary-albumin-creatinine-ratio' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'urinary-albumin-creatinine-ratio' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'urinary-albumin-creatinine-ratio' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'sglt2-inhibitor' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'sglt2-inhibitors' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'sglt2-inhibitors' AND [Version] = 1))
);

INSERT INTO #biomarkers
SELECT FK_Patient_Link_ID, 'metformin' AS Label, EventDate, [Value], Units
FROM #biomarkerValues
WHERE (
	FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE (Concept = 'metformin' AND [Version] = 1)) OR
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE (Concept = 'metformin' AND [Version] = 1))
);


-- Final output
SELECT NhsNo, Label, EventDate, [Value], Units FROM #biomarkers b
INNER JOIN #NhsNoToLinkId n on n.FK_Patient_Link_ID = b.FK_Patient_Link_ID
ORDER BY NhsNo, EventDate;