_This file is autogenerated. Please do not edit._

# The impact of the COVID-19 pandemic on the effectiveness of eTrigger tools

## Summary

A “trigger tool” is a useful way for clinicians to find patients who may need further attention. Each “trigger” is an event, or a combination of events, in the patient’s health record that could (but don’t always) indicate that something has gone wrong. Examples would include:
    - a patient who has an unplanned hospital admission within a few days of a GP visit (It could be coincidence, or it could be that something was missed by the GP)
    - or a patient who has all the symptoms of a disease but who does not have a diagnosis in their record (if a condition is present, but is not diagnosed, then it might not be being treated, which would likely lead to problems for the patient)

Trigger tools can help clinicians find patient safety issues that have occurred and take steps to prevent them happening in the future. If a patient is flagged up by a trigger, a clinician would need to examine their record to determine if something has happened, and decide if further action is necessary. If too many patients are found by a trigger, then it leads to too high a burden on the clinician. Similarly, if the proportion of patients flagged who actually require attention is too low, then the clinician will waste a lot of time reviewing records. Therefore, ideally, each trigger would identify a small number of patients, and a high proportion of them would need further attention. All existing eTrigger tools have been designed in this way.

However, each trigger tool has been developed prior to the COVID-19 pandemic. It is unknown what the impact of the pandemic has had on the number of patients flagging each trigger, and therefore how useful they are for analysing this period of time.

We aim to report on how many patients were flagging against each of a selection of triggers, before and during the pandemic.

## Table of contents

- [Introduction](#introduction)
- [Methodology](#methodology)
- [Reusable queries](#reusable-queries)
- [Clinical code sets](#clinical-code-sets)

## Introduction

The aim of this document is to provide full transparency for all parts of the data extraction process.
This includes:

- The methodology around how the data extraction process is managed and quality is maintained.
- A full list of all queries used in the extraction, and their associated objectives and assumptions.
- A full list of all clinical codes used for the extraction.

## Methodology

After each proposal is approved, a Research Data Engineer (RDE) works closely with the research team to establish precisely what data they require and in what format.
The RDE has access to the entire de-identified database and so builds up an expertise as to which projects are feasible and how best to extract the relevant data.
The RDE has access to a library of resusable SQL queries for common tasks, and sets of clinical codes for different phenotypes, built up from previous studies.
Prior to data extraction, the code is checked and signed off by another RDE.

## Reusable queries
  
This project required the following reusable queries:

- Patient GP encounters
- Classify secondary admissions
- GET practice and ccg for each patient
- CCG lookup table
- Year of birth

Further details for each query can be found below.

### Patient GP encounters
To produce a table of GP encounters for a list of patients. This script uses many codes related to observations (e.g. blood pressure), symptoms, and diagnoses, to infer when GP encounters occured. This script includes face to face and telephone encounters - it will need copying and editing if you don't require both.

_Assumptions_

- multiple codes on the same day will be classed as one encounter (so max daily encounters per patient is 1)

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #GPEncounters (FK_Patient_Link_ID, EncounterDate)
	- FK_Patient_Link_ID - unique patient id
	- EncounterDate - date the patient had a GP encounter
```
_File_: `query-patient-gp-encounters.sql`

_Link_: [https://github.com/rw251/.../query-patient-gp-encounters.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-gp-encounters.sql)

---
### Classify secondary admissions
To categorise admissions to secondary care into 5 categories: Maternity, Unplanned, Planned, Transfer and Unknown.

_Assumptions_

- We assume patients can only have one admission per day. This is probably not true, but where we see multiple admissions it is more likely to be data duplication, or internal admissions, than an admission, discharge and another admission in the same day.
- Where patients have multiple admissions we choose the "highest" category for admission with the categories ranked as follows: Maternity > Unplanned > Planned > Transfer > Unknown
- We have used the following classifications based on the AdmissionTypeCode:
	- PLANNED: PL (ELECTIVE PLANNED), 11 (Elective - Waiting List), WL (ELECTIVE WL), 13 (Elective - Planned), 12 (Elective - Booked), BL (ELECTIVE BOOKED), D (NULL), Endoscopy (Endoscopy), OP (DIRECT OUTPAT CLINIC), Venesection (X36.2 Venesection), Colonoscopy (H22.9 Colonoscopy), Medical (Medical)
	- UNPLANNED: AE (AE.DEPT.OF PROVIDER), 21 (Emergency - Local A&E), I (NULL), GP (GP OR LOCUM GP), 22 (Emergency - GP), 23 (Emergency - Bed Bureau), 28 (Emergency - Other (inc other provider A&E)), 2D (Emergency - Other), 24 (Emergency - Clinic), EM (EMERGENCY OTHER), AI (ACUTE TO INTMED CARE), BB (EMERGENCY BED BUREAU), DO (EMERGENCY DOMICILE), 2A (A+E Department of another provider where the Patient has not been admitted), A+E (Admission	 A+E Admission), Emerg (GP	Emergency GP Patient)
	- MATERNITY: 31 (Maternity ante-partum), BH (BABY BORN IN HOSP), AN (MATERNITY ANTENATAL), 82 (Birth in this Health Care Provider), PN (MATERNITY POST NATAL), B (NULL), 32 (Maternity post-partum), BHOSP (Birth in this Health Care Provider)
	- TRANSFER: 81 (Transfer from other hosp (not A&E)), TR (PLAN TRANS TO TRUST), ET (EM TRAN (OTHER PROV)), HospTran (Transfer from other NHS Hospital), T (TRANSFER), CentTrans (Transfer from CEN Site)
	- OTHER: Anything else not previously classified

_Input_
```
No pre-requisites
```

_Output_
```
A temp table as follows:
 #AdmissionTypes (FK_Patient_Link_ID, AdmissionDate, AcuteProvider, AdmissionType)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
	- AdmissionType - One of: Maternity/Unplanned/Planned/Transfer/Unknown
```
_File_: `query-classify-secondary-admissions.sql`

_Link_: [https://github.com/rw251/.../query-classify-secondary-admissions.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-classify-secondary-admissions.sql)

---
### GET practice and ccg for each patient
For each patient to get the practice id that they are registered to, and the CCG name that the practice belongs to.

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
Two temp tables as follows:
 #PatientPractice (FK_Patient_Link_ID, GPPracticeCode)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
 #PatientPracticeAndCCG (FK_Patient_Link_ID, GPPracticeCode, CCG)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
	- CCG - the name of the patient's CCG
```
_File_: `query-patient-practice-and-ccg.sql`

_Link_: [https://github.com/rw251/.../query-patient-practice-and-ccg.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-practice-and-ccg.sql)

---
### CCG lookup table
To provide lookup table for CCG names. The GMCR provides the CCG id (e.g. '00T', '01G') but not the CCG name. This table can be used in other queries when the output is required to be a ccg name rather than an id.

_Input_
```
No pre-requisites
```

_Output_
```
A temp table as follows:
 #CCGLookup (CcgId, CcgName)
 	- CcgId - Nationally recognised ccg id
	- CcgName - Bolton, Stockport etc..
```
_File_: `query-ccg-lookup.sql`

_Link_: [https://github.com/rw251/.../query-ccg-lookup.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-ccg-lookup.sql)

---
### Year of birth
To get the year of birth for each patient.

_Assumptions_

- Patient data is obtained from multiple sources. Where patients have multiple YOBs we determine the YOB as follows:
- If the patients has a YOB in their primary care data feed we use that as most likely to be up to date
- If every YOB for a patient is the same, then we use that
- If there is a single most recently updated YOB in the database then we use that
- Otherwise we take the highest YOB for the patient that is not in the future

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #PatientYearOfBirth (FK_Patient_Link_ID, YearOfBirth)
 	- FK_Patient_Link_ID - unique patient id
	- YearOfBirth - INT
```
_File_: `query-patient-year-of-birth.sql`

_Link_: [https://github.com/rw251/.../query-patient-year-of-birth.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-year-of-birth.sql)
## Clinical code sets

This project required the following clinical code sets:

- haemoglobin v1
- ferritin v1
- egfr v1
- chronic-kidney-disease v1
- ace-inhibitor v1
- nsaids v1
- diuretic v1
- heart-failure v1
- cancer v1
- atrial-fibrillation v1
- coronary-heart-disease v1
- hypertension v1
- peripheral-arterial-disease v1
- stroke v1
- tia v1
- diabetes v1
- peptic-ulcer-disease v1
- rheumatoid-arthritis v1
- epilepsy v1
- multiple-sclerosis v1
- parkinsons v1
- eating-disorders v1
- anxiety v1
- depression v1
- schizophrenia-psychosis v1
- bipolar v1
- asthma v1
- copd v1
- allergy v1

Further details for each code set can be found below.

### Haemoglobin

A patient's haemoglobin as recorded via clinical code and value. This code set only includes codes that are accompanied by a value (`423.. - Haemoglobin estimation`). It does not include codes that indicate a patient's haemoglobin (`4235 - Haemoglobin low`) without giving the actual value.

Haemoglobin codes were retrieved from https://www.medrxiv.org/content/medrxiv/suppl/2020/05/19/2020.05.14.20101626.DC1/2020.05.14.20101626-1.pdf.

**NB: This code set is intended to only indicate a patient's haemoglobin values.**
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `59.66% - 62.03%` suggests that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-01 | EMIS            | 2652511    | 1582390 (59.66%) |  1582391 (59.66%) |
| 2022-02-01 | TPP             | 212213     |  129224 (60.89%) |   129224 (60.89%) |
| 2022-02-01 | Vision          | 340640     |  211312 (62.03%) |   211312 (62.03%) |
LINK: [https://github.com/rw251/.../tests/haemoglobin/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/haemoglobin/1)

### Ferritin

A patient's ferritin as recorded via clinical code and value. This code set only includes codes that are accompanied by a value (`XaItW - Plasma ferritin level`). It does not include codes that indicate a patient's ferritin without giving the actual value.

**NB: This code set is intended to only indicate a patient's ferritin values.**
#### Prevalence log
By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `33.38% - 39.65%` suggests that this code set is likely well defined.
| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-01 | EMIS            | 2652511    | 1006441 (37.94%) |  1006441 (37.94%) |
| 2022-02-01 | TPP             | 212213     |   70841 (33.38%) |    70841 (33.38%) |
| 2022-02-01 | Vision          | 340640     |  135059 (39.65%) |   135059 (39.65%) |
LINK: [https://github.com/rw251/.../tests/ferritin/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/ferritin/1)

### Glomerular filtration rate (GFR)

Any code that gives the value of a patient's GFR (or estimated GFR - EGFR).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `52.43% - 57.73%` suggests that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-06-10 | EMIS            | 2610073    | 1369349 (52.46%) |  1368468 (52.43%) |
| 2021-06-10 | TPP             | 211034     |  121897 (57.76%) |   121835 (57.73%) |
| 2021-06-10 | Vision          | 335344     |  184635 (55.06%) |   184523 (55.02%) |

LINK: [https://github.com/rw251/.../tests/egfr/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/egfr/1)

### Chronic kidney disease (CKD) diagnosis codes

Developed from https://getset.ga.
This list only includes CKD diagnosis codes (`XaNbn. - Chronic kidney disease stage 3ASerum cholesterol raised`), rather than codes which indicate that a patient might have CKD (`9Ni9.00 - Did not attend chronic kidney disease monitoring clinic`).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `3.18% - 4.30%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-04-06 | EMIS            | 2660237    |  85992 (3.23%)   |   84567 (3.18%)   |
| 2022-04-06 | TPP             | 212647     |   9146 (4.30%)   |    9143 (4.30%)   |
| 2022-04-06 | Vision          | 341912     |  13406 (3.92%)   |   13375 (3.91%)   |
LINK: [https://github.com/rw251/.../conditions/chronic-kidney-disease/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/chronic-kidney-disease/1)

### ACE Inhibitors

This code set was originally created for the SMASH safe medication dashboard and has been validated in practice.

**_NB this code set is for ACE inhibitors AND angiotensin receptor blockers (ARBs). If you just want ACEIs please use v2._**
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `12.36% - 13.02%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |  321934 (12.36%) |   321952 (12.36%) |
| 2021-05-07 | TPP             | 210817     |   27450 (13.02%) |    27450 (13.02%) |
| 2021-05-07 | Vision          | 334632     |   41775 (12.48%) |    41775 (12.48%) |

LINK: [https://github.com/rw251/.../medications/ace-inhibitor/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/medications/ace-inhibitor/1)

### Nonsteroidal anti inflammatory drugs (NSAIDs) oral

This code set was originally created for the SMASH safe medication dashboard and has been validated in practice.

This code set only includes codes that indicates oral NSAIDs. It does not include codes that indicate cream or suppository NSAIDs.

**NB: This code set is intended to indicate only oral NSAIDs, NOT all NSAIDs. If you require all NSAIDs then this is not the code set for you.**
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `46.01% - 50.22%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-02 | EMIS            | 2652511    | 1295120 (48.82%) |  1295123 (48.82%) |
| 2022-02-02 | TPP             | 212213     |  106565 (50.22%) |   106565 (50.22%) |
| 2022-02-02 | Vision          | 340640     |  156717 (46.01%) |   156717 (46.01%) |
LINK: [https://github.com/rw251/.../medications/nsaids/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/medications/nsaids/1)

### Diuretic

This code set was originally created for the SMASH safe medication dashboard and has been validated in practice.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `4.67% - 5.32%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-02 | EMIS            | 2652511    |   125074 (4.72%) |    125097 (4.72%) |
| 2022-02-02 | TPP             | 212213     |    11281 (5.32%) |     11281 (5.32%) |
| 2022-02-02 | Vision          | 340640     |    15916 (4.67%) |     15916 (4.67%) |
LINK: [https://github.com/rw251/.../medications/diuretic/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/medications/diuretic/1)

#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.92% - 1.15%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-03-11 | EMIS            | 2600658    |    23923 (0.92%) |     23923 (0.92%) |
| 2021-03-11 | TPP             | 210333     |     2415 (1.15%) |      2416 (1.15%) |
| 2021-03-11 | Vision          | 333251     |     3157 (0.95%) |      3157 (0.95%) |

LINK: [https://github.com/rw251/.../conditions/heart-failure/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/heart-failure/1)

### Cancer
Readv2 codes from code sets published by in:

Zhu Y, Edwards D, Mant J, Payne RA, Kiddle S. Characteristics, service use and mortality of clusters of multimorbid patients in England: A population-based study. BMC Med [Internet]. 2020 Apr 10 [cited 2021 Apr 14];18(1):78. Available from: https://bmcmedicine.biomedcentral.com/articles/10.1186/s12916-020-01543-8

The above paper used the definition of LTCs as first determined in:

Barnett K, Mercer SW, Norbury M, Watt G, Wyke S, Guthrie B. Epidemiology of multimorbidity and implications for health care, research, and medical education: A cross-sectional study. Lancet [Internet]. 2012 Jul 7 [cited 2021 Apr 14];380(9836):37–43. Available from: www.thelancet.com

CTV3 and SNOMED code sets from OpenSafely.

ICD10 codes have been provided and verified by the Christie team (004). 
#### Prevalence log
By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set, as of 19th July 2021.

| Concept | Version   | System    | Patients | PatientsWithConcept | PatientsWithConceptFromCode | PercentageOfPatients | PercentageOfPatientsFromCode |
| :-----: | :-------: | :-------: | :------: | :-----------------: | :-------------------------: | :------------------: | :--------------------------: |
| cancer  | 1         | EMIS      | 2615750  | 118723              | 78901                       | 4.53877473000096     | 3.01638153493262             |
| cancer  | 1         | TPP       | 211345   | 9607	               | 7280                        | 4.5456481109087      | 3.44460479311079             |
| cancer  | 1         | Vision    | 336528   | 16642               | 11427                       | 4.94520515380592     | 3.39555698188561             |


LINK: [https://github.com/rw251/.../conditions/cancer/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/cancer/1)

#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.65% - 1.80%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-03-11 | EMIS            | 2600658    |    42935 (1.65%) |     42935 (1.65%) |
| 2021-03-11 | TPP             | 210333     |     3536 (1.68%) |      3536 (1.68%) |
| 2021-03-11 | Vision          | 333251     |     5994 (1.80%) |      5994 (1.80%) |

LINK: [https://github.com/rw251/.../conditions/atrial-fibrillation/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/atrial-fibrillation/1)

### Coronary heart disease

This code set was developed from https://www.phpc.cam.ac.uk/pcu/research/research-groups/crmh/cprd_cam/codelists/v11/. Codes indicate a diagnosis of CHD.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `2.75% - 3.09%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-18 | EMIS            | 2662570    |   73153 (2.75%)  |    73156 (2.75%)  |
| 2021-05-18 | TPP             | 212696     |    6550 (3.08%)  |     6576 (3.09%)  |
| 2021-05-18 | Vision          | 342344     |   10209 (2.98%)  |    10209 (2.98%)  |

LINK: [https://github.com/rw251/.../conditions/coronary-heart-disease/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/coronary-heart-disease/1)

### Hypertension

Any diagnosis of hypertension. Excludes hypertension in pregnancy, gestational hyptertension, pre-eclampsia. Based on the QOF code sets for hypertension.

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `12.55% - 12.95%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-07-14 | EMIS            | 2615750    |  328350 (12.55%) |  328339 ( 12.55%) |
| 2021-07-14 | TPP             | 211345     |   27363 (12.95%) |   27362 ( 12.95%) |
| 2021-07-14 | Vision          | 336528     |   43389 (12.89%) |   43389 ( 12.89%) |

LINK: [https://github.com/rw251/.../conditions/hypertension/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/hypertension/1)

### Peripheral arterial disease

Any code indicating a diagnosis of peripheral arterial disease (PAD). Also known as peripheral vascular disease (PVD).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.58% - 0.62%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-12  | EMIS            | 2662570    |    15457 (0.58%) |     15411 (0.58%) |
| 2022-05-12  | TPP             | 212696     |     1241 (0.58%) |      1242 (0.58%) |
| 2022-05-12  | Vision          | 342344     |     2125 (0.62%) |      2079 (0.61%) |

LINK: [https://github.com/rw251/.../conditions/peripheral-arterial-disease/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/peripheral-arterial-disease/1)

### Stroke

Any code indicating a diagnosis of a stroke. Includes ischaemic and haemorrhagic strokes.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.91% - 1.45%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-12  | EMIS            | 2662570    |    24378 (0.92%) |     24359 (0.91%) |
| 2022-05-12  | TPP             | 212696     |     2441 (1.45%) |      2445 (1.45%) |
| 2022-05-12  | Vision          | 342344     |     3308 (0.97%) |      3307 (0.97%) |

LINK: [https://github.com/rw251/.../conditions/stroke/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/stroke/1)

### Transient ischaemic attach

Any code indicating a diagnosis of a transient ischaemic attack (TIA).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.78% - 0.99%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16  | EMIS            | 2662570    |    20798 (0.78%) |     20798 (0.78%) |
| 2022-05-16  | TPP             | 212696     |     1806 (0.85%) |      1811 (0.85%) |
| 2022-05-16  | Vision          | 342344     |     3409 (0.99%) |      3409 (0.99%) |

LINK: [https://github.com/rw251/.../conditions/tia/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/tia/1)

### Diabetes mellitus

Code set for any diagnosis of diabetes mellitus (type I/type II/other).

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `5.96% - 6.05%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |   155421 (5.96%) |    155398 (5.96%) |
| 2021-05-07 | TPP             | 210817     |    12743 (6.04%) |     12745 (6.05%) |
| 2021-05-07 | Vision          | 334632     |    20145 (6.02%) |     20145 (6.02%) |

LINK: [https://github.com/rw251/.../conditions/diabetes/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/diabetes/1)

### Peptic ulcer disease

Any code indicating a diagnosis of a peptic ulcer disease (PUD).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.87% - 1.06%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ------------| --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-05  | EMIS            | 2662112    |    28225 (1.06%) |     28225 (1.06%) |
| 2022-05-05  | TPP             | 212726     |     1861 (0.87%) |      1861 (0.87%) |
| 2022-05-05  | Vision          | 342310     |     3485 (1.02%) |      3459 (1.01%) |

LINK: [https://github.com/rw251/.../conditions/peptic-ulcer-disease/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/peptic-ulcer-disease/1)

### Rheumatoid arthritis

Any code indicating a diagnosis of rheumatoid arthritis. Does not include lupus.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.53% - 0.62%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16  | EMIS            | 2662570    |    15603 (0.59%) |     15603 (0.59%) |
| 2022-05-16  | TPP             | 212696     |     1130 (0.53%) |      1137 (0.53%) |
| 2022-05-16  | Vision          | 342344     |     2126 (0.62%) |      2126 (0.62%) |

LINK: [https://github.com/rw251/.../conditions/rheumatoid-arthritis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/rheumatoid-arthritis/1)

### Epilepsy

Any code indicating a diagnosis of epilepsy. Code set from GetSet with confirmation from https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/55/codelist/res55-epilepsy/.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `1.22% - 1.28%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16  | EMIS            | 2662570    |    32505 (1.22%) |     32639 (1.22%) |
| 2022-05-16  | TPP             | 212696     |     2646 (1.24%) |      2654 (1.25%) |
| 2022-05-16  | Vision          | 342344     |     4369 (1.28%) |      4373 (1.28%) |

LINK: [https://github.com/rw251/.../conditions/epilepsy/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/epilepsy/1)

### Multiple Sclerosis (MS)

Any code indicating a diagnosis of multiple sclerosis (MS).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.15% - 0.20%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16  | EMIS            | 2662570    |     4289 (0.16%) |      4289 (0.16%) |
| 2022-05-16  | TPP             | 212696     |      327 (0.15%) |       327 (0.15%) |
| 2022-05-16  | Vision          | 342344     |      687 (0.20%) |       687 (0.20%) |

LINK: [https://github.com/rw251/.../conditions/multiple-sclerosis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/multiple-sclerosis/1)

### Parkinson's disease

Any code indicating a diagnosis of Parkinson's disease. Excludes other diseases causing Parkinsonism.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.13% - 0.15%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-06  | EMIS            | 2662112    |     3336 (0.13%) |      3336 (0.13%) |
| 2022-05-06  | TPP             | 212726     |      311 (0.15%) |       311 (0.15%) |
| 2022-05-06  | Vision          | 342310     |      488 (0.14%) |       488 (0.14%) |

LINK: [https://github.com/rw251/.../conditions/parkinsons/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/parkinsons/1)

### Eating disorders

Any code indicating a diagnosis of anorexia or bulimia or similar eating disorders.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `0.42% - 0.84%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-06  | EMIS            | 2662112    |    22407 (0.84%) |     22407 (0.84%) |
| 2022-05-06  | TPP             | 212726     |      885 (0.42%) |       885 (0.42%) |
| 2022-05-06  | Vision          | 342310     |     1999 (0.58%) |      1935 (0.57%) |

LINK: [https://github.com/rw251/.../conditions/eating-disorders/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/eating-disorders/1)

### Anxiety

Any code indicating a diagnosis of anxiety or other somatoform disorder.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `18.23% - 18.77%` suggests that this code set is well defined.

| Date        | Practice system | Population | Patients from ID | Patient from code |
| ----------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16  | EMIS            | 2662570    |  499713 (18.77%) |   502416 (18.87%) |
| 2022-05-16  | TPP             | 212696     |   38757 (18.22%) |    38769 (18.23%) |
| 2022-05-16  | Vision          | 342344     |   65130 (19.02%) |    64271 (18.77%)) |

LINK: [https://github.com/rw251/.../conditions/anxiety/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/anxiety/1)

### Depression

Code set for patients with a diagnosis of depression.

Developed from www.opencodelists.org
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, 
we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.
Prevalence range: 21.09% - 22.83%

|    Date    | Practice system |  Population | Patients from ID | Patient from code |
| ---------- | ----------------| ------------| ---------------- | ----------------- |
| 2022-05-12 |	EMIS	       |  2662570    |	553650 (20.79%) | 560060 (21.03%)   |
| 2022-05-12 |	TPP	           |   212696    |   45884 (21.57%) |  45912 (21.59%)   |
| 2022-05-12 |	Vision	       |   342344    |   75709 (22.11%) |  73277 (21.40%)   |
LINK: [https://github.com/rw251/.../conditions/depression/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/depression/1)

### Schizophrenia and Psychosis

Code set for patients with a diagnosis of psychosis or schizophrenia.

Developed from www.opencodelists.org
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions.
Here is a log for this code set. The prevalence range (1.10% - 1.90%)

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------- | ----------------- |
| 2021-06-16 | EMIS            | 2608685    | 46695 (1.79%)    | 46695 (1.79%)     |
| 2021-06-16 | TPP             | 210985     | 28695 (1.10%)    | 28695 (1.10%)     |
| 2021-06-16 | Vision          | 335010     | 49565 (1.90%)    | 49565 (1.90%)     |

LINK: [https://github.com/rw251/.../conditions/schizophrenia-psychosis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/schizophrenia-psychosis/1)

### Bipolar affective disorder

Code set for patients with a diagnosis of bipolar.

Developed from www.opencodelists.org
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. Prevalence range: 0.28% - 0.54%

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------- | ----------------- |
| 2021-06-30 | EMIS            | 2608685    | 14087 (0.54%)    | 14087 (0.54%)     |
| 2021-06-30 | TPP             | 210985     | 591 (0.28%)      | 591 (0.28%)       |
| 2021-06-30 | Vision          | 335010     | 1608 (0.48%)     | 1608 (0.48%)      |

LINK: [https://github.com/rw251/.../conditions/bipolar/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/bipolar/1)

### Asthma

This code set was originally created for the SMASH safe medication dashboard and has been validated in practice.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `12.14% - 13.37%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-11 | EMIS            | 2606497    |  335219 (12.86%) |   335223 (12.86%) |
| 2021-05-11 | TPP             | 210810     |   25596 (12.14%) |    25596 (12.14%) |
| 2021-05-11 | Vision          | 334784     |   44764 (13.37%) |    44764 (13.37%) |

LINK: [https://github.com/rw251/.../conditions/asthma/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/asthma/1)

### COPD

Any suggestion of a diagnosis of COPD.

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `2.10% - 2.33%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |    54668 (2.10%) |     54669 (2.10%) |
| 2021-05-07 | TPP             | 210817     |     4537 (2.15%) |      4538 (2.15%) |
| 2021-05-07 | Vision          | 334632     |     7789 (2.33%) |      7789 (2.33%) |

LINK: [https://github.com/rw251/.../conditions/copd/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/copd/1)

### Allergy codes

This list contains any code that indicates a diagnosis of an allergy or adverse reaction.
Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `7.28% - 10.15%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-08-18 | EMIS            | 2493056    |  232876 (9.34%)  |  252693 (10.15%) |
| 2022-08-18 | TPP             | 198292     |   14321 (7.22%)  |    16214 (8.17%) |
| 2022-08-18 | Vision          | 327521     |   23824 (7.27%)  |    23855 (7.28%) |
LINK: [https://github.com/rw251/.../conditions/allergy/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/allergy/1)
# Clinical code sets

All code sets required for this analysis are available here: [https://github.com/rw251/.../034 - Williams/clinical-code-sets.csv](https://github.com/rw251/gm-idcr/tree/master/projects/034%20-%20Williams/clinical-code-sets.csv). Individual lists for each concept can also be found by using the links above.