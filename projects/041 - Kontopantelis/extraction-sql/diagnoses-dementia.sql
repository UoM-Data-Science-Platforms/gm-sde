--┌────────────────────────────┐
--│ Diagnoses of dementia      │
--└────────────────────────────┘

------------ RESEARCH DATA ENGINEER CHECK ------------

------------------------------------------------------

-- Set the start date
DECLARE @StartDate datetime;
DECLARE @EndDate datetime;
SET @StartDate = '2018-03-01';
SET @EndDate = '2023-08-31';

--DECLARE @IndexDate datetime;
--SET @IndexDate = '2020-03-01';

--Just want the output, not the messages
SET NOCOUNT ON;

--┌──────────────────────────────────────────────────────────────────────┐
--│ Define Cohort for RQ041: patients with biochemical evidence of CKD   │
--└──────────────────────────────────────────────────────────────────────┘

-- OBJECTIVE: To build the cohort of patients needed for RQ041. This reduces duplication of code in the template scripts.

-- COHORT: Any patient with biochemical evidence of CKD. More detail in the comments throughout this script.

-- INPUT: assumes there exists one temp table as follows:
-- #Patients (FK_Patient_Link_ID)
--  A distinct list of FK_Patient_Link_IDs for each patient in the cohort

-- OUTPUT: A temp table as follows:
-- #Cohort (FK_Patient_Link_ID)
-- #PatientEventData


DECLARE @StudyStartDate datetime;
SET @StudyStartDate = '2018-03-01';

--┌───────────────────────────────────────────────────────────┐
--│ Create table of patients who are registered with a GM GP  │
--└───────────────────────────────────────────────────────────┘

-- INPUT REQUIREMENTS: @StudyStartDate

-- Find all patients alive at start date
IF OBJECT_ID('tempdb..#PossiblePatients') IS NOT NULL DROP TABLE #PossiblePatients;
SELECT PK_Patient_Link_ID as FK_Patient_Link_ID, EthnicMainGroup, EthnicGroupDescription, DeathDate INTO #PossiblePatients FROM [SharedCare].Patient_Link
WHERE 
	(DeathDate IS NULL OR (DeathDate >= @StudyStartDate))

-- Find all patients registered with a GP
IF OBJECT_ID('tempdb..#PatientsWithGP') IS NOT NULL DROP TABLE #PatientsWithGP;
SELECT DISTINCT FK_Patient_Link_ID INTO #PatientsWithGP FROM [SharedCare].Patient
where FK_Reference_Tenancy_ID = 2
AND GPPracticeCode NOT LIKE 'ZZZ%';

-- Make cohort from patients alive at start date and registered with a GP
IF OBJECT_ID('tempdb..#Patients') IS NOT NULL DROP TABLE #Patients;
SELECT pp.* INTO #Patients FROM #PossiblePatients pp
INNER JOIN #PatientsWithGP gp on gp.FK_Patient_Link_ID = pp.FK_Patient_Link_ID;

------------------------------------------

-- OUTPUT: #Patients

-- LOAD CODESETS NEEDED FOR DEFINING COHORT

-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

--#region Clinical code sets

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
  [description] [varchar] (255) NULL 
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('dementia',1,'1461.',NULL,'H/O: dementia'),('dementia',1,'1461.00',NULL,'H/O: dementia'),('dementia',1,'4L49.',NULL,'Prion protein markers for Creutzfeldt-Jakob disease'),('dementia',1,'4L49.00',NULL,'Prion protein markers for Creutzfeldt-Jakob disease'),('dementia',1,'66h..',NULL,'Dementia monitoring'),('dementia',1,'66h..00',NULL,'Dementia monitoring'),('dementia',1,'6AB..',NULL,'Dementia annual review'),('dementia',1,'6AB..00',NULL,'Dementia annual review'),('dementia',1,'8BM02',NULL,'Dementia medication review'),('dementia',1,'8BM0200',NULL,'Dementia medication review'),('dementia',1,'9hD..',NULL,'Exception reporting: dementia quality indicators'),('dementia',1,'9hD..00',NULL,'Exception reporting: dementia quality indicators'),('dementia',1,'9hD0.',NULL,'Excepted from dementia quality indicators: Patient unsuitable'),('dementia',1,'9hD0.00',NULL,'Excepted from dementia quality indicators: Patient unsuitable'),('dementia',1,'9hD1.',NULL,'Excepted from dementia quality indicators: Informed dissent'),('dementia',1,'9hD1.00',NULL,'Excepted from dementia quality indicators: Informed dissent'),('dementia',1,'9Ou..',NULL,'Dementia monitoring administration'),('dementia',1,'9Ou..00',NULL,'Dementia monitoring administration'),('dementia',1,'9Ou1.',NULL,'Dementia monitoring first letter'),('dementia',1,'9Ou1.00',NULL,'Dementia monitoring first letter'),('dementia',1,'9Ou2.',NULL,'Dementia monitoring second letter'),('dementia',1,'9Ou2.00',NULL,'Dementia monitoring second letter'),('dementia',1,'9Ou3.',NULL,'Dementia monitoring third letter'),('dementia',1,'9Ou3.00',NULL,'Dementia monitoring third letter'),('dementia',1,'9Ou4.',NULL,'Dementia monitoring verbal invite'),('dementia',1,'9Ou4.00',NULL,'Dementia monitoring verbal invite'),('dementia',1,'9Ou5.',NULL,'Dementia monitoring telephone invite'),('dementia',1,'9Ou5.00',NULL,'Dementia monitoring telephone invite'),('dementia',1,'A410.',NULL,'Kuru'),('dementia',1,'A410.00',NULL,'Kuru'),('dementia',1,'A411.',NULL,'Jakob-Creutzfeldt disease'),('dementia',1,'A411.00',NULL,'Jakob-Creutzfeldt disease'),('dementia',1,'A4110',NULL,'Sporadic Creutzfeldt-Jakob disease'),('dementia',1,'A411000',NULL,'Sporadic Creutzfeldt-Jakob disease'),('dementia',1,'E00..',NULL,'Senile and presenile organic psychotic conditions'),('dementia',1,'E00..00',NULL,'Senile and presenile organic psychotic conditions'),('dementia',1,'E000.',NULL,'Uncomplicated senile dementia'),('dementia',1,'E000.00',NULL,'Uncomplicated senile dementia'),('dementia',1,'E001.',NULL,'Presenile dementia'),('dementia',1,'E001.00',NULL,'Presenile dementia'),('dementia',1,'E0010',NULL,'Uncomplicated presenile dementia'),('dementia',1,'E001000',NULL,'Uncomplicated presenile dementia'),('dementia',1,'E0011',NULL,'Presenile dementia with delirium'),('dementia',1,'E001100',NULL,'Presenile dementia with delirium'),('dementia',1,'E0012',NULL,'Presenile dementia with paranoia'),('dementia',1,'E001200',NULL,'Presenile dementia with paranoia'),('dementia',1,'E0013',NULL,'Presenile dementia with depression'),('dementia',1,'E001300',NULL,'Presenile dementia with depression'),('dementia',1,'E001z',NULL,'Presenile dementia NOS'),('dementia',1,'E001z00',NULL,'Presenile dementia NOS'),('dementia',1,'E002.',NULL,'Senile dementia with depressive or paranoid features'),('dementia',1,'E002.00',NULL,'Senile dementia with depressive or paranoid features'),('dementia',1,'E0020',NULL,'Senile dementia with paranoia'),('dementia',1,'E002000',NULL,'Senile dementia with paranoia'),('dementia',1,'E0021',NULL,'Senile dementia with depression'),('dementia',1,'E002100',NULL,'Senile dementia with depression'),('dementia',1,'E002z',NULL,'Senile dementia with depressive or paranoid features NOS'),('dementia',1,'E002z00',NULL,'Senile dementia with depressive or paranoid features NOS'),('dementia',1,'E003.',NULL,'Senile dementia with delirium'),('dementia',1,'E003.00',NULL,'Senile dementia with delirium'),('dementia',1,'E004.',NULL,'Arteriosclerotic dementia'),('dementia',1,'E004.00',NULL,'Arteriosclerotic dementia'),('dementia',1,'E0040',NULL,'Uncomplicated arteriosclerotic dementia'),('dementia',1,'E004000',NULL,'Uncomplicated arteriosclerotic dementia'),('dementia',1,'E0041',NULL,'Arteriosclerotic dementia with delirium'),('dementia',1,'E004100',NULL,'Arteriosclerotic dementia with delirium'),('dementia',1,'E0042',NULL,'Arteriosclerotic dementia with paranoia'),('dementia',1,'E004200',NULL,'Arteriosclerotic dementia with paranoia'),('dementia',1,'E0043',NULL,'Arteriosclerotic dementia with depression'),('dementia',1,'E004300',NULL,'Arteriosclerotic dementia with depression'),('dementia',1,'E004z',NULL,'Arteriosclerotic dementia NOS'),('dementia',1,'E004z00',NULL,'Arteriosclerotic dementia NOS'),('dementia',1,'E00y.',NULL,'Other senile and presenile organic psychoses'),('dementia',1,'E00y.00',NULL,'Other senile and presenile organic psychoses'),('dementia',1,'E00z.',NULL,'Senile or presenile psychoses NOS'),('dementia',1,'E00z.00',NULL,'Senile or presenile psychoses NOS'),('dementia',1,'E011.',NULL,'Alcohol amnestic syndrome'),('dementia',1,'E011.00',NULL,'Alcohol amnestic syndrome'),('dementia',1,'E0110',NULL,'Korsakovs alcoholic psychosis'),('dementia',1,'E011000',NULL,'Korsakovs alcoholic psychosis'),('dementia',1,'E0111',NULL,'Korsakovs alcoholic psychosis with peripheral neuritis'),('dementia',1,'E011100',NULL,'Korsakovs alcoholic psychosis with peripheral neuritis'),('dementia',1,'E0112',NULL,'Wernicke-Korsakov syndrome'),('dementia',1,'E011200',NULL,'Wernicke-Korsakov syndrome'),('dementia',1,'E011z',NULL,'Alcohol amnestic syndrome NOS'),('dementia',1,'E011z00',NULL,'Alcohol amnestic syndrome NOS'),('dementia',1,'E012.',NULL,'Other alcoholic dementia'),('dementia',1,'E012.00',NULL,'Other alcoholic dementia'),('dementia',1,'E040.',NULL,'Non-alcoholic amnestic syndrome'),('dementia',1,'E040.00',NULL,'Non-alcoholic amnestic syndrome'),('dementia',1,'E041.',NULL,'Dementia in conditions EC'),('dementia',1,'E041.00',NULL,'Dementia in conditions EC'),('dementia',1,'Eu00.',NULL,'[X]Dementia in Alzheimers disease'),('dementia',1,'Eu00.00',NULL,'[X]Dementia in Alzheimers disease'),('dementia',1,'Eu000',NULL,'[X]Dementia in Alzheimers disease with early onset'),('dementia',1,'Eu00000',NULL,'[X]Dementia in Alzheimers disease with early onset'),('dementia',1,'Eu001',NULL,'[X]Dementia in Alzheimers disease with late onset'),('dementia',1,'Eu00100',NULL,'[X]Dementia in Alzheimers disease with late onset'),('dementia',1,'Eu002',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type'),('dementia',1,'Eu00200',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type'),('dementia',1,'Eu00z',NULL,'[X]Dementia in Alzheimers disease, unspecified'),('dementia',1,'Eu00z00',NULL,'[X]Dementia in Alzheimers disease, unspecified'),('dementia',1,'Eu01.',NULL,'[X]Vascular dementia'),('dementia',1,'Eu01.00',NULL,'[X]Vascular dementia'),('dementia',1,'Eu010',NULL,'[X]Vascular dementia of acute onset'),('dementia',1,'Eu01000',NULL,'[X]Vascular dementia of acute onset'),('dementia',1,'Eu011',NULL,'[X]Multi-infarct dementia'),('dementia',1,'Eu01100',NULL,'[X]Multi-infarct dementia'),('dementia',1,'Eu012',NULL,'[X]Subcortical vascular dementia'),('dementia',1,'Eu01200',NULL,'[X]Subcortical vascular dementia'),('dementia',1,'Eu013',NULL,'[X]Mixed cortical and subcortical vascular dementia'),('dementia',1,'Eu01300',NULL,'[X]Mixed cortical and subcortical vascular dementia'),('dementia',1,'Eu01y',NULL,'[X]Other vascular dementia'),('dementia',1,'Eu01y00',NULL,'[X]Other vascular dementia'),('dementia',1,'Eu01z',NULL,'[X]Vascular dementia, unspecified'),('dementia',1,'Eu01z00',NULL,'[X]Vascular dementia, unspecified'),('dementia',1,'Eu02.',NULL,'[X]Dementia in other diseases classified elsewhere'),('dementia',1,'Eu02.00',NULL,'[X]Dementia in other diseases classified elsewhere'),('dementia',1,'Eu020',NULL,'[X]Dementia in Picks disease'),('dementia',1,'Eu02000',NULL,'[X]Dementia in Picks disease'),('dementia',1,'Eu021',NULL,'[X]Dementia in Creutzfeldt-Jakob disease'),('dementia',1,'Eu02100',NULL,'[X]Dementia in Creutzfeldt-Jakob disease'),('dementia',1,'Eu022',NULL,'[X]Dementia in Huntingtons disease'),('dementia',1,'Eu02200',NULL,'[X]Dementia in Huntingtons disease'),('dementia',1,'Eu023',NULL,'[X]Dementia in Parkinsons disease'),('dementia',1,'Eu02300',NULL,'[X]Dementia in Parkinsons disease'),('dementia',1,'Eu024',NULL,'[X]Dementia in human immunodef virus [HIV] disease'),('dementia',1,'Eu02400',NULL,'[X]Dementia in human immunodef virus [HIV] disease'),('dementia',1,'Eu025',NULL,'[X]Lewy body dementia'),('dementia',1,'Eu02500',NULL,'[X]Lewy body dementia'),('dementia',1,'Eu02y',NULL,'[X]Dementia in other specified diseases classif elsewhere'),('dementia',1,'Eu02y00',NULL,'[X]Dementia in other specified diseases classif elsewhere'),('dementia',1,'Eu02z',NULL,'[X] Unspecified dementia'),('dementia',1,'Eu02z00',NULL,'[X] Unspecified dementia'),('dementia',1,'Eu041',NULL,'[X]Delirium superimposed on dementia'),('dementia',1,'Eu04100',NULL,'[X]Delirium superimposed on dementia'),('dementia',1,'Eu106',NULL,'[X]Mental and behavioural disorders due to use of alcohol: amnesic syndrome'),('dementia',1,'Eu10600',NULL,'[X]Mental and behavioural disorders due to use of alcohol: amnesic syndrome'),('dementia',1,'Eu107','11','[X]Alcoholic dementia NOS'),('dementia',1,'Eu107','11','[X]Alcoholic dementia NOS'),('dementia',1,'F0300',NULL,'Encephalitis due to kuru'),('dementia',1,'F030000',NULL,'Encephalitis due to kuru'),('dementia',1,'F110.',NULL,'Alzheimers disease'),('dementia',1,'F110.00',NULL,'Alzheimers disease'),('dementia',1,'F1100',NULL,'Alzheimers disease with early onset'),('dementia',1,'F110000',NULL,'Alzheimers disease with early onset'),('dementia',1,'F1101',NULL,'Alzheimers disease with late onset'),('dementia',1,'F110100',NULL,'Alzheimers disease with late onset'),('dementia',1,'F111.',NULL,'Picks disease'),
('dementia',1,'F111.00',NULL,'Picks disease'),('dementia',1,'F116.',NULL,'Lewy body disease'),('dementia',1,'F116.00',NULL,'Lewy body disease'),('dementia',1,'F118.',NULL,'Frontotemporal degeneration'),('dementia',1,'F118.00',NULL,'Frontotemporal degeneration'),('dementia',1,'F11x7',NULL,'Cerebral degeneration due to Jakob - Creutzfeldt disease'),('dementia',1,'F11x700',NULL,'Cerebral degeneration due to Jakob - Creutzfeldt disease'),('dementia',1,'F11x8',NULL,'Cerebral degeneration due to progressive multifocal leucoencephalopathy'),('dementia',1,'F11x800',NULL,'Cerebral degeneration due to progressive multifocal leucoencephalopathy'),('dementia',1,'F21y2',NULL,'Binswangers disease'),('dementia',1,'F21y200',NULL,'Binswangers disease'),('dementia',1,'Fyu30',NULL,'[X]Other Alzheimers disease'),('dementia',1,'Fyu3000',NULL,'[X]Other Alzheimers disease'),('dementia',1,'A941.',NULL,'General paresis - neurosyphilis'),('dementia',1,'A941.00',NULL,'General paresis - neurosyphilis'),('dementia',1,'E02y1',NULL,'Drug-induced dementia'),('dementia',1,'E02y100',NULL,'Drug-induced dementia'),('dementia',1,'E2A2.',NULL,'Post-concussion syndrome'),('dementia',1,'E2A2.00',NULL,'Post-concussion syndrome'),('dementia',1,'Eu062',NULL,'[X]Postconcussional syndrome'),('dementia',1,'Eu06200',NULL,'[X]Postconcussional syndrome'),('dementia',1,'F112.',NULL,'Senile degeneration of brain'),('dementia',1,'F112.00',NULL,'Senile degeneration of brain');
INSERT INTO #codesreadv2
VALUES ('glomerulonephritis',1,'K02..',NULL,'Chronic glomerulonephritis'),('glomerulonephritis',1,'K02..00',NULL,'Chronic glomerulonephritis'),('glomerulonephritis',1,'K02z.',NULL,'Chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K02z.00',NULL,'Chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K02y.',NULL,'Other chronic glomerulonephritis'),('glomerulonephritis',1,'K02y.00',NULL,'Other chronic glomerulonephritis'),('glomerulonephritis',1,'K02yz',NULL,'Other chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K02yz00',NULL,'Other chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K02y3',NULL,'Chronic diffuse glomerulonephritis'),('glomerulonephritis',1,'K02y300',NULL,'Chronic diffuse glomerulonephritis'),('glomerulonephritis',1,'K02y2',NULL,'Chronic focal glomerulonephritis'),('glomerulonephritis',1,'K02y200',NULL,'Chronic focal glomerulonephritis'),('glomerulonephritis',1,'K02y1',NULL,'Chronic exudative glomerulonephritis'),('glomerulonephritis',1,'K02y100',NULL,'Chronic exudative glomerulonephritis'),('glomerulonephritis',1,'K02y0',NULL,'Chronic glomerulonephritis + diseases EC'),('glomerulonephritis',1,'K02y000',NULL,'Chronic glomerulonephritis + diseases EC'),('glomerulonephritis',1,'K023.',NULL,'Chronic rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'K023.00',NULL,'Chronic rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'K022.',NULL,'Chronic membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K022.00',NULL,'Chronic membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K021.',NULL,'Chronic membranous glomerulonephritis'),('glomerulonephritis',1,'K021.00',NULL,'Chronic membranous glomerulonephritis'),('glomerulonephritis',1,'K020.',NULL,'Chronic proliferative glomerulonephritis'),('glomerulonephritis',1,'K020.00',NULL,'Chronic proliferative glomerulonephritis'),('glomerulonephritis',1,'K00..',NULL,'Acute glomerulonephritis'),('glomerulonephritis',1,'K00..00',NULL,'Acute glomerulonephritis'),('glomerulonephritis',1,'K00z.',NULL,'Acute glomerulonephritis NOS'),('glomerulonephritis',1,'K00z.00',NULL,'Acute glomerulonephritis NOS'),('glomerulonephritis',1,'K00y.',NULL,'Other acute glomerulonephritis'),('glomerulonephritis',1,'K00y.00',NULL,'Other acute glomerulonephritis'),('glomerulonephritis',1,'K00yz',NULL,'Other acute glomerulonephritis NOS'),('glomerulonephritis',1,'K00yz00',NULL,'Other acute glomerulonephritis NOS'),('glomerulonephritis',1,'K00y0',NULL,'Acute glomerulonephritis in diseases EC'),('glomerulonephritis',1,'K00y000',NULL,'Acute glomerulonephritis in diseases EC'),('glomerulonephritis',1,'K000.',NULL,'Acute proliferative glomerulonephritis'),('glomerulonephritis',1,'K000.00',NULL,'Acute proliferative glomerulonephritis'),('glomerulonephritis',1,'K0001',NULL,'Crescentic glomerulonephritis'),('glomerulonephritis',1,'K000100',NULL,'Crescentic glomerulonephritis'),('glomerulonephritis',1,'K032z',NULL,'Nephritis unspecified with lesion of membranoproliferative glomerulonephritis NOS'),('glomerulonephritis',1,'K032z00',NULL,'Nephritis unspecified with lesion of membranoproliferative glomerulonephritis NOS'),('glomerulonephritis',1,'K032y',NULL,'Nephritis unspecified with other specified lesion of membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K032y00',NULL,'Nephritis unspecified with other specified lesion of membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K0325',NULL,'Other familial glomerulonephritis'),('glomerulonephritis',1,'K032500',NULL,'Other familial glomerulonephritis'),('glomerulonephritis',1,'K0324',NULL,'Familial glomerulonephritis in Alports syndrome'),('glomerulonephritis',1,'K032400',NULL,'Familial glomerulonephritis in Alports syndrome'),('glomerulonephritis',1,'K0323',NULL,'Anaphylactoid glomerulonephritis'),('glomerulonephritis',1,'K032300',NULL,'Anaphylactoid glomerulonephritis'),('glomerulonephritis',1,'K0322',NULL,'Focal glomerulonephritis with focal recurrent macroscopic glomerulonephritis'),('glomerulonephritis',1,'K032200',NULL,'Focal glomerulonephritis with focal recurrent macroscopic glomerulonephritis'),('glomerulonephritis',1,'K0320',NULL,'Focal membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K032000',NULL,'Focal membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K01B.',NULL,'Nephrotic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K01B.00',NULL,'Nephrotic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K019.',NULL,'Nephrotic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K019.00',NULL,'Nephrotic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K018.',NULL,'Nephrotic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K018.00',NULL,'Nephrotic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K017.',NULL,'Nephrotic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K017.00',NULL,'Nephrotic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K016.',NULL,'Nephrotic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K016.00',NULL,'Nephrotic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K012.',NULL,'Nephrotic syndrome with membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K012.00',NULL,'Nephrotic syndrome with membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K011.',NULL,'Nephrotic syndrome with membranous glomerulonephritis'),('glomerulonephritis',1,'K011.00',NULL,'Nephrotic syndrome with membranous glomerulonephritis'),('glomerulonephritis',1,'K010.',NULL,'Nephrotic syndrome with proliferative glomerulonephritis'),('glomerulonephritis',1,'K010.00',NULL,'Nephrotic syndrome with proliferative glomerulonephritis'),('glomerulonephritis',1,'K013.',NULL,'Nephrotic syndrome with minimal change glomerulonephritis'),('glomerulonephritis',1,'K013.00',NULL,'Nephrotic syndrome with minimal change glomerulonephritis'),('glomerulonephritis',1,'K03z.',NULL,'Unspecified glomerulonephritis NOS'),('glomerulonephritis',1,'K03z.00',NULL,'Unspecified glomerulonephritis NOS'),('glomerulonephritis',1,'K03X.',NULL,'Unspecified nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K03X.00',NULL,'Unspecified nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K03W.',NULL,'Unspecified nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K03W.00',NULL,'Unspecified nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K03U.',NULL,'Unspecified nephritic syndrome, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K03U.00',NULL,'Unspecified nephritic syndrome, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K036.',NULL,'Cryoglobulinaemic glomerulonephritis'),('glomerulonephritis',1,'K036.00',NULL,'Cryoglobulinaemic glomerulonephritis'),('glomerulonephritis',1,'K0A07',NULL,'Acute nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A0700',NULL,'Acute nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A05',NULL,'Acute nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A0500',NULL,'Acute nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A04',NULL,'Acute nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A0400',NULL,'Acute nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A03',NULL,'Acute nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A0300',NULL,'Acute nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A02',NULL,'Acute nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A0200',NULL,'Acute nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A17',NULL,'Rapidly progressive nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A1700',NULL,'Rapidly progressive nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A15',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A1500',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A14',NULL,'Rapidly progressive nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A1400',NULL,'Rapidly progressive nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A13',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A1300',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A12',NULL,'Rapidly progressive nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A1200',NULL,'Rapidly progressive nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A27',NULL,'Recurrent and persistent haematuria, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A2700',NULL,'Recurrent and persistent haematuria, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A25',NULL,'Recurrent and persistent haematuria, diffuse mesangiocapillary glomerulonephritis'),
('glomerulonephritis',1,'K0A2500',NULL,'Recurrent and persistent haematuria, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A24',NULL,'Recurrent and persistent haematuria, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A2400',NULL,'Recurrent and persistent haematuria, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A23',NULL,'Recurrent and persistent haematuria, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A2300',NULL,'Recurrent and persistent haematuria, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A22',NULL,'Recurrent and persistent haematuria, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A2200',NULL,'Recurrent and persistent haematuria, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A37',NULL,'Chronic nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A3700',NULL,'Chronic nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A35',NULL,'Chronic nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A3500',NULL,'Chronic nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A34',NULL,'Chronic nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A3400',NULL,'Chronic nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A33',NULL,'Chronic nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A3300',NULL,'Chronic nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A32',NULL,'Chronic nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A3200',NULL,'Chronic nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A47',NULL,'Isolated proteinuria with specified morphological lesion, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K0A4700',NULL,'Isolated proteinuria with specified morphological lesion, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K0A45',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A4500',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A44',NULL,'Isolated proteinuria with specified morphological lesion, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A4400',NULL,'Isolated proteinuria with specified morphological lesion, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A43',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A4300',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A42',NULL,'Isolated proteinuria with specified morphological lesion, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A4200',NULL,'Isolated proteinuria with specified morphological lesion, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A57',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A5700',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A55',NULL,'[X]Hereditary nephropathy, not elsewhere classified, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A5500',NULL,'[X]Hereditary nephropathy, not elsewhere classified, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A54',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A5400',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A53',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A5300',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A52',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A5200',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'Kyu0C',NULL,'[X]Unspecified nephritic syndrome, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'Kyu0C00',NULL,'[X]Unspecified nephritic syndrome, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'Kyu0A',NULL,'[X]Unspecified nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'Kyu0A00',NULL,'[X]Unspecified nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'Kyu09',NULL,'[X]Unspecified nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'Kyu0900',NULL,'[X]Unspecified nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A9.',NULL,'Cytomegalovirus-induced glomerulonephritis'),('glomerulonephritis',1,'K0A9.00',NULL,'Cytomegalovirus-induced glomerulonephritis'),('glomerulonephritis',1,'K0A8.',NULL,'Rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'K0A8.00',NULL,'Rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'SP08b',NULL,'De novo glomerulonephritis'),('glomerulonephritis',1,'SP08b00',NULL,'De novo glomerulonephritis'),('glomerulonephritis',1,'K0A28',NULL,'IgA nephropathy'),('glomerulonephritis',1,'K0A2800',NULL,'IgA nephropathy'),('glomerulonephritis',1,'G7520',NULL,'Goodpastures syndrome'),('glomerulonephritis',1,'G752000',NULL,'Goodpastures syndrome'),('glomerulonephritis',1,'K01x4',NULL,'Nephrotic syndrome in systemic lupus erythematosus'),('glomerulonephritis',1,'K01x400',NULL,'Nephrotic syndrome in systemic lupus erythematosus'),('glomerulonephritis',1,'K00y2',NULL,'Acute focal nephritis'),('glomerulonephritis',1,'K00y200',NULL,'Acute focal nephritis'),('glomerulonephritis',1,'K00y3',NULL,'Acute diffuse nephritis'),('glomerulonephritis',1,'K00y300',NULL,'Acute diffuse nephritis'),('glomerulonephritis',1,'K033.',NULL,'Rapidly progressive nephritis unspecified'),('glomerulonephritis',1,'K033.00',NULL,'Rapidly progressive nephritis unspecified'),('glomerulonephritis',1,'PKy90',NULL,'Alports syndrome'),('glomerulonephritis',1,'PKy9000',NULL,'Alports syndrome'),('glomerulonephritis',1,'K001.',NULL,'Acute nephritis with lesions of necrotising glomerulitis'),('glomerulonephritis',1,'K001.00',NULL,'Acute nephritis with lesions of necrotising glomerulitis'),('glomerulonephritis',1,'K00y1',NULL,'Acute exudative nephritis'),('glomerulonephritis',1,'K00y100',NULL,'Acute exudative nephritis'),('glomerulonephritis',1,'K031.',NULL,'Membranous nephritis unspecified'),('glomerulonephritis',1,'K031.00',NULL,'Membranous nephritis unspecified');
INSERT INTO #codesreadv2
VALUES ('kidney-stones',1,'4G4..',NULL,'O/E: kidney stone'),('kidney-stones',1,'4G4..00',NULL,'O/E: kidney stone'),('kidney-stones',1,'4G42.',NULL,'O/E: phosphate -staghorn-stone'),('kidney-stones',1,'4G42.00',NULL,'O/E: phosphate -staghorn-stone'),('kidney-stones',1,'4G4Z.',NULL,'O/E: renal stone NOS'),('kidney-stones',1,'4G4Z.00',NULL,'O/E: renal stone NOS'),('kidney-stones',1,'C3411',NULL,'Renal stone - uric acid'),('kidney-stones',1,'C341100',NULL,'Renal stone - uric acid'),('kidney-stones',1,'K1006',NULL,'Calculous pyelonephritis'),('kidney-stones',1,'K100600',NULL,'Calculous pyelonephritis'),('kidney-stones',1,'K12..',NULL,'Calculus of kidney and ureter'),('kidney-stones',1,'K12..00',NULL,'Calculus of kidney and ureter'),('kidney-stones',1,'K120.',NULL,'Calculus of kidney'),('kidney-stones',1,'K120.00',NULL,'Calculus of kidney'),('kidney-stones',1,'K122.',NULL,'Calculus of kidney with calculus of ureter'),('kidney-stones',1,'K122.00',NULL,'Calculus of kidney with calculus of ureter'),('kidney-stones',1,'PD31.',NULL,'Congenital calculus of kidney'),('kidney-stones',1,'PD31.00',NULL,'Congenital calculus of kidney');
INSERT INTO #codesreadv2
VALUES ('vasculitis',1,'M2y0X',NULL,'Vasculitis limited to skin, unspecified'),('vasculitis',1,'M2y0X00',NULL,'Vasculitis limited to skin, unspecified'),('vasculitis',1,'M2y02',NULL,'Livedoid vasculitis'),('vasculitis',1,'M2y0200',NULL,'Livedoid vasculitis'),('vasculitis',1,'Myu7G',NULL,'[X]Vasculitis limited to skin, unspecified'),('vasculitis',1,'Myu7G00',NULL,'[X]Vasculitis limited to skin, unspecified'),('vasculitis',1,'Myu7A',NULL,'[X]Other vasculitis limited to the skin'),('vasculitis',1,'Myu7A00',NULL,'[X]Other vasculitis limited to the skin'),('vasculitis',1,'M152.',NULL,'Erythema nodosum'),('vasculitis',1,'M152.00',NULL,'Erythema nodosum'),('vasculitis',1,'C3321',NULL,'Cryoglobulinaemic vasculitis'),('vasculitis',1,'C332100',NULL,'Cryoglobulinaemic vasculitis'),('vasculitis',1,'F421E',NULL,'Retinal vasculitis NOS'),('vasculitis',1,'F421E00',NULL,'Retinal vasculitis NOS'),('vasculitis',1,'G758.',NULL,'Churg-Strauss vasculitis'),('vasculitis',1,'G758.00',NULL,'Churg-Strauss vasculitis'),('vasculitis',1,'G76B.',NULL,'Vasculitis'),('vasculitis',1,'G76B.00',NULL,'Vasculitis'),('vasculitis',1,'N040N',NULL,'Rheumatoid vasculitis'),('vasculitis',1,'N040N00',NULL,'Rheumatoid vasculitis'),('vasculitis',1,'D310.',NULL,'Allergic purpura'),('vasculitis',1,'D310.00',NULL,'Allergic purpura'),('vasculitis',1,'D3100',NULL,'Acute vascular purpura'),('vasculitis',1,'D310000',NULL,'Acute vascular purpura'),('vasculitis',1,'F371.',NULL,'Polyneuropathy in collagen vascular disease'),('vasculitis',1,'F371.00',NULL,'Polyneuropathy in collagen vascular disease'),('vasculitis',1,'G750.',NULL,'Polyarteritis nodosa'),('vasculitis',1,'G750.00',NULL,'Polyarteritis nodosa'),('vasculitis',1,'G752.',NULL,'Hypersensitivity angiitis'),('vasculitis',1,'G752.00',NULL,'Hypersensitivity angiitis'),('vasculitis',1,'G752z',NULL,'Hypersensitivity angiitis NOS'),('vasculitis',1,'G752z00',NULL,'Hypersensitivity angiitis NOS');
INSERT INTO #codesreadv2
VALUES ('kidney-transplant',1,'14S2.',NULL,'H/O: kidney recipient'),('kidney-transplant',1,'14S2.00',NULL,'H/O: kidney recipient'),('kidney-transplant',1,'7B00.',NULL,'Transplantation of kidney'),('kidney-transplant',1,'7B00.00',NULL,'Transplantation of kidney'),('kidney-transplant',1,'7B001',NULL,'Transplantation of kidney from live donor'),('kidney-transplant',1,'7B00100',NULL,'Transplantation of kidney from live donor'),('kidney-transplant',1,'7B002',NULL,'Transplantation of kidney from cadaver'),('kidney-transplant',1,'7B00200',NULL,'Transplantation of kidney from cadaver'),('kidney-transplant',1,'7B00y',NULL,'Other specified transplantation of kidney'),('kidney-transplant',1,'7B00y00',NULL,'Other specified transplantation of kidney'),('kidney-transplant',1,'7B00z',NULL,'Transplantation of kidney NOS'),('kidney-transplant',1,'7B00z00',NULL,'Transplantation of kidney NOS'),('kidney-transplant',1,'K0B5.',NULL,'Renal tubulo-interstitial disorders in transplant rejection'),('kidney-transplant',1,'K0B5.00',NULL,'Renal tubulo-interstitial disorders in transplant rejection'),('kidney-transplant',1,'SP080',NULL,'Transplanted organ failure'),('kidney-transplant',1,'SP08000',NULL,'Transplanted organ failure'),('kidney-transplant',1,'SP083',NULL,'Kidney transplant failure and rejection'),('kidney-transplant',1,'SP08300',NULL,'Kidney transplant failure and rejection'),('kidney-transplant',1,'TB001',NULL,'Transplantation of kidney as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at the time of operation'),('kidney-transplant',1,'TB00100',NULL,'Transplantation of kidney as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at the time of operation'),('kidney-transplant',1,'ZV420',NULL,'[V]Kidney transplanted'),('kidney-transplant',1,'ZV42000',NULL,'[V]Kidney transplanted');
INSERT INTO #codesreadv2
VALUES ('egfr',1,'451E.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451E.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451G.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451G.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451K.',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451K.00',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451M.',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451M.00',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.00',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451F.',NULL,'Glomerular filtration rate'),('egfr',1,'451F.00',NULL,'Glomerular filtration rate');
INSERT INTO #codesreadv2
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TC.00',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'44J7.',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'44J7.00',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.',NULL,'Urine microalbumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.00',NULL,'Urine microalbumin:creatinine ratio')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('dementia',1,'1461.',NULL,'H/O: dementia'),('dementia',1,'A410.',NULL,'Kuru'),('dementia',1,'A411.',NULL,'Creutzfeldt-Jakob disease'),('dementia',1,'E00..',NULL,'Senile and presenile organic psychot conditions (& dementia)'),('dementia',1,'E000.',NULL,'Uncomplicated senile dementia'),('dementia',1,'E001.',NULL,'Presenile dementia'),('dementia',1,'E0010',NULL,'Uncomplicated presenile dementia'),('dementia',1,'E0011',NULL,'Presenile dementia with delirium'),('dementia',1,'E0012',NULL,'Presenile dementia with paranoia'),('dementia',1,'E0013',NULL,'Presenile dementia with depression'),('dementia',1,'E001z',NULL,'Presenile dementia NOS'),('dementia',1,'E002.',NULL,'Senile dementia with depressive or paranoid features'),('dementia',1,'E0020',NULL,'Senile dementia with paranoia'),('dementia',1,'E0021',NULL,'Senile dementia with depression'),('dementia',1,'E002z',NULL,'Senile dementia with depressive or paranoid features NOS'),('dementia',1,'E003.',NULL,'Senile dementia with delirium'),('dementia',1,'E004.',NULL,'Arteriosclerotic dementia (including [multi infarct dement])'),('dementia',1,'E0040',NULL,'Uncomplicated arteriosclerotic dementia'),('dementia',1,'E0041',NULL,'Arteriosclerotic dementia with delirium'),('dementia',1,'E0042',NULL,'Arteriosclerotic dementia with paranoia'),('dementia',1,'E0043',NULL,'Arteriosclerotic dementia with depression'),('dementia',1,'E004z',NULL,'Arteriosclerotic dementia NOS'),('dementia',1,'E00y.',NULL,'(Oth senile/presen org psychoses) or (presbyophren psychos)'),('dementia',1,'E00z.',NULL,'Senile or presenile psychoses NOS'),('dementia',1,'E011.',NULL,'Korsakov psychosis'),('dementia',1,'E0110',NULL,'Korsakov psychosis'),('dementia',1,'E0111',NULL,'Korsakovs alcoholic psychosis with peripheral neuritis'),('dementia',1,'E0112',NULL,'Wernicke-Korsakov syndrome'),('dementia',1,'E011z',NULL,'Alcohol amnestic syndrome NOS'),('dementia',1,'E012.',NULL,'Alcoholic dementia: [other] or [NOS]'),('dementia',1,'E040.',NULL,'Korsakoffs syndrome - non-alcoholic'),('dementia',1,'E041.',NULL,'Dementia in conditions EC'),('dementia',1,'Eu00.',NULL,'[X]Dementia in Alzheimers disease'),('dementia',1,'Eu001',NULL,'Dementia in Alzheimers disease with late onset'),('dementia',1,'Eu002',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type'),('dementia',1,'Eu00z',NULL,'[X]Dementia in Alzheimers disease, unspecified'),('dementia',1,'Eu01.',NULL,'Vascular dementia'),('dementia',1,'Eu011',NULL,'[X]Dementia: [multi-infarct] or [predominantly cortical]'),('dementia',1,'Eu01y',NULL,'[X]Other vascular dementia'),('dementia',1,'Eu01z',NULL,'[X]Vascular dementia, unspecified'),('dementia',1,'Eu02.',NULL,'[X]Dementia in other diseases classified elsewhere'),('dementia',1,'Eu020',NULL,'[X]Dementia in Picks disease'),('dementia',1,'Eu021',NULL,'[X]Dementia in Creutzfeldt-Jakob disease'),('dementia',1,'Eu022',NULL,'[X]Dementia in Huntingtons disease'),('dementia',1,'Eu023',NULL,'[X]Dementia in Parkinsons disease'),('dementia',1,'Eu02y',NULL,'[X]Dementia in other specified diseases classif elsewhere'),('dementia',1,'Eu02z',NULL,'[X] Dementia: [unspecified] or [named variants (& NOS)]'),('dementia',1,'Eu041',NULL,'[X]Delirium superimposed on dementia'),('dementia',1,'F110.',NULL,'Alzheimers disease'),('dementia',1,'F1100',NULL,'Dementia in Alzheimers disease with early onset'),('dementia',1,'F1101',NULL,'Dementia in Alzheimers disease with late onset'),('dementia',1,'F111.',NULL,'Picks disease'),('dementia',1,'F11x7',NULL,'Cerebral degeneration due to Creutzfeldt-Jakob disease'),('dementia',1,'F11x8',NULL,'Cerebral degeneration due to multifocal leucoencephalopathy'),('dementia',1,'F21y2',NULL,'Binswangers disease'),('dementia',1,'Fyu30',NULL,'[X]Other Alzheimers disease'),('dementia',1,'Ub1T6',NULL,'Language disorder of dementia'),('dementia',1,'X002m',NULL,'Amyotrophic lateral sclerosis with dementia'),('dementia',1,'X002w',NULL,'Dementia'),('dementia',1,'X002x',NULL,'Dementia in Alzheimers disease with early onset'),('dementia',1,'X002y',NULL,'Familial Alzheimers disease of early onset'),('dementia',1,'X002z',NULL,'Non-familial Alzheimers disease of early onset'),('dementia',1,'X0030',NULL,'Dementia in Alzheimers disease with late onset'),('dementia',1,'X0031',NULL,'Familial Alzheimers disease of late onset'),('dementia',1,'X0032',NULL,'Non-familial Alzheimers disease of late onset'),('dementia',1,'X0033',NULL,'Focal Alzheimers disease'),('dementia',1,'X0034',NULL,'Frontotemporal dementia'),('dementia',1,'X0035',NULL,'Picks disease with Pick bodies'),('dementia',1,'X0036',NULL,'Picks disease with Pick cells and no Pick bodies'),('dementia',1,'X0037',NULL,'Frontotemporal degeneration'),('dementia',1,'X0039',NULL,'Frontal lobe degeneration with motor neurone disease'),('dementia',1,'X003A',NULL,'Lewy body disease'),('dementia',1,'X003G',NULL,'Progressive aphasia in Alzheimers disease'),('dementia',1,'X003H',NULL,'Argyrophilic brain disease'),('dementia',1,'X003I',NULL,'Post-traumatic dementia'),('dementia',1,'X003J',NULL,'Punch drunk syndrome'),('dementia',1,'X003K',NULL,'Spongiform encephalopathy'),('dementia',1,'X003L',NULL,'Prion protein disease'),('dementia',1,'X003M',NULL,'Gerstmann-Straussler-Scheinker syndrome'),('dementia',1,'X003P',NULL,'Acquired immune deficiency syndrome dementia complex'),('dementia',1,'X003R',NULL,'Vascular dementia of acute onset'),('dementia',1,'X003T',NULL,'Subcortical vascular dementia'),('dementia',1,'X003V',NULL,'Mixed cortical and subcortical vascular dementia'),('dementia',1,'X003W',NULL,'Semantic dementia'),('dementia',1,'X003X',NULL,'Patchy dementia'),('dementia',1,'X003Y',NULL,'Epileptic dementia'),('dementia',1,'X003l',NULL,'Parkinsons disease - dementia complex on Guam'),('dementia',1,'X00R0',NULL,'Presbyophrenic psychosis'),('dementia',1,'X00R2',NULL,'Senile dementia'),('dementia',1,'X00Rk',NULL,'Alcoholic dementia NOS'),('dementia',1,'X73mf',NULL,'Creutzfeldt-Jakob disease agent'),('dementia',1,'X73mj',NULL,'Bovine spongiform encephalopathy agent'),('dementia',1,'XE1Xr',NULL,'Senile and presenile organic psychotic conditions'),('dementia',1,'XE1Xs',NULL,'Vascular dementia'),('dementia',1,'XE1Xt',NULL,'Other senile and presenile organic psychoses'),('dementia',1,'XE1Xu',NULL,'Other alcoholic dementia'),('dementia',1,'XE1Z6',NULL,'[X]Unspecified dementia'),('dementia',1,'XE1aG',NULL,'Dementia (& [presenile] or [senile])'),('dementia',1,'Xa0lH',NULL,'Multi-infarct dementia'),('dementia',1,'Xa0sC',NULL,'Frontal lobe degeneration'),('dementia',1,'Xa0sE',NULL,'Dementia of frontal lobe type'),('dementia',1,'Xa1GB',NULL,'Cerebral degeneration presenting primarily with dementia'),('dementia',1,'Xa25J',NULL,'Alcoholic dementia'),('dementia',1,'Xa3ez',NULL,'Other senile/presenile dementia'),('dementia',1,'XaA1S',NULL,'New variant of Creutzfeldt-Jakob disease'),('dementia',1,'XaE74',NULL,'Senile dementia of the Lewy body type'),('dementia',1,'XaIKB',NULL,'Alzheimers disease with early onset'),('dementia',1,'XaIKC',NULL,'Alzheimers disease with late onset'),('dementia',1,'XaKyY',NULL,'[X]Lewy body dementia'),('dementia',1,'XaLFf',NULL,'Exception reporting: dementia quality indicators'),('dementia',1,'XaLFo',NULL,'Excepted from dementia quality indicators: Patient unsuitabl'),('dementia',1,'XaLFp',NULL,'Excepted from dementia quality indicators: Informed dissent'),('dementia',1,'XaMAo',NULL,'Prion protein markers for Creutzfeldt-Jakob disease'),('dementia',1,'XaMFy',NULL,'Dementia monitoring administration'),('dementia',1,'XaMG0',NULL,'Dementia monitoring first letter'),('dementia',1,'XaMGF',NULL,'Dementia annual review'),('dementia',1,'XaMGG',NULL,'Dementia monitoring second letter'),('dementia',1,'XaMGI',NULL,'Dementia monitoring third letter'),('dementia',1,'XaMGJ',NULL,'Dementia monitoring verbal invite'),('dementia',1,'XaMGK',NULL,'Dementia monitoring telephone invite'),('dementia',1,'XaMJC',NULL,'Dementia monitoring'),('dementia',1,'XaZWz',NULL,'Participates in Butterfly Scheme for dementia'),('dementia',1,'XaZX0',NULL,'Butterfly Scheme for dementia declined'),('dementia',1,'XabVp',NULL,'Sporadic Creutzfeldt-Jakob disease'),('dementia',1,'XabtQ',NULL,'Dementia medication review'),('dementia',1,'Xaghb',NULL,'Predominantly cortical dementia'),('dementia',1,'Y000c',NULL,'Dementia review done'),('dementia',1,'Y1f1d',NULL,'Dementia monitoring invitation'),('dementia',1,'Y1f22',NULL,'Dementia monitoring invitation'),('dementia',1,'Y1f98',NULL,'Quality and Outcomes Framework dementia quality indicator-related care invitation (procedure)'),('dementia',1,'Y23fb',NULL,'Mixed dementia'),('dementia',1,'Y6230',NULL,'Creutzfeldt - Jakob disease'),('dementia',1,'Y8180',NULL,'Other senile/presenile dement.'),('dementia',1,'Y9086',NULL,'Senile dementia - simple type'),('dementia',1,'Y9087',NULL,'Senile dementia-acute confused'),('dementia',1,'Eu106',NULL,'[X]Korsakovs psychosis, alcohol-induced'),('dementia',1,'Eu107',NULL,'[X]Alcoholic dementia NOS'),('dementia',1,'E02y1',NULL,'Drug-induced dementia'),('dementia',1,'F112.',NULL,'Senile degeneration of brain'),('dementia',1,'X003N',NULL,'Familial fatal insomnia'),('dementia',1,'X005A',NULL,'Dialysis encephalopathy'),('dementia',1,'X50Hu',NULL,'Amelocerebrohypohidrotic syndrome'),('dementia',1,'X70MA',NULL,'Juvenile general paresis'),('dementia',1,'XE2b7',NULL,'Post-concussional syndrome');
INSERT INTO #codesctv3
VALUES ('glomerulonephritis',1,'Xa1uD',NULL,'Glomerulonephritis'),('glomerulonephritis',1,'XE0dY',NULL,'Acute glomerulonephritis'),('glomerulonephritis',1,'K00z.',NULL,'Acute glomerulonephritis NOS'),('glomerulonephritis',1,'K001.',NULL,'Acute nephritis with lesions of necrotising glomerulitis'),('glomerulonephritis',1,'K000.',NULL,'Acute proliferative glomerulonephritis'),('glomerulonephritis',1,'X30IG',NULL,'Crescentic glomerulonephritis'),('glomerulonephritis',1,'Xa33d',NULL,'[EDTA] Crescentric glomerulonephritis (type I,II,III) associated with renal failure'),('glomerulonephritis',1,'X30I9',NULL,'Endocapillary glomerulonephritis'),('glomerulonephritis',1,'X30IA',NULL,'Idiopathic endocapillary glomerulonephritis'),('glomerulonephritis',1,'X30IB',NULL,'Post-infectious glomerulonephritis'),('glomerulonephritis',1,'X30ID',NULL,'Post-infectious glomerulonephritis - Garland variety'),('glomerulonephritis',1,'X30IC',NULL,'Post-streptococcal glomerulonephritis'),('glomerulonephritis',1,'X30IE',NULL,'Shunt nephritis'),('glomerulonephritis',1,'X30IF',NULL,'Necrotising glomerulonephritis'),('glomerulonephritis',1,'K00y.',NULL,'Other acute glomerulonephritis'),('glomerulonephritis',1,'K00y3',NULL,'Acute diffuse nephritis'),('glomerulonephritis',1,'K00y1',NULL,'Acute exudative nephritis'),('glomerulonephritis',1,'K00y2',NULL,'Acute focal nephritis'),('glomerulonephritis',1,'K00y0',NULL,'Acute glomerulonephritis in diseases EC'),('glomerulonephritis',1,'K00yz',NULL,'Other acute glomerulonephritis NOS'),('glomerulonephritis',1,'XE0db',NULL,'Chronic glomerulonephritis'),('glomerulonephritis',1,'XM1AL',NULL,'[EDTA] Glomerulonephritis, histologically examined (otherwise specified) associated with renal failure'),('glomerulonephritis',1,'XM1AM',NULL,'[EDTA] Glomerulonephritis, histologically not examined associated with renal failure'),('glomerulonephritis',1,'K000.',NULL,'PGN - Acute proliferative glomerulonephritis'),('glomerulonephritis',1,'X30I9',NULL,'Endocapillary glomerulonephritis'),('glomerulonephritis',1,'X30IF',NULL,'Necrotising glomerulonephritis'),('glomerulonephritis',1,'X30IG',NULL,'CGN - Crescentic glomerulonephritis'),('glomerulonephritis',1,'XE0dY',NULL,'AGN - Acute glomerulonephritis'),('glomerulonephritis',1,'X30IA',NULL,'Idiopathic endocapillary glomerulonephritis'),('glomerulonephritis',1,'X30IB',NULL,'Post-infectious glomerulonephritis'),('glomerulonephritis',1,'Xa33d',NULL,'[EDTA] Crescentric glomerulonephritis (type I,II,III) associated with renal failure'),('glomerulonephritis',1,'K00y.',NULL,'Other acute glomerulonephritis'),('glomerulonephritis',1,'K00z.',NULL,'Acute glomerulonephritis NOS'),('glomerulonephritis',1,'Xa1uD',NULL,'Glomerulonephritis'),('glomerulonephritis',1,'X30IC',NULL,'Post-streptococcal glomerulonephritis'),('glomerulonephritis',1,'X30ID',NULL,'Post-infectious glomerulonephritis - Garland variety'),('glomerulonephritis',1,'K00y0',NULL,'Acute glomerulonephritis in diseases EC'),('glomerulonephritis',1,'K00yz',NULL,'Other acute glomerulonephritis NOS'),('glomerulonephritis',1,'XE0db',NULL,'CGN - Chronic glomerulonephritis'),('glomerulonephritis',1,'XM1AL',NULL,'[EDTA] Glomerulonephritis, histologically examined (otherwise specified) associated with renal failure'),('glomerulonephritis',1,'XM1AM',NULL,'[EDTA] Glomerulonephritis, histologically not examined associated with renal failure'),('glomerulonephritis',1,'K020.',NULL,'Chronic nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K021.',NULL,'Chronic nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K023.',NULL,'Chronic rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'K02y.',NULL,'Other chronic glomerulonephritis'),('glomerulonephritis',1,'K02y2',NULL,'Chronic focal glomerulonephritis'),('glomerulonephritis',1,'K02y3',NULL,'Chronic diffuse glomerulonephritis'),('glomerulonephritis',1,'K02yz',NULL,'Other chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K02z.',NULL,'Chronic glomerulonephritis NOS'),('glomerulonephritis',1,'K0A34',NULL,'Chronic nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A35',NULL,'Chronic nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A37',NULL,'Chronic nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'X30Ie',NULL,'GN - Hereditary glomerulonephritis'),('glomerulonephritis',1,'Xa9CC',NULL,'Minimal change glomerulonephritis'),('glomerulonephritis',1,'K02..',NULL,'Chronic glomerulonephritis'),('glomerulonephritis',1,'K022.',NULL,'Membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'X30IW',NULL,'Mesangial IgM proliferative glomerulonephritis'),('glomerulonephritis',1,'X30IY',NULL,'Membranous glomerulonephritis - stage I'),('glomerulonephritis',1,'X30IZ',NULL,'MGN stage II - Membranous glomerulonephritis - stage II'),('glomerulonephritis',1,'X30Ia',NULL,'MGN stage III - Membranous glomerulonephritis stage III'),('glomerulonephritis',1,'X30Ib',NULL,'MGN stage IV - Membranous glomerulonephritis stage IV'),('glomerulonephritis',1,'X30Ic',NULL,'MGN stage V - Membranous glomerulonephritis stage V'),('glomerulonephritis',1,'K02y0',NULL,'Chronic glomerulonephritis with diseases EC'),('glomerulonephritis',1,'K02y1',NULL,'Chronic exudative glomerulonephritis'),('glomerulonephritis',1,'K0325',NULL,'Other familial glomerulonephritis'),('glomerulonephritis',1,'X30Ih',NULL,'Non-progressive hereditary glomerulonephritis'),('glomerulonephritis',1,'X30IH',NULL,'Steroid-sensitive minimal change glomerulonephritis'),('glomerulonephritis',1,'X30II',NULL,'Steroid-resistant minimal change glomerulonephritis'),('glomerulonephritis',1,'X30IJ',NULL,'Steroid-dependent minimal change glomerulonephritis'),('glomerulonephritis',1,'K0320',NULL,'Focal membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'X30IR',NULL,'Mesangiocapillary glomerulonephritis NEC'),('glomerulonephritis',1,'X30IS',NULL,'Mesangiocapillary glomerulonephritis type I'),('glomerulonephritis',1,'X30IT',NULL,'Mesangiocapillary glomerulonephritis type II'),('glomerulonephritis',1,'X30IU',NULL,'MCGN type III - Mesangiocapillary glomerulonephritis type III'),('glomerulonephritis',1,'X30IV',NULL,'Mesangiocapillary glomerulonephritis type IV'),('glomerulonephritis',1,'XM19Y',NULL,'[EDTA] Membrano-proliferative glomerulonephritis,type I (proven immunofluorescence / electron microscopy-excluding lupus erythematosus+other specified multi-system disease) associated renal failure'),('glomerulonephritis',1,'XM19Z',NULL,'[EDTA] Dense deposit disease, membrano-proliferative glomerulonephritis, type II, (proven by immunofluorescence and/or electronic microscopy) associated with renal failure'),('glomerulonephritis',1,'K032y',NULL,'Mesangiocapillary glomerulonephritis NEC'),('glomerulonephritis',1,'K032z',NULL,'Nephritis unspecified with lesion of membranoproliferative glomerulonephritis NOS'),('glomerulonephritis',1,'K0A02',NULL,'Acute nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A03',NULL,'Acute nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A04',NULL,'Acute nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A05',NULL,'Acute nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'X30I8',NULL,'Rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'XE0de',NULL,'Nephritis unspecified with other specified lesion of membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'X30I3',NULL,'Mixed membranous and proliferative glomerulonephritis NEC'),('glomerulonephritis',1,'X30I4',NULL,'Mesangioproliferative glomerulonephritis NEC'),('glomerulonephritis',1,'X30I5',NULL,'Lobular glomerulonephritis NEC'),('glomerulonephritis',1,'X30I6',NULL,'Hypocomplementaemic persistent glomerulonephritis NEC'),('glomerulonephritis',1,'K0A12',NULL,'Rapidly progressive nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A13',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A14',NULL,'Rapidly progressive nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A15',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A17',NULL,'Rapidly progressive nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K010.',NULL,'Nephrotic syndrome with proliferative glomerulonephritis'),('glomerulonephritis',1,'K011.',NULL,'Nephrotic syndrome with membranous glomerulonephritis'),('glomerulonephritis',1,'K012.',NULL,'Nephrotic syndrome with membranoproliferative glomerulonephritis'),('glomerulonephritis',1,'K013.',NULL,'Nephrotic syndrome with minimal change glomerulonephritis'),('glomerulonephritis',1,'K016.',NULL,'Nephrotic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K017.',NULL,'Nephrotic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K018.',NULL,'Nephrotic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K019.',NULL,'Nephrotic syndrome, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K01B.',NULL,'Nephrotic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A07',NULL,'Acute nephritic syndrome, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'XE0dZ',NULL,'Nephrotic syndrome with minimal change glomerulonephritis'),('glomerulonephritis',1,'K0A22',NULL,'Recurrent and persistent haematuria, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A23',NULL,'Recurrent and persistent haematuria, diffuse mesangial proliferative glomerulonephritis'),
('glomerulonephritis',1,'K0A24',NULL,'Recurrent and persistent haematuria, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A25',NULL,'Recurrent and persistent haematuria, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A27',NULL,'Recurrent and persistent haematuria, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'K0A42',NULL,'Isolated proteinuria with specified morphological lesion, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A43',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A44',NULL,'Isolated proteinuria with specified morphological lesion, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A45',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A47',NULL,'Isolated proteinuria with specified morphological lesion, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K0A52',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'K0A53',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A54',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'K0A55',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'K0A57',NULL,'Hereditary nephropathy, not elsewhere classified, diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'Kyu09',NULL,'[X]Unspecified nephritic syndrome, diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'Kyu0A',NULL,'[X]Unspecified nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'Kyu0C',NULL,'[X]Unspecified nephritic syndrome, diffuse concentric glomerulonephritis'),('glomerulonephritis',1,'K0322',NULL,'Focal glomerulonephritis with focal recurrent macroscopic glomerulonephritis'),('glomerulonephritis',1,'K0323',NULL,'Anaphylactoid glomerulonephritis'),('glomerulonephritis',1,'X30Kw',NULL,'Cryoglobulinaemic glomerulonephritis'),('glomerulonephritis',1,'Xa33h',NULL,'[EDTA] Cryoglobulineme glomerulonephritis associated with renal failure'),('glomerulonephritis',1,'X30Mf',NULL,'De novo glomerulonephritis'),('glomerulonephritis',1,'X30Mj',NULL,'CMV - Cytomegalovirus-induced glomerulonephritis'),('glomerulonephritis',1,'K03z.',NULL,'Unspecified glomerulonephritis NOS'),('glomerulonephritis',1,'X30L1',NULL,'Malignancy-associated glomerulonephritis'),('glomerulonephritis',1,'X705a',NULL,'Primary pauci-immune necrotising and crescentic glomerulonephritis'),('glomerulonephritis',1,'K01x4',NULL,'Lupus nephritis'),('glomerulonephritis',1,'X30IQ',NULL,'IgAN - IgA nephropathy'),('glomerulonephritis',1,'K031.',NULL,'Membranous nephritis unspecified'),('glomerulonephritis',1,'K01x4',NULL,'(Nephrotic syndrome in systemic lupus erythematosus) or (lupus nephritis)'),('glomerulonephritis',1,'G7520',NULL,'Goodpastures syndrome'),('glomerulonephritis',1,'K01x4',NULL,'Nephrotic syndrome in systemic lupus erythematosus'),('glomerulonephritis',1,'K033.',NULL,'Rapidly progressive nephritis unspecified'),('glomerulonephritis',1,'X30Kr',NULL,'Lupus nephritis - WHO Class V'),('glomerulonephritis',1,'PKy90',NULL,'Alports syndrome'),('glomerulonephritis',1,'XE0dd',NULL,'Primary IgA nephropathy'),('glomerulonephritis',1,'X30Kp',NULL,'Lupus nephritis - WHO Class III'),('glomerulonephritis',1,'X30Kq',NULL,'Lupus nephritis - WHO Class IV'),('glomerulonephritis',1,'X30IQ',NULL,'IgA nephropathy'),('glomerulonephritis',1,'XE0da',NULL,'Lupus nephritis'),('glomerulonephritis',1,'XE0dd',NULL,'Bergers disease');
INSERT INTO #codesctv3
VALUES ('kidney-stones',1,'XE0dk',NULL,'Calculus of kidney'),('kidney-stones',1,'X30Pp',NULL,'Calculus in calyceal diverticulum'),('kidney-stones',1,'X30Pr',NULL,'Calculus in pelviureteric junction'),('kidney-stones',1,'X30Pq',NULL,'Calculus in renal pelvis'),('kidney-stones',1,'X30Po',NULL,'Calyceal renal calculus'),('kidney-stones',1,'XE0fN',NULL,'Kidney calculus (& [staghorn])'),('kidney-stones',1,'K120z',NULL,'Renal calculus NOS'),('kidney-stones',1,'K1200',NULL,'Staghorn calculus'),('kidney-stones',1,'XM14o',NULL,'Uric acid renal calculus'),('kidney-stones',1,'4G4..',NULL,'O/E: renal calculus'),('kidney-stones',1,'4G42.',NULL,'Phosphate kidney stone &/or [O/E: staghorn]'),('kidney-stones',1,'4G4Z.',NULL,'O/E: renal stone NOS'),('kidney-stones',1,'C3411',NULL,'(Uric acid nephrolithiasis) or (renal stone - uric acid)'),('kidney-stones',1,'K12..',NULL,'Urinary calculus (& [kidney &/or ureter)'),('kidney-stones',1,'K120.',NULL,'(Calculus of kidney) or (nephrolithiasis NOS)'),('kidney-stones',1,'PD31.',NULL,'Congenital calculus of kidney'),('kidney-stones',1,'X30Pn',NULL,'Nephrolithiasis NOS'),('kidney-stones',1,'XE0dj',NULL,'Calculus of kidney and ureter'),('kidney-stones',1,'XM1XM',NULL,'Phosphate kidney stone');
INSERT INTO #codesctv3
VALUES ('vasculitis',1,'C3321',NULL,'Cryoglobulinaemic vasculitis'),('vasculitis',1,'X205F',NULL,'Secondary systemic vasculitis'),('vasculitis',1,'X205G',NULL,'Vasculitis secondary to drug'),('vasculitis',1,'X701l',NULL,'Rheumatoid vasculitis'),('vasculitis',1,'X705w',NULL,'Lupus vasculitis'),('vasculitis',1,'X205D',NULL,'Systemic vasculitis'),('vasculitis',1,'X705t',NULL,'Nailfold rheumatoid vasculitis'),('vasculitis',1,'X705u',NULL,'Systemic rheumatoid vasculitis'),('vasculitis',1,'X705v',NULL,'Necrotising rheumatoid vasculitis'),('vasculitis',1,'G76B.',NULL,'Vasculitis'),('vasculitis',1,'X7061',NULL,'Essential cryoglobulinaemic vasculitis'),('vasculitis',1,'X50BC',NULL,'Primary cutaneous vasculitis'),('vasculitis',1,'X50BG',NULL,'Gougerot-Ruiter vasculitis'),('vasculitis',1,'X705x',NULL,'Hypocomplementaemic vasculitis'),('vasculitis',1,'X50BI',NULL,'Secondary cutaneous vasculitis'),('vasculitis',1,'Myu7A',NULL,'[X]Other vasculitis limited to the skin'),('vasculitis',1,'Myu7G',NULL,'[X]Vasculitis limited to skin, unspecified'),('vasculitis',1,'X50BK',NULL,'Nodular vasculitis'),('vasculitis',1,'X00Dw',NULL,'Cerebral arteritis in systemic vasculitis'),('vasculitis',1,'X00Dz',NULL,'Primary central nervous system granulomatous vasculitis'),('vasculitis',1,'X705i',NULL,'Churg-Strauss vasculitis'),('vasculitis',1,'F421E',NULL,'Retinal vasculitis NOS'),('vasculitis',1,'X00dO',NULL,'Retinal vasculitis'),('vasculitis',1,'X309p',NULL,'Peritoneal vasculitis'),('vasculitis',1,'XaXlI',NULL,'H/O vasculitis'),('vasculitis',1,'D310.',NULL,'Allergic purpura'),('vasculitis',1,'D3100',NULL,'Acute vascular purpura'),('vasculitis',1,'F371.',NULL,'Neuropathy in vasculitis and connective tissue disease'),('vasculitis',1,'G750.',NULL,'(Polyarteritis nodosa) or (necrotising angiitis)'),('vasculitis',1,'G750.',NULL,'Polyarteritis nodosa'),('vasculitis',1,'G752.',NULL,'Hypersensitivity: [angiitis] or [arteritis]'),('vasculitis',1,'G752z',NULL,'Hypersensitivity angiitis NOS'),('vasculitis',1,'X203B',NULL,'Post-arteritic pulmonary hypertension'),('vasculitis',1,'XE0VV',NULL,'Hypersensitivity angiitis');
INSERT INTO #codesctv3
VALUES ('kidney-transplant',1,'14S2.',NULL,'H/O: kidney recipient'),('kidney-transplant',1,'7B00.',NULL,'Renal transplant'),('kidney-transplant',1,'7B001',NULL,'Live donor renal transplant'),('kidney-transplant',1,'7B002',NULL,'Cadaveric renal transplant'),('kidney-transplant',1,'7B00y',NULL,'Other specified transplantation of kidney'),('kidney-transplant',1,'7B00z',NULL,'Transplantation of kidney NOS'),('kidney-transplant',1,'K0B5.',NULL,'Renal tubulo-interstitial disorders in transplant rejection'),('kidney-transplant',1,'SP080',NULL,'(Transpl organ fail) or (deterior ren func aft ren transpl)'),('kidney-transplant',1,'SP083',NULL,'Kidney transplant failure and rejection'),('kidney-transplant',1,'TB001',NULL,'Kidney transplant with complication, without blame'),('kidney-transplant',1,'X30D2',NULL,'Xenograft renal transplant'),('kidney-transplant',1,'X30J3',NULL,'End stage renal failure with renal transplant'),('kidney-transplant',1,'X30Ma',NULL,'Chronic rejection of renal transplant - grade III'),('kidney-transplant',1,'X30Mb',NULL,'Acute-on-chronic rejection of renal transplant'),('kidney-transplant',1,'X30Mc',NULL,'Failed renal transplant'),('kidney-transplant',1,'X30Md',NULL,'Perfusion injury of renal transplant'),('kidney-transplant',1,'X30Me',NULL,'De novo transplant disease'),('kidney-transplant',1,'X30Mf',NULL,'De novo glomerulonephritis'),('kidney-transplant',1,'X30Mg',NULL,'Transplant glomerulopathy'),('kidney-transplant',1,'X30Mh',NULL,'Transplant glomerulopathy - early form'),('kidney-transplant',1,'X30Mi',NULL,'Transplant glomerulopathy - late form'),('kidney-transplant',1,'X30MN',NULL,'Renal transplant disorder'),('kidney-transplant',1,'X30MO',NULL,'Primary non-function of renal transplant'),('kidney-transplant',1,'X30MP',NULL,'Renal transplant rejection'),('kidney-transplant',1,'X30MQ',NULL,'Hyperacute rejection of renal transplant'),('kidney-transplant',1,'X30MR',NULL,'Accelerated rejection of renal transplant'),('kidney-transplant',1,'X30MS',NULL,'Very mild acute rejection of renal transplant'),('kidney-transplant',1,'X30MT',NULL,'Acute rejection of renal transplant'),('kidney-transplant',1,'X30MU',NULL,'Acute rejection of renal transplant - grade I'),('kidney-transplant',1,'X30MV',NULL,'Acute rejection of renal transplant - grade II'),('kidney-transplant',1,'X30MW',NULL,'Acute rejection of renal transplant - grade III'),('kidney-transplant',1,'X30MX',NULL,'Chronic rejection of renal transplant'),('kidney-transplant',1,'X30MY',NULL,'Chronic rejection of renal transplant - grade 1'),('kidney-transplant',1,'X30MZ',NULL,'Chronic rejection of renal transplant - grade II'),('kidney-transplant',1,'X30NN',NULL,'Perirenal and periureteric post-transplant lymphocele'),('kidney-transplant',1,'Xa0HK',NULL,'Unexplained episode of renal transplant dysfunction'),('kidney-transplant',1,'Xa0HL',NULL,'Pre-existing disease in renal transplant'),('kidney-transplant',1,'Xa1dw',NULL,'Transplant kidney'),('kidney-transplant',1,'Xa3x6',NULL,'Kidney replacement'),('kidney-transplant',1,'Xaa2O',NULL,'Thrombosis of artery of transplanted kidney'),('kidney-transplant',1,'Xaa2Q',NULL,'Thrombosis of vein of transplanted kidney'),('kidney-transplant',1,'XaE9T',NULL,'Donor renal transplantation'),('kidney-transplant',1,'XaM1o',NULL,'Allotransplantation of kidney from cadaver, heart-beating'),('kidney-transplant',1,'XaM1p',NULL,'Allotransplantation kidney from cadaver, heart non-beating'),('kidney-transplant',1,'XaM4e',NULL,'Interventions associated with transplantation of kidney'),('kidney-transplant',1,'XaM4f',NULL,'OS interventions associated with transplantation of kidney'),('kidney-transplant',1,'XaM4g',NULL,'Interventions associated with transplantation of kidney NOS'),('kidney-transplant',1,'XaM4l',NULL,'Post-transplantation of kidney examination, recipient'),('kidney-transplant',1,'XaMKM',NULL,'Allotransplantation of kidney from cadaver NEC'),('kidney-transplant',1,'XaZe2',NULL,'Rupture of artery of transplanted kidney'),('kidney-transplant',1,'XaZe3',NULL,'Rupture of vein of transplanted kidney'),('kidney-transplant',1,'XaZe7',NULL,'Stenosis of vein of transplanted kidney'),('kidney-transplant',1,'XaZkw',NULL,'Aneurysm of vein of transplanted kidney'),('kidney-transplant',1,'XaZl0',NULL,'Aneurysm of artery of transplanted kidney'),('kidney-transplant',1,'XaZWa',NULL,'Urological complication of renal transplant'),('kidney-transplant',1,'XaZYx',NULL,'Vascular complication of renal transplant'),('kidney-transplant',1,'Y1602',NULL,'Kidney-pancreas transplant'),('kidney-transplant',1,'ZV420',NULL,'[V]Kidney transplanted');
INSERT INTO #codesctv3
VALUES ('egfr',1,'X70kK',NULL,'Tc99m-DTPA clearance - GFR'),('egfr',1,'X70kL',NULL,'Cr51- EDTA clearance - GFR'),('egfr',1,'X90kf',NULL,'With GFR'),('egfr',1,'XaK8y',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'XaMDA',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'XaZpN',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'XacUJ',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'XacUK',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'XSFyN',NULL,'Glomerular filtration rate');
INSERT INTO #codesctv3
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'XE2n3',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TD.',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'X773Y',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'XE2n4',NULL,'Urine microalbumin/creatinine ratio')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('dementia',1,'1018591000000102',NULL,'Prion protein markers for Creutzfeldt-Jakob disease (observable entity)'),('dementia',1,'1089521000000106',NULL,'Predominantly cortical dementia (disorder)'),('dementia',1,'12348006',NULL,'Presenile dementia (disorder)'),('dementia',1,'13092008',NULL,'Picks disease (disorder)'),('dementia',1,'15662003',NULL,'Senile dementia (disorder)'),('dementia',1,'161465002',NULL,'History of - dementia (context-dependent category)'),('dementia',1,'17262008',NULL,'Non-alcoholic Korsakoffs psychosis (disorder)'),('dementia',1,'191448002',NULL,'Senile and presenile organic psychotic conditions (& dementia)'),('dementia',1,'191449005',NULL,'Uncomplicated senile dementia (disorder)'),('dementia',1,'191451009',NULL,'Uncomplicated presenile dementia (disorder)'),('dementia',1,'191452002',NULL,'Presenile dementia with delirium (disorder)'),('dementia',1,'191454001',NULL,'Presenile dementia with paranoia (disorder)'),('dementia',1,'191455000',NULL,'Presenile dementia with depression (disorder)'),('dementia',1,'191457008',NULL,'Senile dementia with depressive or paranoid features (disorder)'),('dementia',1,'191458003',NULL,'Senile dementia with paranoia (disorder)'),('dementia',1,'191459006',NULL,'Senile dementia with depression (disorder)'),('dementia',1,'191461002',NULL,'Senile dementia with delirium (disorder)'),('dementia',1,'191463004',NULL,'Uncomplicated arteriosclerotic dementia (disorder)'),('dementia',1,'191464005',NULL,'Arteriosclerotic dementia with delirium (disorder)'),('dementia',1,'191465006',NULL,'Arteriosclerotic dementia with paranoia (disorder)'),('dementia',1,'191466007',NULL,'Arteriosclerotic dementia with depression (disorder)'),('dementia',1,'191471000',NULL,'Korsakovs alcoholic psychosis with peripheral neuritis (disorder)'),('dementia',1,'191475009',NULL,'Chronic alcoholic brain syndrome (disorder)'),('dementia',1,'191519005',NULL,'Dementia in conditions EC (disorder)'),('dementia',1,'192818008',NULL,'Cerebral degeneration due to Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'192819000',NULL,'Cerebral degeneration due to progressive multifocal leukoencephalopathy (disorder)'),('dementia',1,'20484008',NULL,'Prion disease (disorder)'),('dementia',1,'21921000119103',NULL,'Dementia co-occurrent and due to Picks disease (disorder)'),('dementia',1,'22381000119105',NULL,'Primary degenerative dementia (disorder)'),('dementia',1,'229672009',NULL,'Language disorder of dementia (disorder)'),('dementia',1,'230258005',NULL,'Amyotrophic lateral sclerosis with dementia (disorder)'),('dementia',1,'230265002',NULL,'Familial Alzheimers disease of early onset (disorder)'),('dementia',1,'230266001',NULL,'Non-familial Alzheimers disease of early onset (disorder)'),('dementia',1,'230267005',NULL,'Familial Alzheimers disease of late onset (disorder)'),('dementia',1,'230268000',NULL,'Non-familial Alzheimers disease of late onset (disorder)'),('dementia',1,'230269008',NULL,'Focal Alzheimers disease (disorder)'),('dementia',1,'230270009',NULL,'Frontotemporal dementia (disorder)'),('dementia',1,'230271008',NULL,'Picks disease with Pick bodies (disorder)'),('dementia',1,'230272001',NULL,'Picks disease with Pick cells and no Pick bodies (disorder)'),('dementia',1,'230273006',NULL,'Frontotemporal degeneration (disorder)'),('dementia',1,'230274000',NULL,'Frontal lobe degeneration with motor neurone disease (disorder)'),('dementia',1,'230280008',NULL,'Progressive aphasia in Alzheimers disease (disorder)'),('dementia',1,'230281007',NULL,'Argyrophilic brain disease (disorder)'),('dementia',1,'230282000',NULL,'Post-traumatic dementia (disorder)'),('dementia',1,'230283005',NULL,'Punch drunk syndrome (disorder)'),('dementia',1,'230284004',NULL,'Spongiform encephalopathy (disorder)'),('dementia',1,'230285003',NULL,'Vascular dementia of acute onset (disorder)'),('dementia',1,'230286002',NULL,'Subcortical vascular dementia (disorder)'),('dementia',1,'230287006',NULL,'Mixed cortical and subcortical vascular dementia (disorder)'),('dementia',1,'230288001',NULL,'Semantic dementia (disorder)'),('dementia',1,'230289009',NULL,'Patchy dementia (disorder)'),('dementia',1,'231438001',NULL,'Presbyophrenic psychosis (disorder)'),('dementia',1,'248711000000102',NULL,'Dementia monitoring (regime/therapy)'),('dementia',1,'249181000000100',NULL,'Dementia annual review (regime/therapy)'),('dementia',1,'267688001',NULL,'Cerebral degenerations NOS &/or Alzheimers disease &/or Picks disease &/or Reyes syndrome'),('dementia',1,'268612007',NULL,'Senile and presenile organic psychotic conditions (disorder)'),('dementia',1,'268745002',NULL,'(Alcoholic psychosis: [Korsakovs] or [other]) or (withdrawal syndrome - alcohol)'),('dementia',1,'26929004',NULL,'Alzheimers disease (disorder)'),('dementia',1,'278855005',NULL,'Frontal lobe degeneration (disorder)'),('dementia',1,'278857002',NULL,'Dementia of frontal lobe type (disorder)'),('dementia',1,'279982005',NULL,'Cerebral degeneration presenting primarily with dementia (disorder)'),('dementia',1,'281004',NULL,'Dementia associated with alcoholism (disorder)'),('dementia',1,'304603007',NULL,'New variant of Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'312991009',NULL,'Senile dementia of the Lewy body type (disorder)'),('dementia',1,'371026009',NULL,'Senile dementia with psychosis (disorder)'),('dementia',1,'416780008',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset (disorder)'),('dementia',1,'416975007',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset (disorder)'),('dementia',1,'421529006',NULL,'Dementia associated with AIDS (disorder)'),('dementia',1,'42344001',NULL,'Alcohol-induced psychosis (disorder)'),('dementia',1,'425390006',NULL,'Dementia associated with Parkinsons Disease (disorder)'),('dementia',1,'429458009',NULL,'Dementia due to Creutzfeldt Jakob disease (disorder)'),('dementia',1,'429998004',NULL,'Vascular dementia (disorder)'),('dementia',1,'442344002',NULL,'Dementia due to Huntington chorea (disorder)'),('dementia',1,'52448006',NULL,'Dementia (disorder)'),('dementia',1,'56267009',NULL,'Multi-infarct dementia (disorder)'),('dementia',1,'62239001',NULL,'Parkinson-dementia complex of Guam (disorder)'),('dementia',1,'67155006',NULL,'Gerstmann-Straussler-Scheinker syndrome (disorder)'),('dementia',1,'68638009',NULL,'Bovine spongiform encephalopathy agent (organism)'),('dementia',1,'69482004',NULL,'Korsakoffs psychosis (disorder)'),('dementia',1,'713060000',NULL,'Sporadic Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'713821000000106',NULL,'Dementia monitoring administration (record artifact)'),('dementia',1,'715821000000107',NULL,'Dementia monitoring first letter (procedure)'),('dementia',1,'715881000000108',NULL,'Exception reporting - dementia quality indicators (finding)'),('dementia',1,'716131000000105',NULL,'Excepted from dementia quality indicators - informed dissent (finding)'),('dementia',1,'716221000000104',NULL,'Dementia monitoring verbal invitation (procedure)'),('dementia',1,'716341000000104',NULL,'Excepted from dementia quality indicators - patient unsuitable (finding)'),('dementia',1,'716671000000102',NULL,'Dementia monitoring third letter (procedure)'),('dementia',1,'716991000000108',NULL,'Dementia monitoring telephone invitation (procedure)'),('dementia',1,'717471000000101',NULL,'Dementia monitoring second letter (procedure)'),('dementia',1,'724992007',NULL,'Epilepsy co-occurrent and due to dementia (disorder)'),('dementia',1,'73097000',NULL,'Alcohol amnestic disorder (disorder)'),('dementia',1,'792004',NULL,'Jakob-Creutzfeldt disease (disorder)'),('dementia',1,'80098002',NULL,'Diffuse Lewy body disease (disorder)'),('dementia',1,'843991000000105',NULL,'Participates in Butterfly Scheme for dementia (finding)'),('dementia',1,'844001000000100',NULL,'Butterfly Scheme for dementia declined (situation)'),('dementia',1,'86188000',NULL,'Kuru (disorder)'),('dementia',1,'88520007',NULL,'Creutzfeldt-Jakob agent (organism)'),('dementia',1,'90099008',NULL,'Subcortical leukoencephalopathy (disorder)'),('dementia',1,'91388009',NULL,'Psychoactive substance abuse (disorder)'),('dementia',1,'938551000000108',NULL,'Dementia medication review (procedure)'),('dementia',1,'922071000000105',NULL,'Sporadic Creutzfeldt Jakob disease'),('dementia',1,'724776007',NULL,'Dementia due to disorder of central nervous system (disorder)'),('dementia',1,'1260354005',NULL,'Frontotemporal dementia due to C9orf72 mutation (disorder)'),('dementia',1,'268613002',NULL,'Vascular dementia (disorder)'),('dementia',1,'90253000',NULL,'Progressive subcortical gliosis (disorder)'),('dementia',1,'9345005',NULL,'Dialysis dementia (disorder)'),('dementia',1,'1259121008',NULL,'Amyotrophic lateral sclerosis, parkinsonism, dementia complex of West New Guinea (disorder)'),('dementia',1,'26852004',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with depression (disorder)'),('dementia',1,'192802002',NULL,'Dementia in Alzheimers disease with early onset (disorder)'),('dementia',1,'1263555006',NULL,'Logopenic non-amnestic Alzheimer disease (disorder)'),('dementia',1,'715662009',NULL,'Iatrogenic Jakob-Creutzfeldt disease (disorder)'),('dementia',1,'155061007',NULL,'Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'698954005',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset in remission (disorder)'),('dementia',1,'716994006',NULL,'Behavioral variant of frontotemporal dementia (disorder)'),('dementia',1,'443541000000101',NULL,'[X]Dementia in Alzheimers disease, unspecified (disorder)'),('dementia',1,'733185001',NULL,'Dementia following injury caused by exposure to ionizing radiation (disorder)'),('dementia',1,'192176001',NULL,'[X]Dementia in Huntingtons disease (disorder)'),('dementia',1,'702429008',NULL,'Frontotemporal dementia with parkinsonism-17 (disorder)'),('dementia',1,'268675002',NULL,'[X]Unspecified dementia (disorder)'),
('dementia',1,'721255002',NULL,'Acquired prion disease (disorder)'),('dementia',1,'1259591007',NULL,'Dementia due to acquired hypothyroidism (disorder)'),('dementia',1,'1259584009',NULL,'Dementia due to and following dialysis (disorder)'),('dementia',1,'671511000000100',NULL,'Alcoholic dementia NOS (disorder)'),('dementia',1,'402771000000101',NULL,'[X]Delirium superimposed on dementia (disorder)'),('dementia',1,'79341000119107',NULL,'Mixed dementia (disorder)'),('dementia',1,'715737004',NULL,'Parkinsonism co-occurrent with dementia of Guadeloupe (disorder)'),('dementia',1,'82959004',NULL,'Dementia paralytica juvenilis (disorder)'),('dementia',1,'1259476008',NULL,'Dementia due to genetic disease (disorder)'),('dementia',1,'41161000000104',NULL,'Multi-infarct dementia'),('dementia',1,'840452004',NULL,'Classical sporadic Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'192163007',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type (disorder)'),('dementia',1,'722980006',NULL,'Dementia due to chromosomal anomaly (disorder)'),('dementia',1,'721219005',NULL,'Familial Alzheimer-like prion disease (disorder)'),('dementia',1,'464291000000103',NULL,'[X]Dementia in other diseases classified elsewhere (disorder)'),('dementia',1,'1186877003',NULL,'Dementia due to vitamin E deficiency (disorder)'),('dementia',1,'191467003',NULL,'Arteriosclerotic dementia NOS (disorder)'),('dementia',1,'1259513009',NULL,'Dementia due to Whipple disease (disorder)'),('dementia',1,'1259492003',NULL,'Dementia due to metastatic malignant neoplasm to brain (disorder)'),('dementia',1,'698725008',NULL,'Dementia associated with neurosyphilis (disorder)'),('dementia',1,'154851005',NULL,'Other senile/presenile dementia (disorder)'),('dementia',1,'1089531000000108',NULL,'Predominantly cortical vascular dementia (disorder)'),('dementia',1,'723123001',NULL,'Ischemic vascular dementia (disorder)'),('dementia',1,'413681000000103',NULL,'[X] Dementia: [unspecif] or [presenile NOS (including presenile psychosis NOS)] or [primary degenerative NOS] or [senile NOS (including senile psychosis NOS)] or [senile depressed or paranoid type] (disorder)'),('dementia',1,'105421000119105',NULL,'Early onset Alzheimers disease with behavioral disturbance (disorder)'),('dementia',1,'1259531005',NULL,'Dementia due to hypertensive encephalopathy (disorder)'),('dementia',1,'788898005',NULL,'Dementia caused by volatile inhalant (disorder)'),('dementia',1,'698625002',NULL,'Dementia associated with normal pressure hydrocephalus (disorder)'),('dementia',1,'774069007',NULL,'Protein kinase cAMP-dependent type I regulatory subunit beta-related neurodegenerative dementia with intermediate filaments (disorder)'),('dementia',1,'266134000',NULL,'Tabes dorsalis (disorder)'),('dementia',1,'1259663006',NULL,'Dementia due to polyarteritis nodosa (disorder)'),('dementia',1,'109478007',NULL,'Kohlschutters syndrome (disorder)'),('dementia',1,'725898002',NULL,'Delirium co-occurrent with dementia (disorder)'),('dementia',1,'51928006',NULL,'General paresis - neurosyphilis (disorder)'),('dementia',1,'16276361000119109',NULL,'Vascular dementia without behavioral disturbance (disorder)'),('dementia',1,'715807002',NULL,'Familial Creutzfeldt-Jakob (disorder)'),('dementia',1,'198681000000106',NULL,'[X]Lewy body dementia (disorder)'),('dementia',1,'412631000000106',NULL,'[X]Other vascular dementia (disorder)'),('dementia',1,'12741002',NULL,'AIDS with dementia (disorder)'),('dementia',1,'154845000',NULL,'Dementia (& [presenile] or [senile]) (disorder)'),('dementia',1,'414351000000102',NULL,'[X]Dementia in Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'733192006',NULL,'Dementia due to herpes encephalitis (disorder)'),('dementia',1,'154850006',NULL,'Vascular dementia (disorder)'),('dementia',1,'1259473000',NULL,'Dementia due to fragile X syndrome (disorder)'),('dementia',1,'390000004',NULL,'Binswangers disease (disorder)'),('dementia',1,'214031000000108',NULL,'[X]Lewy body dementia'),('dementia',1,'371024007',NULL,'Senile dementia with delusion (disorder)'),('dementia',1,'97751000119108',NULL,'Altered behavior in Alzheimers disease (disorder)'),('dementia',1,'716667005',NULL,'Right temporal atrophy variant frontotemporal dementia (disorder)'),('dementia',1,'192173009',NULL,'[X]Dementia in other diseases classified elsewhere (disorder)'),('dementia',1,'25772007',NULL,'Multi-infarct dementia with delusions (disorder)'),('dementia',1,'191493005',NULL,'Dementia caused by drug (disorder)'),('dementia',1,'1259667007',NULL,'Dementia due to paraneoplastic encephalitis (disorder)'),('dementia',1,'154846004',NULL,'Uncomplicated senile dementia (disorder)'),('dementia',1,'698626001',NULL,'Dementia associated with multiple sclerosis (disorder)'),('dementia',1,'42769004',NULL,'Diffuse Lewy body disease with spongiform cortical change (disorder)'),('dementia',1,'783258000',NULL,'Familial dementia Danish type (disorder)'),('dementia',1,'838276009',NULL,'Amyotrophic lateral sclerosis, parkinsonism, dementia complex (disorder)'),('dementia',1,'135811000119107',NULL,'Lewy body dementia with behavioral disturbance (disorder)'),('dementia',1,'762351006',NULL,'Dementia due to and following injury of head (disorder)'),('dementia',1,'230275004',NULL,'Lewy body disease (disorder)'),('dementia',1,'722977005',NULL,'Dementia co-occurrent and due to neurocysticercosis (disorder)'),('dementia',1,'1263585001',NULL,'Frontal variant non-amnestic Alzheimer disease (disorder)'),('dementia',1,'1186883000',NULL,'Dementia due to nutritional deficiency disorder (disorder)'),('dementia',1,'4817008',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with delirium (disorder)'),('dementia',1,'702421006',NULL,'Familial encephalopathy with neuroserpin inclusion bodies (disorder)'),('dementia',1,'788862002',NULL,'Agitation due to dementia (finding)'),('dementia',1,'10532003',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with depression (disorder)'),('dementia',1,'698781002',NULL,'Dementia associated with cerebral anoxia (disorder)'),('dementia',1,'397791000000109',NULL,'[X]Dementia in other specified diseases classified elsewhere (disorder)'),('dementia',1,'1259661008',NULL,'Dementia due to inflammatory disorder of musculoskeletal system (disorder)'),('dementia',1,'82371000119101',NULL,'Dementia due to multiple sclerosis with altered behavior (disorder)'),('dementia',1,'54502004',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with delusions (disorder)'),('dementia',1,'1259465009',NULL,'Dementia due to hepatic failure (disorder)'),('dementia',1,'443491000000105',NULL,'[X]Dementia in Alzheimers disease (disorder)'),('dementia',1,'192170007',NULL,'[X]Other vascular dementia (disorder)'),('dementia',1,'1259677009',NULL,'Dementia due to multiple system atrophy (disorder)'),('dementia',1,'191462009',NULL,'Arteriosclerotic dementia (including [multi infarct dementia]) (disorder)'),('dementia',1,'1259524006',NULL,'Dementia due to trypanosomiasis (disorder)'),('dementia',1,'702393003',NULL,'Frontotemporal dementia with gene located on 3p11 (disorder)'),('dementia',1,'59651006',NULL,'Sedative, hypnotic AND/OR anxiolytic-induced persisting dementia (disorder)'),('dementia',1,'789170003',NULL,'Disinhibited behavior due to dementia (disorder)'),('dementia',1,'192180006',NULL,'[X] Dementia: [unspecif] or [presenile NOS (including presenile psychosis NOS)] or [primary degenerative NOS] or [senile NOS (including senile psychosis NOS)] or [senile depressed or paranoid type] (disorder)'),('dementia',1,'698726009',NULL,'Dementia associated with viral encephalitis (disorder)'),('dementia',1,'191456004',NULL,'Presenile dementia NOS (disorder)'),('dementia',1,'471341000000106',NULL,'[X]Unspecified dementia (disorder)'),('dementia',1,'1259586006',NULL,'Dementia due to autoimmune encephalitis (disorder)'),('dementia',1,'479161000000109',NULL,'[X]Dementia in Parkinsons disease (disorder)'),('dementia',1,'288631000119104',NULL,'Vascular dementia with behavioral disturbance (disorder)'),('dementia',1,'1156800008',NULL,'Autosomal dominant Alzheimer disease due to mutation of presenilin 1 (disorder)'),('dementia',1,'1089581000000107',NULL,'Predominantly cortical dementia (disorder)'),('dementia',1,'192179008',NULL,'[X]Dementia in other specified diseases classif elsewhere (disorder)'),('dementia',1,'192175002',NULL,'[X]Dementia in Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'230290000',NULL,'Epileptic dementia (disorder)'),('dementia',1,'192184002',NULL,'[X]Delirium superimposed on dementia (disorder)'),('dementia',1,'788899002',NULL,'Dementia due to pellagra (disorder)'),('dementia',1,'82361000119107',NULL,'Altered behavior in dementia due to Huntington chorea (disorder)'),('dementia',1,'192808003',NULL,'Lewy body disease (disorder)'),('dementia',1,'194481000',NULL,'[X]Other Alzheimers disease (disorder)'),('dementia',1,'713844000',NULL,'Dementia co-occurrent with human immunodeficiency virus infection (disorder)'),('dementia',1,'733193001',NULL,'Dementia co-occurrent and due to progressive multifocal leukoencephalopathy (disorder)'),('dementia',1,'1259469003',NULL,'Dementia due to Gerstmann Straussler Scheinker syndrome (disorder)'),('dementia',1,'698948009',NULL,'Vascular dementia in remission (disorder)'),('dementia',1,'1259123006',NULL,'Amyotrophic lateral sclerosis, parkinsonism, dementia complex of Kii Peninsula (disorder)'),('dementia',1,'1259511006',NULL,'Dementia due to Wilson disease (disorder)'),('dementia',1,'700911000000100',NULL,'Other senile/presenile dementia (disorder)'),('dementia',1,'141991000119109',NULL,'Delusions in Alzheimers disease (disorder)'),('dementia',1,'66108005',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, uncomplicated (disorder)'),('dementia',1,'421023003',NULL,'Presenile dementia with acquired immunodeficiency syndrome (disorder)'),
('dementia',1,'1259673008',NULL,'Dementia due to neurofilament inclusion body disease (disorder)'),('dementia',1,'1260355006',NULL,'Frontotemporal dementia due to FUS mutation (disorder)'),('dementia',1,'762707000',NULL,'Subcortical dementia (disorder)'),('dementia',1,'413281000000101',NULL,'[X]Vascular dementia, unspecified (disorder)'),('dementia',1,'1259471003',NULL,'Dementia due to Hashimoto encephalopathy (disorder)'),('dementia',1,'1259499007',NULL,'Dementia due to hemorrhagic cerebral infarction due to hypertension (disorder)'),('dementia',1,'192174003',NULL,'[X]Dementia in Picks disease (disorder)'),('dementia',1,'154848003',NULL,'Senile dementia with depressive or paranoid features (disorder)'),('dementia',1,'1259990004',NULL,'Dementia due to classical pantothenate kinase associated neurodegeneration (disorder)'),('dementia',1,'722979008',NULL,'Dementia due to metabolic abnormality (disorder)'),('dementia',1,'192161009',NULL,'Dementia in Alzheimers disease with early onset (disorder)'),('dementia',1,'65096006',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with delirium (disorder)'),('dementia',1,'1186879000',NULL,'Dementia due to thiamine deficiency (disorder)'),('dementia',1,'1163119007',NULL,'Creutzfeldt Jakob disease following graft of dura (disorder)'),('dementia',1,'922061000000103',NULL,'Sporadic Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'1259480003',NULL,'Dementia due to fatal familial insomnia (disorder)'),('dementia',1,'1259124000',NULL,'Amyotrophic lateral sclerosis with frontotemporal dementia (disorder)'),('dementia',1,'134422007',NULL,'Alzheimers disease with early onset (disorder)'),('dementia',1,'2421000119107',NULL,'Hallucinations co-occurrent and due to late onset dementia (disorder)'),('dementia',1,'613591000000100',NULL,'Presenile dementia NOS (disorder)'),('dementia',1,'192803007',NULL,'Dementia in Alzheimers disease with late onset (disorder)'),('dementia',1,'268744003',NULL,'Dementia (& [presenile] or [senile]) (disorder)'),('dementia',1,'1259128002',NULL,'Alzheimer disease with psychosis (disorder)'),('dementia',1,'1187004001',NULL,'Chronic traumatic encephalopathy (disorder)'),('dementia',1,'111480006',NULL,'Psychoactive substance-induced organic dementia (disorder)'),('dementia',1,'142001000119106',NULL,'Depressed mood in Alzheimers disease (disorder)'),('dementia',1,'723390000',NULL,'Rapidly progressive dementia (disorder)'),('dementia',1,'130121000119104',NULL,'Dementia due to Retts syndrome (disorder)'),('dementia',1,'16219201000119101',NULL,'Behavioral disturbance co-occurrent and due to late onset Alzheimer dementia (disorder)'),('dementia',1,'788861009',NULL,'Aggression due to dementia (finding)'),('dementia',1,'1581000119101',NULL,'Dementia of the Alzheimer type with behavioral disturbance (disorder)'),('dementia',1,'154847008',NULL,'Presenile dementia (disorder)'),('dementia',1,'840465008',NULL,'Dementia due to iron deficiency (disorder)'),('dementia',1,'443781000000102',NULL,'[X]Other Alzheimers disease (disorder)'),('dementia',1,'544871000000102',NULL,'Other alcoholic dementia (disorder)'),('dementia',1,'192168003',NULL,'Subcortical vascular dementia (disorder)'),('dementia',1,'1259494002',NULL,'Dementia due to leukodystrophy (disorder)'),('dementia',1,'55009008',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with delusions (disorder)'),('dementia',1,'192177005',NULL,'[X]Dementia in Parkinsons disease (disorder)'),('dementia',1,'1260353004',NULL,'Frontotemporal dementia due to VCP mutation (disorder)'),('dementia',1,'702426001',NULL,'GRN-related frontotemporal dementia (disorder)'),('dementia',1,'414361000000104',NULL,'[X]Dementia in Huntingtons disease (disorder)'),('dementia',1,'142011000119109',NULL,'Alzheimers disease co-occurrent with delirium (disorder)'),('dementia',1,'703544004',NULL,'Inclusion body myopathy with early-onset Paget disease and frontotemporal dementia (disorder)'),('dementia',1,'90194001',NULL,'AIDS with organic dementia (disorder)'),('dementia',1,'1259665004',NULL,'Dementia due to progressive subcortical gliosis (disorder)'),('dementia',1,'1259581001',NULL,'Dementia due to celiac disease (disorder)'),('dementia',1,'762350007',NULL,'Dementia due to prion disease (disorder)'),('dementia',1,'10349009',NULL,'Multi-infarct dementia with delirium (disorder)'),('dementia',1,'88339003',NULL,'Dementia arising in the senium AND/OR presenium (disorder)'),('dementia',1,'230277007',NULL,'Lewy body disease (disorder)'),('dementia',1,'419261000000107',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type (disorder)'),('dementia',1,'1259496000',NULL,'Dementia due to Lyme disease (disorder)'),('dementia',1,'420614009',NULL,'Organic dementia with acquired immunodeficiency syndrome (disorder)'),('dementia',1,'192160005',NULL,'[X]Dementia in Alzheimers disease (disorder)'),('dementia',1,'6475002',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, uncomplicated (disorder)'),('dementia',1,'62102009',NULL,'AIDS with presenile dementia (disorder)'),('dementia',1,'455381000000102',NULL,'[X]Dementia in Picks disease (disorder)'),('dementia',1,'1259501004',NULL,'Dementia due to kuru (disorder)'),('dementia',1,'192162002',NULL,'Dementia in Alzheimers disease with late onset (disorder)'),('dementia',1,'268615009',NULL,'Other alcoholic dementia (disorder)'),('dementia',1,'733191004',NULL,'Dementia due to chronic subdural hematoma (disorder)'),('dementia',1,'1186881003',NULL,'Dementia due to niacin deficiency (disorder)'),('dementia',1,'1259488005',NULL,'Dementia due to cerebral amyloid angiopathy (disorder)'),('dementia',1,'191474008',NULL,'Alcoholic dementia: [other] or [NOS] (disorder)'),('dementia',1,'1259478009',NULL,'Dementia due to familial Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'698687007',NULL,'Post-traumatic dementia with behavioral change (disorder)'),('dementia',1,'613601000000106',NULL,'Senile dementia with depressive or paranoid features NOS (disorder)'),('dementia',1,'192164001',NULL,'[X]Dementia in Alzheimers disease, unspecified (disorder)'),('dementia',1,'1156789004',NULL,'Autosomal dominant Alzheimer disease due to mutation of amyloid precursor protein (disorder)'),('dementia',1,'70936005',NULL,'Multi-infarct dementia, uncomplicated (disorder)'),('dementia',1,'840464007',NULL,'Dementia due to carbon monoxide poisoning (disorder)'),('dementia',1,'138736007',NULL,'H/O: dementia (situation)'),('dementia',1,'733184002',NULL,'Dementia caused by heavy metal exposure (disorder)'),('dementia',1,'1186887004',NULL,'Dementia caused by manganese and/or manganese compound (disorder)'),('dementia',1,'106021000119105',NULL,'Multi-infarct dementia due to atherosclerosis (disorder)'),('dementia',1,'192165000',NULL,'Vascular dementia (disorder)'),('dementia',1,'286932008',NULL,'Other senile/presenile dementia (disorder)'),('dementia',1,'733190003',NULL,'Dementia due to primary malignant neoplasm of brain (disorder)'),('dementia',1,'860826006',NULL,'Creutzfeldt-Jakob Disease caused by human growth hormone (disorder)'),('dementia',1,'783161005',NULL,'Familial dementia British type (disorder)'),('dementia',1,'1259467001',NULL,'Dementia due to hypercalcemia (disorder)'),('dementia',1,'722600006',NULL,'Non-amnestic Alzheimer disease (disorder)'),('dementia',1,'597951000000102',NULL,'Arteriosclerotic dementia NOS (disorder)'),('dementia',1,'698624003',NULL,'Dementia associated with cerebral lipidosis (disorder)'),('dementia',1,'32875003',NULL,'Inhalant-induced persisting dementia (disorder)'),('dementia',1,'82351000119105',NULL,'Altered behavior due to Picks disease (disorder)'),('dementia',1,'134423002',NULL,'Alzheimers disease with late onset (disorder)'),('dementia',1,'192171006',NULL,'[X]Vascular dementia, unspecified (disorder)'),('dementia',1,'1259579003',NULL,'Dementia due to Behcet syndrome (disorder)'),('dementia',1,'833326008',NULL,'Cortical vascular dementia (disorder)'),('dementia',1,'1259679007',NULL,'Dementia due to atypical pantothenate kinase associated neurodegeneration (disorder)'),('dementia',1,'191460001',NULL,'Senile dementia with depressive or paranoid features NOS (disorder)'),('dementia',1,'154849006',NULL,'Senile dementia with delirium (disorder)'),('dementia',1,'698955006',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset in remission (disorder)'),('dementia',1,'1259656006',NULL,'Dementia due to renal failure (disorder)'),('dementia',1,'31081000119101',NULL,'Presenile dementia with delusions (disorder)'),('dementia',1,'1259485008',NULL,'Dementia due to cerebral vasculitis (disorder)'),('dementia',1,'1156798001',NULL,'Autosomal dominant Alzheimer disease due to mutation of presenilin 2 (disorder)'),('dementia',1,'724777003',NULL,'Dementia due to infectious disease (disorder)'),('dementia',1,'1259522005',NULL,'Dementia due to variant Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'1186880002',NULL,'Dementia due to cobalamin deficiency (disorder)'),('dementia',1,'1260352009',NULL,'Frontotemporal dementia due to TARDBP mutation (disorder)'),('dementia',1,'733194007',NULL,'Dementia co-occurrent and due to Down syndrome (disorder)'),('dementia',1,'1259503001',NULL,'Dementia due to iatrogenic Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'698949001',NULL,'Dementia in remission (disorder)'),('dementia',1,'293671000119109',NULL,'Behavioral disturbance due to multi-infarct dementia (disorder)'),('dementia',1,'82381000119103',NULL,'Epileptic dementia with behavioral disturbance (disorder)'),('dementia',1,'1591000119103',NULL,'Dementia with behavioral disturbance (disorder)'),('dementia',1,'191450005',NULL,'Presenile dementia (disorder)'),('dementia',1,'1259517005',NULL,'Dementia due to systemic lupus erythematosus (disorder)'),('dementia',1,'78511000000104',NULL,'Multi-infarct dementia'),('dementia',1,'1259519008',NULL,'Dementia due to subacute sclerosing panencephalitis (disorder)'),
('dementia',1,'1259529001',NULL,'Dementia due to sporadic Creutzfeldt-Jakob disease (disorder)'),('dementia',1,'14070001',NULL,'Multi-infarct dementia with depression (disorder)'),('dementia',1,'192166004',NULL,'Vascular dementia of acute onset (disorder)'),('dementia',1,'101421000119107',NULL,'Dementia due to Parkinsons disease (disorder)'),('dementia',1,'1259675001',NULL,'Dementia due to obstructive hydrocephalus (disorder)'),('dementia',1,'192178000',NULL,'Acquired immune deficiency syndrome dementia complex (disorder)'),('dementia',1,'192169006',NULL,'Mixed cortical and subcortical vascular dementia (disorder)'),('dementia',1,'722978000',NULL,'Dementia caused by toxin (disorder)'),('dementia',1,'713488003',NULL,'Presenile dementia co-occurrent with human immunodeficiency virus infection (disorder)'),('dementia',1,'192167008',NULL,'[X]Dementia: [multi-infarct] or [predominantly cortical] (disorder)'),('dementia',1,'230276003',NULL,'Lewy body disease (disorder)'),('dementia',1,'79358009',NULL,'Transmissible virus dementia (disorder)'),('dementia',1,'1148924004',NULL,'Dementia due to deficiency of folic acid (disorder)'),('dementia',1,'231463001',NULL,'Alcoholic dementia NOS (disorder)'),('dementia',1,'1089501000000102',NULL,'Presenile dementia with psychosis (disorder)'),('dementia',1,'142811000119104',NULL,'Dementia due to Alzheimers disease (disorder)'),('dementia',1,'2421000119107',NULL,'Hallucinations co-occurrent and due to late onset dementia (disorder)'),('dementia',1,'715737004',NULL,'Parkinsonism co-occurrent with dementia of Guadeloupe (disorder)'),('dementia',1,'83157008',NULL,'Fatal familial insomnia (disorder)'),('dementia',1,'45864009',NULL,'Senile degeneration of brain (disorder)'),('dementia',1,'16219201000119101',NULL,'Behavioral disturbance co-occurrent and due to late onset Alzheimer dementia (disorder)'),('dementia',1,'40425004',NULL,'Postconcussion syndrome (disorder)'),('dementia',1,'725898002',NULL,'Delirium co-occurrent with dementia (disorder)');
INSERT INTO #codessnomed
VALUES ('glomerulonephritis',1,'1426004',NULL,'Necrotizing glomerulonephritis (disorder)'),('glomerulonephritis',1,'3704008',NULL,'Diffuse endocapillary proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'4676006',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class II (disorder)'),('glomerulonephritis',1,'11013005',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class VI'),('glomerulonephritis',1,'13335004',NULL,'Sclerosing glomerulonephritis (disorder)'),('glomerulonephritis',1,'19351000',NULL,'Acute glomerulonephritis (disorder)'),('glomerulonephritis',1,'20917003',NULL,'CGN - Chronic glomerulonephritis'),('glomerulonephritis',1,'35546006',NULL,'Mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'36171008',NULL,'GN - Glomerulonephritis'),('glomerulonephritis',1,'36402006',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class IV'),('glomerulonephritis',1,'44785005',NULL,'MCN - Minimal change nephropathy'),('glomerulonephritis',1,'50581000',NULL,'Goodpasture syndrome'),('glomerulonephritis',1,'52042003',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class V'),('glomerulonephritis',1,'55652009',NULL,'Idiopathic crescentic glomerulonephritis type 3'),('glomerulonephritis',1,'57965003',NULL,'Acute benign haemorrhagic glomerulonephritis'),('glomerulonephritis',1,'59479006',NULL,'Mesangiocapillary glomerulonephritis, type II (disorder)'),('glomerulonephritis',1,'64168005',NULL,'Idiopathic crescentic glomerulonephritis, type I (disorder)'),('glomerulonephritis',1,'64212008',NULL,'Diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'68544003',NULL,'PSGN - Post-streptococcal glomerulonephritis'),('glomerulonephritis',1,'68779003',NULL,'Primary immunoglobulin A nephropathy (disorder)'),('glomerulonephritis',1,'68815009',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome'),('glomerulonephritis',1,'73286009',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class I (disorder)'),('glomerulonephritis',1,'73305009',NULL,'Amyloid-like glomerulopathy'),('glomerulonephritis',1,'75888001',NULL,'Mesangiocapillary glomerulonephritis type I'),('glomerulonephritis',1,'76521009',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class III'),('glomerulonephritis',1,'77182004',NULL,'Chronic nephritic syndrome, diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'80321008',NULL,'Mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'83866005',NULL,'Focal AND segmental proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'123609007',NULL,'Subacute glomerulonephritis (disorder)'),('glomerulonephritis',1,'123752003',NULL,'Immune complex glomerulonephritis'),('glomerulonephritis',1,'197579006',NULL,'Acute proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197582001',NULL,'Acute glomerulonephritis associated with another disorder'),('glomerulonephritis',1,'197589005',NULL,'Nephrotic syndrome with proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197590001',NULL,'Nephrotic syndrome with membranous glomerulonephritis (disorder)'),('glomerulonephritis',1,'197591002',NULL,'Nephrotic syndrome with membranoproliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197595006',NULL,'Nephrotic syndrome, diffuse membranous glomerulonephritis (disorder)'),('glomerulonephritis',1,'197596007',NULL,'Nephrotic syndrome, diffuse mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197597003',NULL,'Nephrotic syndrome, diffuse endocapillary proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197598008',NULL,'Nephrotic syndrome, diffuse mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'197600002',NULL,'Nephrotic syndrome, diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'197613008',NULL,'Chronic mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197616000',NULL,'Chronic glomerulonephritis associated with another disorder'),('glomerulonephritis',1,'197617009',NULL,'Chronic exudative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197618004',NULL,'Chronic focal glomerulonephritis (disorder)'),('glomerulonephritis',1,'197619007',NULL,'Chronic diffuse glomerulonephritis (disorder)'),('glomerulonephritis',1,'197626007',NULL,'Focal membranoproliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197629000',NULL,'Anaphylactoid glomerulonephritis (disorder)'),('glomerulonephritis',1,'197683002',NULL,'Acute nephritic syndrome, diffuse membranous glomerulonephritis (disorder)'),('glomerulonephritis',1,'197684008',NULL,'Acute nephritic syndrome, diffuse mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197685009',NULL,'Acute nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197686005',NULL,'Acute nephritic syndrome, diffuse mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'197688006',NULL,'Acute nephritic syndrome, diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'197692004',NULL,'Rapidly progressive nephritic syndrome, diffuse membranous glomerulonephritis (disorder)'),('glomerulonephritis',1,'197693009',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197694003',NULL,'Rapidly progressive nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197695002',NULL,'Rapidly progressive nephritic syndrome, diffuse mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'197697005',NULL,'Rapidly progressive nephritic syndrome, diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'197712008',NULL,'Chronic nephritic syndrome, diffuse endocapillary proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'197713003',NULL,'Chronic nephritic syndrome, diffuse mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'197715005',NULL,'Chronic nephritic syndrome, diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'197720005',NULL,'Isolated proteinuria with specified morphological lesion, diffuse membranous glomerulonephritis (finding)'),('glomerulonephritis',1,'197721009',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangial proliferative glomerulonephritis (finding)'),('glomerulonephritis',1,'197722002',NULL,'Isolated proteinuria with specified morphological lesion, diffuse endocapillary proliferative glomerulonephritis (finding)'),('glomerulonephritis',1,'197723007',NULL,'Isolated proteinuria with specified morphological lesion, diffuse mesangiocapillary glomerulonephritis (finding)'),('glomerulonephritis',1,'197725000',NULL,'Isolated proteinuria with specified morphological lesion, diffuse concentric glomerulonephritis (finding)'),('glomerulonephritis',1,'236392004',NULL,'Rapidly progressive glomerulonephritis (disorder)'),('glomerulonephritis',1,'236393009',NULL,'Endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'236394003',NULL,'Idiopathic endocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'236395002',NULL,'Post-infectious glomerulonephritis (disorder)'),('glomerulonephritis',1,'236397005',NULL,'Post-infectious glomerulonephritis - Garland variety (disorder)'),('glomerulonephritis',1,'236398000',NULL,'Proliferative crescentic glomerulonephritis'),('glomerulonephritis',1,'236399008',NULL,'Steroid-sensitive minimal change glomerulonephritis (disorder)'),('glomerulonephritis',1,'236400001',NULL,'Steroid-resistant minimal change glomerulonephritis (disorder)'),('glomerulonephritis',1,'236401002',NULL,'Steroid-dependent minimal change glomerulonephritis (disorder)'),('glomerulonephritis',1,'236407003',NULL,'Immunoglobulin A nephropathy (disorder)'),('glomerulonephritis',1,'236409000',NULL,'Mesangiocapillary glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'236410005',NULL,'Mesangiocapillary glomerulonephritis type IV (disorder)'),('glomerulonephritis',1,'236411009',NULL,'Immunoglobulin M nephropathy (disorder)'),('glomerulonephritis',1,'236413007',NULL,'Membranous glomerulonephritis - stage I (disorder)'),('glomerulonephritis',1,'236414001',NULL,'Membranous glomerulonephritis - stage II (disorder)'),('glomerulonephritis',1,'236415000',NULL,'Membranous glomerulonephritis - stage III (disorder)'),('glomerulonephritis',1,'236416004',NULL,'Membranous glomerulonephritis - stage IV (disorder)'),('glomerulonephritis',1,'236417008',NULL,'Membranous glomerulonephritis stage V (disorder)'),('glomerulonephritis',1,'236419006',NULL,'Progressive hereditary glomerulonephritis without deafness (disorder)'),('glomerulonephritis',1,'236505008',NULL,'Cryoglobulinemic glomerulonephritis (disorder)'),('glomerulonephritis',1,'236508005',NULL,'Malignancy-associated glomerulonephritis (disorder)'),('glomerulonephritis',1,'236586006',NULL,'De novo glomerulonephritis (disorder)'),('glomerulonephritis',1,'236590008',NULL,'Cytomegalovirus-induced glomerulonephritis (disorder)'),('glomerulonephritis',1,'239932005',NULL,'Primary pauci-immune necrotizing and crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'266549004',NULL,'Nephrotic syndrome with minimal change glomerulonephritis (disorder)'),('glomerulonephritis',1,'359694003',NULL,'Idiopathic crescentic glomerulonephritis, type II (disorder)'),('glomerulonephritis',1,'363233007',NULL,'Nephrotic syndrome secondary to glomerulonephritis (disorder)'),
('glomerulonephritis',1,'399190000',NULL,'Non-progressive hereditary glomerulonephritis'),('glomerulonephritis',1,'399340005',NULL,'Alports syndrome'),('glomerulonephritis',1,'425384007',NULL,'Sarcoidosis with glomerulonephritis'),('glomerulonephritis',1,'425455002',NULL,'Diabetic glomerulonephritis'),('glomerulonephritis',1,'427555000',NULL,'Glomerulonephritis co-occurrent and due to Wegeners granulomatosis'),('glomerulonephritis',1,'441815006',NULL,'Proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'445258009',NULL,'Idiopathic rapidly progressive glomerulonephritis'),('glomerulonephritis',1,'707332000',NULL,'Recurrent proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'711531007',NULL,'Focal mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'714815007',NULL,'Recurrent haematuria co-occurrent and due to diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'714816008',NULL,'Persistent haematuria co-occurrent and due to diffuse crescentic glomerulonephritis'),('glomerulonephritis',1,'714817004',NULL,'Recurrent haematuria co-occurrent and due to diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'714818009',NULL,'Persistent haematuria co-occurrent and due to diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'714819001',NULL,'Recurrent haematuria co-occurrent and due to diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'714820007',NULL,'Persistent haematuria co-occurrent and due to diffuse mesangiocapillary glomerulonephritis'),('glomerulonephritis',1,'714821006',NULL,'Recurrent haematuria co-occurrent and due to diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'714822004',NULL,'Persistent haematuria co-occurrent and due to diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'714825002',NULL,'Recurrent haematuria co-occurrent and due to diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'714826001',NULL,'Persistent haematuria co-occurrent and due to diffuse mesangial proliferative glomerulonephritis'),('glomerulonephritis',1,'718192000',NULL,'Congo red negative amyloidosis like glomerulopathy'),('glomerulonephritis',1,'722086002',NULL,'Malignancy-associated membranous nephropathy'),('glomerulonephritis',1,'722119002',NULL,'Idiopathic membranous nephropathy'),('glomerulonephritis',1,'722120008',NULL,'Membranous glomerulonephritis caused by drug'),('glomerulonephritis',1,'722168002',NULL,'Membranous glomerulonephritis co-occurrent with infectious disease'),('glomerulonephritis',1,'722761003',NULL,'Complement component 3 glomerulonephritis'),('glomerulonephritis',1,'726082003',NULL,'Immunotactoid glomerulonephritis'),('glomerulonephritis',1,'733472005',NULL,'Microcephalus, glomerulonephritis, marfanoid habitus syndrome'),('glomerulonephritis',1,'106911000119102',NULL,'Idiopathic glomerulonephritis'),('glomerulonephritis',1,'120241000119100',NULL,'Glomerulonephritis due to hepatitis C'),('glomerulonephritis',1,'85381000119105',NULL,'Glomerulonephritis due to Henoch-Schönlein purpura (disorder)'),('glomerulonephritis',1,'89681000119101',NULL,'Glomerulonephritis co-occurrent and due to scleroderma'),('glomerulonephritis',1,'101711000119105',NULL,'Glomerulonephritis co-occurrent and due to antineutrophil cytoplasmic antibody positive vasculitis'),('glomerulonephritis',1,'90971000119103',NULL,'Glomerulonephritis co-occurrent and due to vasculitis'),('glomerulonephritis',1,'195791000119101',NULL,'Chronic proliferative glomerulonephritis'),('glomerulonephritis',1,'367561000119103',NULL,'Hereditary diffuse mesangiocapillary glomerulonephritis (disorder)'),('glomerulonephritis',1,'367551000119100',NULL,'Hereditary diffuse mesangial proliferative glomerulonephritis (disorder)'),('glomerulonephritis',1,'367531000119106',NULL,'Hereditary diffuse endocapillary proliferative glomerulonephritis'),('glomerulonephritis',1,'367541000119102',NULL,'Hereditary diffuse membranous glomerulonephritis'),('glomerulonephritis',1,'368941000119108',NULL,'Hereditary nephropathy co-occurrent with membranoproliferative glomerulonephritis type III'),('glomerulonephritis',1,'368881000119109',NULL,'Rapidly progressive nephritic syndrome co-occurrent and due to membranoproliferative glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'28191000119109',NULL,'Chronic nephritic syndrome with membranous glomerulonephritis (disorder)'),('glomerulonephritis',1,'368931000119104',NULL,'Isolated proteinuria co-occurrent and due to membranoproliferative glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'368921000119102',NULL,'Nephritic syndrome co-occurrent and due to membranoproliferative glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'368911000119109',NULL,'Nephrotic syndrome co-occurrent and due to membranoproliferative glomerulonephritis type III'),('glomerulonephritis',1,'367511000119101',NULL,'Hereditary dense deposit disease'),('glomerulonephritis',1,'367521000119108',NULL,'Hereditary diffuse crescentic glomerulonephritis (disorder)'),('glomerulonephritis',1,'368871000119106',NULL,'Acute nephritic syndrome co-occurrent and due to membranoproliferative glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'368901000119106',NULL,'Chronic nephritic syndrome co-occurrent and due to membranoproliferative glomerulonephritis type III (disorder)'),('glomerulonephritis',1,'123610002',NULL,'Healed glomerulonephritis (disorder)');
INSERT INTO #codessnomed
VALUES ('kidney-stones',1,'95570007',NULL,'Kidney stone (disorder)'),('kidney-stones',1,'833291009',NULL,'Calcium oxalate calculus of kidney (disorder)'),('kidney-stones',1,'427649000',NULL,'Calcium renal calculus (disorder)'),('kidney-stones',1,'23754003',NULL,'Calculous pyelonephritis (disorder)'),('kidney-stones',1,'236710009',NULL,'Calculus in renal pelvis (disorder)'),('kidney-stones',1,'266556005',NULL,'Calculus of kidney and ureter (disorder)'),('kidney-stones',1,'236708007',NULL,'Calyceal renal calculus (disorder)'),('kidney-stones',1,'48061001',NULL,'Congenital calculus of kidney (disorder)'),('kidney-stones',1,'833293007',NULL,'Cystine calculus of kidney (disorder)'),('kidney-stones',1,'699322002',NULL,'Matrix stone of kidney (disorder)'),('kidney-stones',1,'168041003',NULL,'On examination - renal calculus (disorder)'),('kidney-stones',1,'275893001',NULL,'Phosphate calculus of kidney (disorder)'),('kidney-stones',1,'1056501000112102',NULL,'Recurrent kidney stone (disorder)'),('kidney-stones',1,'197794008',NULL,'Staghorn calculus (disorder)'),('kidney-stones',1,'274401005',NULL,'Uric acid renal calculus (disorder)'),('kidney-stones',1,'236713006',NULL,'X-linked recessive nephrolithiasis with renal failure (disorder)');
INSERT INTO #codessnomed
VALUES ('vasculitis',1,'228007',NULL,'Lucio phenomenon (disorder)'),('vasculitis',1,'9177003',NULL,'Histiocytic vasculitis of skin (disorder)'),('vasculitis',1,'11791001',NULL,'Necrotizing vasculitis (disorder)'),('vasculitis',1,'31996006',NULL,'Vasculitis (disorder)'),('vasculitis',1,'46286007',NULL,'Lymphocytic vasculitis of skin (disorder)'),('vasculitis',1,'46956008',NULL,'Polyangiitis'),('vasculitis',1,'53312001',NULL,'Vasculitis of the skin (disorder)'),('vasculitis',1,'55275006',NULL,'Non-tubercular erythema induratum'),('vasculitis',1,'56780006',NULL,'Segmental hyalinizing vasculitis (disorder)'),('vasculitis',1,'60555002',NULL,'Hypersensitivity angiitis (disorder)'),('vasculitis',1,'64832003',NULL,'Neutrophilic vasculitis of skin (disorder)'),('vasculitis',1,'77628002',NULL,'Retinal vasculitis (disorder)'),('vasculitis',1,'95578000',NULL,'Renal vasculitis (disorder)'),('vasculitis',1,'190815001',NULL,'Cryoglobulinemic vasculitis (disorder)'),('vasculitis',1,'191306005',NULL,'Henoch-Schönlein purpura (disorder)'),('vasculitis',1,'230731002',NULL,'Cerebral arteritis in systemic vasculitis (disorder)'),('vasculitis',1,'230733004',NULL,'Isolated angiitis of central nervous system (disorder)'),('vasculitis',1,'234019004',NULL,'Secondary systemic vasculitis (disorder)'),('vasculitis',1,'234020005',NULL,'Vasculitis caused by drug'),('vasculitis',1,'238762002',NULL,'Livedoid vasculitis (disorder)'),('vasculitis',1,'238785001',NULL,'Primary cutaneous vasculitis (disorder)'),('vasculitis',1,'238786000',NULL,'Gougerot-Ruiter purpura (disorder)'),('vasculitis',1,'238787009',NULL,'Secondary cutaneous vasculitis (disorder)'),('vasculitis',1,'239924002',NULL,'Primary necrotizing systemic vasculitis (disorder)'),('vasculitis',1,'239933000',NULL,'Primary necrotizing vasculitis with granulomata (disorder)'),('vasculitis',1,'239941000',NULL,'Nailfold rheumatoid vasculitis (disorder)'),('vasculitis',1,'239942007',NULL,'Systemic rheumatoid vasculitis (disorder)'),('vasculitis',1,'239943002',NULL,'Necrotizing rheumatoid vasculitis (disorder)'),('vasculitis',1,'239944008',NULL,'Lupus erythematosus-associated vasculitis'),('vasculitis',1,'239945009',NULL,'Hypocomplementemic urticarial vasculitis (disorder)'),('vasculitis',1,'239947001',NULL,'Essential mixed cryoglobulinemia (disorder)'),('vasculitis',1,'400054000',NULL,'Rheumatoid vasculitis'),('vasculitis',1,'402416000',NULL,'Urticarial vasculitis with monoclonal immunoglobulin M component, Schnitzler'),('vasculitis',1,'402655006',NULL,'Necrotizing cutaneous vasculitis'),('vasculitis',1,'402656007',NULL,'Urticarial vasculitis'),('vasculitis',1,'402657003',NULL,'Necrotizing vasculitis secondary to connective tissue disease'),('vasculitis',1,'402658008',NULL,'Serum sickness type vasculitis'),('vasculitis',1,'402659000',NULL,'Drug-induced necrotizing vasculitis'),('vasculitis',1,'402660005',NULL,'Necrotizing vasculitis secondary to infection'),('vasculitis',1,'402661009',NULL,'Paraneoplastic vasculitis'),('vasculitis',1,'402662002',NULL,'Necrotizing vasculitis due to mixed cryoglobulinemia'),('vasculitis',1,'402663007',NULL,'Pustular vasculitis'),('vasculitis',1,'402664001',NULL,'Localized cutaneous vasculitis'),('vasculitis',1,'402855009',NULL,'Normocomplementemic urticarial vasculitis'),('vasculitis',1,'402859003',NULL,'Necrotizing vasculitis of undetermined etiology'),('vasculitis',1,'402958005',NULL,'Pustular vasculitis due to gonococcal bacteremia'),('vasculitis',1,'403510002',NULL,'Urticarial vasculitis due to lupus erythematosus'),('vasculitis',1,'403511003',NULL,'Necrotizing vasculitis due to lupus erythematosus'),('vasculitis',1,'403518009',NULL,'Necrotizing vasculitis due to scleroderma'),('vasculitis',1,'403616000',NULL,'Drug-induced lymphocytic vasculitis'),('vasculitis',1,'407530004',NULL,'Primary systemic vasculitis'),('vasculitis',1,'416703007',NULL,'Retinal vasculitis due to polyarteritis nodosa'),('vasculitis',1,'417303004',NULL,'Retinal vasculitis due to systemic lupus erythematosus'),('vasculitis',1,'427020007',NULL,'Cerebral vasculitis'),('vasculitis',1,'427213005',NULL,'Autoimmune vasculitis'),('vasculitis',1,'427356003',NULL,'Eosinophilic vasculitis of skin'),('vasculitis',1,'718217000',NULL,'Cutaneous small vessel vasculitis'),('vasculitis',1,'721664001',NULL,'Mesenteric arteritis'),('vasculitis',1,'722191003',NULL,'Antineutrophil cytoplasmic antibody (ANCA) positive vasculitis'),('vasculitis',1,'722858009',NULL,'Vasculitis of large intestine'),('vasculitis',1,'724063005',NULL,'Postinfective vasculitis'),('vasculitis',1,'724597006',NULL,'Large vessel vasculitis'),('vasculitis',1,'724598001',NULL,'Medium sized vessel vasculitis'),('vasculitis',1,'724599009',NULL,'Small vessel vasculitis'),('vasculitis',1,'724600007',NULL,'Immune complex small vessel vasculitis'),('vasculitis',1,'724601006',NULL,'Vasculitis caused by antineutrophil cytoplasmic antibody'),('vasculitis',1,'724602004',NULL,'Single organ vasculitis'),('vasculitis',1,'724996005',NULL,'Vasculitic lumbosacral plexopathy'),('vasculitis',1,'737184001',NULL,'Interstitial lung disease with systemic vasculitis'),('vasculitis',1,'762302008',NULL,'Drug-associated immune complex vasculitis'),('vasculitis',1,'762352004',NULL,'Demyelination due to systemic vasculitis'),('vasculitis',1,'762537007',NULL,'Livedoid vasculitis of lower limb due to varicose veins of lower limb'),('vasculitis',1,'985941000000100',NULL,'Medium vessel vasculitis (disorder)'),('vasculitis',1,'101711000119105',NULL,'Glomerulonephritis co-occurrent and due to antineutrophil cytoplasmic antibody positive vasculitis'),('vasculitis',1,'985971000000106',NULL,'Sarcoid vasculitis (disorder)'),('vasculitis',1,'988101000000109',NULL,'Vasculitis co-occurrent and due to Hepatitis B virus infection (disorder)'),('vasculitis',1,'988081000000103',NULL,'Antineutrophil cytoplasmic antibody associated vasculitis caused by drug (disorder)'),('vasculitis',1,'988111000000106',NULL,'Cryoglobulinaemic vasculitis co-occurrent and due to Hepatitis C virus infection (disorder)'),('vasculitis',1,'233948000',NULL,'Pulmonary hypertension in vasculitis'),('vasculitis',1,'703355003',NULL,'Pulmonary hypertension due to vasculitis (disorder)'),('vasculitis',1,'404658009',NULL,'Optic disc vasculitis'),('vasculitis',1,'193177003',NULL,'Polyneuropathy in collagen vascular disease (disorder)'),('vasculitis',1,'472974007',NULL,'History of vasculitis');
INSERT INTO #codessnomed
VALUES ('egfr',1,'1011481000000105',NULL,'eGFR (estimated glomerular filtration rate) using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1011491000000107',NULL,'eGFR (estimated glomerular filtration rate) using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1020291000000106',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'1107411000000104',NULL,'eGFR (estimated glomerular filtration rate) by laboratory calculation'),('egfr',1,'241373003',NULL,'Technetium-99m-diethylenetriamine pentaacetic acid clearance - glomerular filtration rate (procedure)'),('egfr',1,'262300005',NULL,'With glomerular filtration rate'),('egfr',1,'737105002',NULL,'GFR (glomerular filtration rate) calculation technique'),('egfr',1,'80274001',NULL,'Glomerular filtration rate (observable entity)'),('egfr',1,'996231000000108',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'857971000000104',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula (observable entity)'),('egfr',1,'963601000000106',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation (observable entity)'),('egfr',1,'963611000000108',NULL,'Estimated glomerular filtration rate using cystatin C per 1.73 square metres'),('egfr',1,'963621000000102',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation (observable entity)'),('egfr',1,'963631000000100',NULL,'Estimated glomerular filtration rate using serum creatinine per 1.73 square metres'),('egfr',1,'857981000000102',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres');
INSERT INTO #codessnomed
VALUES ('urinary-albumin-creatinine-ratio',1,'144011000',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'144765005',NULL,'Urine albumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'144766006',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'166721005',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'167540008',NULL,'Urine albumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'167541007',NULL,'Urine microalbumin:creatinine ratio (& level)'),('urinary-albumin-creatinine-ratio',1,'250745003',NULL,'Albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'271075006',NULL,'Urine albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'271076007',NULL,'Urine microalbumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'149861000000104',NULL,'Semi-quantitative result of albumin to creatinine ratio in urine by test strip'),('urinary-albumin-creatinine-ratio',1,'1023491000000104',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'1027791000000103',NULL,'Urine microalbumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'1028271000000109',NULL,'Albumin/creatinine ratio')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesemis
VALUES ('dementia',1,'^ESCTAC697343',NULL,'Acquired immune deficiency syndrome-related dementia'),('dementia',1,'^ESCTAC697346',NULL,'Acquired immune deficiency syndrome dementia complex'),('dementia',1,'^ESCTAD697345',NULL,'ADC - Acquired immune deficiency syndrome dementia complex'),('dementia',1,'^ESCTAI697344',NULL,'AIDS - Acquired immune deficiency syndrome dementia complex'),('dementia',1,'^ESCTDE697342',NULL,'Dementia associated with AIDS'),('dementia',1,'^ESCTDE697347',NULL,'Dementia associated with acquired immunodeficiency syndrome'),('dementia',1,'EMISICD10|F0000',NULL,'Dementia in Alzheimers disease with early onset, without additional symptoms'),('dementia',1,'EMISICD10|F0001',NULL,'Dementia in Alzheimers disease with early onset, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0002',NULL,'Dementia in Alzheimers disease with early onset, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0003',NULL,'Dementia in Alzheimers disease with early onset, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0004',NULL,'Dementia in Alzheimers disease with early onset, other mixed symptoms'),('dementia',1,'EMISICD10|F0010',NULL,'Dementia in Alzheimers disease with late onset, without additional symptoms'),('dementia',1,'EMISICD10|F0011',NULL,'Dementia in Alzheimers disease with late onset, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0012',NULL,'Dementia in Alzheimers disease with late onset, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0013',NULL,'Dementia in Alzheimers disease with late onset, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0014',NULL,'Dementia in Alzheimers disease with late onset, other mixed symptoms'),('dementia',1,'EMISICD10|F0020',NULL,'Dementia in Alzheimers dis, atypical or mixed type, without additional symptoms'),('dementia',1,'EMISICD10|F0021',NULL,'Dementia in Alzheimers dis, atypical or mixed type, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0022',NULL,'Dementia in Alzheimers dis, atypical or mixed type, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0023',NULL,'Dementia in Alzheimers dis, atypical or mixed type, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0024',NULL,'Dementia in Alzheimers dis, atypical or mixed type, other mixed symptoms'),('dementia',1,'EMISICD10|F0090',NULL,'Dementia in Alzheimers disease, unspecified, without additional symptoms'),('dementia',1,'EMISICD10|F0091',NULL,'Dementia in Alzheimers disease, unspecified, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0092',NULL,'Dementia in Alzheimers disease, unspecified, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0093',NULL,'Dementia in Alzheimers disease, unspecified, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0094',NULL,'Dementia in Alzheimers disease, unspecified, other mixed symptoms'),('dementia',1,'EMISICD10|F0100',NULL,'Vascular dementia of acute onset, without additional symptoms'),('dementia',1,'EMISICD10|F0101',NULL,'Vascular dementia of acute onset, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0102',NULL,'Vascular dementia of acute onset, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0103',NULL,'Vascular dementia of acute onset, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0104',NULL,'Vascular dementia of acute onset, other mixed symptoms'),('dementia',1,'EMISICD10|F0110',NULL,'Multi-infarct dementia, without additional symptoms'),('dementia',1,'EMISICD10|F0111',NULL,'Multi-infarct dementia, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0112',NULL,'Multi-infarct dementia, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0113',NULL,'Multi-infarct dementia, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0114',NULL,'Multi-infarct dementia, other mixed symptoms'),('dementia',1,'EMISICD10|F0120',NULL,'Subcortical vascular dementia, without additional symptoms'),('dementia',1,'EMISICD10|F0121',NULL,'Subcortical vascular dementia, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0122',NULL,'Subcortical vascular dementia, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0123',NULL,'Subcortical vascular dementia, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0124',NULL,'Subcortical vascular dementia, other mixed symptoms'),('dementia',1,'EMISICD10|F0130',NULL,'Mixed cortical and subcortical vascular dementia, without additional symptoms'),('dementia',1,'EMISICD10|F0131',NULL,'Mixed cortical and subcortical vascular dementia, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0132',NULL,'Mixed cortical and subcortical vascular dementia, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0133',NULL,'Mixed cortical and subcortical vascular dementia, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0134',NULL,'Mixed cortical and subcortical vascular dementia, other mixed symptoms'),('dementia',1,'EMISICD10|F0180',NULL,'Other vascular dementia, without additional symptoms'),('dementia',1,'EMISICD10|F0181',NULL,'Other vascular dementia, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0182',NULL,'Other vascular dementia, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0183',NULL,'Other vascular dementia, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0184',NULL,'Other vascular dementia, other mixed symptoms'),('dementia',1,'EMISICD10|F0190',NULL,'Vascular dementia, unspecified, without additional symptoms'),('dementia',1,'EMISICD10|F0191',NULL,'Vascular dementia, unspecified, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F0192',NULL,'Vascular dementia, unspecified, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F0193',NULL,'Vascular dementia, unspecified, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F0194',NULL,'Vascular dementia, unspecified, other mixed symptoms'),('dementia',1,'EMISICD10|F03X0',NULL,'Unspecified dementia, without additional symptoms'),('dementia',1,'EMISICD10|F03X1',NULL,'Unspecified dementia, other symptoms, predominantly delusional'),('dementia',1,'EMISICD10|F03X2',NULL,'Unspecified dementia, other symptoms, predominantly hallucinatory'),('dementia',1,'EMISICD10|F03X3',NULL,'Unspecified dementia, other symptoms, predominantly depressive'),('dementia',1,'EMISICD10|F03X4',NULL,'Unspecified dementia, other mixed symptoms'),('dementia',1,'^ESCT1171773',NULL,'Predominantly cortical dementia'),('dementia',1,'^ESCT1381019',NULL,'SDLT - senile dementia of Lewy body type'),('dementia',1,'^ESCT1407776',NULL,'Senile Lewy body dementia'),('dementia',1,'^ESCTAL250298',NULL,'Alcohol-induced persisting dementia'),('dementia',1,'^ESCTAL293125',NULL,'Alzheimer dementia'),('dementia',1,'^ESCTAM500542',NULL,'Amyotrophic lateral sclerosis with dementia'),('dementia',1,'^ESCTBI396461',NULL,'Binswangers dementia'),('dementia',1,'^ESCTBO500582',NULL,'Boxers dementia'),('dementia',1,'^ESCTBU828470',NULL,'Butterfly Scheme for dementia declined'),('dementia',1,'^ESCTDE250297',NULL,'Dementia associated with alcoholism'),('dementia',1,'^ESCTDE380265',NULL,'Dementia of the Lewy body type'),('dementia',1,'^ESCTDE500577',NULL,'Dementia due to head trauma'),('dementia',1,'^ESCTDE500580',NULL,'Dementia pugilistica'),('dementia',1,'^ESCTDE561826',NULL,'Dementia of frontal lobe type'),('dementia',1,'^ESCTDE689724',NULL,'Dementia of the Alzheimers type with early onset'),('dementia',1,'^ESCTDE689727',NULL,'Dementia in Alzheimers disease - type 2'),('dementia',1,'^ESCTDE690020',NULL,'Dementia of the Alzheimers type, late onset'),('dementia',1,'^ESCTDE690024',NULL,'Dementia in Alzheimers disease - type 1'),('dementia',1,'^ESCTDE704365',NULL,'Dementia associated with Parkinsons Disease'),('dementia',1,'^ESCTDE704366',NULL,'Dementia associated with Parkinson Disease'),('dementia',1,'^ESCTDE710360',NULL,'Dementia due to Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTDE726301',NULL,'Dementia due to Huntington disease'),('dementia',1,'^ESCTDE726302',NULL,'Dementia due to Huntingtons disease'),('dementia',1,'^ESCTDE800952',NULL,'Dementia due to Picks disease'),('dementia',1,'^ESCTDE800953',NULL,'Dementia due to Pick disease'),('dementia',1,'^ESCTDE800954',NULL,'Dementia co-occurrent and due to Picks disease'),('dementia',1,'^ESCTDF561827',NULL,'DFT - Dementia frontal lobe type'),('dementia',1,'^ESCTEP786368',NULL,'Epilepsy co-occurrent and due to dementia'),('dementia',1,'^ESCTEP786369',NULL,'Epileptic dementia'),('dementia',1,'^ESCTEP786370',NULL,'Epilepsy with dementia'),('dementia',1,'^ESCTFR500560',NULL,'Frontotemporal dementia'),('dementia',1,'^ESCTHI453987',NULL,'History of dementia'),('dementia',1,'^ESCTLA499781',NULL,'Language disorder of dementia'),('dementia',1,'^ESCTLE602407',NULL,'Lewy body dementia'),('dementia',1,'^ESCTMI341423',NULL,'MID - Multi-infarct dementia'),('dementia',1,'^ESCTMU341426',NULL,'Multi infarct dementia'),('dementia',1,'^ESCTOR335044',NULL,'Organic dementia'),('dementia',1,'^ESCTPA351118',NULL,'Parkinson-dementia complex of Guam'),('dementia',1,'^ESCTPA351119',NULL,'Parkinsons disease - dementia complex on Guam'),('dementia',1,'^ESCTPA500588',NULL,'Patchy dementia'),('dementia',1,'^ESCTPA828469',NULL,'Participates in Butterfly Scheme for dementia'),('dementia',1,'^ESCTPO500575',NULL,'Post-traumatic dementia'),('dementia',1,'^ESCTPR689721',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset'),('dementia',1,'^ESCTPR689722',NULL,'Primary degenerative dementia of the Alzheimer type, early onset'),('dementia',1,'^ESCTPR689725',NULL,'Presenile dementia, Alzheimers type'),
('dementia',1,'^ESCTPR690018',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset'),('dementia',1,'^ESCTPR690019',NULL,'Primary degenerative dementia of the Alzheimer type, late onset'),('dementia',1,'^ESCTPR801011',NULL,'Primary degenerative dementia'),('dementia',1,'^ESCTSD274844',NULL,'SD - Senile dementia'),('dementia',1,'^ESCTSD380263',NULL,'SDLT - Senile dementia of the Lewy body type'),('dementia',1,'^ESCTSD690022',NULL,'SDAT - Senile dementia, Alzheimers type'),('dementia',1,'^ESCTSE500587',NULL,'Semantic dementia'),('dementia',1,'^ESCTSE602406',NULL,'Senile dementia of the Lewy body type'),('dementia',1,'^ESCTSE634806',NULL,'Senile dementia with psychosis'),('dementia',1,'^ESCTSU396466',NULL,'Subcortical atherosclerotic dementia'),('dementia',1,'^ESCTTR251100',NULL,'Transmissible virus dementia'),('dementia',1,'^ESCTVA341425',NULL,'VAD - Vascular dementia'),('dementia',1,'EMISNQDE41',NULL,'Dementia monitoring in primary care'),('dementia',1,'EMISNQDE42',NULL,'Dementia monitoring in secondary care'),('dementia',1,'^ESCTAD293123',NULL,'AD - Alzheimers disease'),('dementia',1,'^ESCTAL293124',NULL,'Alzheimer disease'),('dementia',1,'^ESCTFA500550',NULL,'Familial Alzheimers disease of early onset'),('dementia',1,'^ESCTFA500551',NULL,'Familial Alzheimer disease of early onset'),('dementia',1,'^ESCTFA500554',NULL,'Familial Alzheimers disease of late onset'),('dementia',1,'^ESCTFA500555',NULL,'Familial Alzheimer disease of late onset'),('dementia',1,'^ESCTFO500558',NULL,'Focal Alzheimers disease'),('dementia',1,'^ESCTFO500559',NULL,'Focal Alzheimer disease'),('dementia',1,'^ESCTLE380262',NULL,'Lewy body variant of Alzheimers disease'),('dementia',1,'^ESCTNO500552',NULL,'Non-familial Alzheimers disease of early onset'),('dementia',1,'^ESCTNO500553',NULL,'Non-familial Alzheimer disease of early onset'),('dementia',1,'^ESCTNO500556',NULL,'Non-familial Alzheimers disease of late onset'),('dementia',1,'^ESCTNO500557',NULL,'Non-familial Alzheimer disease of late onset'),('dementia',1,'^ESCTPR500571',NULL,'Progressive aphasia in Alzheimers disease'),('dementia',1,'^ESCTPR500572',NULL,'Progressive aphasia in Alzheimer disease'),('dementia',1,'^ESCTCE476898',NULL,'Cerebral degeneration due to Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTCJ251098',NULL,'CJD - Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTCR251095',NULL,'Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTCR251101',NULL,'Creutzfeldt Jakob disease'),('dementia',1,'^ESCTCR393867',NULL,'Creutzfeldt-Jakob agent'),('dementia',1,'^ESCTCR393869',NULL,'Creutzfeldt-Jakob disease agent'),('dementia',1,'^ESCTCR593165',NULL,'Creutzfeldt-Jakob variant disease'),('dementia',1,'^ESCTJA393868',NULL,'Jakob-Creutzfeldt agent'),('dementia',1,'^ESCTJC251099',NULL,'JCD - Jakob-Creutzfeldt disease'),('dementia',1,'^ESCTNV593163',NULL,'nvCJD - New variant of Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTPR839987',NULL,'Prion protein markers for CJD (Creutzfeldt-Jakob disease)'),('dementia',1,'^ESCTSP769925',NULL,'Sporadic Jakob-Creutzfeldt disease'),('dementia',1,'^ESCTVC593164',NULL,'vCJD - variant Creutzfeldt-Jakob disease'),('dementia',1,'EMISNQSP44',NULL,'Sporadic Creutzfeldt-Jakob disease'),('dementia',1,'EMISNQVA13',NULL,'Variant Creutzfeldt-Jakob disease'),('dementia',1,'^ESCT1407239',NULL,'Picks disease'),('dementia',1,'^ESCT1407240',NULL,'Picks disease'),('dementia',1,'^ESCTAL363017',NULL,'Alcoholic amnestic syndrome'),('dementia',1,'^ESCTAL368893',NULL,'Alcohol-induced persisting amnestic disorder'),('dementia',1,'^ESCTAM363010',NULL,'Amnestic syndrome of Wernickes disease'),('dementia',1,'^ESCTAM363016',NULL,'Amnesic syndrome due to alcohol'),('dementia',1,'^ESCTAR500573',NULL,'Argyrophilic grain disease'),('dementia',1,'^ESCTBO361688',NULL,'Bovine spongiform encephalopathy agent'),('dementia',1,'^ESCTCE476900',NULL,'Cerebral degeneration due to progressive multifocal leukoencephalopathy'),('dementia',1,'^ESCTCH396467',NULL,'Chronic progressive subcortical encephalopathy'),('dementia',1,'^ESCTCI270765',NULL,'Circumscribed cerebral atrophy'),('dementia',1,'^ESCTCL380268',NULL,'CLBD - Cortical Lewy body disease'),('dementia',1,'^ESCTCO380267',NULL,'Cortical Lewy body disease'),('dementia',1,'^ESCTDL380266',NULL,'DLBD - Diffuse Lewy body disease'),('dementia',1,'^ESCTEN396462',NULL,'Encephalitis subcorticalis chronica'),('dementia',1,'^ESCTFR500567',NULL,'Frontal lobe degeneration with motor neurone disease'),('dementia',1,'^ESCTFR561823',NULL,'Frontal lobe degeneration'),('dementia',1,'^ESCTGE359182',NULL,'Gerstmann-Straussler-Scheinker syndrome'),('dementia',1,'^ESCTGS359183',NULL,'GSS - Gerstmann-Straussler-Scheinker syndrome'),('dementia',1,'^ESCTKO277383',NULL,'Korsakovs syndrome - non-alcoholic'),('dementia',1,'^ESCTKO363012',NULL,'Korsakoff psychosis'),('dementia',1,'^ESCTKO363014',NULL,'Korsakov syndrome - alcoholic'),('dementia',1,'^ESCTKO363015',NULL,'Korsakov psychosis'),('dementia',1,'^ESCTKO476314',NULL,'Korsakov alcoholic psychosis with peripheral neuritis'),('dementia',1,'^ESCTLB380264',NULL,'LBD - Lewy body disease'),('dementia',1,'^ESCTLO500566',NULL,'Lobar atrophy'),('dementia',1,'^ESCTNO277380',NULL,'Non-alcoholic Korsakoffs psychosis'),('dementia',1,'^ESCTNO277384',NULL,'Non-alcoholic Korsakoff psychosis'),('dementia',1,'^ESCTPI270766',NULL,'Pick disease'),('dementia',1,'^ESCTPI270767',NULL,'Picks disease'),('dementia',1,'^ESCTPI500561',NULL,'Picks disease with Pick bodies'),('dementia',1,'^ESCTPI500562',NULL,'Pick disease with Pick bodies'),('dementia',1,'^ESCTPI500563',NULL,'Picks disease with Pick cells and no Pick bodies'),('dementia',1,'^ESCTPI500564',NULL,'Pick disease with Pick cells and no Pick bodies'),('dementia',1,'^ESCTPO500576',NULL,'Post-traumatic brain syndrome'),('dementia',1,'^ESCTPR282554',NULL,'Prion disease'),('dementia',1,'^ESCTPU500578',NULL,'Punch drunk syndrome'),('dementia',1,'^ESCTPU500579',NULL,'Punchdrunk encephalopathy'),('dementia',1,'^ESCTPU500581',NULL,'Punch drunk'),('dementia',1,'^ESCTSE476308',NULL,'Senile delirium'),('dementia',1,'^ESCTSP500583',NULL,'Spongiform encephalopathy'),('dementia',1,'^ESCTSU251097',NULL,'Subacute spongiform encephalopathy'),('dementia',1,'^ESCTSU396459',NULL,'Subcortical leucoencephalopathy'),('dementia',1,'^ESCTSU396460',NULL,'Subcortical leukoencephalopathy'),('dementia',1,'^ESCTSU396465',NULL,'Subcortical arteriosclerotic encephalopathy'),('dementia',1,'^ESCTTR500574',NULL,'Traumatic encephalopathy'),('dementia',1,'^ESCTWE363009',NULL,'Wernicke-Korsakoff syndrome'),('dementia',1,'^ESCT1164104',NULL,'Dementia following injury caused by exposure to ionising radiation'),('dementia',1,'^ESCT1164105',NULL,'Postradiation dementia'),('dementia',1,'^ESCT1164106',NULL,'Dementia following injury caused by exposure to ionizing radiation'),('dementia',1,'^ESCT1169048',NULL,'Dementia due to prion disease'),('dementia',1,'^ESCT1169049',NULL,'Dementia due to and following injury of head'),('dementia',1,'^ESCT1169441',NULL,'Subcortical dementia'),('dementia',1,'^ESCT1171771',NULL,'Presenile dementia with psychosis'),('dementia',1,'^ESCT1171774',NULL,'Predominantly cortical vascular dementia'),('dementia',1,'^ESCT1191489',NULL,'[X]Dementia in Alzheimers dis, atypical or mixed type'),('dementia',1,'^ESCT1237064',NULL,'Dementia with mixed etiology'),('dementia',1,'^ESCT1237065',NULL,'MVAD - Mixed vascular Alzheimer dementia'),('dementia',1,'^ESCT1237066',NULL,'Dementia with mixed aetiology'),('dementia',1,'^ESCT1353008',NULL,'PRKAR1B-related neurodegenerative dementia with intermediate filaments'),('dementia',1,'^ESCT1353009',NULL,'Protein kinase cAMP-dependent type I regulatory subunit beta-related neurodegenerative dementia with intermediate filaments'),('dementia',1,'^ESCT1362778',NULL,'Familial dementia British type'),('dementia',1,'^ESCT1362879',NULL,'Familial dementia Danish type'),('dementia',1,'^ESCT1390962',NULL,'Aggression due to dementia'),('dementia',1,'^ESCT1390963',NULL,'Aggression in dementia'),('dementia',1,'^ESCT1390964',NULL,'Agitation due to dementia'),('dementia',1,'^ESCT1390965',NULL,'Agitation in dementia'),('dementia',1,'^ESCT1391007',NULL,'Dementia caused by volatile inhalant'),('dementia',1,'^ESCT1391008',NULL,'Dementia due to pellagra'),('dementia',1,'^ESCT1391306',NULL,'Disinhibited behaviour due to dementia'),('dementia',1,'^ESCT1393438',NULL,'Cortical vascular dementia'),('dementia',1,'^ESCT1393718',NULL,'Amyotrophic lateral sclerosis, parkinsonism, dementia complex'),('dementia',1,'^ESCT1393719',NULL,'Amyotrophic lateral sclerosis, parkinsonism, dementia of Guam syndrome'),('dementia',1,'^ESCT1393722',NULL,'PDALS (parkinsonism, dementia, amyotrophic lateral sclerosis) complex'),('dementia',1,'^ESCT1394318',NULL,'Classical sporadic Creutzfeldt-Jakob disease'),('dementia',1,'^ESCT1394341',NULL,'Dementia due to carbon monoxide poisoning'),('dementia',1,'^ESCT1394342',NULL,'Dementia due to iron deficiency'),('dementia',1,'^ESCT1395118',NULL,'Creutzfeldt-Jakob Disease caused by human growth hormone'),('dementia',1,'^ESCT1395119',NULL,'Human-growth hormone ingestion-related Creutzfeldt-Jakob Disease'),('dementia',1,'^ESCT1409128',NULL,'Dementia with progressive multifocal leucoencephalopathy'),('dementia',1,'^ESCT1409129',NULL,'Dementia co-occurrent and due to progressive multifocal leucoencephalopathy'),('dementia',1,'^ESCT1409378',NULL,'Familial British dementia with amyloid angiopathy'),('dementia',1,'^ESCTAC781444',NULL,'Acquired prion disease'),('dementia',1,'^ESCTAG324065',NULL,'Age-related degeneration of brain'),('dementia',1,'^ESCTAL266745',NULL,'Alzheimers dementia, early onset, with depressed mood'),('dementia',1,'^ESCTAL292995',NULL,'Alzheimers dementia, late onset, with depressive mood'),('dementia',1,'^ESCTAL339290',NULL,'Alzheimers dementia, late onset, with delusions'),('dementia',1,'^ESCTAL802462',NULL,'Altered behaviour co-occurrent and due to Picks disease'),
('dementia',1,'^ESCTAL802463',NULL,'Altered behavior co-occurrent and due to Picks disease'),('dementia',1,'^ESCTAL802464',NULL,'Altered behaviour in Huntingtons dementia'),('dementia',1,'^ESCTAL802465',NULL,'Altered behavior in Huntingtons dementia'),('dementia',1,'^ESCTAL802466',NULL,'Altered behavior in dementia due to Huntington chorea'),('dementia',1,'^ESCTAL803079',NULL,'Altered behaviour in Alzheimers disease'),('dementia',1,'^ESCTAL803080',NULL,'Altered behavior in Alzheimers disease'),('dementia',1,'^ESCTAL803081',NULL,'Altered behavior in Alzheimer disease'),('dementia',1,'^ESCTAL803082',NULL,'Altered behavior in Alzheimers disease'),('dementia',1,'^ESCTAL804495',NULL,'Alzheimers dementia with depressed mood'),('dementia',1,'^ESCTAL804498',NULL,'Alzheimers disease co-occurrent with delirium'),('dementia',1,'^ESCTAM416492',NULL,'Amelocerebrohypohidrotic syndrome'),('dementia',1,'^ESCTBE775512',NULL,'Behavioural variant of frontotemporal dementia'),('dementia',1,'^ESCTBE775513',NULL,'Behavioral variant of frontotemporal dementia'),('dementia',1,'^ESCTBE989613',NULL,'Behavioural disturbance co-occurrent and due to late onset Alzheimer dementia'),('dementia',1,'^ESCTBE989614',NULL,'Behavioral disturbance co-occurrent and due to late onset Alzheimer dementia'),('dementia',1,'^ESCTCH755962',NULL,'CHMP2B-related frontotemporal dementia'),('dementia',1,'^ESCTCH755964',NULL,'Chromosome 3-linked frontotemporal dementia'),('dementia',1,'^ESCTDE257574',NULL,'Dementia of the Alzheimers type, with late onset, with delirium'),('dementia',1,'^ESCTDE257575',NULL,'Dementia Alzheimers type, late onset with delirium'),('dementia',1,'^ESCTDE260328',NULL,'Dementia of the Alzheimers type, with early onset, uncomplicated'),('dementia',1,'^ESCTDE266744',NULL,'Dementia of the Alzheimers type, with early onset, with depressive mood'),('dementia',1,'^ESCTDE292994',NULL,'Dementia of the Alzheimers type, with late onset, with depressive mood'),('dementia',1,'^ESCTDE338438',NULL,'Dementia of the Alzheimers type, with early onset, with delusions'),('dementia',1,'^ESCTDE339289',NULL,'Dementia of the Alzheimers type, with late onset, with delusions'),('dementia',1,'^ESCTDE355841',NULL,'Dementia of the Alzheimers type, with early onset, with delirium'),('dementia',1,'^ESCTDE357505',NULL,'Dementia of the Alzheimers type, with late onset, uncomplicated'),('dementia',1,'^ESCTDE384966',NULL,'Dementia paralytica juvenilis'),('dementia',1,'^ESCTDE751072',NULL,'Dementia associated with cerebral lipidosis'),('dementia',1,'^ESCTDE751073',NULL,'Dementia associated with normal pressure hydrocephalus'),('dementia',1,'^ESCTDE751074',NULL,'Dementia associated with multiple sclerosis'),('dementia',1,'^ESCTDE751196',NULL,'Dementia associated with neurosyphilis'),('dementia',1,'^ESCTDE751197',NULL,'Dementia associated with viral encephalitis'),('dementia',1,'^ESCTDE751279',NULL,'Dementia associated with cerebral anoxia'),('dementia',1,'^ESCTDE751507',NULL,'Dementia in remission'),('dementia',1,'^ESCTDE771038',NULL,'Dementia co-occurrent with human immunodeficiency virus infection'),('dementia',1,'^ESCTDE783882',NULL,'Dementia co-occurrent and due to neurocysticercosis'),('dementia',1,'^ESCTDE783883',NULL,'Dementia caused by toxin'),('dementia',1,'^ESCTDE783884',NULL,'Dementia due to metabolic abnormality'),('dementia',1,'^ESCTDE783885',NULL,'Dementia due to chromosomal anomaly'),('dementia',1,'^ESCTDE786113',NULL,'Dementia due to disorder of central nervous system'),('dementia',1,'^ESCTDE786114',NULL,'Dementia due to infectious disease'),('dementia',1,'^ESCTDE787476',NULL,'Delirium co-occurrent with dementia'),('dementia',1,'^ESCTDE787477',NULL,'Delirium superimposed on dementia'),('dementia',1,'^ESCTDE795509',NULL,'Dementia caused by heavy metal exposure'),('dementia',1,'^ESCTDE795510',NULL,'Dementia due to primary malignant neoplasm of brain'),('dementia',1,'^ESCTDE795511',NULL,'Dementia due to chronic subdural haematoma'),('dementia',1,'^ESCTDE795512',NULL,'Dementia due to chronic subdural hematoma'),('dementia',1,'^ESCTDE795513',NULL,'Dementia due to herpes encephalitis'),('dementia',1,'^ESCTDE795514',NULL,'Dementia with progressive multifocal leukoencephalopathy'),('dementia',1,'^ESCTDE795515',NULL,'Dementia co-occurrent and due to progressive multifocal leukoencephalopathy'),('dementia',1,'^ESCTDE795516',NULL,'Dementia with Down syndrome'),('dementia',1,'^ESCTDE795517',NULL,'Dementia co-occurrent and due to Down syndrome'),('dementia',1,'^ESCTDE796928',NULL,'Dementia of the Alzheimer type with behavioural disturbance'),('dementia',1,'^ESCTDE796929',NULL,'Dementia of the Alzheimer type with behavioral disturbance'),('dementia',1,'^ESCTDE796937',NULL,'Dementia with behavioural disturbance'),('dementia',1,'^ESCTDE796938',NULL,'Dementia with behavioral disturbance'),('dementia',1,'^ESCTDE802467',NULL,'Dementia due to multiple sclerosis with altered behaviour'),('dementia',1,'^ESCTDE802468',NULL,'Dementia due to multiple sclerosis with altered behavior'),('dementia',1,'^ESCTDE803175',NULL,'Dementia due to Parkinsons disease'),('dementia',1,'^ESCTDE803176',NULL,'Dementia due to Parkinsons disease'),('dementia',1,'^ESCTDE803177',NULL,'Dementia due to Parkinson disease'),('dementia',1,'^ESCTDE804101',NULL,'Dementia due to Retts syndrome'),('dementia',1,'^ESCTDE804491',NULL,'Delusions in Alzheimers disease'),('dementia',1,'^ESCTDE804492',NULL,'Delusions in Alzheimers disease'),('dementia',1,'^ESCTDE804493',NULL,'Delusions in Alzheimer disease'),('dementia',1,'^ESCTDE804494',NULL,'Depressed mood in Alzheimers disease'),('dementia',1,'^ESCTDE804496',NULL,'Depressed mood in Alzheimer disease'),('dementia',1,'^ESCTDI264906',NULL,'Dialysis dementia'),('dementia',1,'^ESCTDI264907',NULL,'Dialysis encephalopathy syndrome'),('dementia',1,'^ESCTDI264908',NULL,'Dialysis encephalopathy'),('dementia',1,'^ESCTEA801440',NULL,'Early onset dementia with delusions'),('dementia',1,'^ESCTEA803291',NULL,'Early onset Alzheimers disease with behavioural disturbance'),('dementia',1,'^ESCTEA803292',NULL,'Early onset Alzheimers disease with behavioral disturbance'),('dementia',1,'^ESCTEA803293',NULL,'Early onset Alzheimers disease with behavioral disturbance'),('dementia',1,'^ESCTEA803294',NULL,'Early onset Alzheimer disease with behavioral disturbance'),('dementia',1,'^ESCTEP416490',NULL,'Epilepsy, dementia and amelogenesis imperfecta'),('dementia',1,'^ESCTEP416491',NULL,'Epilepsy, mental deterioration and yellow teeth'),('dementia',1,'^ESCTEP802469',NULL,'Epileptic dementia with behavioural disturbance'),('dementia',1,'^ESCTEP802470',NULL,'Epileptic dementia with behavioral disturbance'),('dementia',1,'^ESCTFA385338',NULL,'Fatal familial insomnia'),('dementia',1,'^ESCTFA385340',NULL,'Familial fatal insomnia'),('dementia',1,'^ESCTFA756028',NULL,'Familial encephalopathy with neuroserpin inclusion bodies'),('dementia',1,'^ESCTFA756029',NULL,'Familial dementia with neuroserpin inclusion bodies'),('dementia',1,'^ESCTFA756054',NULL,'Familial Picks disease'),('dementia',1,'^ESCTFA773790',NULL,'Familial Creutzfeldt-Jakob'),('dementia',1,'^ESCTFA781383',NULL,'Familial Alzheimer-like prion disease'),('dementia',1,'^ESCTFC773791',NULL,'fCJD (Familial Creutzfeldt-Jakob disease)'),('dementia',1,'^ESCTFF385339',NULL,'FFI - Familial fatal insomnia'),('dementia',1,'^ESCTFR755963',NULL,'Frontotemporal dementia with gene located on 3p11'),('dementia',1,'^ESCTFR756041',NULL,'Frontotemporal lobar degeneration'),('dementia',1,'^ESCTFR756053',NULL,'Frontotemporal dementia with parkinsonism-17'),('dementia',1,'^ESCTFT756057',NULL,'FTDP-17 - Frontotemporal dementia with parkinsonism 17'),('dementia',1,'^ESCTGR756039',NULL,'GRN-related frontotemporal dementia'),('dementia',1,'^ESCTHA797312',NULL,'Hallucinations co-occurrent and due to late onset dementia'),('dementia',1,'^ESCTHE756040',NULL,'Hereditary dysphasic disinhibition dementia'),('dementia',1,'^ESCTIA773559',NULL,'Iatrogenic Jakob-Creutzfeldt disease'),('dementia',1,'^ESCTIA773560',NULL,'Iatrogenic Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTIB757762',NULL,'IBMPFD - Inclusion body myopathy with early onset Paget disease and frontotemporal dementia'),('dementia',1,'^ESCTIN302942',NULL,'Inhalant-induced persisting dementia'),('dementia',1,'^ESCTIN757757',NULL,'Inclusion body myopathy with early-onset Paget disease and frontotemporal dementia'),('dementia',1,'^ESCTIN773792',NULL,'Inherited Creutzfeldt-Jakob disease'),('dementia',1,'^ESCTIS784063',NULL,'Ischaemic vascular dementia'),('dementia',1,'^ESCTIS784064',NULL,'Ischemic vascular dementia'),('dementia',1,'^ESCTMI802420',NULL,'Mixed dementia'),('dementia',1,'^ESCTMU266460',NULL,'Multi-infarct dementia with delirium'),('dementia',1,'^ESCTMU266462',NULL,'Multi infarct dementia with delirium'),('dementia',1,'^ESCTMU272293',NULL,'Multi-infarct dementia with depression'),('dementia',1,'^ESCTMU291232',NULL,'Multi-infarct dementia with delusions'),('dementia',1,'^ESCTMU291234',NULL,'Multi infarct dementia with delusions'),('dementia',1,'^ESCTMU365367',NULL,'Multi-infarct dementia, uncomplicated'),('dementia',1,'^ESCTMU365369',NULL,'Multi infarct dementia, uncomplicated'),('dementia',1,'^ESCTMU803324',NULL,'Multi-infarct dementia due to atherosclerosis'),('dementia',1,'^ESCTMU803325',NULL,'Multi infarct dementia with atherosclerosis'),('dementia',1,'^ESCTNO783407',NULL,'Non-amnestic Alzheimer disease'),('dementia',1,'^ESCTOR695730',NULL,'Organic dementia associated with AIDS'),('dementia',1,'^ESCTOR695731',NULL,'Organic dementia associated with acquired immunodeficiency syndrome'),('dementia',1,'^ESCTPA773701',NULL,'Parkinsonism with dementia of Guadeloupe'),('dementia',1,'^ESCTPA773702',NULL,'Parkinsonism co-occurrent with dementia of Guadeloupe'),('dementia',1,'^ESCTPO751142',NULL,'Post-traumatic dementia with behavioural change'),('dementia',1,'^ESCTPO751143',NULL,'Post-traumatic dementia with behavioral change'),
('dementia',1,'^ESCTPR257573',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with delirium'),('dementia',1,'^ESCTPR260327',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, uncomplicated'),('dementia',1,'^ESCTPR266743',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with depression'),('dementia',1,'^ESCTPR292993',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with depression'),('dementia',1,'^ESCTPR338437',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with delusions'),('dementia',1,'^ESCTPR339288',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, with delusions'),('dementia',1,'^ESCTPR355840',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset, with delirium'),('dementia',1,'^ESCTPR357504',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset, uncomplicated'),('dementia',1,'^ESCTPR696469',NULL,'Presenile dementia associated with AIDS'),('dementia',1,'^ESCTPR696470',NULL,'Presenile dementia associated with acquired immunodeficiency syndrome'),('dementia',1,'^ESCTPR751512',NULL,'Primary degenerative dementia of the Alzheimer type, senile onset in remission'),('dementia',1,'^ESCTPR751513',NULL,'Primary degenerative dementia of the Alzheimer type, presenile onset in remission'),('dementia',1,'^ESCTPR770469',NULL,'Presenile dementia co-occurrent with human immunodeficiency virus infection'),('dementia',1,'^ESCTPR801439',NULL,'Presenile dementia with delusions'),('dementia',1,'^ESCTPS419613',NULL,'Psychoactive substance-induced organic dementia'),('dementia',1,'^ESCTPS419614',NULL,'Psychoactive substance induced dementia'),('dementia',1,'^ESCTRA784352',NULL,'Rapidly progressive dementia'),('dementia',1,'^ESCTRI775042',NULL,'Right temporal atrophy variant frontotemporal dementia'),('dementia',1,'^ESCTSE634803',NULL,'Senile dementia with delusion'),('dementia',1,'^ESCTSE634804',NULL,'Senile delusion'),('dementia',1,'^ESCTVA266461',NULL,'Vascular dementia, with delirium'),('dementia',1,'^ESCTVA272294',NULL,'Vascular dementia, with depressive mood'),('dementia',1,'^ESCTVA291233',NULL,'Vascular dementia, with delusions'),('dementia',1,'^ESCTVA365368',NULL,'Vascular dementia, uncomplicated'),('dementia',1,'^ESCTVA751506',NULL,'Vascular dementia in remission'),('dementia',1,'^ESCTVA808923',NULL,'Vascular dementia with behavioural disturbance'),('dementia',1,'^ESCTVA808924',NULL,'Vascular dementia with behavioral disturbance'),('dementia',1,'^ESCTVA990225',NULL,'Vascular dementia without behavioural disturbance'),('dementia',1,'^ESCTVA990226',NULL,'Vascular dementia without behavioral disturbance');
INSERT INTO #codesemis
VALUES ('egfr',1,'^ESCT1167392',NULL,'Glomerular filtration rate calculation technique'),('egfr',1,'^ESCT1167393',NULL,'GFR - Glomerular filtration rate calculation technique'),('egfr',1,'^ESCT1237005',NULL,'GFR (glomerular filtration rate) calculation technique'),('egfr',1,'^ESCT1249126',NULL,'eGFR (estimated glomerular filtration rate) using CKD-Epi (Chronic Kidney Disease Epidemiology Collaboration) formula per 1.73 square metres'),('egfr',1,'^ESCT1262192',NULL,'Estimated glomerular filtration rate by laboratory calculation'),('egfr',1,'^ESCT1262193',NULL,'eGFR (estimated glomerular filtration rate) by laboratory calculation'),('egfr',1,'^ESCT1268044',NULL,'GFR - glomerular filtration rate'),('egfr',1,'^ESCT1437095',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'^ESCT1437099',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'^ESCT1437100',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'^ESCTEG829482',NULL,'eGFR (estimated glomerular filtration rate) using CKD-Epi (Chronic Kidney Disease Epidemiology Collaboration) formula'),('egfr',1,'^ESCTEG835295',NULL,'eGFR (estimated glomerular filtration rate) using cystatin C CKD-EPI (Chronic Kidney Disease Epidemiology Collaboration) equation'),('egfr',1,'^ESCTEG835298',NULL,'eGFR (estimated glomerular filtration rate) using creatinine CKD-EPI (Chronic Kidney Disease Epidemiology Collaboration) equation'),('egfr',1,'^ESCTES829480',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula'),('egfr',1,'^ESCTES835294',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation'),('egfr',1,'^ESCTES835297',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation'),('egfr',1,'^ESCTTC515939',NULL,'Tc99m-DTPA clearance - GFR'),('egfr',1,'^ESCTTE515940',NULL,'Technetium-99m-diethylenetriamine pentaacetic acid clearance - glomerular filtration rate'),('egfr',1,'^ESCTWI545152',NULL,'With GFR'),('egfr',1,'^ESCTWI545153',NULL,'With glomerular filtration rate');
INSERT INTO #codesemis
VALUES ('urinary-albumin-creatinine-ratio',1,'^ESCT1268129',NULL,'Albumin/creatinine ratio in urine'),('urinary-albumin-creatinine-ratio',1,'^ESCT1435793',NULL,'ACR (albumin to creatinine ratio) in urine by test strip semi-quantitative result'),('urinary-albumin-creatinine-ratio',1,'^ESCT1435794',NULL,'Semi-quantitative result of albumin to creatinine ratio in urine by test strip'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL528959',NULL,'Albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL528960',NULL,'Albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTAL840923',NULL,'Albumin / creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552017',NULL,'Urine albumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552018',NULL,'Urine albumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552019',NULL,'Urine microalbumin/creatinine ratio measurement'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552020',NULL,'Urine microalbumin/creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'^ESCTUR552021',NULL,'Urine microalb/creatnine ratio')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL, [description] VARCHAR(255));

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version], dcr.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
AND (dcr.term IS NULL OR dcr.term = rc.Term)
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version], dcc.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL, [description] VARCHAR(255));

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version], dcs.[description]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept, [description]
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept, [description]
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

--#endregion

-- >>> Following code sets injected: egfr v1/urinary-albumin-creatinine-ratio v1/glomerulonephritis v1/kidney-transplant v1/kidney-stones v1/vasculitis v1

---- FIND PATIENTS WITH BIOCHEMICAL EVIDENCE OF CKD

---- find all eGFR and ACR tests

IF OBJECT_ID('tempdb..#EGFR_TESTS') IS NOT NULL DROP TABLE #EGFR_TESTS;
SELECT gp.FK_Patient_Link_ID, 
	CAST(GP.EventDate AS DATE) AS EventDate, 
	[value] = TRY_CONVERT(NUMERIC (18,5), [Value])
INTO #EGFR_TESTS
FROM SharedCare.GP_Events gp
WHERE 
	(gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'egfr' AND [Version]=1) OR
	 gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'egfr' AND [Version]=1))
		AND gp.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
		AND (gp.EventDate) --BETWEEN '2005-01-01' and 
		<= @EndDate
		AND [Value] IS NOT NULL AND TRY_CONVERT(NUMERIC (18,5), [Value]) <> 0 AND [Value] <> '0' -- REMOVE NULLS AND ZEROES
		AND UPPER([Value]) NOT LIKE '%[A-Z]%' -- REMOVE RECORDS WITH TEXT 

IF OBJECT_ID('tempdb..#ACR_TESTS') IS NOT NULL DROP TABLE #ACR_TESTS;
SELECT gp.FK_Patient_Link_ID, 
	CAST(GP.EventDate AS DATE) AS EventDate, 
	[value] = TRY_CONVERT(NUMERIC (18,5), [Value])
INTO #ACR_TESTS
FROM SharedCare.GP_Events gp
WHERE 
	(gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'urinary-albumin-creatinine-ratio' AND [Version]=1) OR
	 gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'urinary-albumin-creatinine-ratio'  AND [Version]=1))
		AND gp.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
		AND gp.EventDate --BETWEEN '2005-01-01' and 
		<= @EndDate
		AND [Value] IS NOT NULL AND TRY_CONVERT(NUMERIC (18,5), [Value]) <> 0 AND [Value] <> '0' -- REMOVE NULLS AND ZEROES
		AND UPPER([Value]) NOT LIKE '%[A-Z]%' -- REMOVE RECORDS WITH TEXT 

-- "eGFR < 60 Ml/Min lasting for at least 3 months"

-- For each low egfr we calculate the first date more than 3 months in the future when they also have a low egfr.
IF OBJECT_ID('tempdb..#E1TEMP') IS NOT NULL DROP TABLE #E1TEMP
SELECT E1.FK_Patient_Link_ID, E1.EventDate, MIN(E2.EventDate) AS FirstLowDatePost3Months 
INTO #E1Temp 
FROM #EGFR_TESTS E1
  INNER JOIN #EGFR_TESTS E2 ON
    E1.FK_Patient_Link_ID = E2.FK_Patient_Link_ID AND
    E2.EventDate >= DATEADD(month, 3, E1.EventDate)
WHERE TRY_CONVERT(NUMERIC, E1.Value) < 60 AND TRY_CONVERT(NUMERIC, E2.Value)  < 60
GROUP BY E1.FK_Patient_Link_ID, E1.EventDate;

-- For each low egfr we find the first date after where their egfr wasn't low
IF OBJECT_ID('tempdb..#E2TEMP') IS NOT NULL DROP TABLE #E2TEMP
SELECT E1.FK_Patient_Link_ID, E1.EventDate, MIN(E2.EventDate) AS FirstOkDatePostValue 
INTO #E2Temp 
FROM #EGFR_TESTS E1
  INNER JOIN #EGFR_TESTS E2 ON
    E1.FK_Patient_Link_ID = E2.FK_Patient_Link_ID AND
    E1.EventDate < E2.EventDate 
WHERE TRY_CONVERT(NUMERIC, E1.Value) < 60 AND TRY_CONVERT(NUMERIC, E2.Value) >= 60
GROUP BY E1.FK_Patient_Link_ID, E1.EventDate;

-- We want everyone in the first table REGARDLESS of whether they have a healthy EGFR in between their <60 results
IF OBJECT_ID('tempdb..#EGFR_cohort') IS NOT NULL DROP TABLE #EGFR_cohort
SELECT DISTINCT E1.FK_Patient_Link_ID
INTO #EGFR_cohort
FROM #E1Temp E1
--LEFT OUTER JOIN #E2Temp E2 ON E1.FK_Patient_Link_ID = E2.FK_Patient_Link_ID AND E1.EventDate = E2.EventDate
--WHERE FirstOkDatePostValue IS NULL OR FirstOkDatePostValue > FirstLowDatePost3Months;

-- Create table of patients who have a healthy EGFR in between their <60 results - this will be used to create a flag for these patients
IF OBJECT_ID('tempdb..#EGFR_HealthyResultInbetween') IS NOT NULL DROP TABLE #EGFR_HealthyResultInbetween
SELECT DISTINCT E1.FK_Patient_Link_ID
INTO #EGFR_HealthyResultInbetween
FROM #E1Temp E1
LEFT OUTER JOIN #E2Temp E2 ON E1.FK_Patient_Link_ID = E2.FK_Patient_Link_ID AND E1.EventDate = E2.EventDate
WHERE FirstOkDatePostValue < FirstLowDatePost3Months;

--------------- Same as above but for: "ACR > 3mg/mmol lasting for at least 3 months” ---------------------

-- For each high ACR we calculate the first date more than 3 months in the future when they also have a high ACR.

IF OBJECT_ID('tempdb..#A1TEMP') IS NOT NULL DROP TABLE #A1TEMP
SELECT A1.FK_Patient_Link_ID, A1.EventDate, MIN(A2.EventDate) AS FirstLowDatePost3Months 
INTO #A1Temp 
FROM #ACR_TESTS A1
  INNER JOIN #ACR_TESTS A2 ON
    A1.FK_Patient_Link_ID = A2.FK_Patient_Link_ID AND
    A2.EventDate >= DATEADD(month, 3, A1.EventDate)
WHERE TRY_CONVERT(NUMERIC, A1.Value) >= 3 AND TRY_CONVERT(NUMERIC, A2.Value)  >= 3
GROUP BY A1.FK_Patient_Link_ID, A1.EventDate;

-- For each high ACR we find the first date after where their ACR wasn't high
IF OBJECT_ID('tempdb..#A2TEMP') IS NOT NULL DROP TABLE #A2TEMP
SELECT A1.FK_Patient_Link_ID, A1.EventDate, MIN(A2.EventDate) AS FirstOkDatePostValue 
INTO #A2Temp 
FROM #ACR_TESTS A1
  INNER JOIN #ACR_TESTS A2 ON
    A1.FK_Patient_Link_ID = A2.FK_Patient_Link_ID AND
    A1.EventDate < A2.EventDate 
WHERE TRY_CONVERT(NUMERIC, A1.Value) >= 3 AND TRY_CONVERT(NUMERIC, A2.Value) < 3
GROUP BY A1.FK_Patient_Link_ID, A1.EventDate;

-- We want everyone in the first table REGARDLESS of whether they have a healthy ACR in between their >3 results
IF OBJECT_ID('tempdb..#ACR_cohort') IS NOT NULL DROP TABLE #ACR_cohort
SELECT DISTINCT A1.FK_Patient_Link_ID
INTO #ACR_cohort
FROM #A1Temp A1
--LEFT OUTER JOIN #A2Temp A2 ON A1.FK_Patient_Link_ID = A2.FK_Patient_Link_ID AND A1.EventDate = A2.EventDate
--WHERE FirstOkDatePostValue IS NULL OR FirstOkDatePostValue > FirstLowDatePost3Months;

-- Create table of patients who have a healthy ACR in between their >=3 results - this will be used to create a flag for these patients
IF OBJECT_ID('tempdb..#ACR_HealthyResultInbetween') IS NOT NULL DROP TABLE #ACR_HealthyResultInbetween
SELECT DISTINCT A1.FK_Patient_Link_ID
INTO #ACR_HealthyResultInbetween
FROM #A1Temp A1
LEFT OUTER JOIN #A2Temp A2 ON A1.FK_Patient_Link_ID = A2.FK_Patient_Link_ID AND A1.EventDate = A2.EventDate
WHERE FirstOkDatePostValue < FirstLowDatePost3Months;


-- CREATE TABLE OF PATIENTS THAT HAVE A HISTORY OF KIDNEY DAMAGE (TO BE USED AS EXTRA CRITERIA FOR EGFRs INDICATING CKD STAGE 1 AND 2)

IF OBJECT_ID('tempdb..#kidney_damage') IS NOT NULL DROP TABLE #kidney_damage;
SELECT DISTINCT FK_Patient_Link_ID
INTO #kidney_damage
FROM SharedCare.GP_Events gp
WHERE (
	gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept IN ('glomerulonephritis', 'kidney-transplant', 'kidney-stones', 'vasculitis') AND [Version]=1) OR
    gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept IN ('glomerulonephritis', 'kidney-transplant', 'kidney-stones', 'vasculitis') AND [Version]=1)
	)
	AND EventDate <= @StartDate

--┌───────────────┐
--│ Year of birth │
--└───────────────┘

-- OBJECTIVE: To get the year of birth for each patient.

-- INPUT: Assumes there exists a temp table as follows:
-- #Patients (FK_Patient_Link_ID)
--  A distinct list of FK_Patient_Link_IDs for each patient in the cohort

-- OUTPUT: A temp table as follows:
-- #PatientYearOfBirth (FK_Patient_Link_ID, YearOfBirth)
-- 	- FK_Patient_Link_ID - unique patient id
--	- YearOfBirth - INT

-- ASSUMPTIONS:
--	- Patient data is obtained from multiple sources. Where patients have multiple YOBs we determine the YOB as follows:
--	-	If the patients has a YOB in their primary care data feed we use that as most likely to be up to date
--	-	If every YOB for a patient is the same, then we use that
--	-	If there is a single most recently updated YOB in the database then we use that
--	-	Otherwise we take the highest YOB for the patient that is not in the future

-- Get all patients year of birth for the cohort
IF OBJECT_ID('tempdb..#AllPatientYearOfBirths') IS NOT NULL DROP TABLE #AllPatientYearOfBirths;
SELECT 
	FK_Patient_Link_ID,
	FK_Reference_Tenancy_ID,
	HDMModifDate,
	YEAR(Dob) AS YearOfBirth
INTO #AllPatientYearOfBirths
FROM SharedCare.Patient p
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
AND Dob IS NOT NULL;


-- If patients have a tenancy id of 2 we take this as their most likely YOB
-- as this is the GP data feed and so most likely to be up to date
IF OBJECT_ID('tempdb..#PatientYearOfBirth') IS NOT NULL DROP TABLE #PatientYearOfBirth;
SELECT FK_Patient_Link_ID, MIN(YearOfBirth) as YearOfBirth INTO #PatientYearOfBirth FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
AND FK_Reference_Tenancy_ID = 2
GROUP BY FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find the patients who remain unmatched
IF OBJECT_ID('tempdb..#UnmatchedYobPatients') IS NOT NULL DROP TABLE #UnmatchedYobPatients;
SELECT FK_Patient_Link_ID INTO #UnmatchedYobPatients FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- If every YOB is the same for all their linked patient ids then we use that
INSERT INTO #PatientYearOfBirth
SELECT FK_Patient_Link_ID, MIN(YearOfBirth) FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
GROUP BY FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find any still unmatched patients
TRUNCATE TABLE #UnmatchedYobPatients;
INSERT INTO #UnmatchedYobPatients
SELECT FK_Patient_Link_ID FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- If there is a unique most recent YOB then use that
INSERT INTO #PatientYearOfBirth
SELECT p.FK_Patient_Link_ID, MIN(p.YearOfBirth) FROM #AllPatientYearOfBirths p
INNER JOIN (
	SELECT FK_Patient_Link_ID, MAX(HDMModifDate) MostRecentDate FROM #AllPatientYearOfBirths
	WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
	GROUP BY FK_Patient_Link_ID
) sub ON sub.FK_Patient_Link_ID = p.FK_Patient_Link_ID AND sub.MostRecentDate = p.HDMModifDate
GROUP BY p.FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find any still unmatched patients
TRUNCATE TABLE #UnmatchedYobPatients;
INSERT INTO #UnmatchedYobPatients
SELECT FK_Patient_Link_ID FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- Otherwise just use the highest value (with the exception that can't be in the future)
INSERT INTO #PatientYearOfBirth
SELECT FK_Patient_Link_ID, MAX(YearOfBirth) FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
GROUP BY FK_Patient_Link_ID
HAVING MAX(YearOfBirth) <= YEAR(GETDATE());

-- Tidy up - helpful in ensuring the tempdb doesn't run out of space mid-query
DROP TABLE #AllPatientYearOfBirths;
DROP TABLE #UnmatchedYobPatients;


-- FIND EARLIEST EGFR AND ACR EVIDENCE OF CKD FOR EACH PATIENT

IF OBJECT_ID('tempdb..#EarliestEvidence') IS NOT NULL DROP TABLE #EarliestEvidence;
SELECT FK_Patient_Link_ID, min(EventDate) as EarliestDate, TestName = 'egfr'
INTO #EarliestEvidence
FROM #E1Temp e
GROUP BY FK_Patient_Link_ID
UNION ALL 
SELECT FK_Patient_Link_ID, min(EventDate) as EarliestDate, TestName = 'acr'
FROM #A1Temp a
GROUP BY FK_Patient_Link_ID

---- CREATE COHORT:
	-- 1. PATIENTS WITH EGFR TESTS INDICATIVE OF CKD STAGES 1-2, PLUS RAISED ACR OR HISTORY OF KIDNEY DAMAGE
	-- 2. PATIENTS WITH EGFR TESTS INDICATIVE OF CKD STAGES 3-5 (AT LEAST 3 MONTHS APART)
	-- 3. PATIENTS WITH ACR TESTS INDICATIVE OF CKD (A3 AND A2) (AT LEAST 3 MONTHS APART)

IF OBJECT_ID('tempdb..#Cohort') IS NOT NULL DROP TABLE #Cohort;
SELECT p.FK_Patient_Link_ID,
		p.EthnicMainGroup,
		yob.YearOfBirth,
		p.DeathDate,
		EvidenceOfCKD_egfr = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #EGFR_cohort) 			THEN 1 ELSE 0 END,-- egfr indicating stages 3-5 	
		EvidenceOfCKD_combo = CASE WHEN (p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #EGFR_TESTS where [Value] >= 60) -- egfr indicating stage 1 or 2, with ACR evidence or kidney damage
				AND ((p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ACR_cohort)) 
					OR p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #kidney_damage)))						THEN 1 ELSE 0 END,
		EvidenceOfCKD_acr = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ACR_cohort) 		THEN 1 ELSE 0 END, -- ACR evidence
		HealthyEgfrResult = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #EGFR_HealthyResultInbetween) THEN 1 ELSE 0 END,
		HealthyAcrResult = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ACR_HealthyResultInbetween) THEN 1 ELSE 0 END,
		EarliestEgfrEvidence = egfr.EarliestDate,
		EarliestAcrEvidence = acr.EarliestDate
INTO #Cohort
FROM #Patients p
LEFT OUTER JOIN #PatientYearOfBirth yob ON yob.FK_Patient_Link_ID = p.FK_Patient_Link_ID
LEFT OUTER JOIN #EarliestEvidence egfr 
	ON egfr.FK_Patient_Link_ID = p.FK_Patient_Link_ID AND egfr.TestName = 'egfr' 
LEFT OUTER JOIN #EarliestEvidence acr 
	ON acr.FK_Patient_Link_ID = p.FK_Patient_Link_ID AND acr.TestName = 'acr' 
WHERE 
	(DeathDate < @EndDate OR DeathDate IS NULL) AND 
	(YEAR(@StartDate) - YearOfBirth > 18) AND 								-- OVER 18s ONLY
		( 
	p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #EGFR_cohort ) -- egfr indicating stages 3-5
		OR (
	p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #EGFR_TESTS where [Value] >= 60) -- egfr indicating stage 1 or 2, with ACR evidence or kidney damage
			AND ((p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ACR_cohort)) OR p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #kidney_damage))
			) 
		OR p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ACR_cohort) -- ACR evidence
		)

-- TABLE OF GP EVENTS FOR COHORT TO SPEED UP REUSABLE QUERIES

IF OBJECT_ID('tempdb..#PatientEventData') IS NOT NULL DROP TABLE #PatientEventData;
SELECT 
  FK_Patient_Link_ID,
  CAST(EventDate AS DATE) AS EventDate,
  SuppliedCode,
  FK_Reference_SnomedCT_ID,
  FK_Reference_Coding_ID,
  [Value],
  [Units]
INTO #PatientEventData
FROM SharedCare.GP_Events
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Cohort);


--Outputs from this reusable query:
-- #Cohort
-- #PatientEventData

---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------



-- >>> Following code sets injected: dementia v1

-- WE NEED TO PROVIDE MEDICATION DESCRIPTION, BUT SOME CODES APPEAR MULTIPLE TIMES IN THE VERSIONEDCODESET TABLES WITH DIFFERENT DESCRIPTIONS
-- THEREFORE, TAKE THE FIRST DESCRIPTION BY USING ROW_NUMBER

IF OBJECT_ID('tempdb..#VersionedCodeSets_1') IS NOT NULL DROP TABLE #VersionedCodeSets_1;
SELECT *
INTO #VersionedCodeSets_1
FROM (
SELECT *,
	ROWNUM = ROW_NUMBER() OVER (PARTITION BY FK_Reference_Coding_ID ORDER BY [description])
FROM #VersionedCodeSets ) SUB
WHERE ROWNUM = 1

IF OBJECT_ID('tempdb..#VersionedSnomedSets_1') IS NOT NULL DROP TABLE #VersionedSnomedSets_1;
SELECT *
INTO #VersionedSnomedSets_1
FROM (
SELECT *,
	ROWNUM = ROW_NUMBER() OVER (PARTITION BY FK_Reference_SnomedCT_ID ORDER BY [description])
FROM #VersionedSnomedSets) SUB
WHERE ROWNUM = 1

---- CREATE OUTPUT TABLE OF DIAGNOSES AND SYMPTOMS, FOR THE COHORT OF INTEREST, AND CODING DATES 

IF OBJECT_ID('tempdb..#DiagnosesAndSymptoms') IS NOT NULL DROP TABLE #DiagnosesAndSymptoms;
SELECT FK_Patient_Link_ID, 
		EventDate, 
		SuppliedCode,
		case when s.Concept is null then c.Concept else s.Concept end as Concept,
		case when s.description is null then c.description else s.description end as [Description]
INTO #DiagnosesAndSymptoms
FROM #PatientEventData gp
LEFT OUTER JOIN #VersionedSnomedSets_1 s ON s.FK_Reference_SnomedCT_ID = gp.FK_Reference_SnomedCT_ID
LEFT OUTER JOIN #VersionedCodeSets_1 c ON c.FK_Reference_Coding_ID = gp.FK_Reference_Coding_ID
WHERE gp.EventDate BETWEEN @StartDate AND @EndDate
AND (
	(gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets_1 WHERE (Concept NOT IN ('egfr','urinary-albumin-creatinine-ratio','glomerulonephritis', 'kidney-transplant', 'kidney-stones', 'vasculitis')))) 
	OR
    (gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets_1 WHERE (Concept NOT IN ('egfr','urinary-albumin-creatinine-ratio','glomerulonephritis', 'kidney-transplant', 'kidney-stones', 'vasculitis'))))
);


SELECT DISTINCT PatientId = FK_Patient_Link_ID, -- ASSUME THAT CODES FROM SAME CODE SET ON SAME DAY ARE DUPLICATES
	EventDate,
	Concept,
	SuppliedCode,
	[Description] = REPLACE([Description], ',', '|')
FROM #DiagnosesAndSymptoms
ORDER BY FK_Patient_Link_ID, EventDate, Concept