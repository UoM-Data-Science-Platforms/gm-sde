--┌──────────────┐
--│ Observations │
--└──────────────┘

-------- RESEARCH DATA ENGINEER CHECK ---------


-- OUTPUT: Data with the following fields
-- 	-   PatientId (int)
--	-	ObservationName
--	-	ObservationDateTime (YYYY-MM-DD 00:00:00)
--  -   TestResult 
--  -   TestUnit

-- Set the start date
DECLARE @StartDate datetime;
SET @StartDate = '2018-03-01';
DECLARE @EndDate datetime;
SET @EndDate = '2022-03-01';

--Just want the output, not the messages
SET NOCOUNT ON;

-- Find all patients alive at start date
IF OBJECT_ID('tempdb..#PossiblePatients') IS NOT NULL DROP TABLE #PossiblePatients;
SELECT PK_Patient_Link_ID as FK_Patient_Link_ID, EthnicMainGroup, DeathDate INTO #PossiblePatients FROM [RLS].vw_Patient_Link
WHERE (DeathDate IS NULL OR DeathDate >= @StartDate);

-- Find all patients registered with a GP
IF OBJECT_ID('tempdb..#PatientsWithGP') IS NOT NULL DROP TABLE #PatientsWithGP;
SELECT DISTINCT FK_Patient_Link_ID INTO #PatientsWithGP FROM [RLS].vw_Patient
where FK_Reference_Tenancy_ID = 2;

-- Make cohort from patients alive at start date and registered with a GP
IF OBJECT_ID('tempdb..#Patients') IS NOT NULL DROP TABLE #Patients;
SELECT pp.* INTO #Patients FROM #PossiblePatients pp
INNER JOIN #PatientsWithGP gp on gp.FK_Patient_Link_ID = pp.FK_Patient_Link_ID;

--------------------------------------------------------------------------------------------------------
----------------------------------- DEFINE MAIN COHORT -- ----------------------------------------------
--------------------------------------------------------------------------------------------------------

-- LOAD CODESETS FOR CONDITIONS THAT INDICATE RISK OF CKD

-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
  [description] [varchar] (255) NULL 
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('diabetes',1,'C10..',NULL,'Diabetes mellitus'),('diabetes',1,'C10..00',NULL,'Diabetes mellitus'),('diabetes',1,'C100.',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C100.00',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C1000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C100000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C1001',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),('diabetes',1,'C100100',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),('diabetes',1,'C100z',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C100z00',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C101.',NULL,'Diabetes mellitus with ketoacidosis'),('diabetes',1,'C101.00',NULL,'Diabetes mellitus with ketoacidosis'),('diabetes',1,'C1010',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C101000',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C1011',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101100',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101y',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101y00',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101z',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C101z00',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C102.',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C102.00',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C1020',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C102000',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C1021',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102100',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102z',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C102z00',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C103.',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C103.00',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C1030',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C103000',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C1031',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103100',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103y',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103y00',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103z',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C103z00',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C104.',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'C104.00',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'C1040',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C104000',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C1041',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104100',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104y',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104y00',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104z',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C104z00',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C105.',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C105.00',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C1050',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C105000',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C1051',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105100',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105y',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105y00',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105z',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C105z00',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C106.',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'C106.00',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'C1060',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C106000',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C1061',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106100',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106y',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106y00',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106z',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C106z00',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C107.',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'C107.00',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'C1070',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C107000',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C1071',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C107100',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C1072',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107200',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107y',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107y00',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107z',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C107z00',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C108.',NULL,'Insulin dependent diabetes mellitus'),('diabetes',1,'C108.00',NULL,'Insulin dependent diabetes mellitus'),('diabetes',1,'C1080',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C108000',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1081',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C108100',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1082',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C108200',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1083',NULL,'Insulin dependent diabetes mellitus with multiple complications'),('diabetes',1,'C108300',NULL,'Insulin dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1084',NULL,'Unstable insulin dependent diabetes mellitus'),('diabetes',1,'C108400',NULL,'Unstable insulin dependent diabetes mellitus'),('diabetes',1,'C1085',NULL,'Insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C108500',NULL,'Insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C1086',NULL,'Insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C108600',NULL,'Insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C1087',NULL,'Insulin dependent diabetes mellitus with retinopathy'),('diabetes',1,'C108700',NULL,'Insulin dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1088',NULL,'Insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C108800',NULL,'Insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C1089',NULL,'Insulin dependent diabetes maturity onset'),('diabetes',1,'C108900',NULL,'Insulin dependent diabetes maturity onset'),('diabetes',1,'C108A',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'C108A00',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'C108B',NULL,'Insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C108B00',NULL,'Insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C108C',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C108C00',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C108D',NULL,'Insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C108D00',NULL,'Insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C108E',NULL,'Insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C108E00',NULL,'Insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C108F',NULL,'Insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C108F00',NULL,'Insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C108G',NULL,'Insulin dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C108G00',NULL,'Insulin dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C108H',NULL,'Insulin dependent diabetes mellitus with arthropathy'),
('diabetes',1,'C108H00',NULL,'Insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C108J',NULL,'Insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C108J00',NULL,'Insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C108y',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108y00',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108z',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C108z00',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C109.',NULL,'Non-insulin dependent diabetes mellitus'),('diabetes',1,'C109.00',NULL,'Non-insulin dependent diabetes mellitus'),('diabetes',1,'C1090',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C109000',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1091',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C109100',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1092',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C109200',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1093',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C109300',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1094',NULL,'Non-insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C109400',NULL,'Non-insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C1095',NULL,'Non-insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C109500',NULL,'Non-insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C1096',NULL,'Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C109600',NULL,'Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1097',NULL,'Non-insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C109700',NULL,'Non-insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C1098',NULL,'Reavens syndrome'),('diabetes',1,'C109800',NULL,'Reavens syndrome'),('diabetes',1,'C1099',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'C109900',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'C109A',NULL,'Non-insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C109A00',NULL,'Non-insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C109B',NULL,'Non-insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C109B00',NULL,'Non-insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C109C',NULL,'Non-insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C109C00',NULL,'Non-insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C109D',NULL,'Non-insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C109D00',NULL,'Non-insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C109E',NULL,'Non-insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C109E00',NULL,'Non-insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C109F',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C109F00',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C109G',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C109G00',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C109H',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C109H00',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C109J',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C109J00',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C109K',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C109K00',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10A.',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'C10A.00',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'C10A0',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A000',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A1',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A100',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A2',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A200',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A3',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A300',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A4',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A400',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A5',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A500',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A6',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A600',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A7',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10A700',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10AW',NULL,'Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'C10AW00',NULL,'Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'C10AX',NULL,'Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'C10AX00',NULL,'Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'C10B.',NULL,'Diabetes mellitus induced by steroids'),('diabetes',1,'C10B.00',NULL,'Diabetes mellitus induced by steroids'),('diabetes',1,'C10B0',NULL,'Steroid induced diabetes mellitus without complication'),('diabetes',1,'C10B000',NULL,'Steroid induced diabetes mellitus without complication'),('diabetes',1,'C10C.',NULL,'Diabetes mellitus autosomal dominant'),('diabetes',1,'C10C.00',NULL,'Diabetes mellitus autosomal dominant'),('diabetes',1,'C10D.',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'C10D.00',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'C10E.',NULL,'Type 1 diabetes mellitus'),('diabetes',1,'C10E.00',NULL,'Type 1 diabetes mellitus'),('diabetes',1,'C10E0',NULL,'Type 1 diabetes mellitus with renal complications'),('diabetes',1,'C10E000',NULL,'Type 1 diabetes mellitus with renal complications'),('diabetes',1,'C10E1',NULL,'Type 1 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10E100',NULL,'Type 1 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10E2',NULL,'Type 1 diabetes mellitus with neurological complications'),('diabetes',1,'C10E200',NULL,'Type 1 diabetes mellitus with neurological complications'),('diabetes',1,'C10E3',NULL,'Type 1 diabetes mellitus with multiple complications'),('diabetes',1,'C10E300',NULL,'Type 1 diabetes mellitus with multiple complications'),('diabetes',1,'C10E4',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'C10E400',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'C10E5',NULL,'Type 1 diabetes mellitus with ulcer'),('diabetes',1,'C10E500',NULL,'Type 1 diabetes mellitus with ulcer'),('diabetes',1,'C10E6',NULL,'Type 1 diabetes mellitus with gangrene'),('diabetes',1,'C10E600',NULL,'Type 1 diabetes mellitus with gangrene'),('diabetes',1,'C10E7',NULL,'Type 1 diabetes mellitus with retinopathy'),('diabetes',1,'C10E700',NULL,'Type 1 diabetes mellitus with retinopathy'),('diabetes',1,'C10E8',NULL,'Type 1 diabetes mellitus - poor control'),('diabetes',1,'C10E800',NULL,'Type 1 diabetes mellitus - poor control'),('diabetes',1,'C10E9',NULL,'Type 1 diabetes mellitus maturity onset'),('diabetes',1,'C10E900',NULL,'Type 1 diabetes mellitus maturity onset'),('diabetes',1,'C10EA',NULL,'Type 1 diabetes mellitus without complication'),('diabetes',1,'C10EA00',NULL,'Type 1 diabetes mellitus without complication'),('diabetes',1,'C10EB',NULL,'Type 1 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10EB00',NULL,'Type 1 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10EC',NULL,'Type 1 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10EC00',NULL,'Type 1 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10ED',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'C10ED00',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'C10EE',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10EE00',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10EF',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10EF00',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10EG',NULL,'Type 1 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10EG00',NULL,'Type 1 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10EH',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'C10EH00',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'C10EJ',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),
('diabetes',1,'C10EJ00',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10EK',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10EK00',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10EL',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10EL00',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10EM',NULL,'Type 1 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10EM00',NULL,'Type 1 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10EN',NULL,'Type 1 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10EN00',NULL,'Type 1 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10EP',NULL,'Type 1 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10EP00',NULL,'Type 1 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10EQ',NULL,'Type 1 diabetes mellitus with gastroparesis'),('diabetes',1,'C10EQ00',NULL,'Type 1 diabetes mellitus with gastroparesis'),('diabetes',1,'C10ER',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'C10ER00',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'C10F.',NULL,'Type 2 diabetes mellitus'),('diabetes',1,'C10F.00',NULL,'Type 2 diabetes mellitus'),('diabetes',1,'C10F0',NULL,'Type 2 diabetes mellitus with renal complications'),('diabetes',1,'C10F000',NULL,'Type 2 diabetes mellitus with renal complications'),('diabetes',1,'C10F1',NULL,'Type 2 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10F100',NULL,'Type 2 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10F2',NULL,'Type 2 diabetes mellitus with neurological complications'),('diabetes',1,'C10F200',NULL,'Type 2 diabetes mellitus with neurological complications'),('diabetes',1,'C10F3',NULL,'Type 2 diabetes mellitus with multiple complications'),('diabetes',1,'C10F300',NULL,'Type 2 diabetes mellitus with multiple complications'),('diabetes',1,'C10F4',NULL,'Type 2 diabetes mellitus with ulcer'),('diabetes',1,'C10F400',NULL,'Type 2 diabetes mellitus with ulcer'),('diabetes',1,'C10F5',NULL,'Type 2 diabetes mellitus with gangrene'),('diabetes',1,'C10F500',NULL,'Type 2 diabetes mellitus with gangrene'),('diabetes',1,'C10F6',NULL,'Type 2 diabetes mellitus with retinopathy'),('diabetes',1,'C10F600',NULL,'Type 2 diabetes mellitus with retinopathy'),('diabetes',1,'C10F7',NULL,'Type 2 diabetes mellitus - poor control'),('diabetes',1,'C10F700',NULL,'Type 2 diabetes mellitus - poor control'),('diabetes',1,'C10F8',NULL,'Reavens syndrome'),('diabetes',1,'C10F800',NULL,'Reavens syndrome'),('diabetes',1,'C10F9',NULL,'Type 2 diabetes mellitus without complication'),('diabetes',1,'C10F900',NULL,'Type 2 diabetes mellitus without complication'),('diabetes',1,'C10FA',NULL,'Type 2 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10FA00',NULL,'Type 2 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10FB',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10FB00',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10FC',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'C10FC00',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'C10FD',NULL,'Type 2 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10FD00',NULL,'Type 2 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10FE',NULL,'Type 2 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10FE00',NULL,'Type 2 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10FF',NULL,'Type 2 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10FF00',NULL,'Type 2 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10FG',NULL,'Type 2 diabetes mellitus with arthropathy'),('diabetes',1,'C10FG00',NULL,'Type 2 diabetes mellitus with arthropathy'),('diabetes',1,'C10FH',NULL,'Type 2 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10FH00',NULL,'Type 2 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10FJ',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C10FJ00',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C10FK',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10FK00',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10FL',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10FL00',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10FM',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10FM00',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10FN',NULL,'Type 2 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10FN00',NULL,'Type 2 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10FP',NULL,'Type 2 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10FP00',NULL,'Type 2 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10FQ',NULL,'Type 2 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10FQ00',NULL,'Type 2 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10FR',NULL,'Type 2 diabetes mellitus with gastroparesis'),('diabetes',1,'C10FR00',NULL,'Type 2 diabetes mellitus with gastroparesis'),('diabetes',1,'C10FS',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'C10FS00',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'C10G.',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'C10G.00',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'C10G0',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'C10G000',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'C10H.',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'C10H.00',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'C10H0',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'C10H000',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'C10M.',NULL,'Lipoatrophic diabetes mellitus'),('diabetes',1,'C10M.00',NULL,'Lipoatrophic diabetes mellitus'),('diabetes',1,'C10M0',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'C10M000',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'C10N.',NULL,'Secondary diabetes mellitus'),('diabetes',1,'C10N.00',NULL,'Secondary diabetes mellitus'),('diabetes',1,'C10N0',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'C10N000',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'C10N1',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'C10N100',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'C10Q.',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'C10Q.00',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'C10y.',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y.00',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y0',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y000',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y1',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10y100',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10yy',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yy00',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yz',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10yz00',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10z.',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z.00',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z0',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z000',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z1',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10z100',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10zy',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zy00',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zz',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'C10zz00',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'C1A0.',NULL,'Metabolic syndrome'),('diabetes',1,'C1A0.00',NULL,'Metabolic syndrome'),('diabetes',1,'Cyu2.',NULL,'[X]Diabetes mellitus'),('diabetes',1,'Cyu2.00',NULL,'[X]Diabetes mellitus'),('diabetes',1,'Cyu20',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu2000',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu21',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu2100',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu22',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu2200',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu23',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'Cyu2300',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'L180.',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),('diabetes',1,'L180.00',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),
('diabetes',1,'L1800',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L180000',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L1801',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L180100',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L1802',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L180200',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L1803',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L180300',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L1804',NULL,'Diabetes mellitus in the pueperium - baby delivered during previous episode of care'),('diabetes',1,'L180400',NULL,'Diabetes mellitus in the pueperium - baby delivered during previous episode of care'),('diabetes',1,'L1805',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L180500',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L1806',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L180600',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L1807',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L180700',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L1808',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L180800',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L1809',NULL,'Gestational diabetes mellitus'),('diabetes',1,'L180900',NULL,'Gestational diabetes mellitus'),('diabetes',1,'L180A',NULL,'Pre-existing type 1 diabetes mellitus in pregnancy'),('diabetes',1,'L180A00',NULL,'Pre-existing type 1 diabetes mellitus in pregnancy'),('diabetes',1,'L180B',NULL,'Pre-existing type 2 diabetes mellitus in pregnancy'),('diabetes',1,'L180B00',NULL,'Pre-existing type 2 diabetes mellitus in pregnancy'),('diabetes',1,'L180X',NULL,'Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'L180X00',NULL,'Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'L180z',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'L180z00',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'Lyu29',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'Lyu2900',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'PKyP.',NULL,'Diabetes insipidus, diabetes mellitus, optic atrophy and deafness'),('diabetes',1,'PKyP.00',NULL,'Diabetes insipidus, diabetes mellitus, optic atrophy and deafness'),('diabetes',1,'Q441.',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'Q441.00',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'ZV13F',NULL,'[V]Personal history of gestational diabetes mellitus'),('diabetes',1,'ZV13F00',NULL,'[V]Personal history of gestational diabetes mellitus');
INSERT INTO #codesreadv2
VALUES ('hypertension',1,'G2...',NULL,'Hypertensive disease'),('hypertension',1,'G2...00',NULL,'Hypertensive disease'),('hypertension',1,'G2z..',NULL,'Hypertensive disease NOS'),('hypertension',1,'G2z..00',NULL,'Hypertensive disease NOS'),('hypertension',1,'G2y..',NULL,'Other specified hypertensive disease'),('hypertension',1,'G2y..00',NULL,'Other specified hypertensive disease'),('hypertension',1,'G28..',NULL,'Stage 2 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G28..00',NULL,'Stage 2 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G26..',NULL,'Severe hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G26..00',NULL,'Severe hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G25..',NULL,'Stage 1 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G25..00',NULL,'Stage 1 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'G251.',NULL,'Stage 1 hypertension (NICE 2011) with evidence of end organ damage'),('hypertension',1,'G251.00',NULL,'Stage 1 hypertension (NICE 2011) with evidence of end organ damage'),('hypertension',1,'G250.',NULL,'Stage 1 hypertension (NICE 2011) without evidence of end organ damage'),('hypertension',1,'G250.00',NULL,'Stage 1 hypertension (NICE 2011) without evidence of end organ damage'),('hypertension',1,'G24..',NULL,'Secondary hypertension'),('hypertension',1,'G24..00',NULL,'Secondary hypertension'),('hypertension',1,'G24z.',NULL,'Secondary hypertension NOS'),('hypertension',1,'G24z.00',NULL,'Secondary hypertension NOS'),('hypertension',1,'G24zz',NULL,'Secondary hypertension NOS'),('hypertension',1,'G24zz00',NULL,'Secondary hypertension NOS'),('hypertension',1,'G24z0',NULL,'Secondary renovascular hypertension NOS'),('hypertension',1,'G24z000',NULL,'Secondary renovascular hypertension NOS'),('hypertension',1,'G244.',NULL,'Hypertension secondary to endocrine disorders'),('hypertension',1,'G244.00',NULL,'Hypertension secondary to endocrine disorders'),('hypertension',1,'G241.',NULL,'Secondary benign hypertension'),('hypertension',1,'G241.00',NULL,'Secondary benign hypertension'),('hypertension',1,'G241z',NULL,'Secondary benign hypertension NOS'),('hypertension',1,'G241z00',NULL,'Secondary benign hypertension NOS'),('hypertension',1,'G2410',NULL,'Secondary benign renovascular hypertension'),('hypertension',1,'G241000',NULL,'Secondary benign renovascular hypertension'),('hypertension',1,'G240.',NULL,'Secondary malignant hypertension'),('hypertension',1,'G240.00',NULL,'Secondary malignant hypertension'),('hypertension',1,'G240z',NULL,'Secondary malignant hypertension NOS'),('hypertension',1,'G240z00',NULL,'Secondary malignant hypertension NOS'),('hypertension',1,'G2400',NULL,'Secondary malignant renovascular hypertension'),('hypertension',1,'G240000',NULL,'Secondary malignant renovascular hypertension'),('hypertension',1,'G20..',NULL,'Essential hypertension'),('hypertension',1,'G20..00',NULL,'Essential hypertension'),('hypertension',1,'G20z.',NULL,'Essential hypertension NOS'),('hypertension',1,'G20z.00',NULL,'Essential hypertension NOS'),('hypertension',1,'G203.',NULL,'Diastolic hypertension'),('hypertension',1,'G203.00',NULL,'Diastolic hypertension'),('hypertension',1,'G202.',NULL,'Systolic hypertension'),('hypertension',1,'G202.00',NULL,'Systolic hypertension'),('hypertension',1,'G201.',NULL,'Benign essential hypertension'),('hypertension',1,'G201.00',NULL,'Benign essential hypertension'),('hypertension',1,'G200.',NULL,'Malignant essential hypertension'),('hypertension',1,'G200.00',NULL,'Malignant essential hypertension'),('hypertension',1,'Gyu2.',NULL,'[X]Hypertensive diseases'),('hypertension',1,'Gyu2.00',NULL,'[X]Hypertensive diseases'),('hypertension',1,'Gyu21',NULL,'[X]Hypertension secondary to other renal disorders'),('hypertension',1,'Gyu2100',NULL,'[X]Hypertension secondary to other renal disorders'),('hypertension',1,'Gyu20',NULL,'[X]Other secondary hypertension'),('hypertension',1,'Gyu2000',NULL,'[X]Other secondary hypertension');
INSERT INTO #codesreadv2
VALUES ('bmi',1,'22K..',NULL,'Body Mass Index'),('bmi',1,'22K..00',NULL,'Body Mass Index'),('bmi',1,'22KE.',NULL,'Obese class III (body mass index equal to or greater than 40.0)'),('bmi',1,'22KE.00',NULL,'Obese class III (body mass index equal to or greater than 40.0)'),('bmi',1,'22KD.',NULL,'Obese class II (body mass index 35.0 - 39.9)'),('bmi',1,'22KD.00',NULL,'Obese class II (body mass index 35.0 - 39.9)'),('bmi',1,'22KC.',NULL,'Obese class I (body mass index 30.0 - 34.9)'),('bmi',1,'22KC.00',NULL,'Obese class I (body mass index 30.0 - 34.9)'),('bmi',1,'22KB.',NULL,'Baseline body mass index'),('bmi',1,'22KB.00',NULL,'Baseline body mass index'),('bmi',1,'22KA.',NULL,'Target body mass index'),('bmi',1,'22KA.00',NULL,'Target body mass index'),('bmi',1,'22K9.',NULL,'Body mass index centile'),('bmi',1,'22K9.00',NULL,'Body mass index centile'),('bmi',1,'22K9K',NULL,'Downs syndrome body mass index centile'),('bmi',1,'22K9K00',NULL,'Downs syndrome body mass index centile'),('bmi',1,'22K9J',NULL,'Child body mass index greater than 99.6th centile'),('bmi',1,'22K9J00',NULL,'Child body mass index greater than 99.6th centile'),('bmi',1,'22K9H',NULL,'Child body mass index 98.1st-99.6th centile'),('bmi',1,'22K9H00',NULL,'Child body mass index 98.1st-99.6th centile'),('bmi',1,'22K9G',NULL,'Child body mass index on 98th centile'),('bmi',1,'22K9G00',NULL,'Child body mass index on 98th centile'),('bmi',1,'22K9F',NULL,'Child body mass index 92nd-97th centile'),('bmi',1,'22K9F00',NULL,'Child body mass index 92nd-97th centile'),('bmi',1,'22K9E',NULL,'Child body mass index on 91st centile'),('bmi',1,'22K9E00',NULL,'Child body mass index on 91st centile'),('bmi',1,'22K9D',NULL,'Child body mass index 76th-90th centile'),('bmi',1,'22K9D00',NULL,'Child body mass index 76th-90th centile'),('bmi',1,'22K9C',NULL,'Child body mass index on 75th centile'),('bmi',1,'22K9C00',NULL,'Child body mass index on 75th centile'),('bmi',1,'22K9B',NULL,'Child body mass index 51st-74th centile'),('bmi',1,'22K9B00',NULL,'Child body mass index 51st-74th centile'),('bmi',1,'22K9A',NULL,'Child body mass index on 50th centile'),('bmi',1,'22K9A00',NULL,'Child body mass index on 50th centile'),('bmi',1,'22K99',NULL,'Child body mass index 26th-49th centile'),('bmi',1,'22K9900',NULL,'Child body mass index 26th-49th centile'),('bmi',1,'22K98',NULL,'Child body mass index on 25th centile'),('bmi',1,'22K9800',NULL,'Child body mass index on 25th centile'),('bmi',1,'22K97',NULL,'Child body mass index 10th-24th centile'),('bmi',1,'22K9700',NULL,'Child body mass index 10th-24th centile'),('bmi',1,'22K96',NULL,'Child body mass index on 9th centile'),('bmi',1,'22K9600',NULL,'Child body mass index on 9th centile'),('bmi',1,'22K95',NULL,'Child body mass index 3rd-8th centile'),('bmi',1,'22K9500',NULL,'Child body mass index 3rd-8th centile'),('bmi',1,'22K94',NULL,'Child body mass index on 2nd centile'),('bmi',1,'22K9400',NULL,'Child body mass index on 2nd centile'),('bmi',1,'22K93',NULL,'Child body mass index 0.4th-1.9th centile'),('bmi',1,'22K9300',NULL,'Child body mass index 0.4th-1.9th centile'),('bmi',1,'22K92',NULL,'Child body mass index less than 0.4th centile'),('bmi',1,'22K9200',NULL,'Child body mass index less than 0.4th centile'),('bmi',1,'22K91',NULL,'Child body mass index centile'),('bmi',1,'22K9100',NULL,'Child body mass index centile'),('bmi',1,'22K90',NULL,'Baseline body mass index centile'),('bmi',1,'22K9000',NULL,'Baseline body mass index centile'),('bmi',1,'22K8.',NULL,'Body mass index 20-24 - normal'),('bmi',1,'22K8.00',NULL,'Body mass index 20-24 - normal'),('bmi',1,'22K7.',NULL,'Body mass index 40+ - severely obese'),('bmi',1,'22K7.00',NULL,'Body mass index 40+ - severely obese'),('bmi',1,'22K6.',NULL,'Body mass index less than 20'),('bmi',1,'22K6.00',NULL,'Body mass index less than 20'),('bmi',1,'22K5.',NULL,'Body mass index 30+ - obesity'),('bmi',1,'22K5.00',NULL,'Body mass index 30+ - obesity'),('bmi',1,'22K4.',NULL,'Body mass index index 25-29 - overweight'),('bmi',1,'22K4.00',NULL,'Body mass index index 25-29 - overweight'),('bmi',1,'22K3.',NULL,'Body Mass Index low K/M2'),('bmi',1,'22K3.00',NULL,'Body Mass Index low K/M2'),('bmi',1,'22K2.',NULL,'Body Mass Index high K/M2'),('bmi',1,'22K2.00',NULL,'Body Mass Index high K/M2'),('bmi',1,'22K1.',NULL,'Body Mass Index normal K/M2'),('bmi',1,'22K1.00',NULL,'Body Mass Index normal K/M2'),('bmi',1,'C3808',NULL,'Childhood obesity'),('bmi',1,'C380800',NULL,'Childhood obesity'),('bmi',2,'22K..',NULL,'Body Mass Index'),('bmi',2,'22K..00',NULL,'Body Mass Index');
INSERT INTO #codesreadv2
VALUES ('height',1,'229..',NULL,'O/E - height'),('height',1,'229..00',NULL,'O/E - height'),('height',1,'229Z.',NULL,'O/E - height NOS'),('height',1,'229Z.00',NULL,'O/E - height NOS');
INSERT INTO #codesreadv2
VALUES ('weight',1,'22A..',NULL,'O/E - weight'),('weight',1,'22A..00',NULL,'O/E - weight'),('weight',1,'22AZ.',NULL,'O/E - weight NOS'),('weight',1,'22AZ.00',NULL,'O/E - weight NOS');
INSERT INTO #codesreadv2
VALUES ('alanine-aminotransferase',1,'44G3.',NULL,'ALT/SGPT serum level'),('alanine-aminotransferase',1,'44G3.00',NULL,'ALT/SGPT serum level'),('alanine-aminotransferase',1,'44GB.',NULL,'Serum alanine aminotransferase level'),('alanine-aminotransferase',1,'44GB.00',NULL,'Serum alanine aminotransferase level'),('alanine-aminotransferase',1,'44G..','11','ALT - blood level'),('alanine-aminotransferase',1,'44G..','11','ALT - blood level');
INSERT INTO #codesreadv2
VALUES ('albumin',1,'44M4.',NULL,'Serum albumin'),('albumin',1,'44M4.00',NULL,'Serum albumin');
INSERT INTO #codesreadv2
VALUES ('alkaline-phosphatase',1,'44F..',NULL,'Serum alkaline phosphatase'),('alkaline-phosphatase',1,'44F..00',NULL,'Serum alkaline phosphatase'),('alkaline-phosphatase',1,'44F3.',NULL,'Total alkaline phosphatase'),('alkaline-phosphatase',1,'44F3.00',NULL,'Total alkaline phosphatase'),('alkaline-phosphatase',1,'44FZ.',NULL,'Serum alkaline phosphatase NOS'),('alkaline-phosphatase',1,'44FZ.00',NULL,'Serum alkaline phosphatase NOS');
INSERT INTO #codesreadv2
VALUES ('b12',1,'44Lc.',NULL,'Vitamin B12 level'),('b12',1,'44Lc.00',NULL,'Vitamin B12 level'),('b12',1,'44Le.',NULL,'Plasma vitamin B12 level'),('b12',1,'44Le.00',NULL,'Plasma vitamin B12 level'),('b12',1,'42TZ.',NULL,'Serum vitamin B12 NOS'),('b12',1,'42TZ.00',NULL,'Serum vitamin B12 NOS'),('b12',1,'42T..',NULL,'Serum vitamin B12'),('b12',1,'42T..00',NULL,'Serum vitamin B12');
INSERT INTO #codesreadv2
VALUES ('calcium',1,'44h4.',NULL,'Blood calcium level'),('calcium',1,'44h4.00',NULL,'Blood calcium level'),('calcium',1,'44h7.',NULL,'Plasma calcium level'),('calcium',1,'44h7.00',NULL,'Plasma calcium level'),('calcium',1,'44h9.',NULL,'Plasma corrected calcium level'),('calcium',1,'44h9.00',NULL,'Plasma corrected calcium level'),('calcium',1,'44hD.',NULL,'Blood ionised calcium level'),('calcium',1,'44hD.00',NULL,'Blood ionised calcium level'),('calcium',1,'44I8.',NULL,'Serum calcium'),('calcium',1,'44I8.00',NULL,'Serum calcium'),('calcium',1,'44IC.',NULL,'Adjusted serum calcium level'),('calcium',1,'44IC.00',NULL,'Adjusted serum calcium level'),('calcium',1,'44ID.',NULL,'Serum ionised calcium level'),('calcium',1,'44ID.00',NULL,'Serum ionised calcium level'),('calcium',1,'44IE.',NULL,'Serum ionized calcium (pH 7.4) level'),('calcium',1,'44IE.00',NULL,'Serum ionized calcium (pH 7.4) level'),('calcium',1,'4Q721',NULL,'Calcium adjusted level'),('calcium',1,'4Q72100',NULL,'Calcium adjusted level');
INSERT INTO #codesreadv2
VALUES ('cholesterol',1,'44P..',NULL,'Serum cholesterol'),('cholesterol',1,'44P..00',NULL,'Serum cholesterol'),('cholesterol',1,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',1,'44PZ.00',NULL,'Serum cholesterol NOS'),('cholesterol',1,'44PL.',NULL,'Non HDL cholesterol level'),('cholesterol',1,'44PL.00',NULL,'Non HDL cholesterol level'),('cholesterol',1,'44PL1',NULL,'Estimated serum non-high density lipoprotein cholesterol level'),('cholesterol',1,'44PL100',NULL,'Estimated serum non-high density lipoprotein cholesterol level'),('cholesterol',1,'44PL0',NULL,'Serum non high density lipoprotein cholesterol level'),('cholesterol',1,'44PL000',NULL,'Serum non high density lipoprotein cholesterol level'),('cholesterol',1,'44PK.',NULL,'Serum fasting total cholesterol'),('cholesterol',1,'44PK.00',NULL,'Serum fasting total cholesterol'),('cholesterol',1,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',1,'44PJ.00',NULL,'Serum total cholesterol level'),('cholesterol',1,'44PI.',NULL,'Calculated LDL cholesterol level'),('cholesterol',1,'44PI.00',NULL,'Calculated LDL cholesterol level'),('cholesterol',1,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',1,'44PH.00',NULL,'Total cholesterol measurement'),('cholesterol',1,'44PG.',NULL,'HDL : total cholesterol ratio'),('cholesterol',1,'44PG.00',NULL,'HDL : total cholesterol ratio'),('cholesterol',1,'44PF.',NULL,'Total cholesterol:HDL ratio'),('cholesterol',1,'44PF.00',NULL,'Total cholesterol:HDL ratio'),('cholesterol',1,'44PE.',NULL,'Serum random LDL cholesterol level'),('cholesterol',1,'44PE.00',NULL,'Serum random LDL cholesterol level'),('cholesterol',1,'44PD.',NULL,'Serum fasting LDL cholesterol level'),('cholesterol',1,'44PD.00',NULL,'Serum fasting LDL cholesterol level'),('cholesterol',1,'44PC.',NULL,'Serum random HDL cholesterol level'),('cholesterol',1,'44PC.00',NULL,'Serum random HDL cholesterol level'),('cholesterol',1,'44PB.',NULL,'Serum fasting HDL cholesterol level'),('cholesterol',1,'44PB.00',NULL,'Serum fasting HDL cholesterol level'),('cholesterol',1,'44P9.',NULL,'Serum cholesterol studies'),('cholesterol',1,'44P9.00',NULL,'Serum cholesterol studies'),('cholesterol',1,'44P8.',NULL,'Serum HDL:non-HDL cholesterol ratio'),('cholesterol',1,'44P8.00',NULL,'Serum HDL:non-HDL cholesterol ratio'),('cholesterol',1,'44P7.',NULL,'Serum VLDL cholesterol level'),('cholesterol',1,'44P7.00',NULL,'Serum VLDL cholesterol level'),('cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('cholesterol',1,'44P6.00',NULL,'Serum LDL cholesterol level'),('cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('cholesterol',1,'44P5.00',NULL,'Serum HDL cholesterol level'),('cholesterol',1,'44P4.',NULL,'Serum cholesterol very high'),('cholesterol',1,'44P4.00',NULL,'Serum cholesterol very high'),('cholesterol',1,'44P3.',NULL,'Serum cholesterol raised'),('cholesterol',1,'44P3.00',NULL,'Serum cholesterol raised'),('cholesterol',1,'44P2.',NULL,'Serum cholesterol borderline'),('cholesterol',1,'44P2.00',NULL,'Serum cholesterol borderline'),('cholesterol',1,'44P1.',NULL,'Serum cholesterol normal'),('cholesterol',1,'44P1.00',NULL,'Serum cholesterol normal'),('cholesterol',1,'44PA.',NULL,'HDL : LDL ratio'),('cholesterol',1,'44PA.00',NULL,'HDL : LDL ratio'),('cholesterol',1,'44lM.',NULL,'Plasma LDL/HDL ratio'),('cholesterol',1,'44lM.00',NULL,'Plasma LDL/HDL ratio'),('cholesterol',1,'44lL.',NULL,'Serum LDL/HDL ratio'),('cholesterol',1,'44lL.00',NULL,'Serum LDL/HDL ratio'),('cholesterol',1,'44lK.',NULL,'Plasma cholesterol/VLDL ratio'),('cholesterol',1,'44lK.00',NULL,'Plasma cholesterol/VLDL ratio'),('cholesterol',1,'44lJ.',NULL,'Serum cholesterol/VLDL ratio'),('cholesterol',1,'44lJ.00',NULL,'Serum cholesterol/VLDL ratio'),('cholesterol',1,'44lI.',NULL,'Plasma cholesterol/LDL ratio'),('cholesterol',1,'44lI.00',NULL,'Plasma cholesterol/LDL ratio'),('cholesterol',1,'44lH.',NULL,'Serum cholesterol/LDL ratio'),('cholesterol',1,'44lH.00',NULL,'Serum cholesterol/LDL ratio'),('cholesterol',1,'44lG.',NULL,'Plasma cholesterol/HDL ratio'),('cholesterol',1,'44lG.00',NULL,'Plasma cholesterol/HDL ratio'),('cholesterol',1,'44lF.',NULL,'Serum cholesterol/HDL ratio'),('cholesterol',1,'44lF.00',NULL,'Serum cholesterol/HDL ratio'),('cholesterol',1,'44l2.',NULL,'Cholesterol/HDL ratio'),('cholesterol',1,'44l2.00',NULL,'Cholesterol/HDL ratio'),('cholesterol',1,'44dB.',NULL,'Plasma LDL cholesterol level'),('cholesterol',1,'44dB.00',NULL,'Plasma LDL cholesterol level'),('cholesterol',1,'44dA.',NULL,'Plasma HDL cholesterol level'),('cholesterol',1,'44dA.00',NULL,'Plasma HDL cholesterol level'),('cholesterol',1,'44d5.',NULL,'Plasma fasting LDL cholesterol level'),('cholesterol',1,'44d5.00',NULL,'Plasma fasting LDL cholesterol level'),('cholesterol',1,'44d4.',NULL,'Plasma random LDL cholesterol level'),('cholesterol',1,'44d4.00',NULL,'Plasma random LDL cholesterol level'),('cholesterol',1,'44d3.',NULL,'Plasma fasting HDL cholesterol level'),('cholesterol',1,'44d3.00',NULL,'Plasma fasting HDL cholesterol level'),('cholesterol',1,'44d2.',NULL,'Plasma random HDL cholesterol level'),('cholesterol',1,'44d2.00',NULL,'Plasma random HDL cholesterol level'),('cholesterol',1,'44R4.',NULL,'Lipoprotein electroph. - LDL'),('cholesterol',1,'44R4.00',NULL,'Lipoprotein electroph. - LDL'),('cholesterol',1,'44R3.',NULL,'Lipoprotein electroph. - HDL'),('cholesterol',1,'44R3.00',NULL,'Lipoprotein electroph. - HDL'),('cholesterol',1,'662a.',NULL,'Pre-treatment serum cholesterol level'),('cholesterol',1,'662a.00',NULL,'Pre-treatment serum cholesterol level'),('cholesterol',1,'44OE.',NULL,'Plasma total cholesterol level'),('cholesterol',1,'44OE.00',NULL,'Plasma total cholesterol level'),('cholesterol',1,'44lzY',NULL,'Serum high density lipoprotein cholesterol:triglyceride ratio'),('cholesterol',1,'44lzY00',NULL,'Serum high density lipoprotein cholesterol:triglyceride ratio'),('cholesterol',1,'4I3O.',NULL,'Fluid sample cholesterol level'),('cholesterol',1,'4I3O.00',NULL,'Fluid sample cholesterol level'),('cholesterol',2,'44P..',NULL,'Serum cholesterol'),('cholesterol',2,'44P..00',NULL,'Serum cholesterol'),('cholesterol',2,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',2,'44PZ.00',NULL,'Serum cholesterol NOS'),('cholesterol',2,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',2,'44PJ.00',NULL,'Serum total cholesterol level'),('cholesterol',2,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PH.00',NULL,'Total cholesterol measurement');
INSERT INTO #codesreadv2
VALUES ('cholesterol-hdl-ratio',1,'44l2.',NULL,'Cholesterol/HDL'),('cholesterol-hdl-ratio',1,'44l2.00',NULL,'Cholesterol/HDL'),('cholesterol-hdl-ratio',1,'44lF.',NULL,'Serum cholesterol/HDL'),('cholesterol-hdl-ratio',1,'44lF.00',NULL,'Serum cholesterol/HDL'),('cholesterol-hdl-ratio',1,'44PF.',NULL,'Total cholesterol:HDL ratio'),('cholesterol-hdl-ratio',1,'44PF.00',NULL,'Total cholesterol:HDL ratio');
INSERT INTO #codesreadv2
VALUES ('creatinine',1,'44J3.',NULL,'Serum creatinine'),('creatinine',1,'44J3.00',NULL,'Serum creatinine'),('creatinine',1,'44JC.',NULL,'Corrected plasma creatinine level'),('creatinine',1,'44JC.00',NULL,'Corrected plasma creatinine level'),('creatinine',1,'44JD.',NULL,'Corrected serum creatinine level'),('creatinine',1,'44JD.00',NULL,'Corrected serum creatinine level'),('creatinine',1,'44JF.',NULL,'Plasma creatinine level'),('creatinine',1,'44JF.00',NULL,'Plasma creatinine level'),('creatinine',1,'44J3z',NULL,'Serum creatinine NOS'),('creatinine',1,'44J3z00',NULL,'Serum creatinine NOS');
INSERT INTO #codesreadv2
VALUES ('diastolic-blood-pressure',1,'246o1',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246o100',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246n0',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246n000',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.00',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246i.',NULL,'Diastolic blood pressure centile'),('diastolic-blood-pressure',1,'246i.00',NULL,'Diastolic blood pressure centile'),('diastolic-blood-pressure',1,'246f.',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246f.00',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.00',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.00',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.00',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.00',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.00',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.00',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.00',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246L.',NULL,'Target diastolic blood pressure'),('diastolic-blood-pressure',1,'246L.00',NULL,'Target diastolic blood pressure'),('diastolic-blood-pressure',1,'246A.',NULL,'O/E - Diastolic BP reading'),('diastolic-blood-pressure',1,'246A.00',NULL,'O/E - Diastolic BP reading');
INSERT INTO #codesreadv2
VALUES ('egfr',1,'451E.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451E.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'451G.',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451G.00',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'451K.',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451K.00',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'451M.',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451M.00',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'451N.00',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres');
INSERT INTO #codesreadv2
VALUES ('ferritin',1,'42d4.',NULL,'Plasma ferritin level'),('ferritin',1,'42d4.00',NULL,'Plasma ferritin level'),('ferritin',1,'42R41',NULL,'Ferritin level low'),('ferritin',1,'42R4100',NULL,'Ferritin level low'),('ferritin',1,'42R42',NULL,'Serum ferritin normal'),('ferritin',1,'42R4200',NULL,'Serum ferritin normal'),('ferritin',1,'42R43',NULL,'Serum ferritin high'),('ferritin',1,'42R4300',NULL,'Serum ferritin high'),('ferritin',1,'42R4.',NULL,'Serum ferritin'),('ferritin',1,'42R4.00',NULL,'Serum ferritin');
INSERT INTO #codesreadv2
VALUES ('folate',1,'42U4.',NULL,'Red blood cell folate'),('folate',1,'42U4.00',NULL,'Red blood cell folate'),('folate',1,'42U5.',NULL,'Serum folate'),('folate',1,'42U5.00',NULL,'Serum folate'),('folate',1,'42UE.',NULL,'Plasma folate level'),('folate',1,'42UE.00',NULL,'Plasma folate level');
INSERT INTO #codesreadv2
VALUES ('fsh',1,'4434.',NULL,'FSH level'),('fsh',1,'4434.00',NULL,'FSH level'),('fsh',1,'443h.',NULL,'Serum FSH level'),('fsh',1,'443h.00',NULL,'Serum FSH level'),('fsh',1,'443i.',NULL,'Plasma FSH level'),('fsh',1,'443i.00',NULL,'Plasma FSH level'),('fsh',1,'4Q23.',NULL,'Follicle stimulating hormone level'),('fsh',1,'4Q23.00',NULL,'Follicle stimulating hormone level');
INSERT INTO #codesreadv2
VALUES ('gamma-glutamyl-transferase',1,'44G7.',NULL,'Plasma gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'44G7.00',NULL,'Plasma gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'44G9.',NULL,'Serum gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'44G9.00',NULL,'Serum gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'44G4.',NULL,'Gamma - G.T. level'),('gamma-glutamyl-transferase',1,'44G4.00',NULL,'Gamma - G.T. level');
INSERT INTO #codesreadv2
VALUES ('haemoglobin',1,'423..',NULL,'Haemoglobin estimation'),('haemoglobin',1,'423..00',NULL,'Haemoglobin estimation'),('haemoglobin',1,'423Z.',NULL,'Haemoglobin estimation NOS'),('haemoglobin',1,'423Z.00',NULL,'Haemoglobin estimation NOS'),('haemoglobin',1,'423C.',NULL,'Haemoglobin H inclusion'),('haemoglobin',1,'423C.00',NULL,'Haemoglobin H inclusion'),('haemoglobin',1,'423B.',NULL,'Haemoglobin abnormal'),('haemoglobin',1,'423B.00',NULL,'Haemoglobin abnormal');
INSERT INTO #codesreadv2
VALUES ('hba1c',1,'42c..',NULL,'HbA1 - diabetic control'),('hba1c',1,'42c..00',NULL,'HbA1 - diabetic control'),('hba1c',1,'42c3.',NULL,'HbA1 level (DCCT aligned)'),('hba1c',1,'42c3.00',NULL,'HbA1 level (DCCT aligned)'),('hba1c',1,'42c2.',NULL,'HbA1 > 10% - bad control'),('hba1c',1,'42c2.00',NULL,'HbA1 > 10% - bad control'),('hba1c',1,'42c1.',NULL,'HbA1 7 - 10% - borderline control'),('hba1c',1,'42c1.00',NULL,'HbA1 7 - 10% - borderline control'),('hba1c',1,'42c0.',NULL,'HbA1 < 7% - good control'),('hba1c',1,'42c0.00',NULL,'HbA1 < 7% - good control'),('hba1c',1,'42W..',NULL,'Hb. A1C - diabetic control'),('hba1c',1,'42W..00',NULL,'Hb. A1C - diabetic control'),('hba1c',1,'42WZ.',NULL,'Hb. A1C - diabetic control NOS'),('hba1c',1,'42WZ.00',NULL,'Hb. A1C - diabetic control NOS'),('hba1c',1,'42W3.',NULL,'Hb. A1C > 10% - bad control'),('hba1c',1,'42W3.00',NULL,'Hb. A1C > 10% - bad control'),('hba1c',1,'42W2.',NULL,'Hb. A1C 7-10% - borderline'),('hba1c',1,'42W2.00',NULL,'Hb. A1C 7-10% - borderline'),('hba1c',1,'42W1.',NULL,'Hb. A1C < 7% - good control'),('hba1c',1,'42W1.00',NULL,'Hb. A1C < 7% - good control'),('hba1c',1,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',1,'42W5.00',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',1,'42W51',NULL,'HbA1c (haemoglobin A1c) level (monitoring ranges) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W5100',NULL,'HbA1c (haemoglobin A1c) level (monitoring ranges) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W50',NULL,'HbA1c (haemoglobin A1c) level (diagnostic reference range) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W5000',NULL,'HbA1c (haemoglobin A1c) level (diagnostic reference range) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W4.',NULL,'HbA1c level (DCCT aligned)'),('hba1c',1,'42W4.00',NULL,'HbA1c level (DCCT aligned)'),('hba1c',1,'44TL.',NULL,'Total glycosylated haemoglobin level'),('hba1c',1,'44TL.00',NULL,'Total glycosylated haemoglobin level'),('hba1c',1,'44TB.',NULL,'Haemoglobin A1c level'),('hba1c',1,'44TB.00',NULL,'Haemoglobin A1c level'),('hba1c',1,'44TB1',NULL,'Haemoglobin A1c (monitoring ranges)'),('hba1c',1,'44TB100',NULL,'Haemoglobin A1c (monitoring ranges)'),('hba1c',1,'44TB0',NULL,'Haemoglobin A1c (diagnostic reference range)'),('hba1c',1,'44TB000',NULL,'Haemoglobin A1c (diagnostic reference range)'),('hba1c',2,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W5.00',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W4.',NULL,'HbA1c level (DCCT aligned)'),('hba1c',2,'42W4.00',NULL,'HbA1c level (DCCT aligned)');
INSERT INTO #codesreadv2
VALUES ('hdl-cholesterol',1,'44PC.',NULL,'Serum random HDL cholesterol level'),('hdl-cholesterol',1,'44PC.00',NULL,'Serum random HDL cholesterol level'),('hdl-cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44P5.00',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44dA.',NULL,'Plasma HDL cholesterol level'),('hdl-cholesterol',1,'44dA.00',NULL,'Plasma HDL cholesterol level');
INSERT INTO #codesreadv2
VALUES ('ldl-cholesterol',1,'44PI.',NULL,'Calculated LDL cholesterol level'),('ldl-cholesterol',1,'44PI.00',NULL,'Calculated LDL cholesterol level'),('ldl-cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'44P6.00',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'44dB.',NULL,'Plasma LDL cholesterol level'),('ldl-cholesterol',1,'44dB.00',NULL,'Plasma LDL cholesterol level');
INSERT INTO #codesreadv2
VALUES ('luteinising-hormone',1,'443e.',NULL,'Serum LH level'),('luteinising-hormone',1,'443e.00',NULL,'Serum LH level'),('luteinising-hormone',1,'443f.',NULL,'Plasma LH level'),('luteinising-hormone',1,'443f.00',NULL,'Plasma LH level');
INSERT INTO #codesreadv2
VALUES ('mean-corpuscular-volume',1,'42A..',NULL,'Mean corpuscular volume (MCV)'),('mean-corpuscular-volume',1,'42A..00',NULL,'Mean corpuscular volume (MCV)'),('mean-corpuscular-volume',1,'42AZ.',NULL,' MCV - NOS'),('mean-corpuscular-volume',1,'42AZ.00',NULL,' MCV - NOS');
INSERT INTO #codesreadv2
VALUES ('oestradiol',1,'4465.',NULL,'Serum oestradiol level'),('oestradiol',1,'4465.00',NULL,'Serum oestradiol level'),('oestradiol',1,'4467.',NULL,'Plasma oestradiol level'),('oestradiol',1,'4467.00',NULL,'Plasma oestradiol level');
INSERT INTO #codesreadv2
VALUES ('parathyroid-hormone',1,'44AJ.',NULL,'Plasma parathyroid hormone level'),('parathyroid-hormone',1,'44AJ.00',NULL,'Plasma parathyroid hormone level');
INSERT INTO #codesreadv2
VALUES ('platelets',1,'42P..',NULL,'Platelet count'),('platelets',1,'42P..00',NULL,'Platelet count'),('platelets',1,'42P1.',NULL,'Platelet count normal'),('platelets',1,'42P1.00',NULL,'Platelet count normal'),('platelets',1,'42PZ.',NULL,'Platelet count NOS'),('platelets',1,'42PZ.00',NULL,'Platelet count NOS');
INSERT INTO #codesreadv2
VALUES ('potassium',1,'44I4.',NULL,'Serum potassium (& level)'),('potassium',1,'44I4.00',NULL,'Serum potassium (& level)'),('potassium',1,'XaDvZ',NULL,'Blood potassium level'),('potassium',1,'XaDvZ00',NULL,'Blood potassium level'),('potassium',1,'XaIRl',NULL,'Plasma potassium level'),('potassium',1,'XaIRl00',NULL,'Plasma potassium level'),('potassium',1,'XE2pz',NULL,'Serum potassium level'),('potassium',1,'XE2pz00',NULL,'Serum potassium level');
INSERT INTO #codesreadv2
VALUES ('progesterone',1,'4463.',NULL,'Serum progesterone'),('progesterone',1,'4463.00',NULL,'Serum progesterone');
INSERT INTO #codesreadv2
VALUES ('red-blood-cells',1,'426..',NULL,'Red blood cell (RBC) count'),('red-blood-cells',1,'426..00',NULL,'Red blood cell (RBC) count'),('red-blood-cells',1,'426Z.',NULL,'RBC count NOS'),('red-blood-cells',1,'426Z.00',NULL,'RBC count NOS');
INSERT INTO #codesreadv2
VALUES ('sex-hormone-binding-globulin',1,'44CD.',NULL,'Serum sex hormone binding globulin level'),('sex-hormone-binding-globulin',1,'44CD.00',NULL,'Serum sex hormone binding globulin level');
INSERT INTO #codesreadv2
VALUES ('sodium',1,'44h1.',NULL,'Blood sodium level'),('sodium',1,'44h1.00',NULL,'Blood sodium level'),('sodium',1,'44h6.',NULL,'Plasma sodium level'),('sodium',1,'44h6.00',NULL,'Plasma sodium level'),('sodium',1,'44I5.',NULL,'Serum sodium'),('sodium',1,'44I5.00',NULL,'Serum sodium'),('sodium',1,'4Q43.',NULL,'Sodium level'),('sodium',1,'4Q43.00',NULL,'Sodium level');
INSERT INTO #codesreadv2
VALUES ('systolic-blood-pressure',1,'246o0',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246o000',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246n1',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246n100',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246l.',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246l.00',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246j.',NULL,'Systolic blood pressure centile'),('systolic-blood-pressure',1,'246j.00',NULL,'Systolic blood pressure centile'),('systolic-blood-pressure',1,'246e.',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246e.00',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246d.',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246d.00',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246b.',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246b.00',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.00',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246W.',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246W.00',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246S.',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246S.00',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246Q.',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246Q.00',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246N.',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'246N.00',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'246K.',NULL,'Target systolic blood pressure'),('systolic-blood-pressure',1,'246K.00',NULL,'Target systolic blood pressure'),('systolic-blood-pressure',1,'2469.',NULL,'O/E - Systolic BP reading'),('systolic-blood-pressure',1,'2469.00',NULL,'O/E - Systolic BP reading');
INSERT INTO #codesreadv2
VALUES ('testosterone',1,'4473.',NULL,'Serum testosterone'),('testosterone',1,'4473.00',NULL,'Serum testosterone'),('testosterone',1,'447G.',NULL,'Plasma testosterone level'),('testosterone',1,'447G.00',NULL,'Plasma testosterone level');
INSERT INTO #codesreadv2
VALUES ('total-bilirubin',1,'44EC.',NULL,'Serum total bilirubin level'),('total-bilirubin',1,'44EC.00',NULL,'Serum total bilirubin level'),('total-bilirubin',1,'44E..',NULL,'Serum bilirubin level'),('total-bilirubin',1,'44E..00',NULL,'Serum bilirubin level'),('total-bilirubin',1,'44E3.',NULL,'Total bilirubin'),('total-bilirubin',1,'44E3.00',NULL,'Total bilirubin'),('total-bilirubin',1,'44EZ.',NULL,'Serum bilirubin NOS'),('total-bilirubin',1,'44EZ.00',NULL,'Serum bilirubin NOS');
INSERT INTO #codesreadv2
VALUES ('triglycerides',1,'44Q..',NULL,'Serum triglycerides'),('triglycerides',1,'44Q..00',NULL,'Serum triglycerides'),('triglycerides',1,'44Q4.',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44Q4.00',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44Q5.',NULL,'Serum random triglyceride level'),('triglycerides',1,'44Q5.00',NULL,'Serum random triglyceride level'),('triglycerides',1,'44QZ.',NULL,'Serum triglycerides NOS'),('triglycerides',1,'44QZ.00',NULL,'Serum triglycerides NOS');
INSERT INTO #codesreadv2
VALUES ('urea',1,'44J9.',NULL,'Serum urea level'),('urea',1,'44J9.00',NULL,'Serum urea level'),('urea',1,'44J8.',NULL,'Blood urea'),('urea',1,'44J8.00',NULL,'Blood urea'),('urea',1,'44J..',NULL,'Blood urea/renal function'),('urea',1,'44J..00',NULL,'Blood urea/renal function'),('urea',1,'44JA.',NULL,'Plasma urea level'),('urea',1,'44JA.00',NULL,'Plasma urea level'),('urea',1,'44JZ.',NULL,'Blood urea/renal function NOS'),('urea',1,'44JZ.00',NULL,'Blood urea/renal function NOS');
INSERT INTO #codesreadv2
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'46TC.00',NULL,'Urine albumin:creatinine ratio');
INSERT INTO #codesreadv2
VALUES ('urine-blood',1,'469..',NULL,'Urine blood test'),('urine-blood',1,'469..00',NULL,'Urine blood test'),('urine-blood',1,'4692.',NULL,'Urine blood test = negative'),('urine-blood',1,'4692.00',NULL,'Urine blood test = negative'),('urine-blood',1,'4693.',NULL,'Urine: trace non-haemol. blood'),('urine-blood',1,'4693.00',NULL,'Urine: trace non-haemol. blood'),('urine-blood',1,'4694.',NULL,'Urine: trace haemolysed blood'),('urine-blood',1,'4694.00',NULL,'Urine: trace haemolysed blood'),('urine-blood',1,'4695.',NULL,'Urine blood test = +'),('urine-blood',1,'4695.00',NULL,'Urine blood test = +'),('urine-blood',1,'4696.',NULL,'Urine blood test = ++'),('urine-blood',1,'4696.00',NULL,'Urine blood test = ++'),('urine-blood',1,'4697.',NULL,'Urine blood test = +++'),('urine-blood',1,'4697.00',NULL,'Urine blood test = +++');
INSERT INTO #codesreadv2
VALUES ('urine-glucose',1,'466..',NULL,'Urine test for glucose'),('urine-glucose',1,'466..00',NULL,'Urine test for glucose'),('urine-glucose',1,'4662.',NULL,'Urine glucose test negative'),('urine-glucose',1,'4662.00',NULL,'Urine glucose test negative'),('urine-glucose',1,'4663.',NULL,'Urine glucose test = trace'),('urine-glucose',1,'4663.00',NULL,'Urine glucose test = trace'),('urine-glucose',1,'4664.',NULL,'Urine glucose test = +'),('urine-glucose',1,'4664.00',NULL,'Urine glucose test = +'),('urine-glucose',1,'4665.',NULL,'Urine glucose test = ++'),('urine-glucose',1,'4665.00',NULL,'Urine glucose test = ++'),('urine-glucose',1,'4666.',NULL,'Urine glucose test = +++'),('urine-glucose',1,'4666.00',NULL,'Urine glucose test = +++'),('urine-glucose',1,'4667.',NULL,'Urine glucose test = ++++'),('urine-glucose',1,'4667.00',NULL,'Urine glucose test = ++++'),('urine-glucose',1,'4668.',NULL,'Glycosuria'),('urine-glucose',1,'4668.00',NULL,'Glycosuria');
INSERT INTO #codesreadv2
VALUES ('urine-ketones',1,'468..',NULL,'Urine ketone test'),('urine-ketones',1,'468..00',NULL,'Urine ketone test'),('urine-ketones',1,'4682.',NULL,'Urine ketone test negative'),('urine-ketones',1,'4682.00',NULL,'Urine ketone test negative'),('urine-ketones',1,'4683.',NULL,'Urine ketone test = trace'),('urine-ketones',1,'4683.00',NULL,'Urine ketone test = trace'),('urine-ketones',1,'4684.',NULL,'Urine ketone test = +'),('urine-ketones',1,'4684.00',NULL,'Urine ketone test = +'),('urine-ketones',1,'4685.',NULL,'Urine ketone test = ++'),('urine-ketones',1,'4685.00',NULL,'Urine ketone test = ++'),('urine-ketones',1,'4686.',NULL,'Urine ketone test = +++'),('urine-ketones',1,'4686.00',NULL,'Urine ketone test = +++'),('urine-ketones',1,'4687.',NULL,'Urine ketone test = ++++'),('urine-ketones',1,'4687.00',NULL,'Urine ketone test = ++++');
INSERT INTO #codesreadv2
VALUES ('urine-protein',1,'467..',NULL,'Urine protein test'),('urine-protein',1,'467..00',NULL,'Urine protein test'),('urine-protein',1,'4672.',NULL,'Urine protein test negative'),('urine-protein',1,'4672.00',NULL,'Urine protein test negative'),('urine-protein',1,'4673.',NULL,'Urine protein test = trace'),('urine-protein',1,'4673.00',NULL,'Urine protein test = trace'),('urine-protein',1,'4674.',NULL,'Urine protein test = +'),('urine-protein',1,'4674.00',NULL,'Urine protein test = +'),('urine-protein',1,'4675.',NULL,'Urine protein test = ++'),('urine-protein',1,'4675.00',NULL,'Urine protein test = ++'),('urine-protein',1,'4676.',NULL,'Urine protein test = +++'),('urine-protein',1,'4676.00',NULL,'Urine protein test = +++'),('urine-protein',1,'4677.',NULL,'Urine protein test = ++++'),('urine-protein',1,'4677.00',NULL,'Urine protein test = ++++'),('urine-protein',1,'4678.',NULL,'Proteinuria'),('urine-protein',1,'4678.00',NULL,'Proteinuria');
INSERT INTO #codesreadv2
VALUES ('urine-protein-creatinine-ratio',1,'44lD.',NULL,'Urine protein/creatinine ratio'),('urine-protein-creatinine-ratio',1,'44lD.00',NULL,'Urine protein/creatinine ratio');
INSERT INTO #codesreadv2
VALUES ('vitamin-d',1,'4QB4.',NULL,'Vitamin D level'),('vitamin-d',1,'4QB4.00',NULL,'Vitamin D level'),('vitamin-d',1,'44LA.',NULL,'Serum vitamin D'),('vitamin-d',1,'44LA.00',NULL,'Serum vitamin D'),('vitamin-d',1,'4QB44',NULL,'Combined total vitamin D2 and D3 level'),('vitamin-d',1,'4QB4400',NULL,'Combined total vitamin D2 and D3 level'),('vitamin-d',1,'4QB45',NULL,'25-Hydroxyvitamin D level'),('vitamin-d',1,'4QB4500',NULL,'25-Hydroxyvitamin D level'),('vitamin-d',1,'4QB46',NULL,'Total 25-hydroxyvitamin D level'),('vitamin-d',1,'4QB4600',NULL,'Total 25-hydroxyvitamin D level'),('vitamin-d',1,'4QB47',NULL,'Serum total 25-hydroxy vitamin D level'),('vitamin-d',1,'4QB4700',NULL,'Serum total 25-hydroxy vitamin D level');
INSERT INTO #codesreadv2
VALUES ('white-blood-cells',1,'42H..',NULL,'Total white cell count'),('white-blood-cells',1,'42H..00',NULL,'Total white cell count'),('white-blood-cells',1,'42H7.',NULL,'Total white blood count'),('white-blood-cells',1,'42H7.00',NULL,'Total white blood count'),('white-blood-cells',1,'42HZ.',NULL,'Total white cell count NOS'),('white-blood-cells',1,'42HZ.00',NULL,'Total white cell count NOS')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('diabetes',1,'C10..',NULL,'DM - Diabetes mellitus'),('diabetes',1,'C100.',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C1000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C1001',NULL,'Maturity onset diabetes'),('diabetes',1,'C100z',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C101.',NULL,'Diabetic ketoacidosis'),('diabetes',1,'C1010',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C1011',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101y',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101z',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C102.',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C1020',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C1021',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102z',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C103.',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C1030',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C1031',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103y',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103z',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C1040',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C1041',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104y',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104z',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C105.',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C1050',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C1051',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105y',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105z',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C1060',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C1061',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106y',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106z',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C1070',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C1071',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C1072',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107y',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107z',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C1080',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1081',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1082',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1083',NULL,'Insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1085',NULL,'Insulin-dependent diabetes mellitus with ulcer'),('diabetes',1,'C1086',NULL,'Insulin-dependent diabetes mellitus with gangrene'),('diabetes',1,'C1087',NULL,'IDDM - Insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1088',NULL,'Insulin-dependent diabetes mellitus - poor control'),('diabetes',1,'C1089',NULL,'Insulin-dependent diabetes maturity onset'),('diabetes',1,'C108y',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108z',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C1090',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1091',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1092',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1093',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1094',NULL,'Non-insulin-dependent diabetes mellitus with ulcer'),('diabetes',1,'C1095',NULL,'Non-insulin-dependent diabetes mellitus with gangrene'),('diabetes',1,'C1096',NULL,'NIDDM - Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1097',NULL,'Non-insulin-dependent diabetes mellitus - poor control'),('diabetes',1,'C10A0',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A1',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A2',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A3',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A4',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A5',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A6',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A7',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10B0',NULL,'Steroid-induced diabetes mellitus without complication'),('diabetes',1,'C10y.',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y0',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y1',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10yy',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yz',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10z.',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z0',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z1',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10zy',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zz',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'Cyu20',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu21',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu22',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu23',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'L180.',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),('diabetes',1,'L1800',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L1801',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L1802',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L1803',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L1804',NULL,'Diabetes mellitus in the puerperium - baby delivered during previous episode of care'),('diabetes',1,'L1805',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L1806',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L1807',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L1808',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L180z',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'Lyu29',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'Q441.',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'X40J4',NULL,'Insulin-dependent diabetes mellitus'),('diabetes',1,'X40J5',NULL,'Non-insulin-dependent diabetes mellitus'),('diabetes',1,'X40J6',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'X40J7',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'X40J8',NULL,'Malnutrition-related diabetes mellitus - fibrocalculous'),('diabetes',1,'X40J9',NULL,'Malnutrition-related diabetes mellitus - protein-deficient'),('diabetes',1,'X40JA',NULL,'Secondary diabetes mellitus'),('diabetes',1,'X40JB',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'X40JC',NULL,'Secondary endocrine diabetes mellitus'),('diabetes',1,'X40JE',NULL,'Reavens syndrome'),('diabetes',1,'X40JF',NULL,'Transitory neonatal diabetes mellitus'),('diabetes',1,'X40JG',NULL,'Genetic syndromes of diabetes mellitus'),('diabetes',1,'X40JI',NULL,'Maturity onset diabetes in youth type 1'),('diabetes',1,'X40JJ',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'X40JN',NULL,'Lipodystrophy, partial, with Reiger anomaly, short stature, and insulinopenic diabetes mellitus'),('diabetes',1,'X40JQ',NULL,'Muscular atrophy, ataxia, retinitis pigmentosa, and diabetes mellitus'),('diabetes',1,'X40JV',NULL,'Hypogonadism, diabetes mellitus, alopecia ,mental retardation and electrocardiographic abnormalities'),('diabetes',1,'X40JX',NULL,'Pineal hyperplasia, insulin-resistant diabetes mellitus and somatic abnormalities'),('diabetes',1,'X40JY',NULL,'Congenital insulin-dependent diabetes mellitus with fatal secretory diarrhoea'),('diabetes',1,'X40Ja',NULL,'Abnormal metabolic state in diabetes mellitus'),('diabetes',1,'X50GO',NULL,'Soft tissue complication of diabetes mellitus'),('diabetes',1,'XE10E',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'XE10F',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),
('diabetes',1,'XE10G',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'XE10H',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'XE10I',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'XE12C',NULL,'Insulin dependent diabetes mel'),('diabetes',1,'XE15k',NULL,'Diabetes mellitus with polyneuropathy'),('diabetes',1,'XM19i',NULL,'[EDTA] Diabetes Type I (insulin dependent) associated with renal failure'),('diabetes',1,'XM19j',NULL,'[EDTA] Diabetes Type II (non-insulin-dependent) associated with renal failure'),('diabetes',1,'XM1Qx',NULL,'Diabetes mellitus with gangrene'),('diabetes',1,'XSETH',NULL,'Maturity onset diabetes mellitus in young'),('diabetes',1,'XSETK',NULL,'Drug-induced diabetes mellitus'),('diabetes',1,'XSETp',NULL,'Diabetes mellitus due to insulin receptor antibodies'),('diabetes',1,'Xa08a',NULL,'Small for gestation neonatal diabetes mellitus'),('diabetes',1,'Xa4g7',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'Xa9FG',NULL,'Postpancreatectomy diabetes mellitus'),('diabetes',1,'XaA6b',NULL,'Perceived control of insulin-dependent diabetes'),('diabetes',1,'XaELP',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'XaELQ',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'XaEnn',NULL,'Type I diabetes mellitus with mononeuropathy'),('diabetes',1,'XaEno',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'XaEnp',NULL,'Type II diabetes mellitus with mononeuropathy'),('diabetes',1,'XaEnq',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'XaF04',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'XaF05',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'XaFWG',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'XaFWI',NULL,'Type II diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'XaFm8',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'XaFmA',NULL,'Type II diabetes mellitus with diabetic cataract'),('diabetes',1,'XaFmK',NULL,'Type I diabetes mellitus with peripheral angiopathy'),('diabetes',1,'XaFmL',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'XaFmM',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'XaFn7',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'XaFn8',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'XaFn9',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'XaIrf',NULL,'Hyperosmolar non-ketotic state in type II diabetes mellitus'),('diabetes',1,'XaIyz',NULL,'Diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaIz0',NULL,'Diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzM',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzN',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaIzQ',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzR',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaJQp',NULL,'Type II diabetes mellitus with exudative maculopathy'),('diabetes',1,'XaJSr',NULL,'Type I diabetes mellitus with exudative maculopathy'),('diabetes',1,'XaJUI',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'XaJlL',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'XaJlM',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'XaJlQ',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'XaJlR',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'XaKyW',NULL,'Type I diabetes mellitus with gastroparesis'),('diabetes',1,'XaKyX',NULL,'Type II diabetes mellitus with gastroparesis'),('diabetes',1,'XaMzI',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'XaOPt',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'XaOPu',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'XacoB',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'XaIfG',NULL,'Type II diabetes on insulin'),('diabetes',1,'XaIfI',NULL,'Type II diabetes on diet only');
INSERT INTO #codesctv3
VALUES ('hypertension',1,'G24..',NULL,'Secondary hypertension'),('hypertension',1,'G240.',NULL,'Malignant secondary hypertension'),('hypertension',1,'G241.',NULL,'Secondary benign hypertension'),('hypertension',1,'G244.',NULL,'Hypertension secondary to endocrine disorders'),('hypertension',1,'G24z.',NULL,'Secondary hypertension NOS'),('hypertension',1,'Gyu20',NULL,'[X]Other secondary hypertension'),('hypertension',1,'Gyu21',NULL,'[X]Hypertension secondary to other renal disorders'),('hypertension',1,'Xa0kX',NULL,'Hypertension due to renovascular disease'),('hypertension',1,'XE0Ub',NULL,'Systemic arterial hypertension'),('hypertension',1,'G2400',NULL,'Secondary malignant renovascular hypertension'),('hypertension',1,'G240z',NULL,'Secondary malignant hypertension NOS'),('hypertension',1,'G2410',NULL,'Secondary benign renovascular hypertension'),('hypertension',1,'G241z',NULL,'Secondary benign hypertension NOS'),('hypertension',1,'G24z0',NULL,'Secondary renovascular hypertension NOS'),('hypertension',1,'G20..',NULL,'Primary hypertension'),('hypertension',1,'G202.',NULL,'Systolic hypertension'),('hypertension',1,'G20z.',NULL,'Essential hypertension NOS'),('hypertension',1,'XE0Uc',NULL,'Primary hypertension'),('hypertension',1,'XE0W8',NULL,'Hypertension'),('hypertension',1,'XSDSb',NULL,'Diastolic hypertension'),('hypertension',1,'Xa0Cs',NULL,'Labile hypertension'),('hypertension',1,'Xa3fQ',NULL,'Malignant hypertension'),('hypertension',1,'XaZWm',NULL,'Stage 1 hypertension'),('hypertension',1,'XaZWn',NULL,'Severe hypertension'),('hypertension',1,'XaZbz',NULL,'Stage 2 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'XaZzo',NULL,'Nocturnal hypertension'),('hypertension',1,'G2...',NULL,'Hypertensive disease'),('hypertension',1,'G200.',NULL,'Malignant essential hypertension'),('hypertension',1,'G201.',NULL,'Benign essential hypertension'),('hypertension',1,'XE0Ud',NULL,'Essential hypertension NOS'),('hypertension',1,'Xa41E',NULL,'Maternal hypertension'),('hypertension',1,'Xab9L',NULL,'Stage 1 hypertension (NICE 2011) without evidence of end organ damage'),('hypertension',1,'Xab9M',NULL,'Stage 1 hypertension (NICE 2011) with evidence of end organ damage'),('hypertension',1,'G2y..',NULL,'Other specified hypertensive disease'),('hypertension',1,'G2z..',NULL,'Hypertensive disease NOS'),('hypertension',1,'Gyu2.',NULL,'[X]Hypertensive diseases'),('hypertension',1,'XM19D',NULL,'[EDTA] Renal vascular disease due to hypertension (no primary renal disease) associated with renal failure'),('hypertension',1,'XM19E',NULL,'[EDTA] Renal vascular disease due to malignant hypertension (no primary renal disease) associated with renal failure');
INSERT INTO #codesctv3
VALUES ('bmi',1,'22K..',NULL,'Body Mass Index'),('bmi',1,'22K1.',NULL,'Body Mass Index normal K/M2'),('bmi',1,'22K2.',NULL,'Body Mass Index high K/M2'),('bmi',1,'22K3.',NULL,'Body Mass Index low K/M2'),('bmi',1,'22K4.',NULL,'Body mass index index 25-29 - overweight'),('bmi',1,'22K5.',NULL,'Body mass index 30+ - obesity'),('bmi',1,'X76CO',NULL,'Quetelet index'),('bmi',1,'Xa7wG',NULL,'Observation of body mass index'),('bmi',1,'Xaa0k',NULL,'Childhood obesity'),('bmi',1,'Xaatm',NULL,'Child BMI centile'),('bmi',1,'Xabdn',NULL,'Downs syndrome BMI centile'),('bmi',1,'XabHx',NULL,'Obese class I (BMI 30.0-34.9)'),('bmi',1,'XabHy',NULL,'Obese class II (BMI 35.0-39.9)'),('bmi',1,'XabHz',NULL,'Obese cls III (BMI eq/gr 40.0)'),('bmi',1,'XabSe',NULL,'Child BMI < 0.4th centile'),('bmi',1,'XabSf',NULL,'Child BMI 0.4th-1.9th centile'),('bmi',1,'XabSg',NULL,'Child BMI on 2nd centile'),('bmi',1,'XabSh',NULL,'Child BMI 3rd-8th centile'),('bmi',1,'XabSj',NULL,'Child BMI on 9th centile'),('bmi',1,'XabSk',NULL,'Child BMI 10th-24th centile'),('bmi',1,'XabSl',NULL,'Child BMI on 25th centile'),('bmi',1,'XabSm',NULL,'Child BMI 26th-49th centile'),('bmi',1,'XabSn',NULL,'Child BMI on 50th centile'),('bmi',1,'XabTe',NULL,'Child BMI on 75th centile'),('bmi',1,'XabTf',NULL,'Child BMI 76th-90th centile'),('bmi',1,'XabTg',NULL,'Child BMI on 91st centile'),('bmi',1,'XabTh',NULL,'Child BMI 92nd-97th centile'),('bmi',1,'XabTi',NULL,'Child BMI on 98th centile'),('bmi',1,'XabTj',NULL,'Child BMI 98.1-99.6 centile'),('bmi',1,'XabTk',NULL,'Child BMI > 99.6th centile'),('bmi',1,'XabTZ',NULL,'Child BMI 51st-74th centile'),('bmi',1,'XaCDR',NULL,'Body mass index less than 20'),('bmi',1,'XaJJH',NULL,'BMI 40+ - severely obese'),('bmi',1,'XaJqk',NULL,'Body mass index 20-24 - normal'),('bmi',1,'XaVwA',NULL,'Body mass index centile'),('bmi',1,'XaZck',NULL,'Baseline BMI centile'),('bmi',1,'XaZcl',NULL,'Baseline body mass index'),('bmi',2,'22K..',NULL,'Body Mass Index');
INSERT INTO #codesctv3
VALUES ('height',1,'229..',NULL,'O/E - height'),('height',1,'229Z.',NULL,'O/E - height NOS');
INSERT INTO #codesctv3
VALUES ('weight',1,'22A..',NULL,'O/E - weight'),('weight',1,'22AZ.',NULL,'O/E - weight NOS');
INSERT INTO #codesctv3
VALUES ('alanine-aminotransferase',1,'44G3.',NULL,'ALT/SGPT serum level'),('alanine-aminotransferase',1,'44G..',NULL,'Liver enzymes (& blood level [ALT] or [SGPT])'),('alanine-aminotransferase',1,'XaLJx',NULL,'Serum alanine aminotransferase level'),('alanine-aminotransferase',1,'X771f',NULL,'ALT - blood level'),('alanine-aminotransferase',1,'X771e',NULL,'SGPT - blood level');
INSERT INTO #codesctv3
VALUES ('albumin',1,'XE2eA',NULL,'Serum albumin'),('albumin',1,'XE2eA',NULL,'Serum albumin level');
INSERT INTO #codesctv3
VALUES ('alkaline-phosphatase',1,'XE2px',NULL,'Serum alkaline phosphatase'),('alkaline-phosphatase',1,'XE2px',NULL,'Serum alkaline phosphatase level'),('alkaline-phosphatase',1,'44F3.',NULL,'Alkaline phosphatase level'),('alkaline-phosphatase',1,'44FZ.',NULL,'Serum alkaline phosphatase NOS');
INSERT INTO #codesctv3
VALUES ('b12',1,'42TZ.',NULL,'Serum vitamin B12 NOS'),('b12',1,'XE2pf',NULL,'Serum vitamin B12 level'),('b12',1,'X76tA',NULL,'Vitamin B12 level'),('b12',1,'XaJ27',NULL,'Plasma vitamin B12 level'),('b12',1,'42T..',NULL,'Serum vitamin B12 (& level)');
INSERT INTO #codesctv3
VALUES ('calcium',1,'44I8.',NULL,'Serum calcium'),('calcium',1,'44IC.',NULL,'Adjusted serum calcium level'),('calcium',1,'XaDvd',NULL,'Blood calcium level'),('calcium',1,'XaIdR',NULL,'Serum ionized calcium (pH 7.4) level'),('calcium',1,'XaIRk',NULL,'Plasma calcium level'),('calcium',1,'XaIRn',NULL,'Plasma corrected calcium level'),('calcium',1,'XaIU0',NULL,'Serum ionised calcium level'),('calcium',1,'XaX4E',NULL,'Blood ionised calcium level'),('calcium',1,'XaZyY',NULL,'Calcium adjusted level'),('calcium',1,'XE2q3',NULL,'Serum calcium level');
INSERT INTO #codesctv3
VALUES ('cholesterol',1,'X772L',NULL,'Cholesterol level'),('cholesterol',1,'X772M',NULL,'High density lipoprot chol lev'),('cholesterol',1,'X772N',NULL,'LDL-Low dens lipoprot chol lev'),('cholesterol',1,'X773m',NULL,'Percentage chol as ester'),('cholesterol',1,'X773W',NULL,'HDL/LDL ratio'),('cholesterol',1,'X80J1',NULL,'HDL - High density lipoprotein'),('cholesterol',1,'X80Nb',NULL,'Hi density lipoprot subfrac 2'),('cholesterol',1,'X80Nc',NULL,'Hi density lipoprot subfrac 3'),('cholesterol',1,'X80Ne',NULL,'LDL - Low density lipoprotein'),('cholesterol',1,'X80NT',NULL,'Free cholesterol'),('cholesterol',1,'X80NU',NULL,'Cholesterol ester'),('cholesterol',1,'XabE1',NULL,'Se non HDL cholesterol level'),('cholesterol',1,'XabT0',NULL,'Estim serum non-HDL cholest lv'),('cholesterol',1,'Xabub',NULL,'Se HDL chol:triglyceride ratio'),('cholesterol',1,'XaEil',NULL,'Hi dens lipoprt/tot chol ratio'),('cholesterol',1,'XaERR',NULL,'Cholesterol/HDL ratio'),('cholesterol',1,'XaEUp',NULL,'Lipoprotein cholesterol ratio'),('cholesterol',1,'XaEUq',NULL,'Serum cholesterol/HDL ratio'),('cholesterol',1,'XaEUr',NULL,'Plasma cholesterol/HDL ratio'),('cholesterol',1,'XaEUs',NULL,'Serum cholesterol/LDL ratio'),('cholesterol',1,'XaEUt',NULL,'Plasma cholesterol/LDL ratio'),('cholesterol',1,'XaEUu',NULL,'Serum cholesterol/VLDL ratio'),('cholesterol',1,'XaEUv',NULL,'Plasma cholesterol/VLDL ratio'),('cholesterol',1,'XaEVQ',NULL,'Serum LDL/HDL ratio'),('cholesterol',1,'XaEVr',NULL,'Plasma HDL cholesterol level'),('cholesterol',1,'XaEVR',NULL,'Plasma LDL/HDL ratio'),('cholesterol',1,'XaEVs',NULL,'Plasma LDL cholesterol level'),('cholesterol',1,'XaFs9',NULL,'Fasting cholesterol level'),('cholesterol',1,'XaIp4',NULL,'Calculated LDL cholesterol lev'),('cholesterol',1,'XaIqd',NULL,'Pre-treatmnt serum cholest lev'),('cholesterol',1,'XaIRd',NULL,'Plasma total cholesterol level'),('cholesterol',1,'XaIYp',NULL,'Fluid sample cholesterol level'),('cholesterol',1,'XaJe9',NULL,'Serum total cholesterol level'),('cholesterol',1,'XaLux',NULL,'Serum fastng total cholesterol'),('cholesterol',1,'XaN3z',NULL,'Non HDL cholesterol level'),('cholesterol',1,'XE28o',NULL,'HDL : LDL ratio'),('cholesterol',1,'XE2eD',NULL,'Serum cholesterol'),('cholesterol',1,'XE2mn',NULL,'Ser HDL/non-HDL cholest ratio'),('cholesterol',1,'XSK14',NULL,'Total cholesterol measurement'),('cholesterol',1,'44P..',NULL,'Serum cholesterol'),('cholesterol',1,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',1,'44PL.',NULL,'Non HDL cholesterol level'),('cholesterol',1,'44PL1',NULL,'Estimated serum non-high density lipoprotein cholesterol level'),('cholesterol',1,'44PL0',NULL,'Serum non high density lipoprotein cholesterol level'),('cholesterol',1,'44PK.',NULL,'Serum fasting total cholesterol'),('cholesterol',1,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',1,'44PI.',NULL,'Calculated LDL cholesterol level'),('cholesterol',1,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',1,'44PG.',NULL,'HDL : total cholesterol ratio'),('cholesterol',1,'44PF.',NULL,'Total cholesterol:HDL ratio'),('cholesterol',1,'44PE.',NULL,'Serum random LDL cholesterol level'),('cholesterol',1,'44PD.',NULL,'Serum fasting LDL cholesterol level'),('cholesterol',1,'44PC.',NULL,'Serum random HDL cholesterol level'),('cholesterol',1,'44PB.',NULL,'Serum fasting HDL cholesterol level'),('cholesterol',1,'44P9.',NULL,'Serum cholesterol studies'),('cholesterol',1,'44P8.',NULL,'Serum HDL:non-HDL cholesterol ratio'),('cholesterol',1,'44P7.',NULL,'Serum VLDL cholesterol level'),('cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('cholesterol',1,'44P4.',NULL,'Serum cholesterol very high'),('cholesterol',1,'44P3.',NULL,'Serum cholesterol raised'),('cholesterol',1,'44P2.',NULL,'Serum cholesterol borderline'),('cholesterol',1,'44P1.',NULL,'Serum cholesterol normal'),('cholesterol',1,'44PA.',NULL,'HDL : LDL ratio'),('cholesterol',1,'44lM.',NULL,'Plasma LDL/HDL ratio'),('cholesterol',1,'44lL.',NULL,'Serum LDL/HDL ratio'),('cholesterol',1,'44lK.',NULL,'Plasma cholesterol/VLDL ratio'),('cholesterol',1,'44lJ.',NULL,'Serum cholesterol/VLDL ratio'),('cholesterol',1,'44lI.',NULL,'Plasma cholesterol/LDL ratio'),('cholesterol',1,'44lH.',NULL,'Serum cholesterol/LDL ratio'),('cholesterol',1,'44lG.',NULL,'Plasma cholesterol/HDL ratio'),('cholesterol',1,'44lF.',NULL,'Serum cholesterol/HDL ratio'),('cholesterol',1,'44l2.',NULL,'Cholesterol/HDL ratio'),('cholesterol',1,'44dB.',NULL,'Plasma LDL cholesterol level'),('cholesterol',1,'44dA.',NULL,'Plasma HDL cholesterol level'),('cholesterol',1,'44d5.',NULL,'Plasma fasting LDL cholesterol level'),('cholesterol',1,'44d4.',NULL,'Plasma random LDL cholesterol level'),('cholesterol',1,'44d3.',NULL,'Plasma fasting HDL cholesterol level'),('cholesterol',1,'44d2.',NULL,'Plasma random HDL cholesterol level'),('cholesterol',1,'44R4.',NULL,'LDL - electrophoresis'),('cholesterol',1,'44R4.',NULL,'Lipoprotein electroph. - LDL'),('cholesterol',1,'44R3.',NULL,'HDL - electrophoresis'),('cholesterol',1,'44R3.',NULL,'Lipoprotein electroph. - HDL'),('cholesterol',1,'662a.',NULL,'Pre-treatment serum cholesterol level'),('cholesterol',1,'44OE.',NULL,'Plasma total cholesterol level'),('cholesterol',1,'44lzY',NULL,'Serum high density lipoprotein cholesterol:triglyceride ratio'),('cholesterol',1,'4I3O.',NULL,'Fluid sample cholesterol level'),('cholesterol',2,'XSK14',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PH.',NULL,'Total cholesterol measurement'),('cholesterol',2,'44PJ.',NULL,'Serum total cholesterol level'),('cholesterol',2,'44P..',NULL,'Serum cholesterol'),('cholesterol',2,'44PZ.',NULL,'Serum cholesterol NOS'),('cholesterol',2,'XE2eD',NULL,'Serum cholesterol'),('cholesterol',2,'XaJe9',NULL,'Serum total cholesterol level');
INSERT INTO #codesctv3
VALUES ('cholesterol-hdl-ratio',1,'44PF.',NULL,'Total cholesterol:HDL ratio');
INSERT INTO #codesctv3
VALUES ('creatinine',1,'XE2q5',NULL,'Serum creatinine'),('creatinine',1,'XE2q5',NULL,'Serum creatinine level'),('creatinine',1,'XaERc',NULL,'Corrected serum creatinine level'),('creatinine',1,'XaERX',NULL,'Corrected plasma creatinine level'),('creatinine',1,'44J3z',NULL,'Serum creatinine NOS');
INSERT INTO #codesctv3
VALUES ('diastolic-blood-pressure',1,'X779S',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'X779T',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'Xac5K',NULL,'Baseline diastolic BP'),('diastolic-blood-pressure',1,'Xaedp',NULL,'Non-invasive centrl diastlc BP'),('diastolic-blood-pressure',1,'XaF4a',NULL,'Ave day diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4b',NULL,'Ave 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4e',NULL,'24h diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4Q',NULL,'Min diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4R',NULL,'Max diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4S',NULL,'Ave diastolic blood pressure'),('diastolic-blood-pressure',1,'XaF4T',NULL,'Min day diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4U',NULL,'Min night diast blood pressure'),('diastolic-blood-pressure',1,'XaF4V',NULL,'Min 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4W',NULL,'Max night diast blood pressure'),('diastolic-blood-pressure',1,'XaF4X',NULL,'Max day diast blood pressure'),('diastolic-blood-pressure',1,'XaF4Y',NULL,'Max 24h diastol blood pressure'),('diastolic-blood-pressure',1,'XaF4Z',NULL,'Ave night diast blood pressure'),('diastolic-blood-pressure',1,'XaIwk',NULL,'Standing diastolic BP'),('diastolic-blood-pressure',1,'XaJ2F',NULL,'Sitting diastolic BP'),('diastolic-blood-pressure',1,'XaJ2H',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'XaKFw',NULL,'Average home diastolic BP'),('diastolic-blood-pressure',1,'XaKjG',NULL,'Ambulatory diastolic BP'),('diastolic-blood-pressure',1,'XaYg8',NULL,'Diastolic BP centile'),('diastolic-blood-pressure',1,'XM02Y',NULL,'DAP-Diastolic arterial pressur'),('diastolic-blood-pressure',1,'246o1',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'246n0',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'246m.',NULL,'Average diastolic blood pressure'),('diastolic-blood-pressure',1,'246i.',NULL,'Diastolic blood pressure centile'),('diastolic-blood-pressure',1,'246f.',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'246c.',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'246a.',NULL,'Average night interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246X.',NULL,'Average day interval diastolic blood pressure'),('diastolic-blood-pressure',1,'246V.',NULL,'Average 24 hour diastolic blood pressure'),('diastolic-blood-pressure',1,'246T.',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'246R.',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'246P.',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'246L.',NULL,'Target diastolic blood pressure'),('diastolic-blood-pressure',1,'246A.',NULL,'O/E - Diastolic BP reading');
INSERT INTO #codesctv3
VALUES ('egfr',1,'X70kK',NULL,'Tc99m-DTPA clearance - GFR'),('egfr',1,'X70kL',NULL,'Cr51- EDTA clearance - GFR'),('egfr',1,'X90kf',NULL,'With GFR'),('egfr',1,'XaK8y',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'XaMDA',NULL,'Glomerular filtration rate calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin'),('egfr',1,'XaZpN',NULL,'Estimated glomerular filtration rate using Chronic Kidney Disease Epidemiology Collaboration formula per 1.73 square metres'),('egfr',1,'XacUJ',NULL,'Estimated glomerular filtration rate using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'XacUK',NULL,'Estimated glomerular filtration rate using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres');
INSERT INTO #codesctv3
VALUES ('ferritin',1,'XaItW',NULL,'Plasma ferritin level'),('ferritin',1,'42R41',NULL,'Ferritin level low'),('ferritin',1,'42R42',NULL,'Serum ferritin normal'),('ferritin',1,'42R4200',NULL,'Serum ferritin normal'),('ferritin',1,'XaIRQ',NULL,'Serum ferritin high'),('ferritin',1,'X76t9',NULL,'Ferritin level'),('ferritin',1,'XE24r',NULL,'Serum ferritin level');
INSERT INTO #codesctv3
VALUES ('folate',1,'42U4.',NULL,'Red blood cell folate level'),('folate',1,'42U5.',NULL,'Serum folate level'),('folate',1,'X76tC',NULL,'Plasma folate level');
INSERT INTO #codesctv3
VALUES ('fsh',1,'4434.',NULL,'FSH level'),('fsh',1,'XE25J',NULL,'FSH - Follicle stimulating hormone level'),('fsh',1,'4434.',NULL,'Serum FSH level'),('fsh',1,'XaELZ',NULL,'Plasma FSH level'),('fsh',1,'XM0lx',NULL,'Serum follicle stimulating hormone level');
INSERT INTO #codesctv3
VALUES ('gamma-glutamyl-transferase',1,'44G4.',NULL,'Gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'XaES3',NULL,'Serum gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'XaES4',NULL,'Plasma gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'X80E1',NULL,'Gamma-glutamyl transferase'),('gamma-glutamyl-transferase',1,'XE28U',NULL,'Gammaglutamyl transferase (& level)');
INSERT INTO #codesctv3
VALUES ('haemoglobin',1,'Xa96v',NULL,'Haemoglobin concentration'),('haemoglobin',1,'XE2m6',NULL,'Haemoglobin estimation level');
INSERT INTO #codesctv3
VALUES ('hba1c',1,'X772q',NULL,'Haemoglobin A1c level'),('hba1c',1,'XE24t',NULL,'Hb. A1C - diabetic control'),('hba1c',1,'42W1.',NULL,'Hb. A1C < 7% - good control'),('hba1c',1,'42W2.',NULL,'Hb. A1C 7-10% - borderline'),('hba1c',1,'42W3.',NULL,'Hb. A1C > 10% - bad control'),('hba1c',1,'42WZ.',NULL,'Hb. A1C - diabetic control NOS'),('hba1c',1,'X80U4',NULL,'Glycosylat haemoglobin-c frac'),('hba1c',1,'XaCES',NULL,'HbA1 - diabetic control'),('hba1c',1,'XaCET',NULL,'HbA1 <7% - good control'),('hba1c',1,'XaCEV',NULL,'HbA1 >10% - bad control'),('hba1c',1,'XaCEU',NULL,'HbA1 7-10% - borderline contrl'),('hba1c',1,'XaERp',NULL,'HbA1c level (DCCT aligned)'),('hba1c',1,'XaPbt',NULL,'HbA1c levl - IFCC standardised'),('hba1c',1,'XabrE',NULL,'HbA1c (diagnostic refrn range)'),('hba1c',1,'XabrF',NULL,'HbA1c (monitoring ranges)'),('hba1c',1,'Xaezd',NULL,'HbA1c(diagnos ref rnge)IFCC st'),('hba1c',1,'Xaeze',NULL,'HbA1c(monitoring rnges)IFCC st'),('hba1c',1,'42W..',NULL,'Hb. A1C - diabetic control'),('hba1c',1,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',1,'42W51',NULL,'HbA1c (haemoglobin A1c) level (monitoring ranges) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W50',NULL,'HbA1c (haemoglobin A1c) level (diagnostic reference range) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'42W4.',NULL,'HbA1c level (DCCT aligned)'),('hba1c',1,'44TB.',NULL,'Haemoglobin A1c level'),('hba1c',1,'44TB1',NULL,'Haemoglobin A1c (monitoring ranges)'),('hba1c',1,'44TB0',NULL,'Haemoglobin A1c (diagnostic reference range)'),('hba1c',2,'XaERp',NULL,'HbA1c level (DCCT aligned)'),('hba1c',2,'XaPbt',NULL,'HbA1c levl - IFCC standardised'),('hba1c',2,'42W5.',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',2,'42W4.',NULL,'HbA1c level (DCCT aligned)');
INSERT INTO #codesctv3
VALUES ('hdl-cholesterol',1,'44P5.',NULL,'Serum HDL cholesterol level'),('hdl-cholesterol',1,'44PC.',NULL,'Ser random HDL cholesterol lev'),('hdl-cholesterol',1,'XaEVr',NULL,'Plasma HDL cholesterol level');
INSERT INTO #codesctv3
VALUES ('ldl-cholesterol',1,'44P6.',NULL,'Serum LDL cholesterol level'),('ldl-cholesterol',1,'XaIp4',NULL,'Calculated LDL cholesterol lev'),('ldl-cholesterol',1,'XaEVs',NULL,'Plasma LDL cholesterol level');
INSERT INTO #codesctv3
VALUES ('luteinising-hormone',1,'XE25I',NULL,'Luteinising hormone level'),('luteinising-hormone',1,'4433.',NULL,'Serum luteinising hormone level'),('luteinising-hormone',1,'XM0lv',NULL,'Serum luteinising hormone level'),('luteinising-hormone',1,'XaELa',NULL,'Plasma luteinising hormone level'),('luteinising-hormone',1,'46J6.',NULL,'Urine luteinising hormone level');
INSERT INTO #codesctv3
VALUES ('mean-corpuscular-volume',1,'42A..',NULL,'Mean cell volume'),('mean-corpuscular-volume',1,'42AZ.',NULL,'MCV - NOS');
INSERT INTO #codesctv3
VALUES ('oestradiol',1,'4465.',NULL,'Serum oestradiol level'),('oestradiol',1,'X7723',NULL,'Oestradiol level'),('oestradiol',1,'XaEQo',NULL,'Plasma oestradiol level');
INSERT INTO #codesctv3
VALUES ('parathyroid-hormone',1,'X7726',NULL,'Parathyroid hormone level'),('parathyroid-hormone',1,'XaIdU',NULL,'Plasma parathyroid hormone level'),('parathyroid-hormone',1,'XE2xc',NULL,'Serum parathyroid hormone level'),('parathyroid-hormone',1,'XE28A',NULL,'Serum parathyroid hormone (& level (& serum))');
INSERT INTO #codesctv3
VALUES ('platelets',1,'42P..',NULL,'Platelet count'),('platelets',1,'42P1.',NULL,'Platelet count normal'),('platelets',1,'42PZ.',NULL,'Platelet count NOS');
INSERT INTO #codesctv3
VALUES ('potassium',1,'44I4.',NULL,'Serum potassium (& level)'),('potassium',1,'XaDvZ',NULL,'Blood potassium level'),('potassium',1,'XaIRl',NULL,'Plasma potassium level'),('potassium',1,'XE2pz',NULL,'Serum potassium level');
INSERT INTO #codesctv3
VALUES ('progesterone',1,'4463.',NULL,'Serum progesterone (& level)'),('progesterone',1,'X7727',NULL,'Progesterone level'),('progesterone',1,'XE2dq',NULL,'Serum progesterone level');
INSERT INTO #codesctv3
VALUES ('red-blood-cells',1,'426..',NULL,'Red blood cell count'),('red-blood-cells',1,'426Z.',NULL,'RBC count NOS');
INSERT INTO #codesctv3
VALUES ('sex-hormone-binding-globulin',1,'44CD.',NULL,'Serum sex hormone binding globulin level');
INSERT INTO #codesctv3
VALUES ('sodium',1,'XE2q0',NULL,'Serum sodium level'),('sodium',1,'XaDva',NULL,'Blood sodium level'),('sodium',1,'XaIRf',NULL,'Plasma sodium level'),('sodium',1,'44I5.',NULL,'Serum sodium (& level)'),('sodium',1,'X771T',NULL,'Sodium level');
INSERT INTO #codesctv3
VALUES ('systolic-blood-pressure',1,'X779Q',NULL,'Non-invasive systol art press'),('systolic-blood-pressure',1,'X779R',NULL,'Invasive systol arterial press'),('systolic-blood-pressure',1,'Xac5L',NULL,'Baseline systolic BP'),('systolic-blood-pressure',1,'Xaedo',NULL,'Non-invasive central systlc BP'),('systolic-blood-pressure',1,'XaF4d',NULL,'24h systolic blood pressure'),('systolic-blood-pressure',1,'XaF4D',NULL,'Min systolic blood pressure'),('systolic-blood-pressure',1,'XaF4E',NULL,'Max systolic blood pressure'),('systolic-blood-pressure',1,'XaF4F',NULL,'Ave systolic blood pressure'),('systolic-blood-pressure',1,'XaF4G',NULL,'Min day systol blood pressure'),('systolic-blood-pressure',1,'XaF4H',NULL,'Min night syst blood pressure'),('systolic-blood-pressure',1,'XaF4I',NULL,'Max night syst blood pressure'),('systolic-blood-pressure',1,'XaF4J',NULL,'Max day syst blood pressure'),('systolic-blood-pressure',1,'XaF4K',NULL,'Ave night syst blood pressure'),('systolic-blood-pressure',1,'XaF4L',NULL,'Ave day systol blood pressure'),('systolic-blood-pressure',1,'XaF4M',NULL,'Min 24h systol blood pressure'),('systolic-blood-pressure',1,'XaF4N',NULL,'Max 24h systol blood pressure'),('systolic-blood-pressure',1,'XaF4O',NULL,'Ave 24h systol blood pressure'),('systolic-blood-pressure',1,'XaIwj',NULL,'Standing systolic BP'),('systolic-blood-pressure',1,'XaJ2E',NULL,'Sitting systolic BP'),('systolic-blood-pressure',1,'XaJ2G',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'XaKFx',NULL,'Average home systolic BP'),('systolic-blood-pressure',1,'XaKjF',NULL,'Ambulatory systolic BP'),('systolic-blood-pressure',1,'XaXfX',NULL,'Post exerc sys BP respons norm'),('systolic-blood-pressure',1,'XaXfY',NULL,'Post exer sys BP respon abnorm'),('systolic-blood-pressure',1,'XaYg9',NULL,'Systolic BP centile'),('systolic-blood-pressure',1,'XM02X',NULL,'SAP - Systol arterial pressure'),('systolic-blood-pressure',1,'246o0',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'246n1',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'246l.',NULL,'Average systolic blood pressure'),('systolic-blood-pressure',1,'246j.',NULL,'Systolic blood pressure centile'),('systolic-blood-pressure',1,'246e.',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'246d.',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'246b.',NULL,'Average night interval systolic blood pressure'),('systolic-blood-pressure',1,'246Y.',NULL,'Average day interval systolic blood pressure'),('systolic-blood-pressure',1,'246W.',NULL,'Average 24 hour systolic blood pressure'),('systolic-blood-pressure',1,'246S.',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'246Q.',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'246N.',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'246K.',NULL,'Target systolic blood pressure'),('systolic-blood-pressure',1,'2469.',NULL,'O/E - Systolic BP reading');
INSERT INTO #codesctv3
VALUES ('testosterone',1,'XE2dr',NULL,'Serum testosterone level'),('testosterone',1,'4473.',NULL,'Serum testosterone'),('testosterone',1,'XaItQ',NULL,'Plasma testosterone level');
INSERT INTO #codesctv3
VALUES ('total-bilirubin',1,'XaERu',NULL,'Serum total bilirubin level'),('total-bilirubin',1,'44E..',NULL,'Serum bilirubin level'),('total-bilirubin',1,'XE2qu',NULL,'Total bilirubin level'),('total-bilirubin',1,'XE2qu',NULL,'Total bilirubin');
INSERT INTO #codesctv3
VALUES ('triglycerides',1,'XE2q9',NULL,'Serum triglycerides'),('triglycerides',1,'XE2q9',NULL,'Serum triglyceride levels'),('triglycerides',1,'44Q4.',NULL,'Serum fasting triglyceride level'),('triglycerides',1,'44QZ.',NULL,'Serum triglycerides NOS');
INSERT INTO #codesctv3
VALUES ('urea',1,'XM0lt',NULL,'Serum urea level'),('urea',1,'X771P',NULL,'Blood urea'),('urea',1,'X771P',NULL,'Urea - blood'),('urea',1,'XaDvl',NULL,'Plasma urea level'),('urea',1,'44JZ.',NULL,'Blood urea/renal function NOS');
INSERT INTO #codesctv3
VALUES ('urinary-albumin-creatinine-ratio',1,'46TC.',NULL,'Urine albumin:creatinine ratio'),('urinary-albumin-creatinine-ratio',1,'XE2n3',NULL,'Urine albumin:creatinine ratio');
INSERT INTO #codesctv3
VALUES ('urine-blood',1,'4692.',NULL,'Urine blood test = negative'),('urine-blood',1,'4693.',NULL,'Urine: trace non-haemol. blood'),('urine-blood',1,'4694.',NULL,'Urine: trace haemolysed blood'),('urine-blood',1,'4695.',NULL,'Urine blood test = +'),('urine-blood',1,'4696.',NULL,'Urine blood test = ++'),('urine-blood',1,'4697.',NULL,'Urine blood test = +++');
INSERT INTO #codesctv3
VALUES ('urine-glucose',1,'466..',NULL,'Glucose - urine test'),('urine-glucose',1,'4662.',NULL,'Urine glucose test negative'),('urine-glucose',1,'4663.',NULL,'Urine glucose test = trace'),('urine-glucose',1,'4664.',NULL,'Urine glucose test = +'),('urine-glucose',1,'4665.',NULL,'Urine glucose test = ++'),('urine-glucose',1,'4666.',NULL,'Urine glucose test = +++'),('urine-glucose',1,'4667.',NULL,'Urine glucose test = ++++');
INSERT INTO #codesctv3
VALUES ('urine-ketones',1,'468..',NULL,'Urine ketone test'),('urine-ketones',1,'4682.',NULL,'Urine ketone test negative'),('urine-ketones',1,'4683.',NULL,'Urine ketone test = trace'),('urine-ketones',1,'4684.',NULL,'Urine ketone test = +'),('urine-ketones',1,'4685.',NULL,'Urine ketone test = ++'),('urine-ketones',1,'4686.',NULL,'Urine ketone test = +++'),('urine-ketones',1,'4687.',NULL,'Urine ketone test = ++++');
INSERT INTO #codesctv3
VALUES ('urine-protein',1,'467..',NULL,'Urine protein test'),('urine-protein',1,'4672.',NULL,'Urine protein test negative'),('urine-protein',1,'4673.',NULL,'Urine protein test = trace'),('urine-protein',1,'4674.',NULL,'Urine protein test = +'),('urine-protein',1,'4675.',NULL,'Urine protein test = ++'),('urine-protein',1,'4676.',NULL,'Urine protein test = +++'),('urine-protein',1,'4677.',NULL,'Urine protein test = ++++');
INSERT INTO #codesctv3
VALUES ('urine-protein-creatinine-ratio',1,'XaEMS',NULL,'Urine protein/creatinine ratio');
INSERT INTO #codesctv3
VALUES ('vitamin-d',1,'44LA.',NULL,'Serum vitamin D'),('vitamin-d',1,'Xabo0',NULL,'Serum total 25-OH vit D level'),('vitamin-d',1,'XaY6m',NULL,'Total 25-hydroxyvitamin D levl'),('vitamin-d',1,'XE2e7',NULL,'Serum vitamin D level'),('vitamin-d',1,'XaXhN',NULL,'Vitamin D level'),('vitamin-d',1,'XaXhT',NULL,'Combined total vit D2 + D3 lvl'),('vitamin-d',1,'XaXm0',NULL,'25-Hydroxyvitamin D level');
INSERT INTO #codesctv3
VALUES ('white-blood-cells',1,'XaIdY',NULL,'Total white blood count'),('white-blood-cells',1,'42H..',NULL,'White blood cell count'),('white-blood-cells',1,'42H..',NULL,'White blood cell count - observation'),('white-blood-cells',1,'42HZ.',NULL,'Total white cell count NOS')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('bmi',1,'6497000',NULL,'Decreased body mass index (finding)'),('bmi',1,'35425004',NULL,'Normal body mass index (finding)'),('bmi',1,'48499001',NULL,'Increased body mass index (finding)'),('bmi',1,'162863004',NULL,'Body mass index 25-29 - overweight'),('bmi',1,'162864005',NULL,'BMI 30+ - obesity'),('bmi',1,'301331008',NULL,'Observation of body mass index'),('bmi',1,'310252000',NULL,'BMI less than 20'),('bmi',1,'408512008',NULL,'Body mass index 40+ - morbidly obese'),('bmi',1,'412768003',NULL,'Body mass index 20-24 - normal'),('bmi',1,'427090001',NULL,'Body mass index less than 16.5'),('bmi',1,'450451007',NULL,'Childhood overweight BMI greater than 85 percentile'),('bmi',1,'722595002',NULL,'Overweight in adulthood with BMI of 25 or more but less than 30'),('bmi',1,'920141000000102',NULL,'Child BMI (body mass index) less than 0.4th centile'),('bmi',1,'920161000000101',NULL,'Child BMI (body mass index) 0.4th-1.9th centile'),('bmi',1,'920181000000105',NULL,'Child BMI (body mass index) on 2nd centile'),('bmi',1,'920201000000109',NULL,'Child BMI (body mass index) 3rd-8th centile'),('bmi',1,'920231000000103',NULL,'Child BMI (body mass index) on 9th centile'),('bmi',1,'920251000000105',NULL,'Child BMI (body mass index) 10th-24th centile'),('bmi',1,'920271000000101',NULL,'Child BMI (body mass index) on 25th centile'),('bmi',1,'920291000000102',NULL,'Child BMI (body mass index) 26th-49th centile'),('bmi',1,'920311000000101',NULL,'Child BMI (body mass index) on 50th centile'),('bmi',1,'920841000000108',NULL,'Child BMI (body mass index) 51st-74th centile'),('bmi',1,'920931000000108',NULL,'Child BMI (body mass index) on 75th centile'),('bmi',1,'920951000000101',NULL,'Child BMI (body mass index) 76th-90th centile'),('bmi',1,'920971000000105',NULL,'Child BMI (body mass index) on 91st centile'),('bmi',1,'920991000000109',NULL,'Child BMI (body mass index) 92nd-97th centile'),('bmi',1,'921011000000105',NULL,'Child BMI (body mass index) on 98th centile'),('bmi',1,'921031000000102',NULL,'Child BMI (body mass index) 98.1st-99.6th centile'),('bmi',1,'921051000000109',NULL,'Child BMI (body mass index) greater than 99.6th centile'),('bmi',1,'914721000000105',NULL,'Obese class I (body mass index 30.0 - 34.9)'),('bmi',1,'914731000000107',NULL,'Obese class II (body mass index 35.0 - 39.9)'),('bmi',1,'914741000000103',NULL,'Obese class III (body mass index equal to or greater than 40.0)'),('bmi',1,'443371000124107',NULL,'Body mass index 30.00 to 34.99'),('bmi',1,'443381000124105',NULL,'Body mass index 35.00 to 39.99'),('bmi',1,'60621009',NULL,'Quetelet index'),('bmi',1,'846931000000101',NULL,'Baseline BMI (body mass index)'),('bmi',1,'852451000000103',NULL,'Maximum body mass index (observable entity)'),('bmi',1,'852461000000100',NULL,'Minimum body mass index (observable entity)'),('bmi',1,'446974000',NULL,'Body mass index centile'),('bmi',1,'846911000000109',NULL,'Baseline BMI (body mass index) centile'),('bmi',1,'896691000000102',NULL,'Child BMI (body mass index) centile'),('bmi',1,'926011000000101',NULL,'Downs syndrome BMI (body mass index) centile'),('bmi',1,'722562008',NULL,'Foetal or neonatal effect or suspected effect of maternal obesity with adult body mass index 30 or greater but less than 40'),('bmi',1,'722563003',NULL,'Foetal or neonatal effect of maternal obesity with adult body mass index equal to or greater than 40'),('bmi',1,'705131003',NULL,'Child at risk for overweight body mass index greater than 85 percentile'),('bmi',1,'43991000119102',NULL,'History of childhood obesity BMI 95-100 percentile'),('bmi',1,'698094009',NULL,'Calculation of body mass index'),('bmi',1,'444862003',NULL,'Childhood obesity BMI 95-100 percentile'),('bmi',2,'301331008',NULL,'Finding of body mass index (finding)');
INSERT INTO #codessnomed
VALUES ('height',1,'14456009',NULL,'Measuring height of patient'),('height',1,'50373000',NULL,'Body height measure'),('height',1,'139977008',NULL,'O/E - height'),('height',1,'162755006',NULL,'On examination - height'),('height',1,'248327008',NULL,'General finding of height'),('height',1,'248333004',NULL,'Standing height');
INSERT INTO #codessnomed
VALUES ('weight',1,'27113001',NULL,'Body weight'),('weight',1,'139985004',NULL,'O/E - weight'),('weight',1,'162763007',NULL,'On examination - weight'),('weight',1,'248341004',NULL,'General weight finding'),('weight',1,'248345008',NULL,'Body weight'),('weight',1,'271604008',NULL,'Weight finding'),('weight',1,'301333006',NULL,'Finding of measures of body weight'),('weight',1,'363808001',NULL,'Measured body weight'),('weight',1,'424927000',NULL,'Body weight with shoes'),('weight',1,'425024002',NULL,'Body weight without shoes'),('weight',1,'735395000',NULL,'Current body weight'),('weight',1,'784399000',NULL,'Self reported body weight');
INSERT INTO #codessnomed
VALUES ('b12',1,'271216009',NULL,'Serum vitamin B12 level'),('b12',1,'365607006',NULL,'Serum vitamin B12 level - finding');
INSERT INTO #codessnomed
VALUES ('cholesterol',1,'13067005',NULL,'Cholesteryl esters measurement (procedure)'),('cholesterol',1,'17888004',NULL,'High density lipoprotein measurement (procedure)'),('cholesterol',1,'28036006',NULL,'High density lipoprotein cholesterol level'),('cholesterol',1,'77068002',NULL,'Cholesterol measurement (procedure)'),('cholesterol',1,'104583003',NULL,'High density lipoprotein/total cholesterol ratio measurement'),('cholesterol',1,'104584009',NULL,'Intermediate density lipoprotein cholesterol measurement'),('cholesterol',1,'104585005',NULL,'Very low density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'104586006',NULL,'Cholesterol/triglyceride ratio measurement (procedure)'),('cholesterol',1,'104594004',NULL,'Cholesterol esterase measurement (procedure)'),('cholesterol',1,'104777003',NULL,'Lecithin cholesterol acyltransferase measurement (procedure)'),('cholesterol',1,'104781003',NULL,'Lipids, cholesterol measurement (procedure)'),('cholesterol',1,'104990004',NULL,'Triglyceride and ester in high density lipoprotein measurement (procedure)'),('cholesterol',1,'104992007',NULL,'Triglyceride and ester in low density lipoprotein measurement'),('cholesterol',1,'113079009',NULL,'Low density lipoprotein cholesterol level'),('cholesterol',1,'121751004',NULL,'Cholesterol sulfate measurement (procedure)'),('cholesterol',1,'121868005',NULL,'Total cholesterol measurement (procedure)'),('cholesterol',1,'166832000',NULL,'Serum high density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'166833005',NULL,'Serum low density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'166834004',NULL,'Serum very low density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'166838001',NULL,'Serum fasting high density lipoprotein cholesterol measurement'),('cholesterol',1,'166839009',NULL,'Serum random high density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'166840006',NULL,'Serum fasting low density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'166841005',NULL,'Serum random low density lipoprotein cholesterol measurement'),('cholesterol',1,'166842003',NULL,'Total cholesterol:high density lipoprotein ratio measurement'),('cholesterol',1,'167072001',NULL,'Plasma random high density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'167073006',NULL,'Plasma fasting high density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'167074000',NULL,'Plasma random low density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'167075004',NULL,'Plasma fasting low density lipoprotein cholesterol measurement'),('cholesterol',1,'250743005',NULL,'HDL/LDL ratio'),('cholesterol',1,'250759005',NULL,'Measurement of percentage cholesterol as ester (procedure)'),('cholesterol',1,'271059008',NULL,'Serum high density lipoprotein/non-high density lipoprotein cholesterol ratio measurement (procedure)'),('cholesterol',1,'313811003',NULL,'Cholesterol/High density lipoprotein ratio measurement'),('cholesterol',1,'313988001',NULL,'Lipoprotein cholesterol ratio measurement (procedure)'),('cholesterol',1,'313989009',NULL,'Serum cholesterol/high density lipoprotein ratio measurement'),('cholesterol',1,'313990000',NULL,'Plasma cholesterol/high density lipoprotein ratio measurement'),('cholesterol',1,'313991001',NULL,'Serum cholesterol/low density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'313992008',NULL,'Plasma cholesterol/low density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'313993003',NULL,'Serum cholesterol/very low density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'313994009',NULL,'Plasma cholesterol/very low density lipoprotein ratio measurement'),('cholesterol',1,'314012003',NULL,'Serum low density lipoprotein/high density lipoprotein ratio measurement'),('cholesterol',1,'314013008',NULL,'Plasma low density lipoprotein/high density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'314035000',NULL,'Plasma high density lipoprotein cholesterol measurement (procedure)'),('cholesterol',1,'314036004',NULL,'Plasma low density lipoprotein cholesterol measurement'),('cholesterol',1,'315017003',NULL,'Fasting cholesterol level (procedure)'),('cholesterol',1,'390956002',NULL,'Plasma total cholesterol level'),('cholesterol',1,'391291008',NULL,'Fluid sample cholesterol level'),('cholesterol',1,'395065005',NULL,'Calculated low density lipoprotein cholesterol level (procedure)'),('cholesterol',1,'395153009',NULL,'Pre-treatment serum cholesterol level'),('cholesterol',1,'412808005',NULL,'Serum total cholesterol level'),('cholesterol',1,'443915001',NULL,'Measurement of total cholesterol and triglycerides'),('cholesterol',1,'789381000000104',NULL,'Cholesterol/phospholipid ratio measurement (procedure)'),('cholesterol',1,'195861000000108',NULL,'Cholesterol content measurement (procedure)'),('cholesterol',1,'293821000000103',NULL,'Non high density lipoprotein cholesterol level'),('cholesterol',1,'194351000000100',NULL,'Cholesterol/low density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'194361000000102',NULL,'Cholesterol/very low density lipoprotein ratio measurement (procedure)'),('cholesterol',1,'247801000000106',NULL,'Serum fasting total cholesterol'),('cholesterol',1,'194801000000108',NULL,'High density lipoprotein/non-high density lipoprotein cholesterol ratio measurement (procedure)'),('cholesterol',1,'912151000000109',NULL,'Serum non high density lipoprotein cholesterol level'),('cholesterol',1,'920471000000100',NULL,'Estimated serum non-high density lipoprotein cholesterol level'),('cholesterol',1,'1006191000000106',NULL,'Serum non HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1102851000000101',NULL,'Estimated serum non high density lipoprotein cholesterol level (observable entity)'),('cholesterol',1,'1030411000000101',NULL,'Non HDL cholesterol level'),('cholesterol',1,'1005681000000107',NULL,'Serum HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1015271000000109',NULL,'Serum HDL (high density lipoprotein):non-HDL (high density lipoprotein) cholesterol ratio'),('cholesterol',1,'1015681000000109',NULL,'Serum cholesterol/HDL (high density lipoprotein) ratio'),('cholesterol',1,'1015741000000109',NULL,'Serum LDL (low density lipoprotein)/HDL (high density lipoprotein) ratio'),('cholesterol',1,'1015751000000107',NULL,'Plasma LDL/HDL (low density lipoprotein/high density lipoprotein) ratio'),('cholesterol',1,'1010581000000101',NULL,'Plasma HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1015701000000106',NULL,'Serum cholesterol/LDL (low density lipoprotein) ratio'),('cholesterol',1,'1015711000000108',NULL,'Plasma cholesterol/LDL (low density lipoprotein) ratio'),('cholesterol',1,'1010591000000104',NULL,'Plasma LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1014501000000104',NULL,'Calculated LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1022191000000100',NULL,'Serum LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1003441000000101',NULL,'Serum VLDL (very low density lipoprotein) cholesterol level'),('cholesterol',1,'1015721000000102',NULL,'Serum cholesterol/VLDL (very low density lipoprotein) ratio'),('cholesterol',1,'1015731000000100',NULL,'Plasma cholesterol/VLDL (very low density lipoprotein) ratio'),('cholesterol',1,'1024231000000104',NULL,'Fluid sample cholesterol level'),('cholesterol',1,'1031421000000101',NULL,'High density lipoprotein/total cholesterol ratio'),('cholesterol',1,'1026451000000102',NULL,'Serum fasting HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1026461000000104',NULL,'Serum random HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1107681000000108',NULL,'HDL (high density lipoprotein) cholesterol molar concentration in serum'),('cholesterol',1,'1028831000000106',NULL,'Plasma random HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1028841000000102',NULL,'Plasma fasting HDL (high density lipoprotein) cholesterol level'),('cholesterol',1,'1107661000000104',NULL,'HDL (high density lipoprotein) cholesterol molar concentration in plasma'),('cholesterol',1,'1028861000000101',NULL,'Plasma fasting LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1028851000000104',NULL,'Plasma random LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1026471000000106',NULL,'Serum fasting LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1026481000000108',NULL,'Serum random LDL (low density lipoprotein) cholesterol level'),('cholesterol',1,'1015691000000106',NULL,'Plasma cholesterol/HDL (high density lipoprotein) ratio'),('cholesterol',1,'994351000000103',NULL,'Serum total cholesterol level'),('cholesterol',1,'1005671000000105',NULL,'Serum cholesterol level'),('cholesterol',1,'1017161000000104',NULL,'Plasma total cholesterol level'),('cholesterol',1,'1107731000000104',NULL,'Ratio of high density lipoprotein cholesterol to total cholesterol in plasma (observable entity)'),('cholesterol',1,'1107741000000108',NULL,'Ratio of high density lipoprotein cholesterol to total cholesterol in serum (observable entity)'),('cholesterol',1,'1028551000000102',NULL,'Total cholesterol:HDL (high density lipoprotein) ratio'),('cholesterol',1,'1029071000000109',NULL,'HDL/LDL ratio'),('cholesterol',1,'1083861000000102',NULL,'Serum HDL (high density lipoprotein) cholesterol/triglyceride ratio'),('cholesterol',1,'1083761000000106',NULL,'Serum fasting total cholesterol level (observable entity)'),('cholesterol',1,'1106541000000101',NULL,'Cholesterol molar concentration in serum'),('cholesterol',1,'1106531000000105',NULL,'Cholesterol molar concentration in plasma'),('cholesterol',1,'9422000',NULL,'Alpha-lipoprotein'),('cholesterol',1,'9556009',NULL,'Acyl CoA cholesterol acyltransferase'),
('cholesterol',1,'22244007',NULL,'LDL - Low density lipoprotein'),('cholesterol',1,'73427004',NULL,'Cholesterol ester'),('cholesterol',1,'88557001',NULL,'LCAT - Lecithin cholesterol acyltransferase'),('cholesterol',1,'102741009',NULL,'Free cholesterol'),('cholesterol',1,'115332003',NULL,'High density lipoprotein subfraction 2'),('cholesterol',1,'115333008',NULL,'High density lipoprotein subfraction 3'),('cholesterol',1,'416724002',NULL,'Cholesterol derivative'),('cholesterol',1,'707084003',NULL,'HDL cholesterol 2'),('cholesterol',1,'707086001',NULL,'HDL cholesterol 2a'),('cholesterol',1,'707091000',NULL,'IDL cholesterol 1'),('cholesterol',1,'707092007',NULL,'IDL cholesterol 2'),('cholesterol',1,'707093002',NULL,'LDL cholesterol pattern A'),('cholesterol',1,'707094008',NULL,'LDL cholesterol pattern BI'),('cholesterol',1,'707095009',NULL,'LDL cholesterol pattern BII'),('cholesterol',1,'707096005',NULL,'LDL cholesterol, acetylated'),('cholesterol',1,'707097001',NULL,'LDL cholesterol, narrow density'),('cholesterol',1,'707098006',NULL,'Cholesterol in lipoprotein a'),('cholesterol',1,'707099003',NULL,'VLDL cholesterol 3'),('cholesterol',1,'707100006',NULL,'VLDL cholesterol, acetylated'),('cholesterol',1,'707101005',NULL,'VLDL cholesterol, beta'),('cholesterol',1,'707124003',NULL,'HDL cholesterol 2b'),('cholesterol',1,'707125002',NULL,'HDL cholesterol 3'),('cholesterol',1,'707126001',NULL,'HDL cholesterol 3a'),('cholesterol',1,'707127005',NULL,'HDL cholesterol 3c'),('cholesterol',1,'707128000',NULL,'HDL cholesterol 3b'),('cholesterol',1,'712626002',NULL,'Cholesterol in chylomicrons'),('cholesterol',1,'13644009',NULL,'High cholesterol'),('cholesterol',1,'124055002',NULL,'Decreased cholesterol esters (finding)'),('cholesterol',1,'166828006',NULL,'Serum cholesterol normal (finding)'),('cholesterol',1,'166830008',NULL,'Serum cholesterol raised (finding)'),('cholesterol',1,'166831007',NULL,'Serum cholesterol very high (finding)'),('cholesterol',1,'365793008',NULL,'Finding of cholesterol level'),('cholesterol',1,'365794002',NULL,'Finding of serum cholesterol level'),('cholesterol',1,'370992007',NULL,'High blood cholesterol/triglycerides'),('cholesterol',1,'398036000',NULL,'Low density lipoprotein catabolic defect'),('cholesterol',1,'442234001',NULL,'Serum cholesterol borderline high (finding)'),('cholesterol',1,'442350007',NULL,'Serum cholesterol borderline low (finding)'),('cholesterol',1,'445445006',NULL,'Raised low density lipoprotein cholesterol'),('cholesterol',1,'67991000119104',NULL,'Serum cholesterol abnormal (finding)'),('cholesterol',1,'850981000000101',NULL,'Cholesterol level (observable entity)'),('cholesterol',1,'852401000000104',NULL,'Maximum cholesterol level (observable entity)'),('cholesterol',1,'852411000000102',NULL,'Minimum cholesterol level (observable entity)'),('cholesterol',1,'853681000000104',NULL,'Total cholesterol level (observable entity)'),('cholesterol',1,'404670008',NULL,'Hollenhorst plaque'),('cholesterol',1,'166854003',NULL,'Lipoprotein electrophoresis - High density lipoprotein (procedure)'),('cholesterol',1,'166855002',NULL,'Lipoprotein electrophoresis - Low density lipoprotein'),('cholesterol',1,'124054003',NULL,'Increased cholesterol esters (finding)'),('cholesterol',1,'439953004',NULL,'Elevated cholesterol/high density lipoprotein ratio'),('cholesterol',1,'102857004',NULL,'Urinary crystal, cholesterol (finding)'),('cholesterol',1,'939391000000100',NULL,'Serum high density lipoprotein cholesterol:triglyceride ratio'),('cholesterol',2,'1005671000000105',NULL,'Serum cholesterol level'),('cholesterol',2,'412808005',NULL,'Serum total cholesterol level'),('cholesterol',2,'121868005',NULL,'Total cholesterol measurement (procedure)'),('cholesterol',2,'994351000000103',NULL,'Serum total cholesterol level');
INSERT INTO #codessnomed
VALUES ('cholesterol-hdl-ratio',1,'313989009',NULL,'Serum cholesterol/HDL ratio');
INSERT INTO #codessnomed
VALUES ('diastolic-blood-pressure',1,'174255007',NULL,'Non-invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'251073000',NULL,'Invasive diastolic blood pressure'),('diastolic-blood-pressure',1,'271650006',NULL,'Diastolic arterial pressure'),('diastolic-blood-pressure',1,'314451001',NULL,'Minimum diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314452008',NULL,'Maximum diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314453003',NULL,'Average diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314454009',NULL,'Minimum day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314455005',NULL,'Minimum night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314456006',NULL,'Minimum 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314457002',NULL,'Maximum night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314458007',NULL,'Maximum day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314459004',NULL,'Maximum 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314460009',NULL,'Average night interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314461008',NULL,'Average day interval diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314462001',NULL,'Average 24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'314465004',NULL,'24 hour diastolic blood pressure (observable entity)'),('diastolic-blood-pressure',1,'400975005',NULL,'Standing diastolic blood pressure'),('diastolic-blood-pressure',1,'407555005',NULL,'Sitting diastolic blood pressure'),('diastolic-blood-pressure',1,'407557002',NULL,'Lying diastolic blood pressure'),('diastolic-blood-pressure',1,'413605002',NULL,'Average home diastolic blood pressure'),('diastolic-blood-pressure',1,'446226005',NULL,'Diastolic blood pressure on admission'),('diastolic-blood-pressure',1,'716632005',NULL,'Baseline diastolic blood pressure'),('diastolic-blood-pressure',1,'198091000000104',NULL,'Ambulatory diastolic blood pressure'),('diastolic-blood-pressure',1,'814081000000101',NULL,'Diastolic blood pressure centile'),('diastolic-blood-pressure',1,'1091811000000102',NULL,'Diastolic arterial pressure (observable entity)'),('diastolic-blood-pressure',1,'1036571000000105',NULL,'Non-invasive central diastolic blood pressure'),('diastolic-blood-pressure',1,'23154005',NULL,'Increased diastolic arterial pressure (finding)'),('diastolic-blood-pressure',1,'42689008',NULL,'Decreased diastolic arterial pressure (finding)'),('diastolic-blood-pressure',1,'49844009',NULL,'Abnormal diastolic arterial pressure (finding)'),('diastolic-blood-pressure',1,'53813002',NULL,'Normal diastolic arterial pressure (finding)'),('diastolic-blood-pressure',1,'163031004',NULL,'On examination - Diastolic BP reading');
INSERT INTO #codessnomed
VALUES ('egfr',1,'1011481000000105',NULL,'eGFR (estimated glomerular filtration rate) using creatinine Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1011491000000107',NULL,'eGFR (estimated glomerular filtration rate) using cystatin C Chronic Kidney Disease Epidemiology Collaboration equation per 1.73 square metres'),('egfr',1,'1020291000000106',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation'),('egfr',1,'1107411000000104',NULL,'eGFR (estimated glomerular filtration rate) by laboratory calculation'),('egfr',1,'241373003',NULL,'Technetium-99m-diethylenetriamine pentaacetic acid clearance - glomerular filtration rate (procedure)'),('egfr',1,'262300005',NULL,'With glomerular filtration rate'),('egfr',1,'737105002',NULL,'GFR (glomerular filtration rate) calculation technique'),('egfr',1,'80274001',NULL,'Glomerular filtration rate (observable entity)'),('egfr',1,'996231000000108',NULL,'GFR (glomerular filtration rate) calculated by abbreviated Modification of Diet in Renal Disease Study Group calculation adjusted for African American origin');
INSERT INTO #codessnomed
VALUES ('folate',1,'993411000000108',NULL,'Serum folate level');
INSERT INTO #codessnomed
VALUES ('fsh',1,'1023191000000105',NULL,'Serum FSH level'),('fsh',1,'1023201000000107',NULL,'Plasma FSH level'),('fsh',1,'1027161000000108',NULL,'FSH - Follicle stimulating hormone level'),('fsh',1,'273971007',NULL,'Serum FSH level');
INSERT INTO #codessnomed
VALUES ('gamma-glutamyl-transferase',1,'69480007',NULL,'Gammaglutamyl transferase'),('gamma-glutamyl-transferase',1,'1028091000000102',NULL,'Gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'60153001',NULL,'Gamma-glutamyl transferase'),('gamma-glutamyl-transferase',1,'1000851000000108',NULL,'Plasma gamma-glutamyl transferase level'),('gamma-glutamyl-transferase',1,'1000861000000106',NULL,'Serum gamma-glutamyl transferase level');
INSERT INTO #codessnomed
VALUES ('hba1c',1,'1019431000000105',NULL,'HbA1c level (Diabetes Control and Complications Trial aligned)'),('hba1c',1,'1003671000000109',NULL,'Haemoglobin A1c level'),('hba1c',1,'1049301000000100',NULL,'HbA1c (haemoglobin A1c) level (diagnostic reference range) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'1049321000000109',NULL,'HbA1c (haemoglobin A1c) level (monitoring ranges) - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'1107481000000106',NULL,'HbA1c (haemoglobin A1c) molar concentration in blood'),('hba1c',1,'999791000000106',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised'),('hba1c',1,'1010941000000103',NULL,'Haemoglobin A1c (monitoring ranges)'),('hba1c',1,'1010951000000100',NULL,'Haemoglobin A1c (diagnostic reference range)'),('hba1c',1,'165679005',NULL,'Haemoglobin A1c (HbA1c) less than 7% indicating good diabetic control'),('hba1c',1,'165680008',NULL,'Haemoglobin A1c (HbA1c) between 7%-10% indicating borderline diabetic control'),('hba1c',1,'165681007',NULL,'Hemoglobin A1c (HbA1c) greater than 10% indicating poor diabetic control'),('hba1c',1,'365845005',NULL,'Haemoglobin A1C - diabetic control finding'),('hba1c',1,'444751005',NULL,'High hemoglobin A1c level'),('hba1c',1,'43396009',NULL,'Hemoglobin A1c measurement (procedure)'),('hba1c',1,'313835008',NULL,'Hemoglobin A1c measurement aligned to the Diabetes Control and Complications Trial'),('hba1c',1,'371981000000106',NULL,'Hb A1c (Haemoglobin A1c) level - IFCC (International Federation of Clinical Chemistry and Laboratory Medicine) standardised'),('hba1c',1,'444257008',NULL,'Calculation of estimated average glucose based on haemoglobin A1c'),('hba1c',1,'269823000',NULL,'Haemoglobin A1C - diabetic control interpretation'),('hba1c',1,'443911005',NULL,'Ordinal level of hemoglobin A1c'),('hba1c',1,'733830002',NULL,'HbA1c - Glycated haemoglobin-A1c'),('hba1c',2,'1019431000000105',NULL,'HbA1c level (Diabetes Control and Complications Trial aligned)'),('hba1c',2,'999791000000106',NULL,'Haemoglobin A1c level - International Federation of Clinical Chemistry and Laboratory Medicine standardised');
INSERT INTO #codessnomed
VALUES ('hdl-cholesterol',1,'1005681000000107',NULL,'Serum high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1010581000000101',NULL,'Plasma high density lipoprotein cholesterol level (observable entity)'),('hdl-cholesterol',1,'1026461000000104',NULL,'Serum random high density lipoprotein cholesterol level (observable entity)');
INSERT INTO #codessnomed
VALUES ('ldl-cholesterol',1,'1010591000000104',NULL,'Plasma low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1014501000000104',NULL,'Calculated low density lipoprotein cholesterol level (observable entity)'),('ldl-cholesterol',1,'1022191000000100',NULL,'Serum low density lipoprotein cholesterol level (observable entity)');
INSERT INTO #codessnomed
VALUES ('luteinising-hormone',1,'1023161000000104',NULL,'Serum luteinising hormone level'),('luteinising-hormone',1,'1015331000000101',NULL,'Urine luteinising hormone level'),('luteinising-hormone',1,'1023171000000106',NULL,'Plasma luteinising hormone level'),('luteinising-hormone',1,'1030811000000104',NULL,'Serum luteinising hormone level'),('luteinising-hormone',1,'166372004',NULL,'Luteinising hormone (& serum level)');
INSERT INTO #codessnomed
VALUES ('oestradiol',1,'166448005',NULL,'Serum oestradiol measurement'),('oestradiol',1,'1023231000000101',NULL,'Plasma oestradiol level'),('oestradiol',1,'1010521000000102',NULL,'Serum oestradiol level'),('oestradiol',1,'37538009',NULL,'Oestradiol measurement');
INSERT INTO #codessnomed
VALUES ('parathyroid-hormone',1,'3352000',NULL,'Parathyroid hormone level'),('parathyroid-hormone',1,'1013021000000104',NULL,'Plasma parathyroid hormone level'),('parathyroid-hormone',1,'997221000000109',NULL,'Serum parathyroid hormone level'),('parathyroid-hormone',1,'271541003',NULL,'Serum parathyroid hormone (& level (& serum))');
INSERT INTO #codessnomed
VALUES ('potassium',1,'1012671000000103',NULL,'Blood potassium level (observable entity)'),('potassium',1,'1000651000000109',NULL,'Serum potassium level (observable entity)'),('potassium',1,'1017401000000106',NULL,'Plasma potassium level (observable entity)');
INSERT INTO #codessnomed
VALUES ('progesterone',1,'270972001',NULL,'Serum progesterone (& level)'),('progesterone',1,'997151000000105',NULL,'Serum progesterone level');
INSERT INTO #codessnomed
VALUES ('sex-hormone-binding-globulin',1,'999661000000105',NULL,'Serum sex hormone binding globulin level (observable entity)');
INSERT INTO #codessnomed
VALUES ('sodium',1,'1020681000000107',NULL,'Sodium level (observable entity)');
INSERT INTO #codessnomed
VALUES ('systolic-blood-pressure',1,'72313002',NULL,'Systolic arterial pressure (observable entity)'),('systolic-blood-pressure',1,'251070002',NULL,'Non-invasive systolic blood pressure'),('systolic-blood-pressure',1,'251071003',NULL,'Invasive systolic blood pressure'),('systolic-blood-pressure',1,'271649006',NULL,'SAP - Systolic arterial pressure'),('systolic-blood-pressure',1,'314438006',NULL,'Minimum systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314439003',NULL,'Maximum systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314440001',NULL,'Average systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314441002',NULL,'Minimum day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314442009',NULL,'Minimum night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314443004',NULL,'Maximum night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314444005',NULL,'Maximum day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314445006',NULL,'Average night interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314446007',NULL,'Average day interval systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314447003',NULL,'Minimum 24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314448008',NULL,'Maximum 24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'314449000',NULL,'Average 24 hour systolic blood pressure (observable entity'),('systolic-blood-pressure',1,'314464000',NULL,'24 hour systolic blood pressure (observable entity)'),('systolic-blood-pressure',1,'399304008',NULL,'Systolic blood pressure on admission'),('systolic-blood-pressure',1,'400974009',NULL,'Standing systolic blood pressure'),('systolic-blood-pressure',1,'407554009',NULL,'Sitting systolic blood pressure'),('systolic-blood-pressure',1,'407556006',NULL,'Lying systolic blood pressure'),('systolic-blood-pressure',1,'413606001',NULL,'Average home systolic blood pressure'),('systolic-blood-pressure',1,'716579001',NULL,'Baseline systolic blood pressure'),('systolic-blood-pressure',1,'198081000000101',NULL,'Ambulatory systolic blood pressure'),('systolic-blood-pressure',1,'814101000000107',NULL,'Systolic blood pressure centile'),('systolic-blood-pressure',1,'1036551000000101',NULL,'Non-invasive central systolic blood pressure'),('systolic-blood-pressure',1,'1087991000000109',NULL,'Level of reduction in systolic blood pressure on standing (observable entity)'),('systolic-blood-pressure',1,'12929001',NULL,'Normal systolic arterial pressure (finding)'),('systolic-blood-pressure',1,'18050000',NULL,'Increased systolic arterial pressure (finding)'),('systolic-blood-pressure',1,'18352002',NULL,'Abnormal systolic arterial pressure (finding)'),('systolic-blood-pressure',1,'81010002',NULL,'Decreased systolic arterial pressure (finding)'),('systolic-blood-pressure',1,'163030003',NULL,'On examination - Systolic blood pressure reading'),('systolic-blood-pressure',1,'707303003',NULL,'Post exercise systolic blood pressure response abnormal'),('systolic-blood-pressure',1,'707304009',NULL,'Post exercise systolic blood pressure response normal (finding)');
INSERT INTO #codessnomed
VALUES ('testosterone',1,'270973006',NULL,'Serum testosterone measurement (procedure)'),('testosterone',1,'995571000000101',NULL,'Plasma testosterone level (observable entity)'),('testosterone',1,'997161000000108',NULL,'Serum testosterone level (observable entity)');
INSERT INTO #codessnomed
VALUES ('urinary-albumin-creatinine-ratio',1,'271075006',NULL,'Urine albumin/creatinine ratio measurement');
INSERT INTO #codessnomed
VALUES ('urine-protein-creatinine-ratio',1,'1028731000000100',NULL,'Urine protein/creatinine ratio');
INSERT INTO #codessnomed
VALUES ('vitamin-d',1,'1007991000000105',NULL,'Serum total 25-hydroxy vitamin D level (observable entity)'),('vitamin-d',1,'1029801000000105',NULL,'Total 25-hydroxyvitamin D level (observable entity)'),('vitamin-d',1,'1031181000000107',NULL,'Serum vitamin D level (observable entity)'),('vitamin-d',1,'12199005',NULL,'Vitamin D, 25-hydroxy measurement (procedure)'),('vitamin-d',1,'270990000',NULL,'Serum vitamin D measurement (procedure)'),('vitamin-d',1,'83729008',NULL,'Vitamin D measurement (procedure)'),('vitamin-d',1,'996641000000102',NULL,'Combined total vitamin D2 and D3 level (observable entity)')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesemis
VALUES ('diabetes',1,'^ESCTGE801661',NULL,'Gestational diabetes, delivered'),('diabetes',1,'^ESCTGE801662',NULL,'Gestational diabetes mellitus complicating pregnancy'),('diabetes',1,'^ESCTMA257526',NULL,'Maternal diabetes mellitus with hypoglycaemia affecting foetus OR newborn'),('diabetes',1,'EMISQNU2',NULL,'Number of admissions for ketoacidosis'),('diabetes',1,'ESCTDI20',NULL,'Diabetic ketoacidosis without coma'),('diabetes',1,'ESCTDI22',NULL,'Diabetic severe hyperglycaemia'),('diabetes',1,'ESCTDI23',NULL,'Diabetic hyperosmolar non-ketotic state'),('diabetes',1,'ESCTDR3',NULL,'Drug-induced diabetes mellitus'),('diabetes',1,'ESCTSE11',NULL,'Secondary endocrine diabetes mellitus');
INSERT INTO #codesemis
VALUES ('hypertension',1,'EMISNQST25',NULL,'Stage 2 hypertension'),('hypertension',1,'^ESCTMA364280',NULL,'Malignant hypertension'),('hypertension',1,'EMISNQST25',NULL,'Stage 2 hypertension');
INSERT INTO #codesemis
VALUES ('bmi',1,'EMISNQBM1',NULL,'BMI centile');
INSERT INTO #codesemis
VALUES ('cholesterol-hdl-ratio',1,'EMISTCH',NULL,'TC/HDL ratio');
INSERT INTO #codesemis
VALUES ('diastolic-blood-pressure',1,'EMISNQDI86',NULL,'Diastolic blood pressure - left arm'),('diastolic-blood-pressure',1,'EMISNQDI87',NULL,'Diastolic blood pressure - right arm');
INSERT INTO #codesemis
VALUES ('systolic-blood-pressure',1,'EMISNQSY8',NULL,'Systolic blood pressure - left arm'),('systolic-blood-pressure',1,'EMISNQSY9',NULL,'Systolic blood pressure - right arm');
INSERT INTO #codesemis
VALUES ('urine-blood',1,'EMISQUR1',NULL,'Urine dipstick for leucocytes'),('urine-blood',1,'EMISQUR2',NULL,'Urine dipstick leucocytes positive'),('urine-blood',1,'EMISQUR3',NULL,'Urine dipstick leucocytes negative')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL, [description] VARCHAR(255));

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version], dcr.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
AND (dcr.term IS NULL OR dcr.term = rc.Term)
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version], dcc.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL, [description] VARCHAR(255));

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version], dcs.[description]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept, [description]
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept, [description]
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

-- >>> Following code sets injected: hypertension v1/diabetes v1

-- LOAD CODESETS FOR TESTS USED TO INDICATE CKD

-- >>> Following code sets injected: egfr v1/urinary-albumin-creatinine-ratio v1


---- FIND PATIENTS WITH BIOCHEMICAL EVIDENCE OF CKD

---- find all eGFR and ACR tests

IF OBJECT_ID('tempdb..#EGFR_ACR_TESTS') IS NOT NULL DROP TABLE #EGFR_ACR_TESTS;
SELECT gp.FK_Patient_Link_ID, 
	CAST(GP.EventDate AS DATE) AS EventDate, 
	SuppliedCode, 
	[value] = TRY_CONVERT(NUMERIC (18,5), [Value]),  
	[Units],
	egfr_Code = CASE WHEN SuppliedCode IN (
		SELECT [Code] FROM #AllCodes WHERE [Concept] IN ('egfr') AND [Version] = 1 ) THEN 1 ELSE 0 END,
	acr_Code = CASE WHEN SuppliedCode IN (
		SELECT [Code] FROM #AllCodes WHERE [Concept] IN ('urinary-albumin-creatinine-ratio') AND [Version] = 1 ) THEN 1 ELSE 0 END
INTO #EGFR_ACR_TESTS
FROM [RLS].[vw_GP_Events] gp
WHERE (
		gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept IN ('egfr', 'urinary-albumin-creatinine-ratio')  AND [Version]=1) OR
		gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept IN ('egfr', 'urinary-albumin-creatinine-ratio')  AND [Version]=1)
	  )
	AND gp.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
	AND (gp.EventDate) BETWEEN '2016-01-01' and @EndDate
	AND [Value] IS NOT NULL AND UPPER([Value]) NOT LIKE '%[A-Z]%' 

-- CREATE TABLE OF EGFR TESTS THAT MEET CKD CRITERIA (VARIOUS STAGEs)

SELECT FK_Patient_Link_ID,
	EventDate,
	egfr_evidence = CASE WHEN egfr_Code = 1 AND [Value] >= 90   THEN 'G1' 
		WHEN egfr_Code = 1 AND [Value] BETWEEN 60 AND 89 		THEN 'G2'
		WHEN egfr_Code = 1 AND [Value] BETWEEN 45 AND 59 		THEN 'G3a'
		WHEN egfr_Code = 1 AND [Value] BETWEEN 30 AND 44 		THEN 'G3b'
		WHEN egfr_Code = 1 AND [Value] BETWEEN 15 AND 29 		THEN 'G4'
		WHEN egfr_Code = 1 AND [Value] BETWEEN  0 AND 15 		THEN 'G5'
			ELSE NULL END
INTO #ckd_stages_egfr
FROM #EGFR_ACR_TESTS

-- FIND EGFR TESTS INDICATIVE OF CKD STAGE 3-5, WITH THE DATES OF THE PREVIOUS TEST

IF OBJECT_ID('tempdb..#egfr_dates') IS NOT NULL DROP TABLE #egfr_dates;
SELECT *, 
	stage_previous_egfr = LAG(egfr_evidence, 1, NULL) OVER (PARTITION BY FK_Patient_Link_ID ORDER BY EventDate),
	date_previous_egfr = LAG(EventDate, 1, NULL) OVER (PARTITION BY FK_Patient_Link_ID ORDER BY EventDate)
INTO #egfr_dates
FROM #ckd_stages_egfr
where egfr_evidence in ('G3a', 'G3b', 'G4', 'G5')
ORDER BY FK_Patient_Link_ID, EventDate

-- CREATE TABLE OF PATIENTS THAT HAD TWO EGFR TESTS INDICATIVE OF CKD STAGE 3-5, WITHIN 3 MONTHS OF EACH OTHER

IF OBJECT_ID('tempdb..#egfr_ckd_evidence') IS NOT NULL DROP TABLE #egfr_ckd_evidence;
SELECT *
INTO #egfr_ckd_evidence
FROM #egfr_dates
WHERE datediff(month, date_previous_egfr, EventDate) <=  3 --only find patients with two tests in three months

-- FIND PATIENTS THAT MEET THE FOLLOWING: "ACR > 3mg/mmol lasting for at least 3 months”

-- CREATE TABLE OF ACR TESTS

SELECT FK_Patient_Link_ID,
	EventDate, 
	acr_evidence = CASE WHEN acr_Code = 1 AND [Value] > 30  	THEN 'A3' 
		WHEN acr_Code = 1 AND [Value] BETWEEN 3 AND 30 			THEN 'A2'
		WHEN acr_Code = 1 AND [Value] BETWEEN  0 AND 3 			THEN 'A1'
			ELSE NULL END 
INTO #ckd_stages_acr
FROM #EGFR_ACR_TESTS

-- FIND TESTS THAT ARE >3mg/mmol AND SHOW DATE OF PREVIOUS TEST

IF OBJECT_ID('tempdb..#acr_dates') IS NOT NULL DROP TABLE #acr_dates;
SELECT *, 
	stage_previous_acr = LAG(acr_evidence, 1, NULL) OVER (PARTITION BY FK_Patient_Link_ID ORDER BY EventDate),
	date_previous_acr = LAG(EventDate, 1, NULL) OVER (PARTITION BY FK_Patient_Link_ID ORDER BY EventDate)
INTO #acr_dates
FROM #ckd_stages_acr
WHERE acr_evidence in ('A3','A2')
ORDER BY FK_Patient_Link_ID, EventDate

IF OBJECT_ID('tempdb..#acr_ckd_evidence') IS NOT NULL DROP TABLE #acr_ckd_evidence;
SELECT *
INTO #acr_ckd_evidence
FROM #acr_dates
WHERE datediff(month, date_previous_acr, EventDate) >=  3 --only find patients with acr stages A1/A2 lasting at least 3 months


-- CREATE TABLE OF PATIENTS AT RISK OF CKD: DIABETES OR HYPERTENSION

-- IF OBJECT_ID('tempdb..#ckd_risk') IS NOT NULL DROP TABLE #ckd_risk;
-- SELECT DISTINCT FK_Patient_Link_ID
-- INTO #ckd_risk
-- FROM [RLS].[vw_GP_Events] gp
-- LEFT OUTER JOIN #VersionedSnomedSets s ON s.FK_Reference_SnomedCT_ID = gp.FK_Reference_SnomedCT_ID
-- LEFT OUTER JOIN #VersionedCodeSets c ON c.FK_Reference_Coding_ID = gp.FK_Reference_Coding_ID
-- WHERE  gp.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
-- AND (
-- 	gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept IN ('diabetes', 'hypertension') AND [Version]=1) OR
--     gp.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept IN ('diabetes', 'hypertension') AND [Version]=1)
-- );

-- CREATE TABLE ONLY INCLUDING THE REQUIRED COHORT, WHICH INCLUDES THOSE WITH EVIDENCE OF CKD AND THOSE AT RISK OF CKD

IF OBJECT_ID('tempdb..#Cohort') IS NOT NULL DROP TABLE #Cohort;
SELECT p.FK_Patient_Link_ID,
		p.EthnicMainGroup,
		p.DeathDate,
		EvidenceOfCKD_egfr = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #egfr_ckd_evidence) THEN 1 ELSE 0 END,
		EvidenceOfCKD_acr = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #acr_ckd_evidence) THEN 1 ELSE 0 END
		--,AtRiskOfCKD = CASE WHEN p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ckd_risk) THEN 1 ELSE 0 END
INTO #Cohort
FROM #Patients p
WHERE p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #egfr_ckd_evidence) 
	OR p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #acr_ckd_evidence) 
	--OR p.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #ckd_risk) 




---------------------------------------------------------------------------------------------------------
---------------------------------------- OBSERVATIONS/MEASUREMENTS --------------------------------------
---------------------------------------------------------------------------------------------------------

-- LOAD CODESETS FOR OBSERVATIONS WITH A VALUE (EXCEPT THOSE ALREADY LOADED AT START OF SCRIPT)

-- >>> Following code sets injected: hba1c v2/sodium v1/creatinine v1/triglycerides v1/potassium v1/urea v1
-- >>> Following code sets injected: ferritin v1/b12 v1/folate v1/haemoglobin v1/white-blood-cells v1/red-blood-cells v1/platelets v1/mean-corpuscular-volume v1
-- >>> Following code sets injected: luteinising-hormone v1/fsh v1/sex-hormone-binding-globulin v1/oestradiol v1/progesterone v1/testosterone v1/parathyroid-hormone v1
-- >>> Following code sets injected: systolic-blood-pressure v1/diastolic-blood-pressure v1/urine-protein-creatinine-ratio v1
-- >>> Following code sets injected: alanine-aminotransferase v1/albumin v1/alkaline-phosphatase v1/total-bilirubin v1/gamma-glutamyl-transferase v1
-- >>> Following code sets injected: cholesterol v2/ldl-cholesterol v1/hdl-cholesterol v1/cholesterol-hdl-ratio v1
-- >>> Following code sets injected: urine-blood v1/urine-protein v1/urine-ketones v1/urine-glucose v1
-- >>> Following code sets injected: bmi v2/height v1/weight v1/vitamin-d v1/calcium v1

-- Get observation values for the cohort
IF OBJECT_ID('tempdb..#observations') IS NOT NULL DROP TABLE #observations;
SELECT 
	FK_Patient_Link_ID,
	CAST(EventDate AS DATE) AS EventDate,
	Concept = CASE WHEN sn.Concept IS NOT NULL THEN sn.Concept ELSE co.Concept END,
	[Version] =  CASE WHEN sn.[Version] IS NOT NULL THEN sn.[Version] ELSE co.[Version] END,
	[Value],
	[Units]
INTO #observations
FROM RLS.vw_GP_Events gp
LEFT JOIN #VersionedSnomedSets sn ON sn.FK_Reference_SnomedCT_ID = gp.FK_Reference_SnomedCT_ID
LEFT JOIN #VersionedCodeSets co ON co.FK_Reference_Coding_ID = gp.FK_Reference_Coding_ID
WHERE
	(gp.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets ) OR
     gp.FK_Reference_Coding_ID   IN (SELECT FK_Reference_Coding_ID   FROM #VersionedCodeSets   ) )
AND gp.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Cohort)
AND EventDate BETWEEN @StartDate and @EndDate

-- WHERE CODES EXIST IN BOTH VERSIONS OF THE CODE SET (OR IN OTHER SIMILAR CODE SETS), THERE WILL BE DUPLICATES, SO EXCLUDE THEM FROM THE SETS/VERSIONS THAT WE DON'T WANT 

IF OBJECT_ID('tempdb..#all_observations') IS NOT NULL DROP TABLE #all_observations;
select 
	FK_Patient_Link_ID, CAST(EventDate AS DATE) EventDate, Concept, [Value], [Units], [Version]
into #all_observations
from #observations
except
select FK_Patient_Link_ID, EventDate, Concept, [Value], [Units], [Version] from #observations 
where 
	(Concept = 'cholesterol' and [Version] <> 2) OR -- e.g. serum HDL cholesterol appears in cholesterol v1 code set, which we don't want, but we do want the code as part of the hdl-cholesterol code set.
	(Concept = 'hba1c' and [Version] <> 2) OR -- e.g. hba1c level appears twice with same value: from version 1 and version 2. We only want version 2 so exclude any others.
	(Concept = 'bmi' and [Version] <> 2) -- e.g. BMI appears appears twice with same value: from version 1 and version 2. We only want version 2 so exclude any others.


-- REMOVE USELESS OBSERVATIONS WITH NO VALUE

IF OBJECT_ID('tempdb..#observations_final') IS NOT NULL DROP TABLE #observations_final;
SELECT FK_Patient_Link_ID,
	EventDate,
	Concept,
	[Value] = TRY_CONVERT(NUMERIC (18,5), [Value]), -- convert to numeric so no text can appear.
	[Units]
INTO #observations_final
FROM #all_observations

-- BRING TOGETHER FOR FINAL OUTPUT

SELECT	 
	PatientId = o.FK_Patient_Link_ID
	,TestName = o.Concept
	,TestDate = o.EventDate
	,TestResult = o.[Value]
	,TestUnit = o.[Units]
FROM #observations_final o
WHERE  [Value] IS NOT NULL AND [Value] != '0' AND [Value] > 0 AND UPPER([Value]) NOT LIKE '%[A-Z]%'  -- EXTRA CHECKS IN CASE ANY ZERO, NULL OR TEXT VALUES REMAINED
