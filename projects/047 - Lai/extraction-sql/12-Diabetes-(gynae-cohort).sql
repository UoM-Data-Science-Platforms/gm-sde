--+--------------------------------------------------------------------------------+
--¦ Diabetes longitudinal information (gynae cohort)                               ¦
--+--------------------------------------------------------------------------------+

-------- RESEARCH DATA ENGINEER CHECK ---------

-- OUTPUT: Data with the following fields
-- PatientId
-- EventDate (YYYY-MM-DD)


-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

--#region Clinical code sets

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
  [description] [varchar] (255) NULL 
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('diabetes',1,'C10..',NULL,'Diabetes mellitus'),('diabetes',1,'C10..00',NULL,'Diabetes mellitus'),('diabetes',1,'C100.',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C100.00',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C1000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C100000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C1001',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),('diabetes',1,'C100100',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),('diabetes',1,'C100z',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C100z00',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C101.',NULL,'Diabetes mellitus with ketoacidosis'),('diabetes',1,'C101.00',NULL,'Diabetes mellitus with ketoacidosis'),('diabetes',1,'C1010',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C101000',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C1011',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101100',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101y',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101y00',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101z',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C101z00',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C102.',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C102.00',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C1020',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C102000',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C1021',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102100',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102z',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C102z00',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C103.',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C103.00',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C1030',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C103000',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C1031',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103100',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103y',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103y00',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103z',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C103z00',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C104.',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'C104.00',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'C1040',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C104000',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C1041',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104100',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104y',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104y00',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104z',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C104z00',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C105.',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C105.00',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C1050',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C105000',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C1051',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105100',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105y',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105y00',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105z',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C105z00',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C106.',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'C106.00',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'C1060',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C106000',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C1061',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106100',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106y',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106y00',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106z',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C106z00',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C107.',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'C107.00',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'C1070',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C107000',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C1071',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C107100',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C1072',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107200',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107y',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107y00',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107z',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C107z00',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C108.',NULL,'Insulin dependent diabetes mellitus'),('diabetes',1,'C108.00',NULL,'Insulin dependent diabetes mellitus'),('diabetes',1,'C1080',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C108000',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1081',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C108100',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1082',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C108200',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1083',NULL,'Insulin dependent diabetes mellitus with multiple complications'),('diabetes',1,'C108300',NULL,'Insulin dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1084',NULL,'Unstable insulin dependent diabetes mellitus'),('diabetes',1,'C108400',NULL,'Unstable insulin dependent diabetes mellitus'),('diabetes',1,'C1085',NULL,'Insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C108500',NULL,'Insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C1086',NULL,'Insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C108600',NULL,'Insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C1087',NULL,'Insulin dependent diabetes mellitus with retinopathy'),('diabetes',1,'C108700',NULL,'Insulin dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1088',NULL,'Insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C108800',NULL,'Insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C1089',NULL,'Insulin dependent diabetes maturity onset'),('diabetes',1,'C108900',NULL,'Insulin dependent diabetes maturity onset'),('diabetes',1,'C108A',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'C108A00',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'C108B',NULL,'Insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C108B00',NULL,'Insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C108C',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C108C00',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C108D',NULL,'Insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C108D00',NULL,'Insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C108E',NULL,'Insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C108E00',NULL,'Insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C108F',NULL,'Insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C108F00',NULL,'Insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C108G',NULL,'Insulin dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C108G00',NULL,'Insulin dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C108H',NULL,'Insulin dependent diabetes mellitus with arthropathy'),
('diabetes',1,'C108H00',NULL,'Insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C108J',NULL,'Insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C108J00',NULL,'Insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C108y',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108y00',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108z',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C108z00',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C109.',NULL,'Non-insulin dependent diabetes mellitus'),('diabetes',1,'C109.00',NULL,'Non-insulin dependent diabetes mellitus'),('diabetes',1,'C1090',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C109000',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1091',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C109100',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1092',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C109200',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1093',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C109300',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1094',NULL,'Non-insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C109400',NULL,'Non-insulin dependent diabetes mellitus with ulcer'),('diabetes',1,'C1095',NULL,'Non-insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C109500',NULL,'Non-insulin dependent diabetes mellitus with gangrene'),('diabetes',1,'C1096',NULL,'Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C109600',NULL,'Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1097',NULL,'Non-insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C109700',NULL,'Non-insulin dependent diabetes mellitus - poor control'),('diabetes',1,'C1098',NULL,'Reavens syndrome'),('diabetes',1,'C109800',NULL,'Reavens syndrome'),('diabetes',1,'C1099',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'C109900',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'C109A',NULL,'Non-insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C109A00',NULL,'Non-insulin dependent diabetes mellitus with mononeuropathy'),('diabetes',1,'C109B',NULL,'Non-insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C109B00',NULL,'Non-insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'C109C',NULL,'Non-insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C109C00',NULL,'Non-insulin dependent diabetes mellitus with nephropathy'),('diabetes',1,'C109D',NULL,'Non-insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C109D00',NULL,'Non-insulin dependent diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C109E',NULL,'Non-insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C109E00',NULL,'Non-insulin dependent diabetes mellitus with diabetic cataract'),('diabetes',1,'C109F',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C109F00',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C109G',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C109G00',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'C109H',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C109H00',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C109J',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C109J00',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C109K',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C109K00',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10A.',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'C10A.00',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'C10A0',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A000',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A1',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A100',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A2',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A200',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A3',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A300',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A4',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A400',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A5',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A500',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A6',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A600',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A7',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10A700',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10AW',NULL,'Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'C10AW00',NULL,'Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'C10AX',NULL,'Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'C10AX00',NULL,'Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'C10B.',NULL,'Diabetes mellitus induced by steroids'),('diabetes',1,'C10B.00',NULL,'Diabetes mellitus induced by steroids'),('diabetes',1,'C10B0',NULL,'Steroid induced diabetes mellitus without complication'),('diabetes',1,'C10B000',NULL,'Steroid induced diabetes mellitus without complication'),('diabetes',1,'C10C.',NULL,'Diabetes mellitus autosomal dominant'),('diabetes',1,'C10C.00',NULL,'Diabetes mellitus autosomal dominant'),('diabetes',1,'C10D.',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'C10D.00',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'C10E.',NULL,'Type 1 diabetes mellitus'),('diabetes',1,'C10E.00',NULL,'Type 1 diabetes mellitus'),('diabetes',1,'C10E0',NULL,'Type 1 diabetes mellitus with renal complications'),('diabetes',1,'C10E000',NULL,'Type 1 diabetes mellitus with renal complications'),('diabetes',1,'C10E1',NULL,'Type 1 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10E100',NULL,'Type 1 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10E2',NULL,'Type 1 diabetes mellitus with neurological complications'),('diabetes',1,'C10E200',NULL,'Type 1 diabetes mellitus with neurological complications'),('diabetes',1,'C10E3',NULL,'Type 1 diabetes mellitus with multiple complications'),('diabetes',1,'C10E300',NULL,'Type 1 diabetes mellitus with multiple complications'),('diabetes',1,'C10E4',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'C10E400',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'C10E5',NULL,'Type 1 diabetes mellitus with ulcer'),('diabetes',1,'C10E500',NULL,'Type 1 diabetes mellitus with ulcer'),('diabetes',1,'C10E6',NULL,'Type 1 diabetes mellitus with gangrene'),('diabetes',1,'C10E600',NULL,'Type 1 diabetes mellitus with gangrene'),('diabetes',1,'C10E7',NULL,'Type 1 diabetes mellitus with retinopathy'),('diabetes',1,'C10E700',NULL,'Type 1 diabetes mellitus with retinopathy'),('diabetes',1,'C10E8',NULL,'Type 1 diabetes mellitus - poor control'),('diabetes',1,'C10E800',NULL,'Type 1 diabetes mellitus - poor control'),('diabetes',1,'C10E9',NULL,'Type 1 diabetes mellitus maturity onset'),('diabetes',1,'C10E900',NULL,'Type 1 diabetes mellitus maturity onset'),('diabetes',1,'C10EA',NULL,'Type 1 diabetes mellitus without complication'),('diabetes',1,'C10EA00',NULL,'Type 1 diabetes mellitus without complication'),('diabetes',1,'C10EB',NULL,'Type 1 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10EB00',NULL,'Type 1 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10EC',NULL,'Type 1 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10EC00',NULL,'Type 1 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10ED',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'C10ED00',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'C10EE',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10EE00',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10EF',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10EF00',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10EG',NULL,'Type 1 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10EG00',NULL,'Type 1 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10EH',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'C10EH00',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'C10EJ',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),
('diabetes',1,'C10EJ00',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10EK',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10EK00',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10EL',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10EL00',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10EM',NULL,'Type 1 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10EM00',NULL,'Type 1 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10EN',NULL,'Type 1 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10EN00',NULL,'Type 1 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10EP',NULL,'Type 1 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10EP00',NULL,'Type 1 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10EQ',NULL,'Type 1 diabetes mellitus with gastroparesis'),('diabetes',1,'C10EQ00',NULL,'Type 1 diabetes mellitus with gastroparesis'),('diabetes',1,'C10ER',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'C10ER00',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'C10F.',NULL,'Type 2 diabetes mellitus'),('diabetes',1,'C10F.00',NULL,'Type 2 diabetes mellitus'),('diabetes',1,'C10F0',NULL,'Type 2 diabetes mellitus with renal complications'),('diabetes',1,'C10F000',NULL,'Type 2 diabetes mellitus with renal complications'),('diabetes',1,'C10F1',NULL,'Type 2 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10F100',NULL,'Type 2 diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10F2',NULL,'Type 2 diabetes mellitus with neurological complications'),('diabetes',1,'C10F200',NULL,'Type 2 diabetes mellitus with neurological complications'),('diabetes',1,'C10F3',NULL,'Type 2 diabetes mellitus with multiple complications'),('diabetes',1,'C10F300',NULL,'Type 2 diabetes mellitus with multiple complications'),('diabetes',1,'C10F4',NULL,'Type 2 diabetes mellitus with ulcer'),('diabetes',1,'C10F400',NULL,'Type 2 diabetes mellitus with ulcer'),('diabetes',1,'C10F5',NULL,'Type 2 diabetes mellitus with gangrene'),('diabetes',1,'C10F500',NULL,'Type 2 diabetes mellitus with gangrene'),('diabetes',1,'C10F6',NULL,'Type 2 diabetes mellitus with retinopathy'),('diabetes',1,'C10F600',NULL,'Type 2 diabetes mellitus with retinopathy'),('diabetes',1,'C10F7',NULL,'Type 2 diabetes mellitus - poor control'),('diabetes',1,'C10F700',NULL,'Type 2 diabetes mellitus - poor control'),('diabetes',1,'C10F8',NULL,'Reavens syndrome'),('diabetes',1,'C10F800',NULL,'Reavens syndrome'),('diabetes',1,'C10F9',NULL,'Type 2 diabetes mellitus without complication'),('diabetes',1,'C10F900',NULL,'Type 2 diabetes mellitus without complication'),('diabetes',1,'C10FA',NULL,'Type 2 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10FA00',NULL,'Type 2 diabetes mellitus with mononeuropathy'),('diabetes',1,'C10FB',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10FB00',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'C10FC',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'C10FC00',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'C10FD',NULL,'Type 2 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10FD00',NULL,'Type 2 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'C10FE',NULL,'Type 2 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10FE00',NULL,'Type 2 diabetes mellitus with diabetic cataract'),('diabetes',1,'C10FF',NULL,'Type 2 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10FF00',NULL,'Type 2 diabetes mellitus with peripheral angiopathy'),('diabetes',1,'C10FG',NULL,'Type 2 diabetes mellitus with arthropathy'),('diabetes',1,'C10FG00',NULL,'Type 2 diabetes mellitus with arthropathy'),('diabetes',1,'C10FH',NULL,'Type 2 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10FH00',NULL,'Type 2 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'C10FJ',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C10FJ00',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'C10FK',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10FK00',NULL,'Hyperosmolar non-ketotic state in type 2 diabetes mellitus'),('diabetes',1,'C10FL',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10FL00',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'C10FM',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10FM00',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'C10FN',NULL,'Type 2 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10FN00',NULL,'Type 2 diabetes mellitus with ketoacidosis'),('diabetes',1,'C10FP',NULL,'Type 2 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10FP00',NULL,'Type 2 diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C10FQ',NULL,'Type 2 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10FQ00',NULL,'Type 2 diabetes mellitus with exudative maculopathy'),('diabetes',1,'C10FR',NULL,'Type 2 diabetes mellitus with gastroparesis'),('diabetes',1,'C10FR00',NULL,'Type 2 diabetes mellitus with gastroparesis'),('diabetes',1,'C10FS',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'C10FS00',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'C10G.',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'C10G.00',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'C10G0',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'C10G000',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'C10H.',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'C10H.00',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'C10H0',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'C10H000',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'C10M.',NULL,'Lipoatrophic diabetes mellitus'),('diabetes',1,'C10M.00',NULL,'Lipoatrophic diabetes mellitus'),('diabetes',1,'C10M0',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'C10M000',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'C10N.',NULL,'Secondary diabetes mellitus'),('diabetes',1,'C10N.00',NULL,'Secondary diabetes mellitus'),('diabetes',1,'C10N0',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'C10N000',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'C10N1',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'C10N100',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'C10Q.',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'C10Q.00',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'C10y.',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y.00',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y0',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y000',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y1',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10y100',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10yy',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yy00',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yz',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10yz00',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10z.',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z.00',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z0',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z000',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z1',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10z100',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10zy',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zy00',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zz',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'C10zz00',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'C1A0.',NULL,'Metabolic syndrome'),('diabetes',1,'C1A0.00',NULL,'Metabolic syndrome'),('diabetes',1,'Cyu2.',NULL,'[X]Diabetes mellitus'),('diabetes',1,'Cyu2.00',NULL,'[X]Diabetes mellitus'),('diabetes',1,'Cyu20',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu2000',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu21',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu2100',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu22',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu2200',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu23',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'Cyu2300',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'L180.',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),('diabetes',1,'L180.00',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),
('diabetes',1,'L1800',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L180000',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L1801',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L180100',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L1802',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L180200',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L1803',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L180300',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L1804',NULL,'Diabetes mellitus in the pueperium - baby delivered during previous episode of care'),('diabetes',1,'L180400',NULL,'Diabetes mellitus in the pueperium - baby delivered during previous episode of care'),('diabetes',1,'L1805',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L180500',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L1806',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L180600',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L1807',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L180700',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L1808',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L180800',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L1809',NULL,'Gestational diabetes mellitus'),('diabetes',1,'L180900',NULL,'Gestational diabetes mellitus'),('diabetes',1,'L180A',NULL,'Pre-existing type 1 diabetes mellitus in pregnancy'),('diabetes',1,'L180A00',NULL,'Pre-existing type 1 diabetes mellitus in pregnancy'),('diabetes',1,'L180B',NULL,'Pre-existing type 2 diabetes mellitus in pregnancy'),('diabetes',1,'L180B00',NULL,'Pre-existing type 2 diabetes mellitus in pregnancy'),('diabetes',1,'L180X',NULL,'Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'L180X00',NULL,'Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'L180z',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'L180z00',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'Lyu29',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'Lyu2900',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'PKyP.',NULL,'Diabetes insipidus, diabetes mellitus, optic atrophy and deafness'),('diabetes',1,'PKyP.00',NULL,'Diabetes insipidus, diabetes mellitus, optic atrophy and deafness'),('diabetes',1,'Q441.',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'Q441.00',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'ZV13F',NULL,'[V]Personal history of gestational diabetes mellitus'),('diabetes',1,'ZV13F00',NULL,'[V]Personal history of gestational diabetes mellitus');
INSERT INTO #codesreadv2
VALUES ('gynaecological-cancer',1,'B44..',NULL,'Malignant neoplasm of ovary and other uterine adnexa'),('gynaecological-cancer',1,'B44..00',NULL,'Malignant neoplasm of ovary and other uterine adnexa'),('gynaecological-cancer',1,'B44z.',NULL,'Malignant neoplasm of uterine adnexa NOS'),('gynaecological-cancer',1,'B44z.00',NULL,'Malignant neoplasm of uterine adnexa NOS'),('gynaecological-cancer',1,'B44y.',NULL,'Malignant neoplasm of other site of uterine adnexa'),('gynaecological-cancer',1,'B44y.00',NULL,'Malignant neoplasm of other site of uterine adnexa'),('gynaecological-cancer',1,'B440.',NULL,'Malignant neoplasm of ovary'),('gynaecological-cancer',1,'B440.00',NULL,'Malignant neoplasm of ovary'),('gynaecological-cancer',1,'1J06.',NULL,'Suspected cervical cancer'),('gynaecological-cancer',1,'1J06.00',NULL,'Suspected cervical cancer'),('gynaecological-cancer',1,'1J07.',NULL,'Suspected endometrial cancer'),('gynaecological-cancer',1,'1J07.00',NULL,'Suspected endometrial cancer'),('gynaecological-cancer',1,'1J0J.',NULL,'Suspected gynaecological cancer'),('gynaecological-cancer',1,'1J0J.00',NULL,'Suspected gynaecological cancer'),('gynaecological-cancer',1,'38GT9',NULL,'QCancer cervical cancer risk'),('gynaecological-cancer',1,'38GT900',NULL,'QCancer cervical cancer risk'),('gynaecological-cancer',1,'38GT8',NULL,'QCancer endometrial cancer risk'),('gynaecological-cancer',1,'38GT800',NULL,'QCancer endometrial cancer risk'),('gynaecological-cancer',1,'K5E..',NULL,'Other abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'K5E..00',NULL,'Other abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'K5Ez.',NULL,'Abnormal uterine and vaginal bleeding, unspecified'),('gynaecological-cancer',1,'K5Ez.00',NULL,'Abnormal uterine and vaginal bleeding, unspecified'),('gynaecological-cancer',1,'K5E2.',NULL,'Abnormal vaginal bleeding, unspecified'),('gynaecological-cancer',1,'K5E2.00',NULL,'Abnormal vaginal bleeding, unspecified'),('gynaecological-cancer',1,'8Hn1.',NULL,'Fast track referral for suspected gynaecological cancer'),('gynaecological-cancer',1,'8Hn1.00',NULL,'Fast track referral for suspected gynaecological cancer'),('gynaecological-cancer',1,'9Np4.',NULL,'Seen in fast track suspected gynaecological cancer clinic'),('gynaecological-cancer',1,'9Np4.00',NULL,'Seen in fast track suspected gynaecological cancer clinic'),('gynaecological-cancer',1,'Byu70',NULL,'[X]Malignant neoplasm of uterine adnexa, unspecified'),('gynaecological-cancer',1,'Byu7000',NULL,'[X]Malignant neoplasm of uterine adnexa, unspecified'),('gynaecological-cancer',1,'B4302',NULL,'Malignant neoplasm of endometrium of corpus uteri'),('gynaecological-cancer',1,'B430200',NULL,'Malignant neoplasm of endometrium of corpus uteri'),('gynaecological-cancer',1,'B7A..',NULL,'Benign neoplasm of ovary'),('gynaecological-cancer',1,'B7A..00',NULL,'Benign neoplasm of ovary'),('gynaecological-cancer',1,'B586.',NULL,'Secondary malignant neoplasm of ovary'),('gynaecological-cancer',1,'B586.00',NULL,'Secondary malignant neoplasm of ovary'),('gynaecological-cancer',1,'B912.',NULL,'Neoplasm of uncertain behaviour of ovary'),('gynaecological-cancer',1,'B912.00',NULL,'Neoplasm of uncertain behaviour of ovary'),('gynaecological-cancer',1,'Kyu9D',NULL,'[X]Other specified abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'Kyu9D00',NULL,'[X]Other specified abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'K59B.',NULL,'Postmenopausal postcoital bleeding'),('gynaecological-cancer',1,'K59B.00',NULL,'Postmenopausal postcoital bleeding'),('gynaecological-cancer',1,'K5A1.',NULL,'Postmenopausal bleeding'),('gynaecological-cancer',1,'K5A1.00',NULL,'Postmenopausal bleeding'),('gynaecological-cancer',1,'8H4V.',NULL,'Referral to gynaecology special interest general practitioner'),('gynaecological-cancer',1,'8H4V.00',NULL,'Referral to gynaecology special interest general practitioner'),('gynaecological-cancer',1,'8Hku.',NULL,'Referral to community gynaecology service'),('gynaecological-cancer',1,'8Hku.00',NULL,'Referral to community gynaecology service'),('gynaecological-cancer',1,'8T0B.',NULL,'Referral to paediatric gynaecology service'),('gynaecological-cancer',1,'8T0B.00',NULL,'Referral to paediatric gynaecology service'),('gynaecological-cancer',1,'8H58.',NULL,'Gynaecological referral'),('gynaecological-cancer',1,'8H58.00',NULL,'Gynaecological referral'),('gynaecological-cancer',1,'8HJ6.',NULL,'Gynaecological self-referral'),('gynaecological-cancer',1,'8HJ6.00',NULL,'Gynaecological self-referral'),('gynaecological-cancer',1,'8HV7.',NULL,'Private referral to gynaecologist'),('gynaecological-cancer',1,'8HV7.00',NULL,'Private referral to gynaecologist'),('gynaecological-cancer',1,'38GT4',NULL,'QCancer ovarian cancer risk calculator'),('gynaecological-cancer',1,'38GT400',NULL,'QCancer ovarian cancer risk calculator'),('gynaecological-cancer',1,'B41..',NULL,'Malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B41..00',NULL,'Malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B41y.',NULL,'Malignant neoplasm of other site of cervix'),('gynaecological-cancer',1,'B41y.00',NULL,'Malignant neoplasm of other site of cervix'),('gynaecological-cancer',1,'B41yz',NULL,'Malignant neoplasm of other site of cervix NOS'),('gynaecological-cancer',1,'B41yz00',NULL,'Malignant neoplasm of other site of cervix NOS'),('gynaecological-cancer',1,'B41z.',NULL,'Malignant neoplasm of cervix uteri NOS'),('gynaecological-cancer',1,'B41z.00',NULL,'Malignant neoplasm of cervix uteri NOS'),('gynaecological-cancer',1,'B45..',NULL,'Malignant neoplasm of other and unspecified female genital organs'),('gynaecological-cancer',1,'B45..00',NULL,'Malignant neoplasm of other and unspecified female genital organs'),('gynaecological-cancer',1,'B45y.',NULL,'Malignant neoplasm of other specified female genital organ'),('gynaecological-cancer',1,'B45y.00',NULL,'Malignant neoplasm of other specified female genital organ'),('gynaecological-cancer',1,'B45z.',NULL,'Malignant neoplasm of female genital organ NOS'),('gynaecological-cancer',1,'B45z.00',NULL,'Malignant neoplasm of female genital organ NOS'),('gynaecological-cancer',1,'B58y2',NULL,'Secondary malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B58y200',NULL,'Secondary malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B790.',NULL,'Benign neoplasm of cervix uteri NEC'),('gynaecological-cancer',1,'B790.00',NULL,'Benign neoplasm of cervix uteri NEC'),('gynaecological-cancer',1,'B7A2.',NULL,'Benign teratoma of ovary'),('gynaecological-cancer',1,'B7A2.00',NULL,'Benign teratoma of ovary'),('gynaecological-cancer',1,'Byu7.',NULL,'[X]Malignant neoplasm of female genital organs'),('gynaecological-cancer',1,'Byu7.00',NULL,'[X]Malignant neoplasm of female genital organs'),('gynaecological-cancer',1,'Byu71',NULL,'[X]Malignant neoplasm of other specified female genital organs'),('gynaecological-cancer',1,'Byu7100',NULL,'[X]Malignant neoplasm of other specified female genital organs'),('gynaecological-cancer',1,'Byu73',NULL,'[X]Malignant neoplasm of female genital organ, unspecified'),('gynaecological-cancer',1,'Byu7300',NULL,'[X]Malignant neoplasm of female genital organ, unspecified'),('gynaecological-cancer',1,'K5E0.',NULL,'Abnormal uterine bleeding unrelated to menstrual cycle'),('gynaecological-cancer',1,'K5E0.00',NULL,'Abnormal uterine bleeding unrelated to menstrual cycle'),('gynaecological-cancer',1,'R0934',NULL,'[D]Pelvic mass'),('gynaecological-cancer',1,'R093400',NULL,'[D]Pelvic mass'),('gynaecological-cancer',1,'R0935',NULL,'[D]Pelvic lump'),('gynaecological-cancer',1,'R093500',NULL,'[D]Pelvic lump')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('diabetes',1,'C10..',NULL,'DM - Diabetes mellitus'),('diabetes',1,'C100.',NULL,'Diabetes mellitus with no mention of complication'),('diabetes',1,'C1000',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'C1001',NULL,'Maturity onset diabetes'),('diabetes',1,'C100z',NULL,'Diabetes mellitus NOS with no mention of complication'),('diabetes',1,'C101.',NULL,'Diabetic ketoacidosis'),('diabetes',1,'C1010',NULL,'Diabetes mellitus, juvenile type, with ketoacidosis'),('diabetes',1,'C1011',NULL,'Diabetes mellitus, adult onset, with ketoacidosis'),('diabetes',1,'C101y',NULL,'Other specified diabetes mellitus with ketoacidosis'),('diabetes',1,'C101z',NULL,'Diabetes mellitus NOS with ketoacidosis'),('diabetes',1,'C102.',NULL,'Diabetes mellitus with hyperosmolar coma'),('diabetes',1,'C1020',NULL,'Diabetes mellitus, juvenile type, with hyperosmolar coma'),('diabetes',1,'C1021',NULL,'Diabetes mellitus, adult onset, with hyperosmolar coma'),('diabetes',1,'C102z',NULL,'Diabetes mellitus NOS with hyperosmolar coma'),('diabetes',1,'C103.',NULL,'Diabetes mellitus with ketoacidotic coma'),('diabetes',1,'C1030',NULL,'Diabetes mellitus, juvenile type, with ketoacidotic coma'),('diabetes',1,'C1031',NULL,'Diabetes mellitus, adult onset, with ketoacidotic coma'),('diabetes',1,'C103y',NULL,'Other specified diabetes mellitus with coma'),('diabetes',1,'C103z',NULL,'Diabetes mellitus NOS with ketoacidotic coma'),('diabetes',1,'C1040',NULL,'Diabetes mellitus, juvenile type, with renal manifestation'),('diabetes',1,'C1041',NULL,'Diabetes mellitus, adult onset, with renal manifestation'),('diabetes',1,'C104y',NULL,'Other specified diabetes mellitus with renal complications'),('diabetes',1,'C104z',NULL,'Diabetes mellitus with nephropathy NOS'),('diabetes',1,'C105.',NULL,'Diabetes mellitus with ophthalmic manifestation'),('diabetes',1,'C1050',NULL,'Diabetes mellitus, juvenile type, with ophthalmic manifestation'),('diabetes',1,'C1051',NULL,'Diabetes mellitus, adult onset, with ophthalmic manifestation'),('diabetes',1,'C105y',NULL,'Other specified diabetes mellitus with ophthalmic complications'),('diabetes',1,'C105z',NULL,'Diabetes mellitus NOS with ophthalmic manifestation'),('diabetes',1,'C1060',NULL,'Diabetes mellitus, juvenile type, with neurological manifestation'),('diabetes',1,'C1061',NULL,'Diabetes mellitus, adult onset, with neurological manifestation'),('diabetes',1,'C106y',NULL,'Other specified diabetes mellitus with neurological complications'),('diabetes',1,'C106z',NULL,'Diabetes mellitus NOS with neurological manifestation'),('diabetes',1,'C1070',NULL,'Diabetes mellitus, juvenile type, with peripheral circulatory disorder'),('diabetes',1,'C1071',NULL,'Diabetes mellitus, adult onset, with peripheral circulatory disorder'),('diabetes',1,'C1072',NULL,'Diabetes mellitus, adult with gangrene'),('diabetes',1,'C107y',NULL,'Other specified diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C107z',NULL,'Diabetes mellitus NOS with peripheral circulatory disorder'),('diabetes',1,'C1080',NULL,'Insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1081',NULL,'Insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1082',NULL,'Insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1083',NULL,'Insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1085',NULL,'Insulin-dependent diabetes mellitus with ulcer'),('diabetes',1,'C1086',NULL,'Insulin-dependent diabetes mellitus with gangrene'),('diabetes',1,'C1087',NULL,'IDDM - Insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1088',NULL,'Insulin-dependent diabetes mellitus - poor control'),('diabetes',1,'C1089',NULL,'Insulin-dependent diabetes maturity onset'),('diabetes',1,'C108y',NULL,'Other specified diabetes mellitus with multiple complications'),('diabetes',1,'C108z',NULL,'Unspecified diabetes mellitus with multiple complications'),('diabetes',1,'C1090',NULL,'Non-insulin-dependent diabetes mellitus with renal complications'),('diabetes',1,'C1091',NULL,'Non-insulin-dependent diabetes mellitus with ophthalmic complications'),('diabetes',1,'C1092',NULL,'Non-insulin-dependent diabetes mellitus with neurological complications'),('diabetes',1,'C1093',NULL,'Non-insulin-dependent diabetes mellitus with multiple complications'),('diabetes',1,'C1094',NULL,'Non-insulin-dependent diabetes mellitus with ulcer'),('diabetes',1,'C1095',NULL,'Non-insulin-dependent diabetes mellitus with gangrene'),('diabetes',1,'C1096',NULL,'NIDDM - Non-insulin-dependent diabetes mellitus with retinopathy'),('diabetes',1,'C1097',NULL,'Non-insulin-dependent diabetes mellitus - poor control'),('diabetes',1,'C10A0',NULL,'Malnutrition-related diabetes mellitus with coma'),('diabetes',1,'C10A1',NULL,'Malnutrition-related diabetes mellitus with ketoacidosis'),('diabetes',1,'C10A2',NULL,'Malnutrition-related diabetes mellitus with renal complications'),('diabetes',1,'C10A3',NULL,'Malnutrition-related diabetes mellitus with ophthalmic complications'),('diabetes',1,'C10A4',NULL,'Malnutrition-related diabetes mellitus with neurological complications'),('diabetes',1,'C10A5',NULL,'Malnutrition-related diabetes mellitus with peripheral circulatory complications'),('diabetes',1,'C10A6',NULL,'Malnutrition-related diabetes mellitus with multiple complications'),('diabetes',1,'C10A7',NULL,'Malnutrition-related diabetes mellitus without complications'),('diabetes',1,'C10B0',NULL,'Steroid-induced diabetes mellitus without complication'),('diabetes',1,'C10y.',NULL,'Diabetes mellitus with other specified manifestation'),('diabetes',1,'C10y0',NULL,'Diabetes mellitus, juvenile type, with other specified manifestation'),('diabetes',1,'C10y1',NULL,'Diabetes mellitus, adult onset, with other specified manifestation'),('diabetes',1,'C10yy',NULL,'Other specified diabetes mellitus with other specified complications'),('diabetes',1,'C10yz',NULL,'Diabetes mellitus NOS with other specified manifestation'),('diabetes',1,'C10z.',NULL,'Diabetes mellitus with unspecified complication'),('diabetes',1,'C10z0',NULL,'Diabetes mellitus, juvenile type, with unspecified complication'),('diabetes',1,'C10z1',NULL,'Diabetes mellitus, adult onset, with unspecified complication'),('diabetes',1,'C10zy',NULL,'Other specified diabetes mellitus with unspecified complications'),('diabetes',1,'C10zz',NULL,'Diabetes mellitus NOS with unspecified complication'),('diabetes',1,'Cyu20',NULL,'[X]Other specified diabetes mellitus'),('diabetes',1,'Cyu21',NULL,'[X]Malnutrition-related diabetes mellitus with other specified complications'),('diabetes',1,'Cyu22',NULL,'[X]Malnutrition-related diabetes mellitus with unspecified complications'),('diabetes',1,'Cyu23',NULL,'[X]Unspecified diabetes mellitus with renal complications'),('diabetes',1,'L180.',NULL,'Diabetes mellitus during pregnancy, childbirth and the puerperium'),('diabetes',1,'L1800',NULL,'Diabetes mellitus - unspecified whether during pregnancy or the puerperium'),('diabetes',1,'L1801',NULL,'Diabetes mellitus during pregnancy - baby delivered'),('diabetes',1,'L1802',NULL,'Diabetes mellitus in the puerperium - baby delivered during current episode of care'),('diabetes',1,'L1803',NULL,'Diabetes mellitus during pregnancy - baby not yet delivered'),('diabetes',1,'L1804',NULL,'Diabetes mellitus in the puerperium - baby delivered during previous episode of care'),('diabetes',1,'L1805',NULL,'Pre-existing diabetes mellitus, insulin-dependent'),('diabetes',1,'L1806',NULL,'Pre-existing diabetes mellitus, non-insulin-dependent'),('diabetes',1,'L1807',NULL,'Pre-existing malnutrition-related diabetes mellitus'),('diabetes',1,'L1808',NULL,'Diabetes mellitus arising in pregnancy'),('diabetes',1,'L180z',NULL,'Diabetes mellitus during pregnancy, childbirth or the puerperium NOS'),('diabetes',1,'Lyu29',NULL,'[X]Pre-existing diabetes mellitus, unspecified'),('diabetes',1,'Q441.',NULL,'Neonatal diabetes mellitus'),('diabetes',1,'X40J4',NULL,'Insulin-dependent diabetes mellitus'),('diabetes',1,'X40J5',NULL,'Non-insulin-dependent diabetes mellitus'),('diabetes',1,'X40J6',NULL,'Insulin treated Type 2 diabetes mellitus'),('diabetes',1,'X40J7',NULL,'Malnutrition-related diabetes mellitus'),('diabetes',1,'X40J8',NULL,'Malnutrition-related diabetes mellitus - fibrocalculous'),('diabetes',1,'X40J9',NULL,'Malnutrition-related diabetes mellitus - protein-deficient'),('diabetes',1,'X40JA',NULL,'Secondary diabetes mellitus'),('diabetes',1,'X40JB',NULL,'Secondary pancreatic diabetes mellitus'),('diabetes',1,'X40JC',NULL,'Secondary endocrine diabetes mellitus'),('diabetes',1,'X40JE',NULL,'Reavens syndrome'),('diabetes',1,'X40JF',NULL,'Transitory neonatal diabetes mellitus'),('diabetes',1,'X40JG',NULL,'Genetic syndromes of diabetes mellitus'),('diabetes',1,'X40JI',NULL,'Maturity onset diabetes in youth type 1'),('diabetes',1,'X40JJ',NULL,'Diabetes mellitus autosomal dominant type 2'),('diabetes',1,'X40JN',NULL,'Lipodystrophy, partial, with Reiger anomaly, short stature, and insulinopenic diabetes mellitus'),('diabetes',1,'X40JQ',NULL,'Muscular atrophy, ataxia, retinitis pigmentosa, and diabetes mellitus'),('diabetes',1,'X40JV',NULL,'Hypogonadism, diabetes mellitus, alopecia ,mental retardation and electrocardiographic abnormalities'),('diabetes',1,'X40JX',NULL,'Pineal hyperplasia, insulin-resistant diabetes mellitus and somatic abnormalities'),('diabetes',1,'X40JY',NULL,'Congenital insulin-dependent diabetes mellitus with fatal secretory diarrhoea'),('diabetes',1,'X40Ja',NULL,'Abnormal metabolic state in diabetes mellitus'),('diabetes',1,'X50GO',NULL,'Soft tissue complication of diabetes mellitus'),('diabetes',1,'XE10E',NULL,'Diabetes mellitus, juvenile type, with no mention of complication'),('diabetes',1,'XE10F',NULL,'Diabetes mellitus, adult onset, with no mention of complication'),
('diabetes',1,'XE10G',NULL,'Diabetes mellitus with renal manifestation'),('diabetes',1,'XE10H',NULL,'Diabetes mellitus with neurological manifestation'),('diabetes',1,'XE10I',NULL,'Diabetes mellitus with peripheral circulatory disorder'),('diabetes',1,'XE12C',NULL,'Insulin dependent diabetes mel'),('diabetes',1,'XE15k',NULL,'Diabetes mellitus with polyneuropathy'),('diabetes',1,'XM19i',NULL,'[EDTA] Diabetes Type I (insulin dependent) associated with renal failure'),('diabetes',1,'XM19j',NULL,'[EDTA] Diabetes Type II (non-insulin-dependent) associated with renal failure'),('diabetes',1,'XM1Qx',NULL,'Diabetes mellitus with gangrene'),('diabetes',1,'XSETH',NULL,'Maturity onset diabetes mellitus in young'),('diabetes',1,'XSETK',NULL,'Drug-induced diabetes mellitus'),('diabetes',1,'XSETp',NULL,'Diabetes mellitus due to insulin receptor antibodies'),('diabetes',1,'Xa08a',NULL,'Small for gestation neonatal diabetes mellitus'),('diabetes',1,'Xa4g7',NULL,'Unstable type 1 diabetes mellitus'),('diabetes',1,'Xa9FG',NULL,'Postpancreatectomy diabetes mellitus'),('diabetes',1,'XaA6b',NULL,'Perceived control of insulin-dependent diabetes'),('diabetes',1,'XaELP',NULL,'Insulin-dependent diabetes without complication'),('diabetes',1,'XaELQ',NULL,'Non-insulin-dependent diabetes mellitus without complication'),('diabetes',1,'XaEnn',NULL,'Type I diabetes mellitus with mononeuropathy'),('diabetes',1,'XaEno',NULL,'Insulin dependent diabetes mellitus with polyneuropathy'),('diabetes',1,'XaEnp',NULL,'Type II diabetes mellitus with mononeuropathy'),('diabetes',1,'XaEnq',NULL,'Type 2 diabetes mellitus with polyneuropathy'),('diabetes',1,'XaF04',NULL,'Type 1 diabetes mellitus with nephropathy'),('diabetes',1,'XaF05',NULL,'Type 2 diabetes mellitus with nephropathy'),('diabetes',1,'XaFWG',NULL,'Type 1 diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'XaFWI',NULL,'Type II diabetes mellitus with hypoglycaemic coma'),('diabetes',1,'XaFm8',NULL,'Type 1 diabetes mellitus with diabetic cataract'),('diabetes',1,'XaFmA',NULL,'Type II diabetes mellitus with diabetic cataract'),('diabetes',1,'XaFmK',NULL,'Type I diabetes mellitus with peripheral angiopathy'),('diabetes',1,'XaFmL',NULL,'Type 1 diabetes mellitus with arthropathy'),('diabetes',1,'XaFmM',NULL,'Type 1 diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'XaFn7',NULL,'Non-insulin-dependent diabetes mellitus with peripheral angiopathy'),('diabetes',1,'XaFn8',NULL,'Non-insulin dependent diabetes mellitus with arthropathy'),('diabetes',1,'XaFn9',NULL,'Non-insulin dependent diabetes mellitus with neuropathic arthropathy'),('diabetes',1,'XaIrf',NULL,'Hyperosmolar non-ketotic state in type II diabetes mellitus'),('diabetes',1,'XaIyz',NULL,'Diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaIz0',NULL,'Diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzM',NULL,'Type 1 diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzN',NULL,'Type 1 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaIzQ',NULL,'Type 2 diabetes mellitus with persistent proteinuria'),('diabetes',1,'XaIzR',NULL,'Type 2 diabetes mellitus with persistent microalbuminuria'),('diabetes',1,'XaJQp',NULL,'Type II diabetes mellitus with exudative maculopathy'),('diabetes',1,'XaJSr',NULL,'Type I diabetes mellitus with exudative maculopathy'),('diabetes',1,'XaJUI',NULL,'Diabetes mellitus induced by non-steroid drugs'),('diabetes',1,'XaJlL',NULL,'Secondary pancreatic diabetes mellitus without complication'),('diabetes',1,'XaJlM',NULL,'Diabetes mellitus induced by non-steroid drugs without complication'),('diabetes',1,'XaJlQ',NULL,'Lipoatrophic diabetes mellitus without complication'),('diabetes',1,'XaJlR',NULL,'Secondary diabetes mellitus without complication'),('diabetes',1,'XaKyW',NULL,'Type I diabetes mellitus with gastroparesis'),('diabetes',1,'XaKyX',NULL,'Type II diabetes mellitus with gastroparesis'),('diabetes',1,'XaMzI',NULL,'Cystic fibrosis related diabetes mellitus'),('diabetes',1,'XaOPt',NULL,'Maternally inherited diabetes mellitus'),('diabetes',1,'XaOPu',NULL,'Latent autoimmune diabetes mellitus in adult'),('diabetes',1,'XacoB',NULL,'Maturity onset diabetes of the young type 5'),('diabetes',1,'XaIfG',NULL,'Type II diabetes on insulin'),('diabetes',1,'XaIfI',NULL,'Type II diabetes on diet only');
INSERT INTO #codesctv3
VALUES ('gynaecological-cancer',1,'X78iC',NULL,'Malignant tumour of female genital organ'),('gynaecological-cancer',1,'B44..',NULL,'Malignant neoplasm of ovary and other uterine adnexa'),('gynaecological-cancer',1,'B440.',NULL,'Malignant neoplasm of ovary'),('gynaecological-cancer',1,'B44y.',NULL,'Malignant neoplasm of other site of uterine adnexa'),('gynaecological-cancer',1,'B44z.',NULL,'Malignant neoplasm of uterine adnexa NOS'),('gynaecological-cancer',1,'Byu70',NULL,'[X]Malignant neoplasm of uterine adnexa, unspecified'),('gynaecological-cancer',1,'XaFrN',NULL,'Local recurrence of malignant tumour of cervix'),('gynaecological-cancer',1,'XE1w9',NULL,'Benign neoplasm of ovary'),('gynaecological-cancer',1,'B7A..',NULL,'Benign neoplasm of ovary'),('gynaecological-cancer',1,'XaKzK',NULL,'Suspected gynaecological cancer'),('gynaecological-cancer',1,'XaFwn',NULL,'Suspected endometrial cancer'),('gynaecological-cancer',1,'XaFwm',NULL,'Suspected cervical cancer'),('gynaecological-cancer',1,'XaaIN',NULL,'QCancer endometrial cancer risk'),('gynaecological-cancer',1,'XaZev',NULL,'QCancer ovarian cancer risk'),('gynaecological-cancer',1,'XaaIO',NULL,'QCancer cervical cancer risk'),('gynaecological-cancer',1,'XaE6w',NULL,'Other abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'XaE6z',NULL,'Abnormal vaginal bleeding, unspecified'),('gynaecological-cancer',1,'XaE70',NULL,'Abnormal uterine and vaginal bleeding, unspecified'),('gynaecological-cancer',1,'XaXsb',NULL,'Referral to community gynaecology service'),('gynaecological-cancer',1,'8H58.',NULL,'Gynaecological referral'),('gynaecological-cancer',1,'8HJ6.',NULL,'Gynaecological self-referral'),('gynaecological-cancer',1,'8HV7.',NULL,'Private referral to gynaecologist'),('gynaecological-cancer',1,'XaBTf',NULL,'Referral to gynaecologist'),('gynaecological-cancer',1,'XaAgH',NULL,'Referral to obstetrician and gynaecologist'),('gynaecological-cancer',1,'XaMeB',NULL,'Fast track referral for suspected gynaecological cancer'),('gynaecological-cancer',1,'XaPyV',NULL,'Seen in fast track suspected gynaecological cancer clinic'),('gynaecological-cancer',1,'XaFri',NULL,'Metastasis from malignant tumour of cervix'),('gynaecological-cancer',1,'B912.',NULL,'Neoplasm of uncertain behaviour of ovary'),('gynaecological-cancer',1,'Kyu9D',NULL,'[X]Other specified abnormal uterine and vaginal bleeding'),('gynaecological-cancer',1,'Xa86A',NULL,'Abnormal vaginal bleeding'),('gynaecological-cancer',1,'XaKJm',NULL,'Postmenopausal postcoital bleeding'),('gynaecological-cancer',1,'XaAct',NULL,'Referral to obstetrics and gynaecology service'),('gynaecological-cancer',1,'XaMA6',NULL,'Referral to gynaecology special interest general practitioner'),('gynaecological-cancer',1,'Xaack',NULL,'Referral to paediatric gynaecology service'),('gynaecological-cancer',1,'B41..',NULL,'Cervical carcinoma (uterus)'),('gynaecological-cancer',1,'B41..',NULL,'Malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B41y.',NULL,'Malignant neoplasm of other site of cervix'),('gynaecological-cancer',1,'B41y.',NULL,'Malignant neoplasm of other site of cervix'),('gynaecological-cancer',1,'B41yz',NULL,'Malignant neoplasm of other site of cervix NOS'),('gynaecological-cancer',1,'B41yz',NULL,'Malignant neoplasm of other site of cervix NOS'),('gynaecological-cancer',1,'B41z.',NULL,'Malignant neoplasm of cervix uteri NOS'),('gynaecological-cancer',1,'B41z.',NULL,'Malignant neoplasm of cervix uteri NOS'),('gynaecological-cancer',1,'B4302',NULL,'Malignant neoplasm of endometrium'),('gynaecological-cancer',1,'B4302',NULL,'Malignant neoplasm of endometrium of corpus uteri'),('gynaecological-cancer',1,'B4302',NULL,'Malignant neoplasm of endometrium of corpus uteri'),('gynaecological-cancer',1,'B45..',NULL,'Malignant neoplasm of other and unspecified female genital organs'),('gynaecological-cancer',1,'B45..',NULL,'Malignant neoplasm of other and unspecified female genital organs'),('gynaecological-cancer',1,'B45y.',NULL,'Malignant neoplasm of other specified female genital organ'),('gynaecological-cancer',1,'B45y.',NULL,'Malignant neoplasm of other specified female genital organ'),('gynaecological-cancer',1,'B45z.',NULL,'Malignant neoplasm of female genital organ NOS'),('gynaecological-cancer',1,'B45z.',NULL,'Malignant neoplasm of female genital organ NOS'),('gynaecological-cancer',1,'B586.',NULL,'Krukenburg tumour'),('gynaecological-cancer',1,'B586.',NULL,'Metastasis to ovary'),('gynaecological-cancer',1,'B586.',NULL,'Metastasis to ovary'),('gynaecological-cancer',1,'B586.',NULL,'Ovarian metastasis'),('gynaecological-cancer',1,'B586.',NULL,'Secondary cancer of ovary'),('gynaecological-cancer',1,'B586.',NULL,'Secondary malignant neoplasm of ovary'),('gynaecological-cancer',1,'B586.',NULL,'Secondary tumour to ovary'),('gynaecological-cancer',1,'B58y2',NULL,'Secondary cancer of the cervix'),('gynaecological-cancer',1,'B58y2',NULL,'Secondary malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B58y2',NULL,'Secondary malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'B790.',NULL,'Benign neoplasm of cervix uteri NEC'),('gynaecological-cancer',1,'Byu7.',NULL,'[X]Malignant neoplasm of female genital organs'),('gynaecological-cancer',1,'Byu7.',NULL,'[X]Malignant neoplasm of female genital organs'),('gynaecological-cancer',1,'Byu71',NULL,'[X]Malignant neoplasm of other specified female genital organs'),('gynaecological-cancer',1,'Byu71',NULL,'[X]Malignant neoplasm of other specified female genital organs'),('gynaecological-cancer',1,'Byu73',NULL,'[X]Malignant neoplasm of female genital organ, unspecified'),('gynaecological-cancer',1,'Byu73',NULL,'[X]Malignant neoplasm of female genital organ, unspecified'),('gynaecological-cancer',1,'K5A1.',NULL,'Bleeding after menopause'),('gynaecological-cancer',1,'K5A1.',NULL,'PMB - Postmenopausal bleeding'),('gynaecological-cancer',1,'K5A1.',NULL,'Postmenopausal bleeding'),('gynaecological-cancer',1,'K5A1.',NULL,'Postmenopausal bleeding'),('gynaecological-cancer',1,'R0934',NULL,'[D]Pelvic mass'),('gynaecological-cancer',1,'R0934',NULL,'[D]Pelvic mass'),('gynaecological-cancer',1,'R0935',NULL,'[D]Pelvic lump'),('gynaecological-cancer',1,'R0935',NULL,'[D]Pelvic lump'),('gynaecological-cancer',1,'X407e',NULL,'Tumour of cervix'),('gynaecological-cancer',1,'X407e',NULL,'Tumour of cervix'),('gynaecological-cancer',1,'X78Wf',NULL,'Ovarian tumour'),('gynaecological-cancer',1,'X78Wf',NULL,'Tumour of ovary'),('gynaecological-cancer',1,'X78Wf',NULL,'Tumour of ovary'),('gynaecological-cancer',1,'X78Wl',NULL,'Clear cell tumour of ovary'),('gynaecological-cancer',1,'X78Wl',NULL,'Clear cell tumour of ovary'),('gynaecological-cancer',1,'X78Wl',NULL,'Mesonephroid tumour of ovary'),('gynaecological-cancer',1,'X78Wm',NULL,'Borderline epithelial tumour'),('gynaecological-cancer',1,'X78Wm',NULL,'Borderline epithelial tumour'),('gynaecological-cancer',1,'X78Wo',NULL,'Undifferentiated carcinoma of ovary'),('gynaecological-cancer',1,'X78Wo',NULL,'Undifferentiated carcinoma of ovary'),('gynaecological-cancer',1,'X78XE',NULL,'Benign teratoma of ovary'),('gynaecological-cancer',1,'X78XE',NULL,'Benign teratoma of ovary'),('gynaecological-cancer',1,'X78XF',NULL,'Dermoid cyst of ovary'),('gynaecological-cancer',1,'X78XF',NULL,'Dermoid cyst of ovary'),('gynaecological-cancer',1,'X78XF',NULL,'Mature cystic teratoma of ovary'),('gynaecological-cancer',1,'X78Xl',NULL,'Benign tumour of cervix'),('gynaecological-cancer',1,'X78Xl',NULL,'Benign tumour of cervix'),('gynaecological-cancer',1,'XaE6x',NULL,'Abnormal uterine bleeding unrelated to menstrual cycle'),('gynaecological-cancer',1,'XaE6x',NULL,'Abnormal uterine bleeding unrelated to menstrual cycle'),('gynaecological-cancer',1,'XE1vi',NULL,'Ca cervix'),('gynaecological-cancer',1,'XE1vi',NULL,'Cancer of cervix'),('gynaecological-cancer',1,'XE1vi',NULL,'Malignant neoplasm of cervix'),('gynaecological-cancer',1,'XE1vi',NULL,'Malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'XE1vi',NULL,'Malignant tumour of cervix'),('gynaecological-cancer',1,'XE1vi',NULL,'Malignant tumour of cervix'),('gynaecological-cancer',1,'XE1w8',NULL,'Benign neoplasm of cervix uteri NEC'),('gynaecological-cancer',1,'XE1w8',NULL,'Benign neoplasm of cervix uteri NEC'),('gynaecological-cancer',1,'XE1zN',NULL,'Adenocarcinoma cervix uteri'),('gynaecological-cancer',1,'XE1zN',NULL,'Carcinoma cervix uteri'),('gynaecological-cancer',1,'XE1zN',NULL,'Carcinoma cervix uteri: [adenocarcinoma] or [invasive]'),('gynaecological-cancer',1,'XE1zN',NULL,'Cervical carcinoma, invasive'),('gynaecological-cancer',1,'XE1zT',NULL,'Ca cervix uteri NOS'),('gynaecological-cancer',1,'XE1zT',NULL,'Ca cervix uteri NOS'),('gynaecological-cancer',1,'XE1zX',NULL,'Ca ovary/other uterine adnexa'),('gynaecological-cancer',1,'XE1zX',NULL,'Ca ovary/other uterine adnexa'),('gynaecological-cancer',1,'XE1zZ',NULL,'Ca ovary/uterine adnexa NOS'),('gynaecological-cancer',1,'XM1Ca',NULL,'Pelvic mass'),('gynaecological-cancer',1,'XM1Ca',NULL,'Pelvic mass'),('gynaecological-cancer',1,'XM1CZ',NULL,'Pelvic lump'),('gynaecological-cancer',1,'XM1CZ',NULL,'Pelvic lump')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('gynaecological-cancer',1,'74285003',NULL,'Mass of pelvic structure'),('gynaecological-cancer',1,'92056006',NULL,'Benign tumor of cervix'),('gynaecological-cancer',1,'92260003',NULL,'Benign ovarian tumor'),('gynaecological-cancer',1,'93934004',NULL,'Primary malignant neoplasm of ovary (disorder)'),('gynaecological-cancer',1,'94126000',NULL,'Primary malignant neoplasm of uterine adnexa (disorder)'),('gynaecological-cancer',1,'94455000',NULL,'Cancer metastatic to ovary'),('gynaecological-cancer',1,'94664002',NULL,'Secondary malignant neoplasm of uterine adnexa (disorder)'),('gynaecological-cancer',1,'94792004',NULL,'Neoplasm of uncertain behavior of uterine cervix (disorder)'),('gynaecological-cancer',1,'94974001',NULL,'Neoplasm of uncertain behavior of ovary (disorder)'),('gynaecological-cancer',1,'109880006',NULL,'Overlapping malignant neoplasm of uterine cervix (disorder)'),('gynaecological-cancer',1,'123841004',NULL,'Tumor of cervix'),('gynaecological-cancer',1,'123843001',NULL,'Tumor of ovary'),('gynaecological-cancer',1,'188192002',NULL,'Malignant neoplasm of endometrium of corpus uteri (disorder)'),('gynaecological-cancer',1,'188469005',NULL,'Cancer metastatic to cervix'),('gynaecological-cancer',1,'254856004',NULL,'Undifferentiated ovarian cancer'),('gynaecological-cancer',1,'314970000',NULL,'Local recurrence of malignant tumor of cervix (disorder)'),('gynaecological-cancer',1,'314992001',NULL,'Metastasis from malignant tumor of cervix (disorder)'),('gynaecological-cancer',1,'363354003',NULL,'Cervical cancer'),('gynaecological-cancer',1,'363443007',NULL,'Ovarian cancer'),('gynaecological-cancer',1,'363514001',NULL,'Malignant tumor of female genital organ (disorder)'),('gynaecological-cancer',1,'369522002',NULL,'Primary malignant neoplasm of left ovary (disorder)'),('gynaecological-cancer',1,'369523007',NULL,'Cancer metastatic to left ovary'),('gynaecological-cancer',1,'369529006',NULL,'Primary malignant neoplasm of right ovary (disorder)'),('gynaecological-cancer',1,'369530001',NULL,'Cancer metastatic to right ovary'),('gynaecological-cancer',1,'372024009',NULL,'Primary malignant neoplasm of uterine cervix'),('gynaecological-cancer',1,'416712009',NULL,'Clear cell (mesonephric) neoplasm of ovary'),('gynaecological-cancer',1,'422782004',NULL,'Primary malignant neoplasm of ovary, with widespread metastatic disease'),('gynaecological-cancer',1,'423274005',NULL,'Ovarian cancer stage 4'),('gynaecological-cancer',1,'423480004',NULL,'Cancer of ovary, stage 3'),('gynaecological-cancer',1,'423973006',NULL,'Invasive cervical cancer'),('gynaecological-cancer',1,'424486004',NULL,'Cancer of ovary, stage 2'),('gynaecological-cancer',1,'424600001',NULL,'Ovarian cancer stage 1'),('gynaecological-cancer',1,'428322007',NULL,'Malignant neoplasm of uterine adnexa'),('gynaecological-cancer',1,'716855006',NULL,'Theca steroid producing cell malignant tumour of ovary'),('gynaecological-cancer',1,'718220008',NULL,'Hereditary breast and ovarian cancer syndrome'),('gynaecological-cancer',1,'764791008',NULL,'Borderline epithelial neoplasm of ovary (disorder)'),('gynaecological-cancer',1,'33521000119105',NULL,'Neoplasm of low malignant potential behavior of ovary (disorder)'),('gynaecological-cancer',1,'15540006',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage I'),('gynaecological-cancer',1,'25654007',NULL,'FIGO CC stage Ib'),('gynaecological-cancer',1,'49219005',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage Ia'),('gynaecological-cancer',1,'52708004',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage III (finding)'),('gynaecological-cancer',1,'68240008',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage II (finding)'),('gynaecological-cancer',1,'81822003',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage IV (finding)'),('gynaecological-cancer',1,'87977001',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage Ib occ'),('gynaecological-cancer',1,'708327004',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IA1 (finding)'),('gynaecological-cancer',1,'708331005',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IA2 (finding)'),('gynaecological-cancer',1,'708340009',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IB1 (finding)'),('gynaecological-cancer',1,'708368008',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IB2 (finding)'),('gynaecological-cancer',1,'708381001',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIA1 (finding)'),('gynaecological-cancer',1,'708383003',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIA2 (finding)'),('gynaecological-cancer',1,'708387002',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIB (finding)'),('gynaecological-cancer',1,'708393005',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIIA (finding)'),('gynaecological-cancer',1,'708395003',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIIB (finding)'),('gynaecological-cancer',1,'708400002',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IVA (finding)'),('gynaecological-cancer',1,'708404006',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IVB (finding)'),('gynaecological-cancer',1,'315266007',NULL,'Suspected cervical cancer (situation)'),('gynaecological-cancer',1,'315267003',NULL,'Suspected endometrial cancer (situation)'),('gynaecological-cancer',1,'397682005',NULL,'Suspected gynecological cancer (situation)'),('gynaecological-cancer',1,'725275004',NULL,'Subject refused referral to gynaecologist'),('gynaecological-cancer',1,'762997004',NULL,'Suspected ovarian cancer'),('gynaecological-cancer',1,'4461000175108',NULL,'Screening for malignant neoplasm of cervix not done'),('gynaecological-cancer',1,'112241000119107',NULL,'Cervical cancer Papanicolaou smear screening declined'),('gynaecological-cancer',1,'30382004',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage II'),('gynaecological-cancer',1,'34537009',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IV'),('gynaecological-cancer',1,'46756001',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I A'),('gynaecological-cancer',1,'50237009',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I'),('gynaecological-cancer',1,'60275007',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I B (finding)'),('gynaecological-cancer',1,'80975007',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage III (finding)'),('gynaecological-cancer',1,'708415001',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage IIIB'),('gynaecological-cancer',1,'708432002',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage IIIC1'),('gynaecological-cancer',1,'708435000',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IIIC2'),('gynaecological-cancer',1,'708443005',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IVA (finding)'),('gynaecological-cancer',1,'708446002',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IVB (finding)'),('gynaecological-cancer',1,'708533009',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IIIA'),('gynaecological-cancer',1,'785781000000101',NULL,'Referral to community gynaecology service'),('gynaecological-cancer',1,'76742009',NULL,'Postmenopausal bleeding (finding)'),('gynaecological-cancer',1,'301822002',NULL,'Abnormal vaginal bleeding (finding)'),('gynaecological-cancer',1,'415149004',NULL,'Postmenopausal postcoital bleeding'),('gynaecological-cancer',1,'874231000000101',NULL,'QCancer endometrial cancer risk'),('gynaecological-cancer',1,'848891000000105',NULL,'QCancer ovarian cancer risk (observable entity)'),('gynaecological-cancer',1,'874251000000108',NULL,'QCancer cervical cancer risk'),('gynaecological-cancer',1,'369814002',NULL,'T3 (III): Endometrial tumor with local and/or regional spread as specified in T3a, b, N1 and FIGO IIIA, B, and C below or adnexa (direct extension or metastasis) and/or cancer cells in ascites or peritoneal washings (finding)'),('gynaecological-cancer',1,'446526009',NULL,'Debulking of neoplasm of ovary'),('gynaecological-cancer',1,'473239006',NULL,'Bilateral oophorectomy for malignant tumour of ovary'),('gynaecological-cancer',1,'94397007',NULL,'Cancer metastatic to neck lymph nodes'),('gynaecological-cancer',1,'700125004',NULL,'Referral to paediatric gynaecology service'),('gynaecological-cancer',1,'432519008',NULL,'Elevated cancer antigen 125'),('gynaecological-cancer',1,'276311000000101',NULL,'Fast track referral for suspected gynaecological cancer'),('gynaecological-cancer',1,'382511000000105',NULL,'Seen in fast track suspected gynaecological cancer clinic'),('gynaecological-cancer',1,'249011000000106',NULL,'Referral to gynaecology special interest general practitioner'),('gynaecological-cancer',1,'119423009',NULL,'Benign teratoma of ovary (disorder)'),('gynaecological-cancer',1,'189116006',NULL,'Benign neoplasm of ovary (& dermoid cyst)'),('gynaecological-cancer',1,'312984006',NULL,'Abnormal uterine bleeding unrelated to menstrual cycle (disorder)')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesemis
VALUES ('diabetes',1,'^ESCTGE801661',NULL,'Gestational diabetes, delivered'),('diabetes',1,'^ESCTGE801662',NULL,'Gestational diabetes mellitus complicating pregnancy'),('diabetes',1,'^ESCTMA257526',NULL,'Maternal diabetes mellitus with hypoglycaemia affecting foetus OR newborn'),('diabetes',1,'EMISQNU2',NULL,'Number of admissions for ketoacidosis'),('diabetes',1,'ESCTDI20',NULL,'Diabetic ketoacidosis without coma'),('diabetes',1,'ESCTDI22',NULL,'Diabetic severe hyperglycaemia'),('diabetes',1,'ESCTDI23',NULL,'Diabetic hyperosmolar non-ketotic state'),('diabetes',1,'ESCTDR3',NULL,'Drug-induced diabetes mellitus'),('diabetes',1,'ESCTSE11',NULL,'Secondary endocrine diabetes mellitus');
INSERT INTO #codesemis
VALUES ('gynaecological-cancer',1,'^ESCT1199845',NULL,'Suspected ovarian cancer'),('gynaecological-cancer',1,'^ESCT1202154',NULL,'Borderline epithelial tumour of ovary'),('gynaecological-cancer',1,'^ESCT1202155',NULL,'Borderline ovarian epithelial tumor'),('gynaecological-cancer',1,'^ESCT1202156',NULL,'Borderline ovarian epithelial tumour'),('gynaecological-cancer',1,'^ESCT1202157',NULL,'Borderline epithelial tumor of ovary'),('gynaecological-cancer',1,'^ESCT1202158',NULL,'Borderline epithelial neoplasm of ovary'),('gynaecological-cancer',1,'^ESCT1247309',NULL,'Malignant tumor of female genital organ'),('gynaecological-cancer',1,'^ESCTBE399649',NULL,'Benign neoplasm of uterine cervix'),('gynaecological-cancer',1,'^ESCTBE399650',NULL,'Benign neoplasm of cervix uteri'),('gynaecological-cancer',1,'^ESCTBE399651',NULL,'Benign tumour of cervix'),('gynaecological-cancer',1,'^ESCTBE399652',NULL,'Benign tumor of cervix'),('gynaecological-cancer',1,'^ESCTBE400041',NULL,'Benign ovarian tumor'),('gynaecological-cancer',1,'^ESCTBI748490',NULL,'Bilateral oophorectomy for malignant neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTBI748491',NULL,'Bilateral oophorectomy for ovarian malignancy'),('gynaecological-cancer',1,'^ESCTBI748492',NULL,'Bilateral oophorectomy for malignant tumor of ovary'),('gynaecological-cancer',1,'^ESCTBI748493',NULL,'Bilateral oophorectomy for malignant tumour of ovary'),('gynaecological-cancer',1,'^ESCTBL374815',NULL,'Bleeding after menopause'),('gynaecological-cancer',1,'^ESCTCA403543',NULL,'Cancer metastatic to neck lymph nodes'),('gynaecological-cancer',1,'^ESCTCA403692',NULL,'Cancer metastatic to ovary'),('gynaecological-cancer',1,'^ESCTCA475133',NULL,'Cancer metastatic to cervix'),('gynaecological-cancer',1,'^ESCTCA624310',NULL,'Cancer of cervix'),('gynaecological-cancer',1,'^ESCTCA624313',NULL,'Cancer of the uterine cervix'),('gynaecological-cancer',1,'^ESCTCA624613',NULL,'CA - Cancer of ovary'),('gynaecological-cancer',1,'^ESCTCA632597',NULL,'Cancer metastatic to left ovary'),('gynaecological-cancer',1,'^ESCTCA632610',NULL,'Cancer metastatic to right ovary'),('gynaecological-cancer',1,'^ESCTCA700461',NULL,'Carcinoma of ovary, stage 4'),('gynaecological-cancer',1,'^ESCTCA700462',NULL,'Cancer of ovary, stage 4'),('gynaecological-cancer',1,'^ESCTCA700824',NULL,'Carcinoma of ovary, stage 3'),('gynaecological-cancer',1,'^ESCTCA700826',NULL,'Cancer of ovary, stage 3'),('gynaecological-cancer',1,'^ESCTCA701746',NULL,'Carcinoma of uterine cervix, invasive'),('gynaecological-cancer',1,'^ESCTCA701747',NULL,'Cancer of uterine cervix, invasive'),('gynaecological-cancer',1,'^ESCTCA702727',NULL,'Carcinoma of ovary, stage 2'),('gynaecological-cancer',1,'^ESCTCA702729',NULL,'Cancer of ovary, stage 2'),('gynaecological-cancer',1,'^ESCTCA702949',NULL,'Carcinoma of ovary, stage 1'),('gynaecological-cancer',1,'^ESCTCA702950',NULL,'Cancer of ovary, stage 1'),('gynaecological-cancer',1,'^ESCTCE624314',NULL,'Cervical cancer'),('gynaecological-cancer',1,'^ESCTCE797918',NULL,'Cervical cancer screening not done'),('gynaecological-cancer',1,'^ESCTCE803550',NULL,'Cervical cancer Papanicolaou smear screening declined'),('gynaecological-cancer',1,'^ESCTCL689609',NULL,'Clear cell (mesonephric) neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTDE732582',NULL,'Debulking of neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTEL716188',NULL,'Elevated cancer antigen 125'),('gynaecological-cancer',1,'^ESCTFI274652',NULL,'FIGO CC stage I'),('gynaecological-cancer',1,'^ESCTFI291047',NULL,'FIGO CC stage Ib'),('gynaecological-cancer',1,'^ESCTFI298928',NULL,'FIGO EC stage II'),('gynaecological-cancer',1,'^ESCTFI305606',NULL,'FIGO EC stage IV'),('gynaecological-cancer',1,'^ESCTFI325560',NULL,'FIGO EC stage I A'),('gynaecological-cancer',1,'^ESCTFI329633',NULL,'FIGO CC stage Ia'),('gynaecological-cancer',1,'^ESCTFI331374',NULL,'FIGO EC stage I'),('gynaecological-cancer',1,'^ESCTFI335459',NULL,'FIGO CC stage III'),('gynaecological-cancer',1,'^ESCTFI347892',NULL,'FIGO EC stage I B'),('gynaecological-cancer',1,'^ESCTFI361021',NULL,'FIGO CC stage II'),('gynaecological-cancer',1,'^ESCTFI381706',NULL,'FIGO EC stage III'),('gynaecological-cancer',1,'^ESCTFI383047',NULL,'FIGO CC stage IV'),('gynaecological-cancer',1,'^ESCTFI392953',NULL,'FIGO CC stage Ib occ'),('gynaecological-cancer',1,'^ESCTFI763214',NULL,'FIGO CC stage IA1'),('gynaecological-cancer',1,'^ESCTFI763222',NULL,'FIGO CC stage IA2'),('gynaecological-cancer',1,'^ESCTFI763240',NULL,'FIGO CC stage IB1'),('gynaecological-cancer',1,'^ESCTFI763270',NULL,'FIGO CC stage IB2'),('gynaecological-cancer',1,'^ESCTFI763288',NULL,'FIGO CC stage IIA1'),('gynaecological-cancer',1,'^ESCTFI763293',NULL,'FIGO CC stage IIA2'),('gynaecological-cancer',1,'^ESCTFI763301',NULL,'FIGO CC stage IIB'),('gynaecological-cancer',1,'^ESCTFI763311',NULL,'FIGO CC stage IIIA'),('gynaecological-cancer',1,'^ESCTFI763317',NULL,'FIGO CC stage IIIB'),('gynaecological-cancer',1,'^ESCTFI763327',NULL,'FIGO CC stage IVA'),('gynaecological-cancer',1,'^ESCTFI763336',NULL,'FIGO CC stage IVB'),('gynaecological-cancer',1,'^ESCTFI763356',NULL,'FIGO EC stage IIIB'),('gynaecological-cancer',1,'^ESCTFI763390',NULL,'FIGO EC stage IIIC1'),('gynaecological-cancer',1,'^ESCTFI763398',NULL,'FIGO EC stage IIIC2'),('gynaecological-cancer',1,'^ESCTFI763414',NULL,'FIGO EC stage IVA'),('gynaecological-cancer',1,'^ESCTFI763420',NULL,'FIGO EC stage IVB'),('gynaecological-cancer',1,'^ESCTFI763570',NULL,'FIGO EC stage IIIA'),('gynaecological-cancer',1,'^ESCTGY472470',NULL,'Gynecological referral'),('gynaecological-cancer',1,'^ESCTGY472575',NULL,'Gynecological self-referral'),('gynaecological-cancer',1,'^ESCTHE776943',NULL,'Hereditary breast and ovarian cancer syndrome'),('gynaecological-cancer',1,'^ESCTIN274653',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage I'),('gynaecological-cancer',1,'^ESCTIN274654',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage I'),('gynaecological-cancer',1,'^ESCTIN274655',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage I'),('gynaecological-cancer',1,'^ESCTIN291043',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer stage Ib'),('gynaecological-cancer',1,'^ESCTIN291044',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage Ib'),('gynaecological-cancer',1,'^ESCTIN291045',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage Ib'),('gynaecological-cancer',1,'^ESCTIN291046',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage Ib'),('gynaecological-cancer',1,'^ESCTIN298929',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage II'),('gynaecological-cancer',1,'^ESCTIN298930',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage II'),('gynaecological-cancer',1,'^ESCTIN298931',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage II'),('gynaecological-cancer',1,'^ESCTIN298932',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage II'),('gynaecological-cancer',1,'^ESCTIN305607',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IV'),('gynaecological-cancer',1,'^ESCTIN305608',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IV'),('gynaecological-cancer',1,'^ESCTIN305609',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IV'),('gynaecological-cancer',1,'^ESCTIN325561',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage I A'),('gynaecological-cancer',1,'^ESCTIN325562',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage I A'),('gynaecological-cancer',1,'^ESCTIN325563',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I A'),('gynaecological-cancer',1,'^ESCTIN329631',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage Ia'),('gynaecological-cancer',1,'^ESCTIN329632',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage Ia'),('gynaecological-cancer',1,'^ESCTIN329634',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage Ia'),('gynaecological-cancer',1,'^ESCTIN331375',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage I'),('gynaecological-cancer',1,'^ESCTIN331376',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage I'),('gynaecological-cancer',1,'^ESCTIN331377',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I'),('gynaecological-cancer',1,'^ESCTIN335460',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage III'),('gynaecological-cancer',1,'^ESCTIN335461',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage III'),('gynaecological-cancer',1,'^ESCTIN335462',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage III'),('gynaecological-cancer',1,'^ESCTIN347893',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage I B'),('gynaecological-cancer',1,'^ESCTIN347894',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage I B'),('gynaecological-cancer',1,'^ESCTIN347895',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage I B'),('gynaecological-cancer',1,'^ESCTIN361022',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage II'),
('gynaecological-cancer',1,'^ESCTIN361023',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage II'),('gynaecological-cancer',1,'^ESCTIN361024',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage II'),('gynaecological-cancer',1,'^ESCTIN381707',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage III'),('gynaecological-cancer',1,'^ESCTIN381708',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage III'),('gynaecological-cancer',1,'^ESCTIN381709',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage III'),('gynaecological-cancer',1,'^ESCTIN383048',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IV'),('gynaecological-cancer',1,'^ESCTIN383049',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IV'),('gynaecological-cancer',1,'^ESCTIN383050',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage IV'),('gynaecological-cancer',1,'^ESCTIN392954',NULL,'International Federation of Gynecology and Obstetrics cervical cancer stage Ib occ'),('gynaecological-cancer',1,'^ESCTIN392955',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage Ib occ'),('gynaecological-cancer',1,'^ESCTIN392956',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer stage Ib occ'),('gynaecological-cancer',1,'^ESCTIN392957',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage Ib occ'),('gynaecological-cancer',1,'^ESCTIN701748',NULL,'Invasive cervical cancer'),('gynaecological-cancer',1,'^ESCTIN716186',NULL,'Increased cancer antigen 125'),('gynaecological-cancer',1,'^ESCTIN763215',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IA1'),('gynaecological-cancer',1,'^ESCTIN763216',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IA1'),('gynaecological-cancer',1,'^ESCTIN763223',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IA2'),('gynaecological-cancer',1,'^ESCTIN763224',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IA2'),('gynaecological-cancer',1,'^ESCTIN763241',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IB1'),('gynaecological-cancer',1,'^ESCTIN763242',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IB1'),('gynaecological-cancer',1,'^ESCTIN763271',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IB2'),('gynaecological-cancer',1,'^ESCTIN763272',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IB2'),('gynaecological-cancer',1,'^ESCTIN763289',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IIA1'),('gynaecological-cancer',1,'^ESCTIN763290',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIA1'),('gynaecological-cancer',1,'^ESCTIN763294',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIA2'),('gynaecological-cancer',1,'^ESCTIN763295',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IIA2'),('gynaecological-cancer',1,'^ESCTIN763302',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IIB'),('gynaecological-cancer',1,'^ESCTIN763303',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIB'),('gynaecological-cancer',1,'^ESCTIN763312',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIIA'),('gynaecological-cancer',1,'^ESCTIN763313',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IIIA'),('gynaecological-cancer',1,'^ESCTIN763318',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763319',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763328',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IVA'),('gynaecological-cancer',1,'^ESCTIN763329',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IVA'),('gynaecological-cancer',1,'^ESCTIN763337',NULL,'International Federation of Gynecology and Obstetrics cervical cancer (FIGO CC) stage IVB'),('gynaecological-cancer',1,'^ESCTIN763338',NULL,'International Federation of Gynaecology and Obstetrics cervical cancer (FIGO CC) stage IVB'),('gynaecological-cancer',1,'^ESCTIN763357',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763358',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763359',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763360',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage IIIB'),('gynaecological-cancer',1,'^ESCTIN763391',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IIIC1'),('gynaecological-cancer',1,'^ESCTIN763392',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IIIC1'),('gynaecological-cancer',1,'^ESCTIN763393',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IIIC1'),('gynaecological-cancer',1,'^ESCTIN763394',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage IIIC1'),('gynaecological-cancer',1,'^ESCTIN763399',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IIIC2'),('gynaecological-cancer',1,'^ESCTIN763400',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IIIC2'),('gynaecological-cancer',1,'^ESCTIN763401',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer stage IIIC2'),('gynaecological-cancer',1,'^ESCTIN763402',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer stage IIIC2'),('gynaecological-cancer',1,'^ESCTIN763415',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IVA'),('gynaecological-cancer',1,'^ESCTIN763416',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IVA'),('gynaecological-cancer',1,'^ESCTIN763421',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IVB'),('gynaecological-cancer',1,'^ESCTIN763422',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IVB'),('gynaecological-cancer',1,'^ESCTIN763569',NULL,'International Federation of Gynaecology and Obstetrics endometrial cancer (FIGO EC) stage IIIA'),('gynaecological-cancer',1,'^ESCTIN763571',NULL,'International Federation of Gynecology and Obstetrics endometrial cancer (FIGO EC) stage IIIA'),('gynaecological-cancer',1,'^ESCTKR403685',NULL,'Krukenburg tumor'),('gynaecological-cancer',1,'^ESCTKR403691',NULL,'Krukenburg tumour'),('gynaecological-cancer',1,'^ESCTLO605219',NULL,'Local recurrence of malignant tumour of cervix'),('gynaecological-cancer',1,'^ESCTLO605220',NULL,'Local recurrence of malignant tumor of cervix'),('gynaecological-cancer',1,'^ESCTMA370769',NULL,'Mass of pelvic structure'),('gynaecological-cancer',1,'^ESCTMA624309',NULL,'Malignant tumor of cervix'),('gynaecological-cancer',1,'^ESCTMA624311',NULL,'Malignant neoplasm of cervix'),('gynaecological-cancer',1,'^ESCTMA624612',NULL,'Malignant tumor of ovary'),('gynaecological-cancer',1,'^ESCTMA624805',NULL,'Malignant tumor of female genital organ'),('gynaecological-cancer',1,'^ESCTME403541',NULL,'Metastatic malignant neoplasm to lymph nodes of neck'),('gynaecological-cancer',1,'^ESCTME403542',NULL,'Metastasis to cervical lymph nodes'),('gynaecological-cancer',1,'^ESCTME403684',NULL,'Metastatic malignant neoplasm to ovary'),('gynaecological-cancer',1,'^ESCTME403688',NULL,'Metastasis to ovary'),('gynaecological-cancer',1,'^ESCTME404206',NULL,'Metastatic malignant neoplasm to uterine adnexa'),('gynaecological-cancer',1,'^ESCTME475130',NULL,'Metastatic malignant neoplasm to uterine cervix'),('gynaecological-cancer',1,'^ESCTME475131',NULL,'Metastatic malignant neoplasm to cervix uteri'),('gynaecological-cancer',1,'^ESCTME605247',NULL,'Metastasis from malignant tumour of cervix'),('gynaecological-cancer',1,'^ESCTME605248',NULL,'Metastasis from malignant tumor of cervix'),('gynaecological-cancer',1,'^ESCTNE404442',NULL,'Neoplasm of uncertain behaviour of uterine cervix'),('gynaecological-cancer',1,'^ESCTNE404443',NULL,'Neoplasm of uncertain behavior of uterine cervix'),('gynaecological-cancer',1,'^ESCTNE404444',NULL,'Neoplasm of uncertain behavior of cervix uteri'),('gynaecological-cancer',1,'^ESCTNE404445',NULL,'Neoplasm of uncertain behaviour of cervix uteri'),('gynaecological-cancer',1,'^ESCTNE404825',NULL,'Neoplasm of uncertain behavior of ovary'),('gynaecological-cancer',1,'^ESCTNE435657',NULL,'Neoplasm of uterine cervix'),('gynaecological-cancer',1,'^ESCTNE435662',NULL,'Neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTNE801501',NULL,'Neoplasm of low malignant potential behaviour of ovary'),('gynaecological-cancer',1,'^ESCTNE801502',NULL,'Neoplasm of low malignant potential behavior of ovary'),
('gynaecological-cancer',1,'^ESCTOV403687',NULL,'Ovarian metastasis'),('gynaecological-cancer',1,'^ESCTOV417122',NULL,'Overlapping malignant neoplasm of uterine cervix'),('gynaecological-cancer',1,'^ESCTOV417123',NULL,'Overlapping malignant neoplasm of cervix uteri'),('gynaecological-cancer',1,'^ESCTOV431731',NULL,'Ovarian mature cystic teratoma'),('gynaecological-cancer',1,'^ESCTOV435664',NULL,'Ovarian tumour'),('gynaecological-cancer',1,'^ESCTOV435665',NULL,'Ovarian tumor'),('gynaecological-cancer',1,'^ESCTOV624615',NULL,'Ovarian cancer'),('gynaecological-cancer',1,'^ESCTOV699568',NULL,'Ovarian cancer, disseminated'),('gynaecological-cancer',1,'^ESCTOV700463',NULL,'Ovarian cancer stage 4'),('gynaecological-cancer',1,'^ESCTOV700825',NULL,'Ovarian cancer stage 3'),('gynaecological-cancer',1,'^ESCTOV702728',NULL,'Ovarian cancer stage 2'),('gynaecological-cancer',1,'^ESCTOV702951',NULL,'Ovarian cancer stage 1'),('gynaecological-cancer',1,'^ESCTPA786697',NULL,'Patient refused referral to gynecologist'),('gynaecological-cancer',1,'^ESCTPA786700',NULL,'Patient refused referral to gynaecologist'),('gynaecological-cancer',1,'^ESCTPE370768',NULL,'Pelvic lump'),('gynaecological-cancer',1,'^ESCTPM374814',NULL,'PMB - Postmenopausal bleeding'),('gynaecological-cancer',1,'^ESCTPR402715',NULL,'Primary malignant neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTPR402929',NULL,'Primary malignant neoplasm of uterine adnexa'),('gynaecological-cancer',1,'^ESCTPR472843',NULL,'Private referral to gynecologist'),('gynaecological-cancer',1,'^ESCTPR632595',NULL,'Primary malignant neoplasm of left ovary'),('gynaecological-cancer',1,'^ESCTPR632608',NULL,'Primary malignant neoplasm of right ovary'),('gynaecological-cancer',1,'^ESCTPR636302',NULL,'Primary malignant neoplasm of uterine cervix'),('gynaecological-cancer',1,'^ESCTPR699569',NULL,'Primary malignant neoplasm of ovary, with widespread metastatic disease'),('gynaecological-cancer',1,'^ESCTRA716187',NULL,'Raised cancer antigen 125'),('gynaecological-cancer',1,'^ESCTRE472469',NULL,'Referral to gynaecology service'),('gynaecological-cancer',1,'^ESCTRE472472',NULL,'Referral to gynecology service'),('gynaecological-cancer',1,'^ESCTRE595195',NULL,'Referral to obstetrics and gynaecology service'),('gynaecological-cancer',1,'^ESCTRE595196',NULL,'Referral to obstetrics and gynecology service'),('gynaecological-cancer',1,'^ESCTRE595438',NULL,'Referral to obstetrician and gynecologist'),('gynaecological-cancer',1,'^ESCTRE597926',NULL,'Referral to gynecologist'),('gynaecological-cancer',1,'^ESCTRE753131',NULL,'Referral to pediatric gynecology service'),('gynaecological-cancer',1,'^ESCTRE786695',NULL,'Referral to gynaecologist declined by subject'),('gynaecological-cancer',1,'^ESCTRE786696',NULL,'Referral to gynecologist declined by subject'),('gynaecological-cancer',1,'^ESCTSC797919',NULL,'Screening for malignant neoplasm of cervix not done'),('gynaecological-cancer',1,'^ESCTSE403540',NULL,'Secondary malignant neoplasm of lymph nodes of neck'),('gynaecological-cancer',1,'^ESCTSE403686',NULL,'Secondary tumor to ovary'),('gynaecological-cancer',1,'^ESCTSE403689',NULL,'Secondary cancer of ovary'),('gynaecological-cancer',1,'^ESCTSE403690',NULL,'Secondary tumour to ovary'),('gynaecological-cancer',1,'^ESCTSE404205',NULL,'Secondary malignant neoplasm of uterine adnexa'),('gynaecological-cancer',1,'^ESCTSE475132',NULL,'Secondary malignant neoplasm of uterine cervix'),('gynaecological-cancer',1,'^ESCTSE632596',NULL,'Secondary malignant neoplasm of left ovary'),('gynaecological-cancer',1,'^ESCTSE632609',NULL,'Secondary malignant neoplasm of right ovary'),('gynaecological-cancer',1,'^ESCTSU659110',NULL,'Suspected gynecological cancer'),('gynaecological-cancer',1,'^ESCTSU786698',NULL,'Subject declined referral to gynecologist'),('gynaecological-cancer',1,'^ESCTSU786699',NULL,'Subject refused referral to gynecologist'),('gynaecological-cancer',1,'^ESCTSU786701',NULL,'Subject declined referral to gynaecologist'),('gynaecological-cancer',1,'^ESCTSU786702',NULL,'Subject refused referral to gynaecologist'),('gynaecological-cancer',1,'^ESCTT3633184',NULL,'T3 (III): Endometrial tumour with local and/or regional spread as specified in T3a, b, N1 and FIGO IIIA, B, and C below or adnexa (direct extension or metastasis) and/or cancer cells in ascites or peritoneal washings'),('gynaecological-cancer',1,'^ESCTT3633185',NULL,'T3 (III): Endometrial tumor with local and/or regional spread as specified in T3a, b, N1 and FIGO IIIA, B, and C below or adnexa (direct extension or metastasis) and/or cancer cells in ascites or peritoneal washings'),('gynaecological-cancer',1,'^ESCTTH775303',NULL,'Theca steroid producing cell malignant neoplasm of ovary'),('gynaecological-cancer',1,'^ESCTTH775304',NULL,'Theca steroid producing cell malignant tumor of ovary'),('gynaecological-cancer',1,'^ESCTTH775305',NULL,'Theca steroid producing cell malignant tumour of ovary'),('gynaecological-cancer',1,'^ESCTTU435658',NULL,'Tumour of cervix'),('gynaecological-cancer',1,'^ESCTTU435659',NULL,'Tumor of cervix'),('gynaecological-cancer',1,'^ESCTTU435663',NULL,'Tumour of ovary'),('gynaecological-cancer',1,'^ESCTTU435666',NULL,'Tumor of ovary'),('gynaecological-cancer',1,'^ESCTUN535181',NULL,'Undifferentiated carcinoma of ovary'),('gynaecological-cancer',1,'^ESCTUN535182',NULL,'Undifferentiated ovarian cancer'),('gynaecological-cancer',1,'EMISNQQC5',NULL,'QCancer ovarian cancer risk score'),('gynaecological-cancer',1,'EMISNQQC8',NULL,'QCancer cervical cancer risk score'),('gynaecological-cancer',1,'EMISNQQC9',NULL,'QCancer endometrial cancer risk score'),('gynaecological-cancer',1,'EMISNQSU3',NULL,'Suspected gynaecological cancer')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL, [description] VARCHAR(255));

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version], dcr.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
AND (dcr.term IS NULL OR dcr.term = rc.Term)
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version], dcc.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL, [description] VARCHAR(255));

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version], dcs.[description]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept, [description]
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept, [description]
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

--#endregion

-- >>> Following code sets injected: gynaecological-cancer v1


-- Set the start date
DECLARE @StartDate datetime;
DECLARE @EndDate datetime;
SET @StartDate = '2011-01-01';
SET @EndDate = '2022-06-01';

--Just want the output, not the messages
SET NOCOUNT ON;


-- Create the gynae cancer cohort========================================================================================================
IF OBJECT_ID('tempdb..#GynaeCohort') IS NOT NULL DROP TABLE #GynaeCohort;
SELECT DISTINCT FK_Patient_Link_ID 
INTO #GynaeCohort
FROM SharedCare.GP_Events
WHERE (
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'gynaecological-cancer' AND Version = 1) OR
  FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'gynaecological-cancer' AND Version = 1)
) AND EventDate >= @StartDate AND EventDate < @EndDate;


-- Create a table with all patients for post COPI and within 2 cohorts=========================================================================================================================
IF OBJECT_ID('tempdb..#PatientsToInclude') IS NOT NULL DROP TABLE #PatientsToInclude;
SELECT FK_Patient_Link_ID INTO #PatientsToInclude
FROM [SharedCare].[Patient_GP_History]
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #GynaeCohort)
GROUP BY FK_Patient_Link_ID
HAVING MIN(StartDate) < '2022-06-01';

IF OBJECT_ID('tempdb..#Patients') IS NOT NULL DROP TABLE #Patients;
SELECT DISTINCT FK_Patient_Link_ID 
INTO #Patients 
FROM #PatientsToInclude;


-- >>> Following code sets injected: diabetes v1


-- The final table============================================================================================================================================
SELECT DISTINCT FK_Patient_Link_ID AS PatientId, 
		CONVERT(date, EventDate) AS EventDate
FROM SharedCare.GP_Events
WHERE (
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'diabetes' AND Version = 1) OR
  FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'diabetes' AND Version = 1)
) AND FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients) AND CONVERT(date, EventDate) < @EndDate
ORDER BY FK_Patient_Link_ID, EventDate;
