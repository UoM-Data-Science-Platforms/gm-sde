--┌────────────────────────────────────┐
--│ An example SQL generation template │
--└────────────────────────────────────┘

-- OUTPUT: Data with the following fields
-- 	- PatientId (int)
--  - DateOfFirstDiagnosis (YYYY-MM-DD) 

--Just want the output, not the messages
SET NOCOUNT ON;

-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('hypertension',1,'G2...00','Hypertensive disease'),('hypertension',1,'G2...','Hypertensive disease'),('hypertension',1,'G20..11','High blood pressure'),('hypertension',1,'G20..','High blood pressure'),('hypertension',1,'G20..00','Essential hypertension'),('hypertension',1,'G20..','Essential hypertension'),('hypertension',1,'G201.00','Benign essential hypertension'),('hypertension',1,'G201.','Benign essential hypertension'),('hypertension',1,'G20z.11','Hypertension NOS'),('hypertension',1,'G20z.','Hypertension NOS'),('hypertension',1,'G202.00','Systolic hypertension'),('hypertension',1,'G202.','Systolic hypertension'),('hypertension',1,'G2z..00','Hypertensive disease NOS'),('hypertension',1,'G2z..','Hypertensive disease NOS'),('hypertension',1,'G24..00','Secondary hypertension'),('hypertension',1,'G24..','Secondary hypertension'),('hypertension',1,'G20z.00','Essential hypertension NOS'),('hypertension',1,'G20z.','Essential hypertension NOS'),('hypertension',1,'G200.00','Malignant essential hypertension'),('hypertension',1,'G200.','Malignant essential hypertension'),('hypertension',1,'G24z.00','Secondary hypertension NOS'),('hypertension',1,'G24z.','Secondary hypertension NOS'),('hypertension',1,'G2y..00','Other specified hypertensive disease'),('hypertension',1,'G2y..','Other specified hypertensive disease'),('hypertension',1,'G241000','Secondary benign renovascular hypertension'),('hypertension',1,'G2410','Secondary benign renovascular hypertension'),('hypertension',1,'G24z100','Hypertension secondary to drug'),('hypertension',1,'G24z1','Hypertension secondary to drug'),('hypertension',1,'G24z000','Secondary renovascular hypertension NOS'),('hypertension',1,'G24z0','Secondary renovascular hypertension NOS'),('hypertension',1,'G240.00','Secondary malignant hypertension'),('hypertension',1,'G240.','Secondary malignant hypertension'),('hypertension',1,'G244.00','Hypertension secondary to endocrine disorders'),('hypertension',1,'G244.','Hypertension secondary to endocrine disorders'),('hypertension',1,'G24zz00','Secondary hypertension NOS'),('hypertension',1,'G24zz','Secondary hypertension NOS'),('hypertension',1,'G241z00','Secondary benign hypertension NOS'),('hypertension',1,'G241z','Secondary benign hypertension NOS'),('hypertension',1,'G241.00','Secondary benign hypertension'),('hypertension',1,'G241.','Secondary benign hypertension'),('hypertension',1,'G240000','Secondary malignant renovascular hypertension'),('hypertension',1,'G2400','Secondary malignant renovascular hypertension'),('hypertension',1,'Gyu2.00','[X]Hypertensive diseases'),('hypertension',1,'Gyu2.','[X]Hypertensive diseases'),('hypertension',1,'G240z00','Secondary malignant hypertension NOS'),('hypertension',1,'G240z','Secondary malignant hypertension NOS'),('hypertension',1,'G203.00','Diastolic hypertension'),('hypertension',1,'G203.','Diastolic hypertension'),('hypertension',1,'Gyu2000','[X]Other secondary hypertension'),('hypertension',1,'Gyu20','[X]Other secondary hypertension')

INSERT INTO #AllCodes
SELECT [concept], [version], [code] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('hypertension',1,'14A2.','H/O: hypertension'),('hypertension',1,'21261','Hypertension resolved'),('hypertension',1,'2466.','O/E - BP reading raised'),('hypertension',1,'2467.','O/E - BP reading very high'),('hypertension',1,'662..','Cardiac disease monitoring (& [hypertension])'),('hypertension',1,'6627.','Good hypertension control'),('hypertension',1,'6628.','Poor hypertension control'),('hypertension',1,'6629.','Hypertension:follow-up default'),('hypertension',1,'662F.','Hypertension treatm. started'),('hypertension',1,'662G.','Hypertensive treatm.changed'),('hypertension',1,'662H.','Hypertension treatm.stopped'),('hypertension',1,'662O.','On treatment for hypertension'),('hypertension',1,'662P.','Hypertension monitoring'),('hypertension',1,'8HT5.','Referral to hypertension clinic'),('hypertension',1,'9N03.','Seen in hypertension clinic'),('hypertension',1,'9N1y2','Seen in hypertension clinic'),('hypertension',1,'9OI..','Hypertension admin: [monitoring] or [clinic]'),('hypertension',1,'9OI1.','Attends hypertension monitoring'),('hypertension',1,'9OI3.','Hypertension monitoring offer default'),('hypertension',1,'9OI4.','Hypertension monitoring first letter'),('hypertension',1,'9OI4.','Hypertension monitoring first letter'),('hypertension',1,'9OI5.','Hypertension monitoring second letter'),('hypertension',1,'9OI5.','Hypertension monitoring second letter'),('hypertension',1,'9OI6.','Hypertension monitoring third letter'),('hypertension',1,'9OI6.','Hypertension monitoring third letter'),('hypertension',1,'9OI7.','Hypertension monitoring verbal invite'),('hypertension',1,'9OI7.','Hypertension monitoring verbal invite'),('hypertension',1,'9OI8.','Hypertension monitoring telephone invite'),('hypertension',1,'9OI8.','Hypertension monitoring telephone invite'),('hypertension',1,'9OIA.','Hypertension monitor (& check done)'),('hypertension',1,'9OIZ.','Hypertens.monitoring admin.NOS'),('hypertension',1,'F4211','Hypertensive retinopathy'),('hypertension',1,'G2...','Hypertensive disease'),('hypertension',1,'G2...','Hypertensive disease'),('hypertension',1,'G2...','Hypertensive disease'),('hypertension',1,'G20..','High blood pressure (& [essential hypertension])'),('hypertension',1,'G20..','High blood pressure (& [essential hypertension])'),('hypertension',1,'G200.','Malignant essential hypertension'),('hypertension',1,'G200.','Malignant essential hypertension'),('hypertension',1,'G201.','Benign essential hypertension'),('hypertension',1,'G201.','Benign essential hypertension'),('hypertension',1,'G202.','Systolic hypertension'),('hypertension',1,'G202.','Systolic hypertension'),('hypertension',1,'G20z.','Hypertension NOS (& [essential])'),('hypertension',1,'G20z.','Hypertension NOS (& [essential])'),('hypertension',1,'G21..','Hypertensive heart disease'),('hypertension',1,'G21..','Hypertensive heart disease'),('hypertension',1,'G210.','Malignant hypertensive heart disease'),('hypertension',1,'G210.','Malignant hypertensive heart disease'),('hypertension',1,'G2100','Malignant hypertensive heart disease without CCF'),('hypertension',1,'G2100','Malignant hypertensive heart disease without CCF'),('hypertension',1,'G2101','Malignant hypertensive heart disease with CCF'),('hypertension',1,'G2101','Malignant hypertensive heart disease with CCF'),('hypertension',1,'G210z','Malignant hypertensive heart disease NOS'),('hypertension',1,'G210z','Malignant hypertensive heart disease NOS'),('hypertension',1,'G211.','Benign hypertensive heart disease'),('hypertension',1,'G211.','Benign hypertensive heart disease'),('hypertension',1,'G2110','Benign hypertensive heart disease without CCF'),('hypertension',1,'G2110','Benign hypertensive heart disease without CCF'),('hypertension',1,'G2111','Benign hypertensive heart disease with CCF'),('hypertension',1,'G2111','Benign hypertensive heart disease with CCF'),('hypertension',1,'G211z','Benign hypertensive heart disease NOS'),('hypertension',1,'G211z','Benign hypertensive heart disease NOS'),('hypertension',1,'G21z.','Hypertensive heart disease NOS'),('hypertension',1,'G21z.','Hypertensive heart disease NOS'),('hypertension',1,'G21z0','"Hypertensiv:[cardiomeg][heart dis NOS, no congest card fail]"'),('hypertension',1,'G21z0','"Hypertensiv:[cardiomeg][heart dis NOS, no congest card fail]"'),('hypertension',1,'G21z1','Hypertensive heart disease NOS with CCF'),('hypertension',1,'G21z1','Hypertensive heart disease NOS with CCF'),('hypertension',1,'G22..','Hypertensive renal disease (& [nephrosclerosis])'),('hypertension',1,'G220.','Malignant hypertensive renal disease'),('hypertension',1,'G221.','Benign hypertensive renal disease'),('hypertension',1,'G222.','Hypertensive renal disease with renal failure'),('hypertension',1,'G22z.','(Renal hypertension) or (hypertensive renal disease NOS)'),('hypertension',1,'G23..','Hypertensive heart and renal disease'),('hypertension',1,'G23..','Hypertensive heart and renal disease'),('hypertension',1,'G230.','Malignant hypertensive heart and renal disease'),('hypertension',1,'G230.','Malignant hypertensive heart and renal disease'),('hypertension',1,'G231.','Benign hypertensive heart and renal disease'),('hypertension',1,'G231.','Benign hypertensive heart and renal disease'),('hypertension',1,'G232.','Hypertensive heart&renal dis wth (congestive) heart failure'),('hypertension',1,'G232.','Hypertensive heart&renal dis wth (congestive) heart failure'),('hypertension',1,'G233.','Hypertensive heart and renal disease with renal failure'),('hypertension',1,'G233.','Hypertensive heart and renal disease with renal failure'),('hypertension',1,'G234.','Hyperten heart&renal dis+both(congestv)heart and renal fail'),('hypertension',1,'G234.','Hyperten heart&renal dis+both(congestv)heart and renal fail'),('hypertension',1,'G23z.','Hypertensive heart and renal disease NOS'),('hypertension',1,'G23z.','Hypertensive heart and renal disease NOS'),('hypertension',1,'G24..','Secondary hypertension'),('hypertension',1,'G24..','Secondary hypertension'),('hypertension',1,'G240.','Malignant secondary hypertension'),('hypertension',1,'G240.','Malignant secondary hypertension'),('hypertension',1,'G2400','Secondary malignant renovascular hypertension'),('hypertension',1,'G2400','Secondary malignant renovascular hypertension'),('hypertension',1,'G240z','Secondary malignant hypertension NOS'),('hypertension',1,'G240z','Secondary malignant hypertension NOS'),('hypertension',1,'G241.','Secondary benign hypertension'),('hypertension',1,'G241.','Secondary benign hypertension'),('hypertension',1,'G2410','Secondary benign renovascular hypertension'),('hypertension',1,'G2410','Secondary benign renovascular hypertension'),('hypertension',1,'G241z','Secondary benign hypertension NOS'),('hypertension',1,'G241z','Secondary benign hypertension NOS'),('hypertension',1,'G244.','Hypertension secondary to endocrine disorders'),('hypertension',1,'G244.','Hypertension secondary to endocrine disorders'),('hypertension',1,'G24z.','Secondary hypertension NOS'),('hypertension',1,'G24z.','Secondary hypertension NOS'),('hypertension',1,'G24z0','Secondary renovascular hypertension NOS'),('hypertension',1,'G24z0','Secondary renovascular hypertension NOS'),('hypertension',1,'G24zz','Secondary hypertension NOS'),('hypertension',1,'G24zz','Secondary hypertension NOS'),('hypertension',1,'G2y..','Other specified hypertensive disease'),('hypertension',1,'G2y..','Other specified hypertensive disease'),('hypertension',1,'G2z..','Hypertensive disease NOS'),('hypertension',1,'G2z..','Hypertensive disease NOS'),('hypertension',1,'G672.','Hypertensive: [encephalopathy] or [crisis]'),('hypertension',1,'Gyu2.','[X]Hypertensive diseases'),('hypertension',1,'Gyu2.','[X]Hypertensive diseases'),('hypertension',1,'Gyu20','[X]Other secondary hypertension'),('hypertension',1,'Gyu20','[X]Other secondary hypertension'),('hypertension',1,'Gyu21','[X]Hypertension secondary to other renal disorders'),('hypertension',1,'Gyu21','[X]Hypertension secondary to other renal disorders'),('hypertension',1,'L122.','Other pre-existing hypertension in preg/childbirth/puerp'),('hypertension',1,'L122.','Other pre-existing hypertension in preg/childbirth/puerp'),('hypertension',1,'L1220','Other pre-existing hypertension in preg/childb/puerp unspec'),('hypertension',1,'L1220','Other pre-existing hypertension in preg/childb/puerp unspec'),('hypertension',1,'L1221','Other pre-existing hypertension in preg/childb/puerp - deliv'),('hypertension',1,'L1221','Other pre-existing hypertension in preg/childb/puerp - deliv'),('hypertension',1,'L1222','Oth pre-exist hypert in preg/childb/puerp -del with p/n comp'),('hypertension',1,'L1222','Oth pre-exist hypert in preg/childb/puerp -del with p/n comp'),('hypertension',1,'L1223','Other pre-exist hypertension in preg/childb/puerp-not deliv'),('hypertension',1,'L1223','Other pre-exist hypertension in preg/childb/puerp-not deliv'),('hypertension',1,'L1224','Other pre-exist hypertension in preg/childb/puerp + p/n comp'),('hypertension',1,'L1224','Other pre-exist hypertension in preg/childb/puerp + p/n comp'),('hypertension',1,'L122z','Other pre-existing hypertension in preg/childb/puerp NOS'),('hypertension',1,'L122z','Other pre-existing hypertension in preg/childb/puerp NOS'),('hypertension',1,'L127.','Pre-eclampsia or eclampsia with pre-existing hypertension'),('hypertension',1,'L127.','Pre-eclampsia or eclampsia with pre-existing hypertension'),('hypertension',1,'L127z','Pre-eclampsia or eclampsia + pre-existing hypertension NOS'),('hypertension',1,'L127z','Pre-eclampsia or eclampsia + pre-existing hypertension NOS'),('hypertension',1,'L128.','Pre-exist hypertension compl preg childbirth and puerperium'),('hypertension',1,'L128.','Pre-exist hypertension compl preg childbirth and puerperium'),('hypertension',1,'L1280','Pre-exist hyperten heart dis compl preg childbth+puerperium'),('hypertension',1,'L1281','Pre-exist hyperten heart renal dis comp preg chldbirth/puerp'),
('hypertension',1,'L1281','Pre-exist hyperten heart renal dis comp preg chldbirth/puerp'),('hypertension',1,'L1282','Pre-exist 2ndry hypertens comp preg childbth and puerprum'),('hypertension',1,'L1282','Pre-exist 2ndry hypertens comp preg childbth and puerprum'),('hypertension',1,'XE0Ub','Hypertension'),('hypertension',1,'XE0Ub','Hypertension'),('hypertension',1,'XE0Ub','Hypertension'),('hypertension',1,'XE0Uc','Essential hypertension'),('hypertension',1,'XE0Uc','Essential hypertension'),('hypertension',1,'XE0Uc','Essential hypertension'),('hypertension',1,'XE0Ud','Essential hypertension NOS'),('hypertension',1,'XE0Ud','Essential hypertension NOS'),('hypertension',1,'XE0Ud','Essential hypertension NOS'),('hypertension',1,'XE0Ue','Hypertensive heart disease NOS without CCF'),('hypertension',1,'XE0Ue','Hypertensive heart disease NOS without CCF'),('hypertension',1,'XE0Ue','Hypertensive heart disease NOS without CCF'),('hypertension',1,'XE0Uf','Hypertensive renal disease'),('hypertension',1,'XE0Uf','Hypertensive renal disease'),('hypertension',1,'XE0VM','Hypertensive encephalopathy'),('hypertension',1,'XE0VM','Hypertensive encephalopathy'),('hypertension',1,'XE0W8','(Hypertensive disease) or (hypertension)'),('hypertension',1,'XE0W8','(Hypertensive disease) or (hypertension)'),('hypertension',1,'XE0xu','Pregnancy with hypertension (& [pre-existing])'),('hypertension',1,'XE2NY','Hypertension monitoring admin.'),('hypertension',1,'XE2NY','Hypertension monitoring admin.'),('hypertension',1,'XE2NZ','Hypertension monitoring check done'),('hypertension',1,'XE2NZ','Hypertension monitoring check done'),('hypertension',1,'XM1Qp','Cardiomegaly - hypertensive'),('hypertension',1,'XM1Qp','Cardiomegaly - hypertensive'),('hypertension',1,'XM1Qp','Cardiomegaly - hypertensive'),('hypertension',1,'XM1U2','Hypertension clinic admin.'),('hypertension',1,'XM1U2','Hypertension clinic admin.'),('hypertension',1,'XM1YA','Hypertension monitoring'),('hypertension',1,'XSDSb','Diastolic hypertension'),('hypertension',1,'XSDSb','Diastolic hypertension'),('hypertension',1,'Xa0Cs','Labile hypertension'),('hypertension',1,'Xa0Cs','Labile hypertension'),('hypertension',1,'Xa0kX','Renovascular hypertension'),('hypertension',1,'Xa0kX','Renovascular hypertension'),('hypertension',1,'Xa0lt','Pre-existing hypertension complicating pregnancy'),('hypertension',1,'Xa0lt','Pre-existing hypertension complicating pregnancy'),('hypertension',1,'Xa3fQ','Malignant hypertension'),('hypertension',1,'Xa3fQ','Malignant hypertension'),('hypertension',1,'Xa8HD','On treatment for hypertension'),('hypertension',1,'XaBLq','Antihypertensive therapy'),('hypertension',1,'XaBSX','Hypertension screening recall'),('hypertension',1,'XaBU4','Hypertension monitoring status'),('hypertension',1,'XaBU5','Hypertension monitoring call'),('hypertension',1,'XaIy8','Moderate hypertension control'),('hypertension',1,'XaIyD','Hypertension six month review'),('hypertension',1,'XaIyE','Hypertension annual review'),('hypertension',1,'XaJ5h','Patient on maximal tolerated antihypertensive therapy'),('hypertension',1,'XaJ5h','Patient on maximal tolerated antihypertensive therapy'),('hypertension',1,'XaJYi','Hypertension clinical management plan'),('hypertension',1,'XaM5f','High cost hypertension drugs'),('hypertension',1,'XaM5n','Other specified high cost hypertension drugs'),('hypertension',1,'XaM5p','High cost hypertension drugs NOS'),('hypertension',1,'XaXOi','Hypertension 9 month review'),('hypertension',1,'XaYZS','Hypertension self-management plan review'),('hypertension',1,'XaZWm','Stage 1 hypertension (NICE - Nat Ins for Hth Clin Excl 2011)'),('hypertension',1,'XaZWm','Stage 1 hypertension (NICE - Nat Ins for Hth Clin Excl 2011)'),('hypertension',1,'XaZWm','Stage 1 hypertension (NICE - Nat Ins for Hth Clin Excl 2011)'),('hypertension',1,'XaZWn','Severe hypertension (Nat Inst for Health Clinical Ex 2011)'),('hypertension',1,'XaZWn','Severe hypertension (Nat Inst for Health Clinical Ex 2011)'),('hypertension',1,'XaZWn','Severe hypertension (Nat Inst for Health Clinical Ex 2011)'),('hypertension',1,'XaZbT','Hypertension resistant to drug therapy'),('hypertension',1,'XaZbT','Hypertension resistant to drug therapy'),('hypertension',1,'XaZbz','Stage 2 hypertension (NICE - Nat Ins for Hth Clin Excl 2011)'),('hypertension',1,'XaZbz','Stage 2 hypertension (NICE - Nat Ins for Hth Clin Excl 2011)'),('hypertension',1,'XaZzo','Nocturnal hypertension'),('hypertension',1,'XaZzo','Nocturnal hypertension'),('hypertension',1,'Xab9L','Stage 1 hyperten (NICE 2011) without evidnce end organ damge'),('hypertension',1,'Xab9L','Stage 1 hyperten (NICE 2011) without evidnce end organ damge'),('hypertension',1,'Xab9M','Stage 1 hyperten (NICE 2011) with evidnce end organ damge'),('hypertension',1,'Xab9M','Stage 1 hyperten (NICE 2011) with evidnce end organ damge'),('hypertension',1,'Xafj3','Hypertension monitoring invitation short msg service txt msg'),('hypertension',1,'Xafj4','Hypertension mnitoring short msg service text msg 1st invitn'),('hypertension',1,'Xafj5','Hypertension mnitoring short msg service text msg 2nd invitn'),('hypertension',1,'Xafj6','Hypertension mnitoring short msg service text msg 3rd invitn'),('hypertension',1,'XagLb','Hypertension monitoring invitation email'),('hypertension',1,'Y1328','Refractory Hypertension')

INSERT INTO #AllCodes
SELECT [concept], [version], [code] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('hypertension',1,'38481006','Hypertensive renal disease (disorder)'),('hypertension',1,'83105008','Malignant hypertensive heart disease with congestive heart failure (disorder)'),('hypertension',1,'48146000','Diastolic hypertension (disorder)'),('hypertension',1,'199006004','Pre-existing hypertensive heart disease complicating pregnancy'),('hypertension',1,'270440008','Hypertension monitoring check done (finding)'),('hypertension',1,'697929007','Intermittent hypertension (disorder)'),('hypertension',1,'185716009','Attends hypertension monitoring (finding)'),('hypertension',1,'66610008','Malignant hypertensive heart AND renal disease (disorder)'),('hypertension',1,'308502002','Hypertension monitoring status (finding)'),('hypertension',1,'308427006','Hypertension screening recall (procedure)'),('hypertension',1,'163028000','On examination - blood pressure reading very high (finding)'),('hypertension',1,'713641000000103','Hypertension monitoring administration (record artifact)'),('hypertension',1,'736286003','Hypertension clinical management plan (record artifact)'),('hypertension',1,'268509003','Cardiac disease monitoring (regime/therapy)'),('hypertension',1,'302192008','On treatment for hypertension (regime/therapy)'),('hypertension',1,'220901000000101','High cost hypertension drug therapy - OPCS Classification of Interventions and Procedures (procedure)'),('hypertension',1,'194767001','Benign hypertensive heart disease with congestive cardiac failure (disorder)'),('hypertension',1,'1201005','Benign essential hypertension (disorder)'),('hypertension',1,'38341003','Hypertensive disorder'),('hypertension',1,'1066941000000104','Hypertension monitoring invitation short message service text message (procedure)'),('hypertension',1,'401118009','Hypertension annual review (procedure)'),('hypertension',1,'198997005','Pre-eclampsia or eclampsia with pre-existing hypertension (disorder)'),('hypertension',1,'73410007','Benign secondary renovascular hypertension (disorder)'),('hypertension',1,'66052004','Benign hypertensive heart AND renal disease (disorder)'),('hypertension',1,'199005000','Pre-existing hypertension complicating pregnancy'),('hypertension',1,'1066961000000103','Hypertension monitoring short message service text message second invitation (procedure)'),('hypertension',1,'185723005','Hypertension monitoring telephone invite (procedure)'),('hypertension',1,'161501007','History of hypertension (situation)'),('hypertension',1,'845891000000103','Hypertension resistant to drug therapy (disorder)'),('hypertension',1,'194780003','Hypertensive heart and renal disease with renal failure (disorder)'),('hypertension',1,'163027005','On examination - blood pressure reading raised (finding)'),('hypertension',1,'194783001','Secondary malignant renovascular hypertension (disorder)'),('hypertension',1,'86234004','Hypertensive heart AND renal disease (disorder)'),('hypertension',1,'275516004','Cardiomegaly - hypertensive (disorder)'),('hypertension',1,'401117004','Moderate hypertension control (finding)'),('hypertension',1,'193003','Benign hypertensive renal disease (disorder)'),('hypertension',1,'199007008','Pre-existing hypertensive heart and renal disease complicating pregnancy'),('hypertension',1,'162659009','Hypertension resolved (finding)'),('hypertension',1,'308503007','Hypertension monitoring call (procedure)'),('hypertension',1,'1083101000000106','Hypertension monitoring invitation email (procedure)'),('hypertension',1,'65443008','Malignant hypertensive renal disease (disorder)'),('hypertension',1,'863191000000102','Nocturnal hypertension (disorder)'),('hypertension',1,'275944005','Hypertension monitoring (regime/therapy)'),('hypertension',1,'185264001','Seen in hypertension clinic (finding)'),('hypertension',1,'183856001','Referral to hypertension clinic (procedure)'),('hypertension',1,'48194001','Pregnancy-induced hypertension (disorder)'),('hypertension',1,'908651000000101','Stage 1 hypertension (National Institute for Health and Clinical Excellence 2011) with evidence of end organ damage (disorder)'),('hypertension',1,'31992008','Secondary hypertension (disorder)'),('hypertension',1,'64715009','Hypertensive heart disease (disorder)'),('hypertension',1,'59621000','Essential hypertension (disorder)'),('hypertension',1,'185718005','Hypertension monitoring offer default (finding)'),('hypertension',1,'1066971000000105','Hypertension monitoring short message service text message third invitation (procedure)'),('hypertension',1,'36221001','Benign hypertensive heart disease (disorder)'),('hypertension',1,'194788005','Hypertension secondary to endocrine disorder (disorder)'),('hypertension',1,'846371000000103','Stage 2 hypertension (National Institute for Health and Clinical Excellence 2011) (disorder)'),('hypertension',1,'401048005','Hypertension six month review (procedure)'),('hypertension',1,'170579000','Hypertension:follow-up default (finding)'),('hypertension',1,'36315003','Malignant hypertensive heart disease without congestive heart failure (disorder)'),('hypertension',1,'185721007','Hypertension monitoring third letter (procedure)'),('hypertension',1,'810981000000107','Hypertension self-management plan review (procedure)'),('hypertension',1,'6962006','Hypertensive retinopathy (disorder)'),('hypertension',1,'50490005','Hypertensive encephalopathy (disorder)'),('hypertension',1,'908631000000108','Stage 1 hypertension (National Institute for Health and Clinical Excellence 2011) without evidence of end organ damage (disorder)'),('hypertension',1,'199008003','Pre-existing secondary hypertension complicating pregnancy'),('hypertension',1,'713661000000102','Hypertension clinic administration (record artifact)'),('hypertension',1,'78975002','Malignant essential hypertension (disorder)'),('hypertension',1,'89242004','Malignant secondary hypertension (disorder)'),('hypertension',1,'170578008','Poor hypertension control (finding)'),('hypertension',1,'194779001','Hypertensive heart and renal disease with (congestive) heart failure (disorder)'),('hypertension',1,'170577003','Good hypertension control (finding)'),('hypertension',1,'123799005','Renovascular hypertension (disorder)'),('hypertension',1,'194781004','Hypertensive heart and renal disease with both (congestive) heart failure and renal failure (disorder)'),('hypertension',1,'843821000000102','Stage 1 hypertension (National Institute for Health and Clinical Excellence 2011) (disorder)'),('hypertension',1,'185722000','Hypertension monitoring verbal invite (procedure)'),('hypertension',1,'54225002','Malignant hypertensive heart disease (disorder)'),('hypertension',1,'407567007','Patient on maximal tolerated antihypertensive therapy (finding)'),('hypertension',1,'170587004','Hypertensive treatment changed (situation)'),('hypertension',1,'86041002','Pre-existing hypertension in obstetric context (disorder)'),('hypertension',1,'185719002','Hypertension monitoring first letter (procedure)'),('hypertension',1,'170586008','Treatment for hypertension started (situation)'),('hypertension',1,'95691008','Arteriosclerotic retinopathy (disorder)'),('hypertension',1,'194785008','Secondary benign hypertension (disorder)'),('hypertension',1,'70272006','Malignant hypertension (disorder)'),('hypertension',1,'170588009','Treatment for hypertension stopped (situation)'),('hypertension',1,'56218007','Systolic hypertension (disorder)'),('hypertension',1,'766211000000109','Hypertension 9 month review (regime/therapy)'),('hypertension',1,'185720008','Hypertension monitoring second letter (procedure)'),('hypertension',1,'308116003','Antihypertensive therapy (procedure)'),('hypertension',1,'843841000000109','Severe hypertension (National Institute for Health and Clinical Excellence 2011) (disorder)'),('hypertension',1,'1066951000000101','Hypertension monitoring short message service text message first invitation (procedure)'),('hypertension',1,'698640000','Hypertension in the puerperium with pulmonary edema (disorder)'),('hypertension',1,'96731000119100','Hypertensive heart AND chronic kidney disease stage 3 (disorder)'),('hypertension',1,'285831000119108','Malignant hypertensive chronic kidney disease (disorder)'),('hypertension',1,'371125006','Labile essential hypertension (disorder)'),('hypertension',1,'23717007','Benign essential hypertension complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'39018007','Renal arterial hypertension (disorder)'),('hypertension',1,'62240004','Benign arteriolar nephrosclerosis (disorder)'),('hypertension',1,'198954000','Renal hypertension complicating pregnancy'),('hypertension',1,'37618003','Chronic hypertension complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'198951008','Renal hypertension complicating pregnancy'),('hypertension',1,'1474004','Hypertensive heart AND renal disease complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'726513006','History of hemolysis-elevated liver enzymes-low platelet count syndrome (situation)'),('hypertension',1,'129151000119102','Chronic kidney disease stage 4 due to hypertension (disorder)'),('hypertension',1,'198966006','Transient hypertension of pregnancy - delivered with postnatal complication (disorder)'),('hypertension',1,'851071000000108','Heart failure initial assessment (regime/therapy)'),('hypertension',1,'248411000000105','Atrial fibrillation annual review (regime/therapy)'),('hypertension',1,'153891000119101','End stage renal disease on dialysis due to hypertension on (disorder)'),('hypertension',1,'31407004','Pre-existing hypertension complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'198949009','Renal hypertension complicating pregnancy'),('hypertension',1,'29259002','Malignant hypertension complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'390885007','Heart failure annual review (regime/therapy)'),
('hypertension',1,'71874008','Benign essential hypertension complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'105651000119100','History of pre-eclampsia (situation)'),('hypertension',1,'140111000119107','Hypertension in chronic kidney disease stage 4 due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'428575007','Hypertension secondary to kidney transplant (disorder)'),('hypertension',1,'40521000119100','Postpartum pregnancy-induced hypertension (disorder)'),('hypertension',1,'23786008','Malignant hypertension complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'96741000119109','Hypertensive heart AND chronic kidney disease stage 2 (disorder)'),('hypertension',1,'34694006','Pre-existing hypertension complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'10757441000119102','Pre-existing hypertensive heart disease in mother complicating childbirth (disorder)'),('hypertension',1,'123800009','Goldblatt hypertension (disorder)'),('hypertension',1,'49220004','Hypertensive renal failure (disorder)'),('hypertension',1,'81626002','Malignant hypertension in obstetric context (disorder)'),('hypertension',1,'199003007','Pre-eclampsia or eclampsia with pre-existing hypertension with postnatal complication (disorder)'),('hypertension',1,'712832005','Supine hypertension (disorder)'),('hypertension',1,'284961000119106','Chronic kidney disease due to benign hypertension (disorder)'),('hypertension',1,'698638005','Pregnancy induced hypertension with pulmonary edema (disorder)'),('hypertension',1,'762463000','Diastolic hypertension co-occurrent with systolic hypertension (disorder)'),('hypertension',1,'198953006','Renal hypertension complicating pregnancy'),('hypertension',1,'709881001','History of gestational hypertension (situation)'),('hypertension',1,'5501000119106','Postoperative hypertension (disorder)'),('hypertension',1,'712487000','End stage renal disease due to benign hypertension (disorder)'),('hypertension',1,'96751000119106','Hypertensive heart AND chronic kidney disease stage 1 (disorder)'),('hypertension',1,'134377004','Atrial fibrillation monitoring (regime/therapy)'),('hypertension',1,'74451002','Secondary diastolic hypertension (disorder)'),('hypertension',1,'697930002','Labile hypertension due to being in a clinical environment (disorder)'),('hypertension',1,'237279007','Transient hypertension of pregnancy (disorder)'),('hypertension',1,'77970009','Benign hypertensive heart disease without congestive heart failure (disorder)'),('hypertension',1,'286371000119107','Malignant hypertensive end stage renal disease on dialysis (disorder)'),('hypertension',1,'170571002','Initial cardiac assessment (regime/therapy)'),('hypertension',1,'703310005','Autosomal dominant progressive nephropathy with hypertension (disorder)'),('hypertension',1,'134378009','Congestive heart failure monitoring (regime/therapy)'),('hypertension',1,'198967002','Transient hypertension of pregnancy - not delivered (disorder)'),('hypertension',1,'26078007','Hypertension secondary to renal disease complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'417206009','Cardiovascular disease monitoring (regime/therapy)'),('hypertension',1,'104931000119100','Chronic kidney disease due to hypertension (disorder)'),('hypertension',1,'59720008','Sustained diastolic hypertension (disorder)'),('hypertension',1,'199000005','Pre-eclampsia or eclampsia with pre-existing hypertension - delivered with postnatal complication (disorder)'),('hypertension',1,'765182005','Pre-eclampsia in puerperium (disorder)'),('hypertension',1,'10562009','Malignant hypertension complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'39727004','Hypertension secondary to renal disease complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'140121000119100','Hypertension in chronic kidney disease stage 3 due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'198965005','Transient hypertension of pregnancy - delivered (disorder)'),('hypertension',1,'15781000119107','Hypertensive heart AND chronic kidney disease with congestive heart failure (disorder)'),('hypertension',1,'67359005','Pre-eclampsia added to pre-existing hypertension (disorder)'),('hypertension',1,'715280009','Telehealth hypertension monitoring (regime/therapy)'),('hypertension',1,'59997006','Endocrine hypertension (disorder)'),('hypertension',1,'473392002','Hypertensive nephrosclerosis (disorder)'),('hypertension',1,'31881008','Cardiovascular renal disease (disorder)'),('hypertension',1,'284991000119104','Chronic kidney disease stage 3 due to benign hypertension (disorder)'),('hypertension',1,'198986005','Severe pre-eclampsia with postnatal complication (disorder)'),('hypertension',1,'199002002','Pre-eclampsia or eclampsia with pre-existing hypertension - not delivered (disorder)'),('hypertension',1,'307632004','Non-proteinuric hypertension of pregnancy (disorder)'),('hypertension',1,'18416000','Essential hypertension complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'16229371000119106','Labile systemic arterial hypertension (disorder)'),('hypertension',1,'198942000','Benign essential hypertension complicating pregnancy'),('hypertension',1,'10752641000119102','Eclampsia with pre-existing hypertension in childbirth (disorder)'),('hypertension',1,'140101000119109','Hypertension in chronic kidney disease stage 5 due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'161807003','History of severe pre-eclampsia (situation)'),('hypertension',1,'52698002','Transient hypertension (disorder)'),('hypertension',1,'82771000119102','Hypertension complicating pregnancy (disorder)'),('hypertension',1,'288250001','Maternal hypertension (disorder)'),('hypertension',1,'8762007','Chronic hypertension in obstetric context (disorder)'),('hypertension',1,'19769006','High-renin essential hypertension (disorder)'),('hypertension',1,'118781000119108','Pre-existing hypertensive chronic kidney disease in mother complicating pregnancy (disorder)'),('hypertension',1,'24042004','Chronic hypertension complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'429198000','Exertional hypertension (disorder)'),('hypertension',1,'284981000119102','Chronic kidney disease stage 2 due to benign hypertension (disorder)'),('hypertension',1,'398254007','Pre-eclampsia (disorder)'),('hypertension',1,'40511000119107','Postpartum pre-existing essential hypertension (disorder)'),('hypertension',1,'48552006','Hypertension secondary to renal disease complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'198984008','Severe pre-eclampsia - delivered with postnatal complication (disorder)'),('hypertension',1,'10725009','Benign hypertension (disorder)'),('hypertension',1,'111438007','Hypertension secondary to renal disease in obstetric context (disorder)'),('hypertension',1,'285011000119108','Chronic kidney disease stage 5 due to benign hypertension (disorder)'),('hypertension',1,'198944004','Benign essential hypertension complicating pregnancy'),('hypertension',1,'132721000119104','Hypertensive emergency (disorder)'),('hypertension',1,'720568003','Brachydactyly and arterial hypertension syndrome (disorder)'),('hypertension',1,'117681000119102','Chronic kidney disease stage 1 due to hypertension (disorder)'),('hypertension',1,'65402008','Pre-existing hypertension complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'96711000119105','Hypertensive heart AND chronic kidney disease stage 5 (disorder)'),('hypertension',1,'57684003','Parenchymal renal hypertension (disorder)'),('hypertension',1,'23130000','Paroxysmal hypertension (disorder)'),('hypertension',1,'28119000','Renal hypertension (disorder)'),('hypertension',1,'541000119105','Hypertension complicating pregnancy'),('hypertension',1,'285001000119105','Chronic kidney disease stage 4 due to benign hypertension (disorder)'),('hypertension',1,'46764007','Severe pre-eclampsia (disorder)'),('hypertension',1,'16147005','Arteriolar nephritis (disorder)'),('hypertension',1,'367390009','Hypertension in the obstetric context (disorder)'),('hypertension',1,'698591006','Benign hypertensive renal disease with renal failure (disorder)'),('hypertension',1,'170601008','Coronary heart disease monitoring (regime/therapy)'),('hypertension',1,'198985009','Severe pre-eclampsia - not delivered (disorder)'),('hypertension',1,'9901000','Essential hypertension complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'8218002','Chronic hypertension complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'417322008','Cardiovascular disease annual review (regime/therapy)'),('hypertension',1,'492611000000102','Cardiovascular disease high risk review (regime/therapy)'),('hypertension',1,'49102001','Hypertensive heart AND renal disease in obstetric context (disorder)'),('hypertension',1,'78808002','Essential hypertension complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'706882009','Hypertensive crisis (disorder)'),('hypertension',1,'140131000119102','Hypertension in chronic kidney disease stage 2 due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'96701000119107','Hypertensive heart AND chronic kidney disease on dialysis (disorder)'),('hypertension',1,'153851000119106','Malignant hypertensive chronic kidney disease stage 5 (disorder)'),('hypertension',1,'284971000119100','Chronic kidney disease stage 1 due to benign hypertension (disorder)'),('hypertension',1,'41114007','Mild pre-eclampsia (disorder)'),('hypertension',1,'8501000119104','Hypertensive heart and chronic kidney disease (disorder)'),('hypertension',1,'14973001','Renal sclerosis with hypertension (disorder)'),
('hypertension',1,'170572009','Follow-up cardiac assessment (regime/therapy)'),('hypertension',1,'198945003','Benign essential hypertension complicating pregnancy'),('hypertension',1,'845331000000109','Amiodarone monitoring (regime/therapy)'),('hypertension',1,'285881000119109','Malignant hypertensive chronic kidney disease stage 4 (disorder)'),('hypertension',1,'129181000119109','Chronic kidney disease stage 2 due to hypertension (disorder)'),('hypertension',1,'198983002','Severe pre-eclampsia - delivered (disorder)'),('hypertension',1,'129161000119100','Chronic kidney disease stage 5 due to hypertension (disorder)'),('hypertension',1,'247361000000100','Heart failure 6 month review (regime/therapy)'),('hypertension',1,'206596003','Neonatal hypertension (disorder)'),('hypertension',1,'198999008','Pre-eclampsia or eclampsia with pre-existing hypertension - delivered (disorder)'),('hypertension',1,'169465000','Hypertension caused by oral contraceptive pill (disorder)'),('hypertension',1,'128001000119105','Hypertension concurrent and due to end stage renal disease on dialysis due to type 1 diabetes mellitus (disorder)'),('hypertension',1,'63287004','Benign essential hypertension in obstetric context (disorder)'),('hypertension',1,'10757481000119107','Pre-existing hypertensive heart and chronic kidney disease in mother complicating pregnancy (disorder)'),('hypertension',1,'198947006','Benign essential hypertension complicating pregnancy'),('hypertension',1,'367821000119106','Hypertension due to compression of renal parenchyma (disorder)'),('hypertension',1,'237282002','Impending eclampsia (disorder)'),('hypertension',1,'198968007','Transient hypertension of pregnancy with postnatal complication (disorder)'),('hypertension',1,'95605009','Hemolysis-elevated liver enzymes-low platelet count syndrome (disorder)'),('hypertension',1,'170574005','Yearly observation of borderline hypertension (regime/therapy)'),('hypertension',1,'49171007','Hypertensive renal disease complicating AND/OR reason for care during childbirth (disorder)'),('hypertension',1,'46481004','Low-renin essential hypertension (disorder)'),('hypertension',1,'170573004','Pre-treatment blood pressure reading (regime/therapy)'),('hypertension',1,'57873008','Hypertensive renal disease complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'707265005','Aortic aneurysm monitoring (regime/therapy)'),('hypertension',1,'198952001','Renal hypertension complicating pregnancy'),('hypertension',1,'72022006','Essential hypertension in obstetric context (disorder)'),('hypertension',1,'429457004','Systolic essential hypertension (disorder)'),('hypertension',1,'84094009','Rebound hypertension (disorder)'),('hypertension',1,'65518004','Labile diastolic hypertension (disorder)'),('hypertension',1,'198941007','Hypertension complicating pregnancy'),('hypertension',1,'10757401000119104','Pre-existing hypertensive heart and chronic kidney disease in mother complicating childbirth (disorder)'),('hypertension',1,'194791005','Hypertension caused by drug (disorder)'),('hypertension',1,'443482000','Hypertensive urgency (disorder)'),('hypertension',1,'96721000119103','Hypertensive heart AND chronic kidney disease stage 4 (disorder)'),('hypertension',1,'427889009','Hypertension associated with transplantation (disorder)'),('hypertension',1,'78544004','Chronic hypertensive uremia (disorder)'),('hypertension',1,'73030000','Hypertensive renal disease in obstetric context (disorder)'),('hypertension',1,'81363003','Malignant arteriolar nephrosclerosis (disorder)'),('hypertension',1,'66709007','Hypertensive renal disease complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'417287002','Cardiovascular disease interim monitoring (regime/therapy)'),('hypertension',1,'69909000','Eclampsia added to pre-existing hypertension (disorder)'),('hypertension',1,'285841000119104','Malignant hypertensive end stage renal disease (disorder)'),('hypertension',1,'395148004','Cardiac event recording (regime/therapy)'),('hypertension',1,'285871000119106','Malignant hypertensive chronic kidney disease stage 3 (disorder)'),('hypertension',1,'871681000000102','Heart failure monitoring (regime/therapy)'),('hypertension',1,'111411000119103','End stage renal disease due to hypertension (disorder)'),('hypertension',1,'35303009','Benign essential hypertension complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'127991000119101','Hypertension concurrent and due to end stage renal disease on dialysis due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'285861000119100','Malignant hypertensive chronic kidney disease stage 2 (disorder)'),('hypertension',1,'71421000119105','Hypertension in chronic kidney disease due to type 2 diabetes mellitus (disorder)'),('hypertension',1,'704667004','Hypertension concurrent and due to end stage renal disease on dialysis (disorder)'),('hypertension',1,'71701000119105','Hypertension in chronic kidney disease due to type 1 diabetes mellitus (disorder)'),('hypertension',1,'285851000119102','Malignant hypertensive chronic kidney disease stage 1 (disorder)'),('hypertension',1,'170591009','Digoxin monitoring (regime/therapy)'),('hypertension',1,'397748008','Hypertension with albuminuria (disorder)'),('hypertension',1,'22966008','Hypertensive heart AND renal disease complicating AND/OR reason for care during pregnancy (disorder)'),('hypertension',1,'15394000','Toxemia of pregnancy (disorder)'),('hypertension',1,'237281009','Moderate proteinuric hypertension of pregnancy (disorder)'),('hypertension',1,'198946002','Benign essential hypertension complicating pregnancy'),('hypertension',1,'170590005','Cardiac drug monitoring (regime/therapy)'),('hypertension',1,'766937004','Hypertension due to gain-of-function mutation in mineralocorticoid receptor (disorder)'),('hypertension',1,'129171000119106','Chronic kidney disease stage 3 due to hypertension (disorder)'),('hypertension',1,'221281000000109','High cost hypertension drug therapy NOS - OPCS Classification of Interventions and Procedures (procedure)'),('hypertension',1,'843851000000107','Severe hypertension'),('hypertension',1,'692801000000103','Benign essential hypertension complicating pregnancy'),('hypertension',1,'272821000000100','Primary pulmonary hypertension drugs band 4'),('hypertension',1,'221291000000106','Other specified high cost hypertension drug therapy - OPCS Classification of Interventions and Procedures (procedure)'),('hypertension',1,'492621000000108','At risk of cardiovascular disease review'),('hypertension',1,'253041000000107','Heart failure 6 month review'),('hypertension',1,'1051531000000104','History of haemolysis'),('hypertension',1,'635071000000100','Mild or unspecified pre-eclampsia - delivered (disorder)'),('hypertension',1,'478861000000109','[X]Edema'),('hypertension',1,'587111000000100','Pre-eclampsia or eclampsia with pre-existing hypertension unspecified (disorder)'),('hypertension',1,'247111000000104','Diastolic hypertension (disorder)'),('hypertension',1,'648001000000103','Mild or unspecified pre-eclampsia NOS (disorder)'),('hypertension',1,'599281000000106','Hypertensive heart and renal disease NOS (disorder)'),('hypertension',1,'684221000000101','Hypertensive heart disease NOS without congestive cardiac failure (disorder)'),('hypertension',1,'892411000000107','Pulmonary arterial hypertension drugs Band 1'),('hypertension',1,'802941000000103','Aortic aneurysm monitoring (regime/therapy)'),('hypertension',1,'1076211000000101','Arteriosclerotic retinopathy (disorder)'),('hypertension',1,'845341000000100','Amiodarone monitoring'),('hypertension',1,'695711000000100','Transient hypertension of pregnancy NOS (disorder)'),('hypertension',1,'672551000000109','Mild or unspecified pre-eclampsia (disorder)'),('hypertension',1,'419571000000103','[X]Hypertension secondary to other renal disorders (disorder)'),('hypertension',1,'471521000000108','[X]Hypertensive diseases (disorder)'),('hypertension',1,'606221000000105','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'272841000000107','High cost hypertension drugs NOS'),('hypertension',1,'586581000000102','Secondary benign hypertension NOS (disorder)'),('hypertension',1,'599321000000103','Other specified hypertensive disease (disorder)'),('hypertension',1,'272801000000109','Primary pulmonary hypertension drugs band 2'),('hypertension',1,'703671000000107','Pre-eclampsia NOS (disorder)'),('hypertension',1,'492631000000105','At risk of cardiovascular disease review'),('hypertension',1,'414391000000105','[X]Other secondary hypertension (disorder)'),('hypertension',1,'276789009','Labile hypertension (disorder)'),('hypertension',1,'695701000000102','Transient hypertension of pregnancy unspecified (disorder)'),('hypertension',1,'191241000000108','Cardiovascular disease annual review'),('hypertension',1,'565761000000106','Cardiac disease monitoring NOS (regime/therapy)'),('hypertension',1,'599261000000102','Hypertensive heart disease NOS (disorder)'),('hypertension',1,'846381000000101','Stage 2 hypertension (NICE - National Institute for Health and Clinical Excellence 2011)'),('hypertension',1,'892431000000104','Pulmonary arterial hypertension drugs Band 2'),('hypertension',1,'587121000000106','Pre-eclampsia or eclampsia with pre-existing hypertension NOS (disorder)'),('hypertension',1,'599341000000105','Hypertensive disease NOS (disorder)'),('hypertension',1,'11721000000102','Hypertension clinic admin. (administrative concept)'),('hypertension',1,'684211000000107','Essential hypertension NOS (disorder)'),('hypertension',1,'713651000000100','Hypertension monitoring administration NOS (record artifact)'),('hypertension',1,'187811000000103','Cardiovascular disease interim monitoring'),('hypertension',1,'194766005','Benign hypertensive heart disease without congestive cardiac failure (disorder)'),
('hypertension',1,'187801000000100','Cardiovascular disease annual review'),('hypertension',1,'77737007','Benign hypertensive heart disease with congestive heart failure (disorder)'),('hypertension',1,'645721000000102','Benign hypertensive heart disease NOS (disorder)'),('hypertension',1,'948151000000100','Telehealth hypertension monitoring (regime/therapy)'),('hypertension',1,'272781000000108','High cost hypertension drugs'),('hypertension',1,'766221000000103','Hypertension 9 month review'),('hypertension',1,'599291000000108','Secondary malignant hypertension NOS (disorder)'),('hypertension',1,'674201000000103','Hypertension of pregnancy NOS (disorder)'),('hypertension',1,'832151000000107','Hypertension self-management plan review'),('hypertension',1,'292601000000100','Diastolic hypertension'),('hypertension',1,'609021000000109','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'635061000000107','Mild or unspecified pre-eclampsia unspecified (disorder)'),('hypertension',1,'635101000000109','Severe pre-eclampsia unspecified (disorder)'),('hypertension',1,'250411000000105','Heart failure 6 month review'),('hypertension',1,'191231000000104','Cardiovascular disease monitoring'),('hypertension',1,'412779008','Hypertension clinical management plan (qualifier value)'),('hypertension',1,'167031000000101','Hypertension resolved'),('hypertension',1,'883971000000102','History of pre-eclampsia (situation)'),('hypertension',1,'609011000000103','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'250591000000100','Atrial fibrillation annual review'),('hypertension',1,'845901000000102','Hypertension resistant to drug therapy'),('hypertension',1,'802951000000100','Aortic aneurysm monitoring'),('hypertension',1,'908661000000103','Stage 1 hypertension (NICE - National Institute for Health and Clinical Excellence 2011) with evidence of end organ damage'),('hypertension',1,'892451000000106','Pulmonary arterial hypertension drugs Band 3'),('hypertension',1,'948161000000102','Telehealth hypertension monitoring'),('hypertension',1,'843831000000100','Stage 1 hypertension'),('hypertension',1,'599311000000109','Secondary renovascular hypertension NOS (disorder)'),('hypertension',1,'272811000000106','Primary pulmonary hypertension drugs band 3'),('hypertension',1,'892471000000102','Pulmonary arterial hypertension drugs Band 4'),('hypertension',1,'40555009','Toxemia (disorder)'),('hypertension',1,'187791000000104','Cardiovascular disease monitoring'),('hypertension',1,'308551004','Gestational hypertension (disorder)'),('hypertension',1,'647991000000107','Mild or unspecified pre-eclampsia with postnatal complication (disorder)'),('hypertension',1,'698810000','Hypertensive renal disease with end stage renal failure (disorder)'),('hypertension',1,'883981000000100','H/O: pre-eclampsia'),('hypertension',1,'606231000000107','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'627791000000106','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'3331000000104','Hypertension monitoring admin. (administrative concept)'),('hypertension',1,'171791000000104','Hypertension resolved'),('hypertension',1,'608991000000100','Renal hypertension complicating pregnancy'),('hypertension',1,'627801000000105','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'662181000000100','Hypertensive renal disease NOS (disorder)'),('hypertension',1,'635081000000103','Mild or unspecified pre-eclampsia - delivered with postnatal complication (disorder)'),('hypertension',1,'908641000000104','Stage 1 hypertension (NICE - National Institute for Health and Clinical Excellence 2011) without evidence of end organ damage'),('hypertension',1,'272791000000105','Primary pulmonary hypertension drugs band 1'),('hypertension',1,'599271000000109','Hypertensive heart disease NOS with congestive cardiac failure (disorder)'),('hypertension',1,'606201000000101','Renal hypertension complicating pregnancy'),('hypertension',1,'565741000000105','Cardiac drug monitoring NOS (regime/therapy)'),('hypertension',1,'253221000000105','Atrial fibrillation annual review'),('hypertension',1,'11511004','Hypertensive heart AND renal disease complicating AND/OR reason for care during puerperium (disorder)'),('hypertension',1,'635091000000101','Mild or unspecified pre-eclampsia - not delivered (disorder)'),('hypertension',1,'544581000000102','Toxemia NOS (disorder)'),('hypertension',1,'606211000000104','Other pre-existing hypertension complicating pregnancy'),('hypertension',1,'194774006','Hypertensive renal disease with renal failure (disorder)'),('hypertension',1,'191251000000106','Cardiovascular disease interim monitoring'),('hypertension',1,'692791000000102','Benign essential hypertension complicating pregnancy')

INSERT INTO #AllCodes
SELECT [concept], [version], [code] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];



INSERT INTO #AllCodes
SELECT [concept], [version], [code] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL);

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL);

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL);

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL);

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT);

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT);

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

-- >>> Following code sets injected: hypertension v1
SELECT FK_Patient_Link_ID AS PatientId, MIN(EventDate) AS DateOfFirstDiagnosis FROM [RLS].[vw_GP_Events]
WHERE (
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'hypertension' AND Version = 1) OR
  FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'hypertension' AND Version = 1)
)
GROUP BY FK_Patient_Link_ID;