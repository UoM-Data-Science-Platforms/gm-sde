_This file is autogenerated. Please do not edit._

# The influence of COVID-19 infections and vaccinations on the likelihood of the development of long COVID.

## Summary

Since early 2020, the world has continued to be challenged by the pandemic caused by the SARS-CoV-2 virus (COVID-19) and its successive variant forms. It was apparent from the early phase of the pandemic that a multi-system syndrome can develop in the weeks following a COVID-19 infection, now referred to as long COVID.

While work has already been done to determine the risk factors for the development of long COVID, the influence of multiple acute COVID-19 infections and number of COVID-19 vaccinations is unclear. We have already undertaken a study using GMCR data which show that recorded long COVID was more prevalent in men with T2D than in matched non-T2D controls with the opposite seen for T2D women, with recorded long COVID rates being similar for T2D men and women. Younger age, female sex, mixed ethnicity, and higher BMI were all associated with a greater likelihood of developing long COVID when taken as individual variables. We plan to look at the entirety of long COVID diagnoses/referrals for specialist assessment in adults whose data is recorded in the GMCR from 1st March 2020 till 31st December 2023. We will determine the influence of the number of acute COVID-19 infections and number of COVID-19 vaccinations on the likelihood of the development of long COVID.We will also examine the independent relations of age, sex, ethnicity, social disadvantage, and major comorbidities on the likelihood of long COVID developing.

## Table of contents

- [Introduction](#introduction)
- [Methodology](#methodology)
- [Reusable queries](#reusable-queries)
- [Clinical code sets](#clinical-code-sets)

## Introduction

The aim of this document is to provide full transparency for all parts of the data extraction process.
This includes:

- The methodology around how the data extraction process is managed and quality is maintained.
- A full list of all queries used in the extraction, and their associated objectives and assumptions.
- A full list of all clinical codes used for the extraction.

## Methodology

After each proposal is approved, a Research Data Engineer (RDE) works closely with the research team to establish precisely what data they require and in what format.
The RDE has access to the entire de-identified database and so builds up an expertise as to which projects are feasible and how best to extract the relevant data.
The RDE has access to a library of resusable SQL queries for common tasks, and sets of clinical codes for different phenotypes, built up from previous studies.
Prior to data extraction, the code is checked and signed off by another RDE.

## Reusable queries
  
This project required the following reusable queries:

- Find the first diagnosis of a particular disease
- COVID vaccinations
- Secondary admissions and length of stay following each of n COVID tests
- Secondary admissions and length of stay
- Secondary discharges
- Find the closest value to a particular date
- Smoking status
- GET practice and ccg for each patient
- CCG lookup table
- Townsend Score (2011)
- Lower level super output area
- Define Cohort for RQ066: Long COVID
- Cohort matching on year of birth / sex / and an index date
- Sex
- Year of birth
- Patients with COVID
- Patients with post-COVID syndrome (long COVID)

Further details for each query can be found below.

### Find the first diagnosis of a particular disease
To find the first diagnosis for a particular disease for every patient.

_Input_
```
A variable:
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "SharedCare.GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode
  - code-set: string - the name of the code set to be used. Must be one from the repository.
  - version: number - the code set version
  - temp-table-name: string - the name of the temp table that this will produce
```

_Output_
```
Temp table with the name of the provided parameter `temp-table-name` with columns:
	-	FK_Patient_Link_ID - unique patient id
	-	DateOfFirstDiagnosis - date (YYY/MM/DD) - the date of the first diagnosis
```
_File_: `query-get-first-diagnosis.sql`

_Link_: [https://github.com/rw251/.../query-get-first-diagnosis.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-first-diagnosis.sql)

---
### COVID vaccinations
To obtain a table with first, second, third... etc vaccine doses per patient.

_Assumptions_

- GP records can often be duplicated. The assumption is that if a patient receives two vaccines within 14 days of each other then it is likely that both codes refer to the same vaccine.
- The vaccine can appear as a procedure or as a medication. We assume that the presence of either represents a vaccination

_Input_
```
Takes two parameters:
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "RLS.vw_GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode
	- gp-medications-table: string - (table name) the name of the table containing the GP medications. Usually is "RLS.vw_GP_Medications" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode
```

_Output_
```
A temp table as follows:
 #COVIDVaccinations (FK_Patient_Link_ID, VaccineDate, DaysSinceFirstVaccine)
 	- FK_Patient_Link_ID - unique patient id
	- VaccineDose1Date - date of first vaccine (YYYY-MM-DD)
	-	VaccineDose2Date - date of second vaccine (YYYY-MM-DD)
	-	VaccineDose3Date - date of third vaccine (YYYY-MM-DD)
	-	VaccineDose4Date - date of fourth vaccine (YYYY-MM-DD)
	-	VaccineDose5Date - date of fifth vaccine (YYYY-MM-DD)
	-	VaccineDose6Date - date of sixth vaccine (YYYY-MM-DD)
	-	VaccineDose7Date - date of seventh vaccine (YYYY-MM-DD)
```
_File_: `query-get-covid-vaccines.sql`

_Link_: [https://github.com/rw251/.../query-get-covid-vaccines.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-covid-vaccines.sql)

---
### Secondary admissions and length of stay following each of n COVID tests
To obtain tables with the first secondary care admission, and length of stay, following the nth COVID test.

_Input_
```
One parameter
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
```

_Output_
```
Two temp table as follows:
 #PatientsAdmissionsPostTest
 	- FK_Patient_Link_ID - unique patient id
	- FirstAdmissionPost1stCOVIDTest - date of first admission following 1st covid postivie test (YYYY-MM-DD)
	-	FirstAdmissionPost2ndCOVIDTest
	-	FirstAdmissionPost3rdCOVIDTest
	-	FirstAdmissionPost4thCOVIDTest
	-	FirstAdmissionPost5thCOVIDTest
  (Limited to one admission per person per hospital per day, because if a patient has 2 admissions
   on the same day to the same hopsital then it's most likely data duplication rather than two short
   hospital stays)
 #PatientsLOSPostTest
 	- FK_Patient_Link_ID - unique patient id
	-	LengthOfStay1stAdmission1stCOVIDTest - length of stay for first admission following 1st positive covid test
	-	LengthOfStay1stAdmission2ndCOVIDTest - length of stay for first admission following 2nd positive covid test
	-	LengthOfStay1stAdmission3rdCOVIDTest - length of stay for first admission following 3rd positive covid test
	-	LengthOfStay1stAdmission4thCOVIDTest - length of stay for first admission following 4th positive covid test
	-	LengthOfStay1stAdmission5thCOVIDTest - length of stay for first admission following 5th positive covid test
```
_File_: `query-get-admissions-and-length-of-stay-post-covid.sql`

_Link_: [https://github.com/rw251/.../query-get-admissions-and-length-of-stay-post-covid.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-admissions-and-length-of-stay-post-covid.sql)

---
### Secondary admissions and length of stay
To obtain a table with every secondary care admission, along with the acute provider, the date of admission, the date of discharge, and the length of stay.

_Input_
```
One parameter
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
```

_Output_
```
Two temp table as follows:
 #Admissions (FK_Patient_Link_ID, AdmissionDate, AcuteProvider)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
  (Limited to one admission per person per hospital per day, because if a patient has 2 admissions
   on the same day to the same hopsital then it's most likely data duplication rather than two short
   hospital stays)
 #LengthOfStay (FK_Patient_Link_ID, AdmissionDate)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
	- DischargeDate - date of discharge (YYYY-MM-DD)
	- LengthOfStay - Number of days between admission and discharge. 1 = [0,1) days, 2 = [1,2) days, etc.
```
_File_: `query-get-admissions-and-length-of-stay.sql`

_Link_: [https://github.com/rw251/.../query-get-admissions-and-length-of-stay.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-admissions-and-length-of-stay.sql)

---
### Secondary discharges
To obtain a table with every secondary care discharge, along with the acute provider, and the date of discharge.

_Input_
```
One parameter
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
```

_Output_
```
A temp table as follows:
 #Discharges (FK_Patient_Link_ID, DischargeDate, AcuteProvider)
 	- FK_Patient_Link_ID - unique patient id
	- DischargeDate - date of discharge (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
  (Limited to one discharge per person per hospital per day, because if a patient has 2 discharges
   on the same day to the same hopsital then it's most likely data duplication rather than two short
   hospital stays)
```
_File_: `query-get-discharges.sql`

_Link_: [https://github.com/rw251/.../query-get-discharges.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-discharges.sql)

---
### Find the closest value to a particular date
To find the first diagnosis for a particular disease for every patient.

_Input_
```
A variable:
  - date: date - (YYYY-MM-DD) the date to look around
  - comparison: inequality sign (>, <, >= or <=) e.g. if '>' then will look for the first value strictly after the date
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "SharedCare.GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode
  - code-set: string - the name of the code set to be used. Must be one from the repository.
  - version: number - the code set version
  - temp-table-name: string - the name of the temp table that this will produce
```

_Output_
```
Temp tables as follows:
 #Patients - list of patient ids of the cohort
```
_File_: `query-get-closest-value-to-date.sql`

_Link_: [https://github.com/rw251/.../query-get-closest-value-to-date.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-closest-value-to-date.sql)

---
### Smoking status
To get the smoking status for each patient in a cohort.

_Assumptions_

- We take the most recent smoking status in a patient's record to be correct
- However, there is likely confusion between the "non smoker" and "never smoked" codes. Especially as sometimes the synonyms for these codes overlap. Therefore, a patient wih a most recent smoking status of "never", but who has previous smoking codes, would be classed as WorstSmokingStatus=non-trivial-smoker / CurrentSmokingStatus=non-smoker

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
 Also takes one parameter:
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "RLS.vw_GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, FK_Reference_Coding_ID, and FK_Reference_SnomedCT_ID
```

_Output_
```
A temp table as follows:
 #PatientSmokingStatus (FK_Patient_Link_ID, PassiveSmoker, WorstSmokingStatus, CurrentSmokingStatus)
	- FK_Patient_Link_ID - unique patient id
	- PassiveSmoker - Y/N (whether a patient has ever had a code for passive smoking)
	- WorstSmokingStatus - [non-trivial-smoker/trivial-smoker/non-smoker]
	- CurrentSmokingStatus - [non-trivial-smoker/trivial-smoker/non-smoker]
```
_File_: `query-patient-smoking-status.sql`

_Link_: [https://github.com/rw251/.../query-patient-smoking-status.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-smoking-status.sql)

---
### GET practice and ccg for each patient
For each patient to get the practice id that they are registered to, and the CCG name that the practice belongs to.

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
Two temp tables as follows:
 #PatientPractice (FK_Patient_Link_ID, GPPracticeCode)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
 #PatientPracticeAndCCG (FK_Patient_Link_ID, GPPracticeCode, CCG)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
	- CCG - the name of the patient's CCG
```
_File_: `query-patient-practice-and-ccg.sql`

_Link_: [https://github.com/rw251/.../query-patient-practice-and-ccg.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-practice-and-ccg.sql)

---
### CCG lookup table
To provide lookup table for CCG names. The GMCR provides the CCG id (e.g. '00T', '01G') but not the CCG name. This table can be used in other queries when the output is required to be a ccg name rather than an id.

_Input_
```
No pre-requisites
```

_Output_
```
A temp table as follows:
 #CCGLookup (CcgId, CcgName)
 	- CcgId - Nationally recognised ccg id
	- CcgName - Bolton, Stockport etc..
```
_File_: `query-ccg-lookup.sql`

_Link_: [https://github.com/rw251/.../query-ccg-lookup.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-ccg-lookup.sql)

---
### Townsend Score (2011)
To get the 2011 Townsend score and quintile for each patient.

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #PatientTownsend (FK_Patient_Link_ID, TownsendScoreHigherIsMoreDeprived, TownsendQuintileHigherIsMoreDeprived)
 	- FK_Patient_Link_ID - unique patient id
	- TownsendScoreHigherIsMoreDeprived - number range approx [-7,13]
	- TownsendQuintileHigherIsMoreDeprived - number 1 to 5 inclusive
```
_File_: `query-patient-townsend.sql`

_Link_: [https://github.com/rw251/.../query-patient-townsend.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-townsend.sql)

---
### Lower level super output area
To get the LSOA for each patient.

_Assumptions_

- Patient data is obtained from multiple sources. Where patients have multiple LSOAs we determine the LSOA as follows:
- If the patients has an LSOA in their primary care data feed we use that as most likely to be up to date
- If every LSOA for a paitent is the same, then we use that
- If there is a single most recently updated LSOA in the database then we use that
- Otherwise the patient's LSOA is considered unknown

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #PatientLSOA (FK_Patient_Link_ID, LSOA)
 	- FK_Patient_Link_ID - unique patient id
	- LSOA_Code - nationally recognised LSOA identifier
```
_File_: `query-patient-lsoa.sql`

_Link_: [https://github.com/rw251/.../query-patient-lsoa.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-lsoa.sql)

---
### Define Cohort for RQ066: Long COVID
To build the cohort of patients needed for RQ066. This reduces duplication of code in the template scripts. The cohort is any patient with a suggestion of long covid. There is also a matched cohort (3:1) on age, sex and date of covid test.

_Input_
```
No inputs

```

_Output_
```
Temp tables as follows:
 #Patients - list of patient ids of the cohort
```
_File_: `query-build-rq066-cohort.sql`

_Link_: [https://github.com/rw251/.../query-build-rq066-cohort.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-build-rq066-cohort.sql)

---
### Cohort matching on year of birth / sex / and an index date
To take a primary cohort and find a 1:5 matched cohort based on year of birth, sex, and an index date of an event.

_Input_
```
Takes two parameters
  - yob-flex: integer - number of years each way that still allow a year of birth match
  - index-date-flex: integer - number of days either side of the index date that we allow matching
 Requires two temp tables to exist as follows:
 #MainCohort (FK_Patient_Link_ID, IndexDate, Sex, YearOfBirth)
 	- FK_Patient_Link_ID - unique patient id
	- IndexDate - date of event of interest (YYYY-MM-DD)
	- Sex - M/F
	- YearOfBirth - Integer
 #PotentialMatches (FK_Patient_Link_ID, IndexDate, Sex, YearOfBirth)
 	- FK_Patient_Link_ID - unique patient id
	- IndexDate - date of event of interest (YYYY-MM-DD)
	- Sex - M/F
	- YearOfBirth - Integer
```

_Output_
```
A temp table as follows:
 #CohortStore (FK_Patient_Link_ID, YearOfBirth, Sex, IndexDate, MatchingPatientId, MatchingYearOfBirth, MatchingIndexDate)
  - FK_Patient_Link_ID - unique patient id for primary cohort patient
  - YearOfBirth - of the primary cohort patient
  - Sex - of the primary cohort patient
  - IndexDate - date of event of interest (YYYY-MM-DD)
  - MatchingPatientId - id of the matched patient
  - MatchingYearOfBirth - year of birth of the matched patient
  - MatchingIndexDate - index date for the matched patient
```
_File_: `query-cohort-matching-yob-sex-index-date.sql`

_Link_: [https://github.com/rw251/.../query-cohort-matching-yob-sex-index-date.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-cohort-matching-yob-sex-index-date.sql)

---
### Sex
To get the Sex for each patient.

_Assumptions_

- Patient data is obtained from multiple sources. Where patients have multiple sexes we determine the sex as follows:
- If the patients has a sex in their primary care data feed we use that as most likely to be up to date
- If every sex for a patient is the same, then we use that
- If there is a single most recently updated sex in the database then we use that
- Otherwise the patient's sex is considered unknown

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #PatientSex (FK_Patient_Link_ID, Sex)
 	- FK_Patient_Link_ID - unique patient id
	- Sex - M/F
```
_File_: `query-patient-sex.sql`

_Link_: [https://github.com/rw251/.../query-patient-sex.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-sex.sql)

---
### Year of birth
To get the year of birth for each patient.

_Assumptions_

- Patient data is obtained from multiple sources. Where patients have multiple YOBs we determine the YOB as follows:
- If the patients has a YOB in their primary care data feed we use that as most likely to be up to date
- If every YOB for a patient is the same, then we use that
- If there is a single most recently updated YOB in the database then we use that
- Otherwise we take the highest YOB for the patient that is not in the future

_Input_
```
Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
```

_Output_
```
A temp table as follows:
 #PatientYearOfBirth (FK_Patient_Link_ID, YearOfBirth)
 	- FK_Patient_Link_ID - unique patient id
	- YearOfBirth - INT
```
_File_: `query-patient-year-of-birth.sql`

_Link_: [https://github.com/rw251/.../query-patient-year-of-birth.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-year-of-birth.sql)

---
### Patients with COVID
To get tables of all patients with a COVID diagnosis in their record. This now includes a table that has reinfections. This uses a 90 day cut-off to rule out patients that get multiple tests for a single infection. This 90 day cut-off is also used in the government COVID dashboard. In the first wave, prior to widespread COVID testing, and prior to the correct clinical codes being	available to clinicians, infections were recorded in a variety of ways. We therefore take the first diagnosis from any code indicative of COVID. However, for subsequent infections we insist on the presence of a positive COVID test (PCR or antigen) as opposed to simply a diagnosis code. This is to avoid the situation where a hospital diagnosis code gets entered into the primary care record several months after the actual infection.

_Input_
```
Takes three parameters
  - start-date: string - (YYYY-MM-DD) the date to count diagnoses from. Usually this should be 2020-01-01.
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "SharedCare.GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode
```

_Output_
```
Three temp tables as follows:
 #CovidPatients (FK_Patient_Link_ID, FirstCovidPositiveDate)
 	- FK_Patient_Link_ID - unique patient id
	- FirstCovidPositiveDate - earliest COVID diagnosis
 #CovidPatientsAllDiagnoses (FK_Patient_Link_ID, CovidPositiveDate)
 	- FK_Patient_Link_ID - unique patient id
	- CovidPositiveDate - any COVID diagnosis
 #CovidPatientsMultipleDiagnoses
	-	FK_Patient_Link_ID - unique patient id
	-	FirstCovidPositiveDate - date of first COVID diagnosis
	-	SecondCovidPositiveDate - date of second COVID diagnosis
	-	ThirdCovidPositiveDate - date of third COVID diagnosis
	-	FourthCovidPositiveDate - date of fourth COVID diagnosis
	-	FifthCovidPositiveDate - date of fifth COVID diagnosis
```
_File_: `query-patients-with-covid.sql`

_Link_: [https://github.com/rw251/.../query-patients-with-covid.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patients-with-covid.sql)

---
### Patients with post-COVID syndrome (long COVID)
To get tables of all patients with a post-COVID syndrome code in their record. Separated into diagnosis, assessment and referral codes. 

_Input_
```
Takes three parameters
  - start-date: string - (YYYY-MM-DD) the date to count diagnoses from. Usually this should be 2020-01-01.
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
	- gp-events-table: string - (table name) the name of the table containing the GP events. Usually is "SharedCare.GP_Events" but can be anything with the columns: FK_Patient_Link_ID, EventDate, and SuppliedCode

```

_Output_
```
One temp table as follows:
 #PostCOVIDPatients
	-	FK_Patient_Link_ID - unique patient id
  - FirstPostCOVIDDiagnosisDate - First date of a post COVID diagnosis
  - FirstPostCOVIDAssessmentDate - First date of a post COVID assessment
  - FirstPostCOVIDReferralDate - First date of a post COVID referral
```
_File_: `query-patients-with-post-covid-syndrome.sql`

_Link_: [https://github.com/rw251/.../query-patients-with-post-covid-syndrome.sql](https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patients-with-post-covid-syndrome.sql)
## Clinical code sets

This project required the following clinical code sets:

- long-covid-diagnosis v1
- long-covid-referral v1
- long-covid-assessment v1
- covid-positive-antigen-test v1
- covid-positive-pcr-test v1
- covid-positive-test-other v1
- smoking-status-current v1
- smoking-status-currently-not v1
- smoking-status-ex v1
- smoking-status-ex-trivial v1
- smoking-status-never v1
- smoking-status-passive v1
- smoking-status-trivial v1
- bmi v2
- covid-vaccination v1
- angina v1
- ankylosing-spondylitis v1
- asthma v1
- attention-deficit-hyperactivity-disorder v1
- autism-spectrum-disorder v1
- cancer v3
- ckd-stage-3 v1
- ckd-stage-4 v1
- ckd-stage-5 v1
- copd v1
- coronary-angioplasty v1
- coronary-artery-bypass-graft v1
- depression v1
- diabetes-type-i v1
- diabetes-type-ii v1
- heart-failure v1
- hypertension v1
- myocardial-infarction v1
- ptsd v1
- rheumatoid-arthritis v1
- sle v1
- stroke v1

Further details for each code set can be found below.

### Long COVID diagnosis

Any code indicating a diagnosis of long-covid / post-covid syndrome. There are also code sets for [long-covid-assessment](../../../patient/long-covid-assessment/) and [long-covid-referral](../../../patient/long-covid-referral/).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.095% - 0.401%` suggests missing codes from TPP practices. However, there is literature showing that all long covid codes are poorly used (https://doi.org/10.3399%2FBJGP.2021.0301 and https://www.adruk.org/fileadmin/uploads/adruk/Documents/Data_Insights/Clinical_coding_and_capture_of_Long_COVID_V.3__4_.pdf).

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-09-12 | EMIS            | 2463856    |    9874 (0.401%) |     9879 (0.401%) |
| 2023-09-12 | TPP             | 200590     |      26 (0.013%) |     191 (0.0952%) |
| 2023-09-12 | Vision          | 332095     |     808 (0.243%) |      810 (0.244%) |

LINK: [https://github.com/rw251/.../conditions/long-covid-diagnosis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/long-covid-diagnosis/1)

### Long COVID referral

Any code indicating a referral for long-covid / post-covid syndrome. There are also code sets for [long-covid-diagnosis](../../../conditions/long-covid-diagnosis/) and [long-covid-assessment](../../long-covid-assessment/).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.15% - 0.657%` suggests missing codes from Vision and TPP practices. However, there is literature showing that all long covid codes are poorly used (https://doi.org/10.3399%2FBJGP.2021.0301 and https://www.adruk.org/fileadmin/uploads/adruk/Documents/Data_Insights/Clinical_coding_and_capture_of_Long_COVID_V.3__4_.pdf).

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-09-12 | EMIS            | 2463856    |   16167 (0.656%) |    16176 (0.657%) |
| 2023-09-12 | TPP             | 200590     |    11 (0.00548%) |      425 (0.212%) |
| 2023-09-12 | Vision          | 332095     |     467 (0.141%) |       498 (0.15%) |

LINK: [https://github.com/rw251/.../referrals/long-covid-referral/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/referrals/long-covid-referral/1)

### Long COVID assessment

Any code indicating an assessment of long-covid / post-covid syndrome. There are also code sets for [long-covid-diagnosis](../../../conditions/long-covid-diagnosis/) and [long-covid-referral](../../long-covid-referral/).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.0% - 0.007%` suggests missing codes from all practices. However, there is literature showing that all long covid codes are poorly used (https://doi.org/10.3399%2FBJGP.2021.0301 and https://www.adruk.org/fileadmin/uploads/adruk/Documents/Data_Insights/Clinical_coding_and_capture_of_Long_COVID_V.3__4_.pdf). So this is probably lack of use rather than missing codes.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-09-12 | EMIS            | 2463856    |   166 (0.00674%) |    166 (0.00674%) |
| 2023-09-12 | TPP             | 200590     |           0 (0%) |            0 (0%) |
| 2023-09-12 | Vision          | 332095     |    1 (0.000301%) |     1 (0.000301%) |

LINK: [https://github.com/rw251/.../patient/long-covid-assessment/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/long-covid-assessment/1)

### COVID-19 positive antigen test

A code that indicates that a person has a positive antigen test for COVID-19.
#### COVID positive tests in primary care

The codes used in primary care to indicate a positive COVID test can be split into 3 types: antigen test, PCR test and other. We keep these as separate code sets. However due to the way that COVID diagnoses are recorded in different ways in different GP systems, and because some codes are ambiguous, currently it only makes sense to group these 3 code sets together. Therefore the prevalence log below is for the combined code sets of `covid-positive-antigen-test`, `covid-positive-pcr-test` and `covid-positive-test-other`.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `19.7% - 25.4%` suggests that this code set is likely well defined. _NB - this code set needs to rely on the SuppliedCode in the database rather than the foreign key ids._

_Update **2024-01-23**: Prevalence now 23% - 25%._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-25 | EMIS            | 2656041    |   152972 (5.76%) |    545759 (20.5%) |
| 2022-02-25 | TPP             | 212453     |      256 (0.12%) |     39503 (18.6%) |
| 2022-02-25 | Vision          | 341354     |     9440 (2.77%) |     65963 (19.3%) |
| 2023-10-04 | EMIS            | 2465646    |     567107 (23%) |    572342 (23.2%) |
| 2023-10-04 | TPP             | 200499     |     2840 (1.42%) |     50964 (25.4%) |
| 2023-10-04 | Vision          | 332029     |    62534 (18.8%) |     65493 (19.7%) |
| 2024-01-23 | EMIS            | 2520311    |   618005 (24.5%) |    623202 (24.7%) |
| 2024-01-23 | TPP             | 201513     |     3349 (1.66%) |     50954 (25.3%) |
| 2024-01-23 | Vision          | 334747     |    76501 (22.9%) |     77578 (23.2%) |
#### Audit log

- Find_missing_codes last run 2024-01-23

LINK: [https://github.com/rw251/.../tests/covid-positive-antigen-test/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/covid-positive-antigen-test/1)

### COVID-19 positive pcr test

A code that indicates that a person has a positive pcr test for COVID-19.
#### COVID positive tests in primary care

The codes used in primary care to indicate a positive COVID test can be split into 3 types: antigen test, PCR test and other. We keep these as separate code sets. However due to the way that COVID diagnoses are recorded in different ways in different GP systems, and because some codes are ambiguous, currently it only makes sense to group these 3 code sets together. Therefore the prevalence log below is for the combined code sets of `covid-positive-antigen-test`, `covid-positive-pcr-test` and `covid-positive-test-other`.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `19.7% - 25.4%` suggests that this code set is likely well defined. _NB - this code set needs to rely on the SuppliedCode in the database rather than the foreign key ids._

_Update **2024-01-23**: Prevalence now 23% - 25%._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-25 | EMIS            | 2656041    |   152972 (5.76%) |    545759 (20.5%) |
| 2022-02-25 | TPP             | 212453     |      256 (0.12%) |     39503 (18.6%) |
| 2022-02-25 | Vision          | 341354     |     9440 (2.77%) |     65963 (19.3%) |
| 2023-10-04 | EMIS            | 2465646    |     567107 (23%) |    572342 (23.2%) |
| 2023-10-04 | TPP             | 200499     |     2840 (1.42%) |     50964 (25.4%) |
| 2023-10-04 | Vision          | 332029     |    62534 (18.8%) |     65493 (19.7%) |
| 2024-01-23 | EMIS            | 2520311    |   618005 (24.5%) |    623202 (24.7%) |
| 2024-01-23 | TPP             | 201513     |     3349 (1.66%) |     50954 (25.3%) |
| 2024-01-23 | Vision          | 334747     |    76501 (22.9%) |     77578 (23.2%) |
#### Audit log

- Find_missing_codes last run 2024-01-23

LINK: [https://github.com/rw251/.../tests/covid-positive-pcr-test/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/covid-positive-pcr-test/1)

### COVID-19 positive test - other

A code that indicates that a person has a positive test for COVID-19, but where the type of test (antigen or PCR) is unknown.
#### COVID positive tests in primary care

The codes used in primary care to indicate a positive COVID test can be split into 3 types: antigen test, PCR test and other. We keep these as separate code sets. However due to the way that COVID diagnoses are recorded in different ways in different GP systems, and because some codes are ambiguous, currently it only makes sense to group these 3 code sets together. Therefore the prevalence log below is for the combined code sets of `covid-positive-antigen-test`, `covid-positive-pcr-test` and `covid-positive-test-other`.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `19.7% - 25.4%` suggests that this code set is likely well defined. _NB - this code set needs to rely on the SuppliedCode in the database rather than the foreign key ids._

_Update **2024-01-23**: Prevalence now 23% - 25%._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-02-25 | EMIS            | 2656041    |   152972 (5.76%) |    545759 (20.5%) |
| 2022-02-25 | TPP             | 212453     |      256 (0.12%) |     39503 (18.6%) |
| 2022-02-25 | Vision          | 341354     |     9440 (2.77%) |     65963 (19.3%) |
| 2023-10-04 | EMIS            | 2465646    |     567107 (23%) |    572342 (23.2%) |
| 2023-10-04 | TPP             | 200499     |     2840 (1.42%) |     50964 (25.4%) |
| 2023-10-04 | Vision          | 332029     |    62534 (18.8%) |     65493 (19.7%) |
| 2024-01-23 | EMIS            | 2520311    |   618005 (24.5%) |    623202 (24.7%) |
| 2024-01-23 | TPP             | 201513     |     3349 (1.66%) |     50954 (25.3%) |
| 2024-01-23 | Vision          | 334747     |    76501 (22.9%) |     77578 (23.2%) |
#### Audit log

- Find_missing_codes last run 2024-01-23

LINK: [https://github.com/rw251/.../tests/covid-positive-test-other/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/tests/covid-positive-test-other/1)

### Smoking status current

Any code suggestive that a patient is a current smoker.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `22% - 27%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |   613314 (24.3%) |    607924 (24.1%) |
| 2024-01-19 | TPP             | 201469     |    53798 (26.7%) |     53814 (26.7%) |
| 2024-01-19 | Vision          | 334528     |    74805 (22.4%) |     74677 (22.3%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-current/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-current/1)

### Smoking status currently not

Any code suggestive that a patient is currently a non-smoker. This is different to the "never smoked" code set.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `17% - 21%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |   521439 (20.7%) |    521519 (20.7%) |
| 2024-01-19 | TPP             | 201469     |    37505 (18.6%) |     37506 (18.6%) |
| 2024-01-19 | Vision          | 334528     |    57671 (17.2%) |     57505 (17.2%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-currently-not/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-currently-not/1)

### Smoking status ex

Any code suggestive that a patient is an ex-smoker.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `24% - 29%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |   596405 (23.7%) |    596734 (23.7%) |
| 2024-01-19 | TPP             | 201469     |    57707 (28.6%) |     57720 (28.6%) |
| 2024-01-19 | Vision          | 334528     |    80560 (24.1%) |     80597 (24.1%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-ex/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-ex/1)

### Smoking status ex trivial

Codes showing a patient is currently a non smoker but has been a trivial smoker in the past.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.3% - 1.0%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |   24616 (0.977%) |    24630 (0.978%) |
| 2024-01-19 | TPP             | 201469     |     1632 (0.81%) |     1633 (0.811%) |
| 2024-01-19 | Vision          | 334528     |    1076 (0.322%) |     1076 (0.322%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-ex-trivial/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-ex-trivial/1)

### Smoking status never

Any code suggestive that a patient has never smoked. This is different to the "currently not" code set.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `51% - 55%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |  1392255 (55.3%) |   1353278 (53.7%) |
| 2024-01-19 | TPP             | 201469     |   110979 (55.1%) |      110723 (55%) |
| 2024-01-19 | Vision          | 334528     |   176702 (52.8%) |    172037 (51.4%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-never/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-never/1)

### Passive smoker

Any code suggesting the patient has been exposed to cigarette smoke passively.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.2% - 1.5%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |    29106 (1.16%) |     29111 (1.16%) |
| 2024-01-19 | TPP             | 201469     |     2404 (1.19%) |      2404 (1.19%) |
| 2024-01-19 | Vision          | 334528     |     4931 (1.47%) |      4931 (1.47%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-passive/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-passive/1)

### Smoking status trivial

Any code suggesting the patient is currently smoking a trivial amount (on average less than 1 per day).
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.2% - 1.7%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |    38988 (1.55%) |     38950 (1.55%) |
| 2024-01-19 | TPP             | 201469     |     2919 (1.45%) |       2426 (1.2%) |
| 2024-01-19 | Vision          | 334528     |     5709 (1.71%) |      5708 (1.71%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../patient/smoking-status-trivial/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/smoking-status-trivial/1)

### Body Mass Index (BMI)

A patient's BMI as recorded via clinical code and value. This code set only includes codes that are accompanied by a value (`22K.. - Body Mass Index`). It does not include codes that indicate a patient's BMI (`22K6. - Body mass index less than 20`) without giving the actual value.

**NB: This code set is intended to indicate a patient's BMI. If you need to know whether a BMI was recorded then please use v1 of the code set.**
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `63.96% - 79.69%` suggests that this code set is perhaps not well defined. However, as EMIS (80% of practices) and TPP (10% of practices) are close, it could simply be down to Vision automatically recording BMIs and therefore increasing the prevalence there.

**UPDATE** By looking at the prevalence of patients with a BMI code that also has a non-zero value the range becomes `62.48% - 64.93%` which suggests that this code set is well defined.

_Update **2023/11/01**: prevalence now `61.2% - 65.7%` for EMIS and VISION. TPP higher at 73%._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    | 1709250 (65.60%) |  1709224 (65.60%) |
| 2021-05-07 | TPP             | 210817     |  134841 (63.96%) |   134835 (63.96%) |
| 2021-05-07 | Vision          | 334632     |  266612 (79.67%) |   266612 (79.67%) |
| 2021-05-11 | EMIS            | 2606497    | 1692442 (64.93%) |  1692422 (64.93%) |
| 2021-05-11 | TPP             | 210810     |  134652 (63.87%) |   134646 (63.87%) |
| 2021-05-11 | Vision          | 334784     |  209175 (62.48%) |   209175 (62.48%) |
| 2023-11-01 | EMIS            | 2472595    |  1624196 (65.7%) |   1624289 (65.7%) |
| 2023-11-01 | TPP             | 200603     |     146449 (73%) |      146448 (73%) |
| 2023-11-01 | Vision          | 332447     |   203333 (61.2%) |    203347 (61.2%) |
#### Audit log

- Find_missing_codes last run 2023-11-01

LINK: [https://github.com/rw251/.../patient/bmi/2](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/patient/bmi/2)

#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range `1.19% - 26.55%` as of 11th March 2021 is too wide. However the prevalence figure of 26.55% from EMIS is close to public data and is likely ok.

**UPDATE - 25th March 2021** Missing Read and CTV3 codes were added to the vaccination list and now the range of `26.91% - 32.96%` seems reasonable. It should be noted that there is an approx 2 week lag between events occurring and them being entered in the record.

**UPDATE - 12th April 2021**, latest prevalence figures.

**UPDATE - 18th March 2022** There are now new codes for things like 3rd/4th/booster dose of vaccine. The latest prevalence shows `65.0% - 66.3%` have at least one vaccine code in the GP_Events table, and `88.2% - 93.6%` have at least one code for the vaccine in the GP_Medications table.

**UPDATE - 24th January 2024** There has clearly been a reporting change as the prevalence of the vaccine as a medication has gone down. The event codes for the administration of the COVID vaccine seem to be the reliable place to find this informaiton.
##### MED

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-12 | EMIS            | 2606497    |           0 (0%) |    379577(14.56%) |
| 2021-05-12 | TPP             | 210810     |           0 (0%) |       1637(0.78%) |
| 2021-05-12 | Vision          | 334784     |           0 (0%) |         93(0.03%) |
| 2022-03-18 | EMIS            | 2658131    |  1750506 (65.9%) |    1763420(66.3%) |
| 2022-03-18 | TPP             | 212662     |      8207 (3.9%) |     138285(65.0%) |
| 2022-03-18 | Vision          | 341594     |   122060 (35.7%) |     225844(66.1%) |
| 2024-01-23 | EMIS            | 2520311    |  1547833 (61.4%) |   1547833 (61.4%) |
| 2024-01-23 | TPP             | 201513     |     8819 (4.38%) |      8819 (4.38%) |
| 2024-01-23 | Vision          | 334747     |   127541 (38.1%) |    127541 (38.1%) |
##### EVENT

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-12 | EMIS            | 2606497    |     4446 (0.17%) |  1101577 (42.26%) |
| 2021-05-12 | TPP             | 210810     |        7 (0.00%) |    87841 (41.66%) |
| 2021-05-12 | Vision          | 334784     |        1 (0.00%) |   142724 (42.63%) |
| 2022-03-18 | EMIS            | 2658131    |  2486786 (93.6%) |   1676951 (63.1%) |
| 2022-03-18 | TPP             | 212662     |   187463 (88.2%) |      7314 (3.44%) |
| 2022-03-18 | Vision          | 341594     |   312617 (91.5%) |     62512 (18.3%) |
| 2024-01-23 | EMIS            | 2520311    |   243506 (9.66%) |   1571372 (62.3%) |
| 2024-01-23 | TPP             | 201513     |     2322 (1.15%) |    137349 (68.2%) |
| 2024-01-23 | Vision          | 334747     |     32138 (9.6%) |    209223 (62.5%) |
#### Audit log

- Find_missing_codes last run 2024-01-23

LINK: [https://github.com/rw251/.../procedures/covid-vaccination/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/procedures/covid-vaccination/1)

### Angina

Any code indicating a diagnosis of angina. Does not include codes that indicate angina but are not diagnoses e.g. "h/o angina", "angina plan discussed".
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.03% - 1.37%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-12-07 | EMIS            | 2438760    |    26698 (1.09%) |     27181 (1.11%) |
| 2022-12-07 | TPP             | 198672     |     2658 (1.34%) |      4448 (2.24%) |
| 2022-12-07 | Vision          | 327081     |     3537 (1.08%) |      3530 (1.08%) |
| 2024-01-19 | EMIS            | 2519438    |    26111 (1.04%) |     25927 (1.03%) |
| 2024-01-19 | TPP             | 201469     |     2758 (1.37%) |      2759 (1.37%) |
| 2024-01-19 | Vision          | 334528     |     3465 (1.04%) |      3451 (1.03%) |
#### Audit log

- Find_missing_codes last run 2024-01-16

LINK: [https://github.com/rw251/.../conditions/angina/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/angina/1)

### Ankylosing Spondylitis

A code indicating a diagnosis of ankylosing Spondylitis.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.12% - 0.14%` suggests this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |    3089 (0.123%) |     3090 (0.123%) |
| 2024-01-19 | TPP             | 201469     |     269 (0.134%) |      267 (0.133%) |
| 2024-01-19 | Vision          | 334528     |      470 (0.14%) |       470 (0.14%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/ankylosing-spondylitis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ankylosing-spondylitis/1)

### Asthma

This code set was originally created for the SMASH safe medication dashboard and has been validated in practice.

- Includes byssinosis and other forms of occupational asthma
- Includes "asthmatic bronchitis" but not "allergic bronchitis"
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `12.7% - 13.6%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-11 | EMIS            | 2606497    |  335219 (12.86%) |   335223 (12.86%) |
| 2021-05-11 | TPP             | 210810     |   25596 (12.14%) |    25596 (12.14%) |
| 2021-05-11 | Vision          | 334784     |   44764 (13.37%) |    44764 (13.37%) |
| 2024-01-19 | EMIS            | 2519438    |   320421 (12.7%) |    320849 (12.7%) |
| 2024-01-19 | TPP             | 201469     |    27456 (13.6%) |     27465 (13.6%) |
| 2024-01-19 | Vision          | 334528     |      43457 (13%) |       43511 (13%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../conditions/asthma/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/asthma/1)

### Attention deficit hyperactivity disorder

This code set was created from getset.ga.

- Includes codes suggesting ADHD such as monitoring letters and annual reviews
- Does not include ADHD assessment scales
- Includes attention deficit disorder (i.e. without hyperactivity). This might not be what you want.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.02 - 1.31%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |    25644 (1.02%) |     25648 (1.02%) |
| 2024-01-19 | TPP             | 201469     |     2059 (1.02%) |      2066 (1.03%) |
| 2024-01-19 | Vision          | 334528     |     4394 (1.31%) |      4377 (1.31%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/attention-deficit-hyperactivity-disorder/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/attention-deficit-hyperactivity-disorder/1)

### Autism spectrum disorder

This code set was created from getset.ga.

- Includes "suspected autism" codes. This might not be what you want.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.11 - 1.22%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-09-27 | EMIS            | 2449912    |    21708 (0.88%) |     21831 (0.89%) |
| 2022-09-27 | TPP             | 198140     |     1575 (0.79%) |      1727 (0.87%) |
| 2022-09-27 | Vision          | 325784     |     2769 (0.84%) |      2614 (0.80%) |
| 2024-01-19 | EMIS            | 2519438    |    30794 (1.22%) |     30797 (1.22%) |
| 2024-01-19 | TPP             | 201469     |     2239 (1.11%) |      2239 (1.11%) |
| 2024-01-19 | Vision          | 334528     |     3851 (1.15%) |      3840 (1.15%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/autism-spectrum-disorder/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/autism-spectrum-disorder/1)

### Cancer

This version of the code set is based on the PCD ref set for cancer QOF reporting. The large size of the code set means it has yet to be fully validated. If using as a co-variate in an analysis it is sufficient, but if using as a primary outcome or exposure variable then should be checked further.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `3.36% - 3.48%` for EMIS and Vision suggests that this code set is well defined. TPP practices are a bit higher at `4.84%` which may be down to the way cancer is recorded there, or a higher prevalence in those practices.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-10-31 | EMIS            | 2472595    |    81360 (3.29%) |     81210 (3.28%) |
| 2023-10-31 | TPP             | 200603     |     7909 (3.94%) |      7674 (3.83%) |
| 2023-10-31 | Vision          | 332447     |    11410 (3.43%) |     11506 (3.46%) |
| 2024-01-19 | EMIS            | 2519438    |    84634 (3.36%) |     84610 (3.36%) |
| 2024-01-19 | TPP             | 201469     |     9847 (4.89%) |      9748 (4.84%) |
| 2024-01-19 | Vision          | 334528     |    11545 (3.45%) |     11645 (3.48%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/cancer/3](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/cancer/3)

### Chronic kidney disease (CKD) stage 3

Codes showing a diagnosis of stage 3 CKD.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `2.9% - 3.2%` for EMIS and Vision suggests that this code set is well defined. TPP practices are a bit higher at `4.3%` which may be down to the way CKD is recorded there.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-10-31 | EMIS            | 2472595    |    72486 (2.93%) |     72556 (2.93%) |
| 2023-10-31 | TPP             | 200603     |      8619 (4.3%) |       8619 (4.3%) |
| 2023-10-31 | Vision          | 332447     |    10540 (3.17%) |     10551 (3.17%) |
#### Audit log

- Find_missing_codes last run 2023-10-31

LINK: [https://github.com/rw251/.../conditions/ckd-stage-3/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ckd-stage-3/1)

### Chronic kidney disease (CKD) stage 4 codes

Codes showing a diagnosis of stage 4 CKD.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.21% - 0.22%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-10-31 | EMIS            | 2472595    |    5456 (0.221%) |     5465 (0.221%) |
| 2023-10-31 | TPP             | 200603     |     444 (0.221%) |      444 (0.221%) |
| 2023-10-31 | Vision          | 332447     |     682 (0.205%) |      682 (0.205%) |
#### Audit log

- Find_missing_codes last run 2023-10-31

LINK: [https://github.com/rw251/.../conditions/ckd-stage-4/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ckd-stage-4/1)

### Chronic kidney disease (CKD) stage 5

Codes showing a diagnosis of stage 5 CKD. Also includes codes for "end stage renal failure".
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.075% - 0.085%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-10-31 | EMIS            | 2472595    |   2099 (0.0849%) |     2101 (0.085%) |
| 2023-10-31 | TPP             | 200603     |    151 (0.0753%) |     151 (0.0753%) |
| 2023-10-31 | Vision          | 332447     |    247 (0.0743%) |     248 (0.0746%) |
#### Audit log

- Find_missing_codes last run 2023-10-31

LINK: [https://github.com/rw251/.../conditions/ckd-stage-5/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ckd-stage-5/1)

### COPD

Any suggestion of a diagnosis of COPD.

Developed from https://getset.ga.

- Includes "obliterative bronchiolitis" as a similar condition to COPD. Might not be required for all studies.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `2.19% - 2.49%` in 2023 suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |    54668 (2.10%) |     54669 (2.10%) |
| 2021-05-07 | TPP             | 210817     |     4537 (2.15%) |      4538 (2.15%) |
| 2021-05-07 | Vision          | 334632     |     7789 (2.33%) |      7789 (2.33%) |
| 2023-09-15 | EMIS            | 2463856    |    53577 (2.17%) |     53551 (2.17%) |
| 2023-09-15 | TPP             | 200590     |     4959 (2.47%) |      4966 (2.48%) |
| 2023-09-15 | Vision          | 332095     |     7382 (2.22%) |      7374 (2.22%) |
| 2024-01-19 | EMIS            | 2519438    |    54964 (2.18%) |     55097 (2.19%) |
| 2024-01-19 | TPP             | 201469     |     5016 (2.49%) |      5023 (2.49%) |
| 2024-01-19 | Vision          | 334528     |     7434 (2.22%) |      7444 (2.23%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../conditions/copd/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/copd/1)

### Coronary angioplasty

Any code indicating that a patient has received a coronary angioplasty.

- Does not include coronary atherectomy (laser treatment) unless angioplasty, stent or balloon is also mentioned
- Includes "history of" codes so not suitable if you need to know when it occurred
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.32% - 0.39%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-12-07 | EMIS            | 2438760    |    8492 (0.348%) |     8456 (0.347%) |
| 2022-12-07 | TPP             | 198672     |     782 (0.394%) |      849 (0.427%) |
| 2022-12-07 | Vision          | 327081     |    1123 (0.343%) |     1122 (0.343%) |
| 2024-01-19 | EMIS            | 2519438    |     8308 (0.33%) |     8179 (0.325%) |
| 2024-01-19 | TPP             | 201469     |     784 (0.389%) |       785 (0.39%) |
| 2024-01-19 | Vision          | 334528     |    1095 (0.327%) |     1063 (0.318%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../procedures/coronary-angioplasty/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/procedures/coronary-angioplasty/1)

### Coronary artery bypass graft (CABG)

Any code indicating that a patient has received a coronary artery bypass graft.

- Does not include general coronary artery operations
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.4% - 0.5%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-12-07 | EMIS            | 2438760    |   11331 (0.465%) |     11466 (0.47%) |
| 2022-12-07 | TPP             | 198672     |     1092 (0.55%) |     1454 (0.732%) |
| 2022-12-07 | Vision          | 327081     |    1445 (0.442%) |      1439 (0.44%) |
| 2024-01-19 | EMIS            | 2519438    |   10448 (0.415%) |     10331 (0.41%) |
| 2024-01-19 | TPP             | 201469     |    1006 (0.499%) |     1006 (0.499%) |
| 2024-01-19 | Vision          | 334528     |     1272 (0.38%) |     1261 (0.377%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../procedures/coronary-artery-bypass-graft/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/procedures/coronary-artery-bypass-graft/1)

### Depression

Code set for patients with a diagnosis of depression.

Developed from www.opencodelists.org

- No "affective disorder" codes unless mention of depression e.g. 191632009: Bipolar affective disorder, currently depressed, severe, with psychosis (disorder)
- Seasonal affective disorder included as that is a depressive condition
- Includes non-diagnosis codes such as monitoring invites
- Codes indicating grief from bereavement or other life events are included on the grounds that if they are coded in a person's record they are likely clinically important
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system,
we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.
The prevalence range `23% - 25%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------- | ----------------- |
| 2022-05-12 | EMIS            | 2662570    | 553650 (20.79%)  | 560060 (21.03%)   |
| 2022-05-12 | TPP             | 212696     | 45884 (21.57%)   | 45912 (21.59%)    |
| 2022-05-12 | Vision          | 342344     | 75709 (22.11%)   | 73277 (21.40%)    |
| 2024-01-19 | EMIS            | 2519438    | 676518 (26.9%)   | 572943 (22.7%)    |
| 2024-01-19 | TPP             | 201469     | 51022 (25.3%)    | 50682 (25.2%)     |
| 2024-01-19 | Vision          | 334528     | 80546 (24.1%)    | 78271 (23.4%)     |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../conditions/depression/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/depression/1)

### Diabetes mellitus type 1

Any diagnosis of T1DM. A super set of the QOF business rule.

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.42% - 0.55%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |    11381 (0.44%) |     11381 (0.44%) |
| 2021-05-07 | TPP             | 210817     |      887 (0.42%) |       887 (0.42%) |
| 2021-05-07 | Vision          | 334632     |     1607 (0.48%) |      1607 (0.48%) |
| 2023-09-12 | EMIS            | 2463856    |   10968 (0.445%) |    10223 (0.415%) |
| 2023-09-12 | TPP             | 200590     |    1094 (0.545%) |     1090 (0.543%) |
| 2023-09-12 | Vision          | 332095     |    1574 (0.474%) |     1455 (0.438%) |
| 2023-09-15 | EMIS            | 2463856    |   10999 (0.446%) |    10253 (0.416%) |
| 2023-09-15 | TPP             | 200590     |    1096 (0.546%) |     1092 (0.544%) |
| 2023-09-15 | Vision          | 332095     |    1578 (0.475%) |     1459 (0.439%) |
| 2024-01-19 | EMIS            | 2519438    |   11460 (0.455%) |    10629 (0.422%) |
| 2024-01-19 | TPP             | 201469     |    1118 (0.555%) |     1101 (0.546%) |
| 2024-01-19 | Vision          | 334528     |    1612 (0.482%) |     1486 (0.444%) |
#### Audit log

- Find_missing_codes last run 2024-01-18

LINK: [https://github.com/rw251/.../conditions/diabetes-type-i/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/diabetes-type-i/1)

### Diabetes mellitus type 2

Any diagnosis of T2DM. A super set of the QOF business rule. Includes "adult onset" diabetes, but DOES NOT include "maturity onset" diabetes.

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `5.3% - 6.9%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-05-07 | EMIS            | 2605681    |   133938 (5.14%) |    133938 (5.14%) |
| 2021-05-07 | TPP             | 210817     |    10954 (5.20%) |     10954 (5.20%) |
| 2021-05-07 | Vision          | 334632     |    16936 (5.06%) |     16933 (5.06%) |
| 2023-09-12 | EMIS            | 2463856    |   139199 (5.65%) |    139230 (5.65%) |
| 2023-09-12 | TPP             | 200590     |    13456 (6.71%) |     13458 (6.71%) |
| 2023-09-12 | Vision          | 332095     |    17554 (5.29%) |     17542 (5.28%) |
| 2023-09-15 | EMIS            | 2463856    |   139785 (5.67%) |    139814 (5.67%) |
| 2023-09-15 | TPP             | 200590     |    13485 (6.72%) |     13487 (6.72%) |
| 2023-09-15 | Vision          | 332095     |    17621 (5.31%) |      17609 (5.3%) |
| 2024-01-19 | EMIS            | 2519438    |   142872 (5.67%) |    142899 (5.67%) |
| 2024-01-19 | TPP             | 201469     |    13853 (6.88%) |     13854 (6.88%) |
| 2024-01-19 | Vision          | 334528     |    17859 (5.34%) |     17847 (5.33%) |
#### Audit log

- Find_missing_codes last run 2024-01-18

LINK: [https://github.com/rw251/.../conditions/diabetes-type-ii/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/diabetes-type-ii/1)

### Heart failure

Any code indicating a diagnosis, or presence of heart failure. Does not include "History of" heart failure codes.

- Excludes "Cor pulmonale" as although this usually leads to heart failure, but is not heart failure.
- Also does not include "Chronic pulmonary heart disease" or "pulmonary oedema". Both of which can lead to heart failure but are not heart failure.
#### Notes

The code `G581.` (read v2 and CTV3) includes "Left ventricular failure" and "Pulmonary oedema - acute" as synonyms for CTV3 but not read v2. These are not synonyms and we want the former but not the latter. Given the read v2 code is just "left ventricular failure" we include this code, but it is possible we match some patients with only a pulmonary oedema.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.92% - 1.15%` is sufficiently narrow that this code set is likely well defined.

_Update **2024-01-19**: Prevalence now 1.06% - 1.28%. TPP still with slightly higher prevalence, but sufficiently close to EMIS and Vision._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-03-11 | EMIS            | 2600658    |    23923 (0.92%) |     23923 (0.92%) |
| 2021-03-11 | TPP             | 210333     |     2415 (1.15%) |      2416 (1.15%) |
| 2021-03-11 | Vision          | 333251     |     3157 (0.95%) |      3157 (0.95%) |
| 2024-01-19 | EMIS            | 2519438    |    26810 (1.06%) |     26692 (1.06%) |
| 2024-01-19 | TPP             | 201469     |     2566 (1.27%) |      2569 (1.28%) |
| 2024-01-19 | Vision          | 334528     |     3578 (1.07%) |      3562 (1.06%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../conditions/heart-failure/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/heart-failure/1)

### Hypertension

Any diagnosis of hypertension. Excludes hypertension in pregnancy, gestational hyptertension, pre-eclampsia. Based on the QOF code sets for hypertension.

Developed from https://getset.ga.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `12.55% - 12.95%` suggests that this code set is well defined.

_Update **2024-01-19**: Prevalence now 13% - 16%. TPP still with slightly higher prevalence, but sufficiently close to EMIS and Vision._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2021-07-14 | EMIS            | 2615750    |  328350 (12.55%) |  328339 ( 12.55%) |
| 2021-07-14 | TPP             | 211345     |   27363 (12.95%) |   27362 ( 12.95%) |
| 2021-07-14 | Vision          | 336528     |   43389 (12.89%) |   43389 ( 12.89%) |
| 2024-01-19 | EMIS            | 2519438    |   344485 (13.7%) |    334360 (13.3%) |
| 2024-01-19 | TPP             | 201469     |    32473 (16.1%) |     32437 (16.1%) |
| 2024-01-19 | Vision          | 334528     |    44732 (13.4%) |       43625 (13%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/hypertension/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/hypertension/1)

### Myocardial infarction (MI)

Any code that indicates that a person has had a myocardial infarction. NB This includes "history" codes as well so is not best suited if you solely want to know when a diagnosis occurred.

- Includes acute coronary syndrome
- Includes aborted myocardial infarction
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `1.36% - 1.62%` suggests that this code set is well defined.

_Update **2024-01-19**: Prevalence now 1.5% - 1.8%. TPP still with slightly higher prevalence, but sufficiently close to EMIS and Vision._

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-12-07 | EMIS            | 2438760    |    33211 (1.36%) |     33876 (1.39%) |
| 2022-12-07 | TPP             | 198672     |     3210 (1.62%) |      5353 (2.69%) |
| 2022-12-07 | Vision          | 327081     |     4447 (1.36%) |      4454 (1.36%) |
| 2024-01-19 | EMIS            | 2519438    |     37720 (1.5%) |      37757 (1.5%) |
| 2024-01-19 | TPP             | 201469     |     3571 (1.77%) |      3572 (1.77%) |
| 2024-01-19 | Vision          | 334528     |     4945 (1.48%) |      4950 (1.48%) |
#### Audit log

- Find_missing_codes last run 2024-01-17

LINK: [https://github.com/rw251/.../conditions/myocardial-infarction/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/myocardial-infarction/1)

### Post-traumatic stress disorder (PTSD)

Any code suggesting PTSD. Developed from a code set at opencodelists.org.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.62% - 0.76%` is sufficiently narrow that this code set is likely well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2024-01-19 | EMIS            | 2519438    |   19105 (0.758%) |    19102 (0.758%) |
| 2024-01-19 | TPP             | 201469     |     1290 (0.64%) |     1258 (0.624%) |
| 2024-01-19 | Vision          | 334528     |    2530 (0.756%) |     2530 (0.756%) |

LINK: [https://github.com/rw251/.../conditions/ptsd/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ptsd/1)

### Rheumatoid arthritis

Any code indicating a diagnosis of rheumatoid arthritis.

- Does not include lupus
- Does not include ankylosing spondylitis
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.55% - 0.66%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-16 | EMIS            | 2662570    |    15603 (0.59%) |     15603 (0.59%) |
| 2022-05-16 | TPP             | 212696     |     1130 (0.53%) |      1137 (0.53%) |
| 2022-05-16 | Vision          | 342344     |     2126 (0.62%) |      2126 (0.62%) |
| 2024-01-23 | EMIS            | 2520311    |   17971 (0.713%) |    13940 (0.553%) |
| 2024-01-23 | TPP             | 201513     |     1591 (0.79%) |     1337 (0.663%) |
| 2024-01-23 | Vision          | 334747     |    2488 (0.743%) |      1909 (0.57%) |
#### Audit log

- Find_missing_codes last run 2024-01-23

LINK: [https://github.com/rw251/.../conditions/rheumatoid-arthritis/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/rheumatoid-arthritis/1)

### Systemic Lupus Erythematosus (SLE)

Codes from: https://www.opencodelists.org/codelist/opensafely/systemic-lupus-erythematosus-sle/2020-05-12/#full-list

Includes codes for other diagnoses that are "due to" or "caused by" SLE.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.

The prevalence range `0.11% - 0.125%` suggests that this code set is well defined.

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2023-10-03 | EMIS            | 2469004    |    4340 (0.176%) |     2866 (0.116%) |
| 2023-10-03 | TPP             | 200687     |     326 (0.162%) |      209 (0.104%) |
| 2023-10-03 | Vision          | 332247     |     712 (0.214%) |      420 (0.126%) |
| 2024-01-19 | EMIS            | 2519438    |    2912 (0.116%) |     2913 (0.116%) |
| 2024-01-19 | TPP             | 201469     |     215 (0.107%) |      215 (0.107%) |
| 2024-01-19 | Vision          | 334528     |     419 (0.125%) |      419 (0.125%) |
#### Audit log

- Find_missing_codes last run 2024-01-19

LINK: [https://github.com/rw251/.../conditions/sle/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/sle/1)

### Stroke

Any code indicating a diagnosis of a stroke. Includes ischaemic and haemorrhagic strokes. Does not include codes for types of vascular dementia such as multi infarct dementia, which are usually caused by a series of mini strokes. Excludes "history of" codes.

Code set derived from https://getset.gq and the Primary Care Domain Reference Set Portal.
#### Prevalence log

By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range `0.91% - 1.45%` suggests that this code set is well defined.

_Update **2024-01-19**: Prevalence now 1.2% - 1.5% when examining codes_

| Date       | Practice system | Population | Patients from ID | Patient from code |
| ---------- | --------------- | ---------- | ---------------: | ----------------: |
| 2022-05-12 | EMIS            | 2662570    |    24378 (0.92%) |     24359 (0.91%) |
| 2022-05-12 | TPP             | 212696     |     2441 (1.45%) |      2445 (1.45%) |
| 2022-05-12 | Vision          | 342344     |     3308 (0.97%) |      3307 (0.97%) |
| 2023-09-12 | EMIS            | 2463856    |   23678 (0.961%) |    11237 (0.456%) |
| 2023-09-12 | TPP             | 200590     |     2631 (1.31%) |      2593 (1.29%) |
| 2023-09-12 | Vision          | 332095     |    3098 (0.933%) |     1699 (0.512%) |
| 2024-01-19 | EMIS            | 2519438    |    33873 (1.34%) |     31102 (1.23%) |
| 2024-01-19 | TPP             | 201469     |      3215 (1.6%) |      2983 (1.48%) |
| 2024-01-19 | Vision          | 334528     |     4325 (1.29%) |      3950 (1.18%) |
#### Audit log

- Find_missing_codes last run 2024-01-18

LINK: [https://github.com/rw251/.../conditions/stroke/1](https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/stroke/1)
# Clinical code sets

All code sets required for this analysis are available here: [https://github.com/rw251/.../066 - Heald (Long Covid)/clinical-code-sets.csv](https://github.com/rw251/gm-idcr/tree/master/projects/066%20-%20Heald%20(Long%20Covid)/clinical-code-sets.csv). Individual lists for each concept can also be found by using the links above.