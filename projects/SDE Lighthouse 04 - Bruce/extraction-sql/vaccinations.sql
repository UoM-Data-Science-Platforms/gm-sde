--┌────────────────────────────────────┐
--│ LH004 Vaccinations file            │
--└────────────────────────────────────┘

-- OUTPUT: Data with the following fields
-- 	- PatientId (int)
--  - Date
--  - VaccinationType

--Just want the output, not the messages
SET NOCOUNT ON;

DECLARE @StartDate datetime;
DECLARE @EndDate datetime;
SET @StartDate = '2020-01-01';  -- CHECK
SET @EndDate = '2023-10-31'; -- CHECK

--┌───────────────────────────────────────────────────────────────┐
--│ Define Cohort for LH004: patients that had an SLE diagnosis   │
--└───────────────────────────────────────────────────────────────┘

-- OBJECTIVE: To build the cohort of patients needed for LH004. This reduces duplication of code in the template scripts.

-- COHORT: Any patient with a SLE diagnosis between start and end date.

-- INPUT: None

-- OUTPUT: Temp tables as follows:
-- #Cohort

DECLARE @StudyStartDate datetime;
SET @StudyStartDate = '2020-01-01'; 

--┌───────────────────────────────────────────────────────────┐
--│ Create table of patients who are registered with a GM GP  │
--└───────────────────────────────────────────────────────────┘

-- INPUT REQUIREMENTS: @StudyStartDate

-- Find all patients alive at start date
IF OBJECT_ID('tempdb..#PossiblePatients') IS NOT NULL DROP TABLE #PossiblePatients;
SELECT PK_Patient_Link_ID as FK_Patient_Link_ID, EthnicMainGroup, EthnicGroupDescription, DeathDate INTO #PossiblePatients FROM [SharedCare].Patient_Link
WHERE 
	(DeathDate IS NULL OR (DeathDate >= @StudyStartDate))

-- Find all patients registered with a GP
IF OBJECT_ID('tempdb..#PatientsWithGP') IS NOT NULL DROP TABLE #PatientsWithGP;
SELECT DISTINCT FK_Patient_Link_ID INTO #PatientsWithGP FROM [SharedCare].Patient
where FK_Reference_Tenancy_ID = 2
AND GPPracticeCode NOT LIKE 'ZZZ%';

-- Make cohort from patients alive at start date and registered with a GP
IF OBJECT_ID('tempdb..#Patients') IS NOT NULL DROP TABLE #Patients;
SELECT pp.* INTO #Patients FROM #PossiblePatients pp
INNER JOIN #PatientsWithGP gp on gp.FK_Patient_Link_ID = pp.FK_Patient_Link_ID;

------------------------------------------

-- OUTPUT: #Patients
--┌───────────────┐
--│ Year of birth │
--└───────────────┘

-- OBJECTIVE: To get the year of birth for each patient.

-- INPUT: Assumes there exists a temp table as follows:
-- #Patients (FK_Patient_Link_ID)
--  A distinct list of FK_Patient_Link_IDs for each patient in the cohort

-- OUTPUT: A temp table as follows:
-- #PatientYearOfBirth (FK_Patient_Link_ID, YearOfBirth)
-- 	- FK_Patient_Link_ID - unique patient id
--	- YearOfBirth - INT

-- ASSUMPTIONS:
--	- Patient data is obtained from multiple sources. Where patients have multiple YOBs we determine the YOB as follows:
--	-	If the patients has a YOB in their primary care data feed we use that as most likely to be up to date
--	-	If every YOB for a patient is the same, then we use that
--	-	If there is a single most recently updated YOB in the database then we use that
--	-	Otherwise we take the highest YOB for the patient that is not in the future

-- Get all patients year of birth for the cohort
IF OBJECT_ID('tempdb..#AllPatientYearOfBirths') IS NOT NULL DROP TABLE #AllPatientYearOfBirths;
SELECT 
	FK_Patient_Link_ID,
	FK_Reference_Tenancy_ID,
	HDMModifDate,
	YEAR(Dob) AS YearOfBirth
INTO #AllPatientYearOfBirths
FROM SharedCare.Patient p
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
AND Dob IS NOT NULL;


-- If patients have a tenancy id of 2 we take this as their most likely YOB
-- as this is the GP data feed and so most likely to be up to date
IF OBJECT_ID('tempdb..#PatientYearOfBirth') IS NOT NULL DROP TABLE #PatientYearOfBirth;
SELECT FK_Patient_Link_ID, MIN(YearOfBirth) as YearOfBirth INTO #PatientYearOfBirth FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Patients)
AND FK_Reference_Tenancy_ID = 2
GROUP BY FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find the patients who remain unmatched
IF OBJECT_ID('tempdb..#UnmatchedYobPatients') IS NOT NULL DROP TABLE #UnmatchedYobPatients;
SELECT FK_Patient_Link_ID INTO #UnmatchedYobPatients FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- If every YOB is the same for all their linked patient ids then we use that
INSERT INTO #PatientYearOfBirth
SELECT FK_Patient_Link_ID, MIN(YearOfBirth) FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
GROUP BY FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find any still unmatched patients
TRUNCATE TABLE #UnmatchedYobPatients;
INSERT INTO #UnmatchedYobPatients
SELECT FK_Patient_Link_ID FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- If there is a unique most recent YOB then use that
INSERT INTO #PatientYearOfBirth
SELECT p.FK_Patient_Link_ID, MIN(p.YearOfBirth) FROM #AllPatientYearOfBirths p
INNER JOIN (
	SELECT FK_Patient_Link_ID, MAX(HDMModifDate) MostRecentDate FROM #AllPatientYearOfBirths
	WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
	GROUP BY FK_Patient_Link_ID
) sub ON sub.FK_Patient_Link_ID = p.FK_Patient_Link_ID AND sub.MostRecentDate = p.HDMModifDate
GROUP BY p.FK_Patient_Link_ID
HAVING MIN(YearOfBirth) = MAX(YearOfBirth);

-- Find any still unmatched patients
TRUNCATE TABLE #UnmatchedYobPatients;
INSERT INTO #UnmatchedYobPatients
SELECT FK_Patient_Link_ID FROM #Patients
EXCEPT
SELECT FK_Patient_Link_ID FROM #PatientYearOfBirth;

-- Otherwise just use the highest value (with the exception that can't be in the future)
INSERT INTO #PatientYearOfBirth
SELECT FK_Patient_Link_ID, MAX(YearOfBirth) FROM #AllPatientYearOfBirths
WHERE FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #UnmatchedYobPatients)
GROUP BY FK_Patient_Link_ID
HAVING MAX(YearOfBirth) <= YEAR(GETDATE());

-- Tidy up - helpful in ensuring the tempdb doesn't run out of space mid-query
DROP TABLE #AllPatientYearOfBirths;
DROP TABLE #UnmatchedYobPatients;

-- >>> Codesets required... Inserting the code set code
--
--┌────────────────────┐
--│ Clinical code sets │
--└────────────────────┘

-- OBJECTIVE: To populate temporary tables with the existing clinical code sets.
--            See the [SQL-generation-process.md](SQL-generation-process.md) for more details.

-- INPUT: No pre-requisites

-- OUTPUT: Five temp tables as follows:
--  #AllCodes (Concept, Version, Code)
--  #CodeSets (FK_Reference_Coding_ID, Concept)
--  #SnomedSets (FK_Reference_SnomedCT_ID, FK_SNOMED_ID)
--  #VersionedCodeSets (FK_Reference_Coding_ID, Concept, Version)
--  #VersionedSnomedSets (FK_Reference_SnomedCT_ID, Version, FK_SNOMED_ID)

--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
--!!! DO NOT EDIT THIS FILE MANUALLY !!!
--!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

--#region Clinical code sets

IF OBJECT_ID('tempdb..#AllCodes') IS NOT NULL DROP TABLE #AllCodes;
CREATE TABLE #AllCodes (
  [Concept] [varchar](255) NOT NULL,
  [Version] INT NOT NULL,
  [Code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
  [description] [varchar] (255) NULL 
);

IF OBJECT_ID('tempdb..#codesreadv2') IS NOT NULL DROP TABLE #codesreadv2;
CREATE TABLE #codesreadv2 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesreadv2
VALUES ('sle',1,'F3710',NULL,'Polyneuropathy in disseminated lupus erythematosus'),('sle',1,'F371000',NULL,'Polyneuropathy in disseminated lupus erythematosus'),('sle',1,'F3961',NULL,'Myopathy due to disseminated lupus erythematosus'),('sle',1,'F396100',NULL,'Myopathy due to disseminated lupus erythematosus'),('sle',1,'F4D33',NULL,'Eyelid discoid lupus erythematosus'),('sle',1,'F4D3300',NULL,'Eyelid discoid lupus erythematosus'),('sle',1,'H57y4',NULL,'Lung disease with systemic lupus erythematosus'),('sle',1,'H57y400',NULL,'Lung disease with systemic lupus erythematosus'),('sle',1,'K01x4',NULL,'Nephrotic syndrome in systemic lupus erythematosus'),('sle',1,'K01x400',NULL,'Nephrotic syndrome in systemic lupus erythematosus'),('sle',1,'M154.',NULL,'Lupus erythematosus'),('sle',1,'M154.00',NULL,'Lupus erythematosus'),('sle',1,'M1540',NULL,'Lupus erythematosus chronicus'),('sle',1,'M154000',NULL,'Lupus erythematosus chronicus'),('sle',1,'M1541',NULL,'Discoid lupus erythematosus'),('sle',1,'M154100',NULL,'Discoid lupus erythematosus'),('sle',1,'M1542',NULL,'Lupus erythematosus migrans'),('sle',1,'M154200',NULL,'Lupus erythematosus migrans'),('sle',1,'M1543',NULL,'Lupus erythematosus nodularis'),('sle',1,'M154300',NULL,'Lupus erythematosus nodularis'),('sle',1,'M1544',NULL,'Lupus erythematosus profundus'),('sle',1,'M154400',NULL,'Lupus erythematosus profundus'),('sle',1,'M1545',NULL,'Lupus erythematosus tumidus'),('sle',1,'M154500',NULL,'Lupus erythematosus tumidus'),('sle',1,'M1546',NULL,'Lupus erythematosus unguium mutilans'),('sle',1,'M154600',NULL,'Lupus erythematosus unguium mutilans'),('sle',1,'M154z',NULL,'Lupus erythematosus NOS'),('sle',1,'M154z00',NULL,'Lupus erythematosus NOS'),('sle',1,'Myu78',NULL,'[X]Other local lupus erythematosus'),('sle',1,'Myu7800',NULL,'[X]Other local lupus erythematosus'),('sle',1,'N000.',NULL,'Systemic lupus erythematosus'),('sle',1,'N000.00',NULL,'Systemic lupus erythematosus'),('sle',1,'N0002',NULL,'Drug-induced systemic lupus erythematosus'),('sle',1,'N000200',NULL,'Drug-induced systemic lupus erythematosus'),('sle',1,'N000z',NULL,'Systemic lupus erythematosus NOS'),('sle',1,'N000z00',NULL,'Systemic lupus erythematosus NOS'),('sle',1,'Nyu43',NULL,'[X]Other forms of systemic lupus erythematosus'),('sle',1,'Nyu4300',NULL,'[X]Other forms of systemic lupus erythematosus'),('sle',1,'K0B40',NULL,'Renal tubulo-interstitial disorder in systemic lupus erythematosus'),('sle',1,'K0B4000',NULL,'Renal tubulo-interstitial disorder in systemic lupus erythematosus'),('sle',1,'M1547',NULL,'Subacute cutaneous lupus erythematosus'),('sle',1,'M154700',NULL,'Subacute cutaneous lupus erythematosus'),('sle',1,'N0000',NULL,'Disseminated lupus erythematosus'),('sle',1,'N000000',NULL,'Disseminated lupus erythematosus'),('sle',1,'N0003',NULL,'Systemic lupus erythematosus with organ or system involvement'),('sle',1,'N000300',NULL,'Systemic lupus erythematosus with organ or system involvement'),('sle',1,'N0004',NULL,'Systemic lupus erythematosus with pericarditis'),('sle',1,'N000400',NULL,'Systemic lupus erythematosus with pericarditis'),('sle',1,'N0005',NULL,'Neonatal lupus erythematosus'),('sle',1,'N000500',NULL,'Neonatal lupus erythematosus'),('sle',1,'N0006',NULL,'Cerebral lupus'),('sle',1,'N000600',NULL,'Cerebral lupus');
INSERT INTO #codesreadv2
VALUES ('tuberculosis',1,'A10..',NULL,'Primary tuberculous infection'),('tuberculosis',1,'A10..00',NULL,'Primary tuberculous infection'),('tuberculosis',1,'A100.',NULL,'Primary tuberculous complex'),('tuberculosis',1,'A100.00',NULL,'Primary tuberculous complex'),('tuberculosis',1,'A101.',NULL,'Tuberculous pleurisy in primary progressive tuberculosis'),('tuberculosis',1,'A101.00',NULL,'Tuberculous pleurisy in primary progressive tuberculosis'),('tuberculosis',1,'A10y.',NULL,'Other primary progressive tuberculosis'),('tuberculosis',1,'A10y.00',NULL,'Other primary progressive tuberculosis'),('tuberculosis',1,'A10z.',NULL,'Primary tuberculous infection NOS'),('tuberculosis',1,'A10z.00',NULL,'Primary tuberculous infection NOS'),('tuberculosis',1,'A11..',NULL,'Lung tuberculosis'),('tuberculosis',1,'A11..00',NULL,'Lung tuberculosis'),('tuberculosis',1,'A110.',NULL,'Infiltrative lung tuberculosis'),('tuberculosis',1,'A110.00',NULL,'Infiltrative lung tuberculosis'),('tuberculosis',1,'A111.',NULL,'Nodular lung tuberculosis'),('tuberculosis',1,'A111.00',NULL,'Nodular lung tuberculosis'),('tuberculosis',1,'A113.',NULL,'Tuberculosis of bronchus'),('tuberculosis',1,'A113.00',NULL,'Tuberculosis of bronchus'),('tuberculosis',1,'A115.',NULL,'Tuberculous bronchiectasis'),('tuberculosis',1,'A115.00',NULL,'Tuberculous bronchiectasis'),('tuberculosis',1,'A116.',NULL,'Tuberculous pneumonia'),('tuberculosis',1,'A116.00',NULL,'Tuberculous pneumonia'),('tuberculosis',1,'A117.',NULL,'Tuberculous pneumothorax'),('tuberculosis',1,'A117.00',NULL,'Tuberculous pneumothorax'),('tuberculosis',1,'A11y.',NULL,'Other specified pulmonary tuberculosis'),('tuberculosis',1,'A11y.00',NULL,'Other specified pulmonary tuberculosis'),('tuberculosis',1,'A11z.',NULL,'Pulmonary tuberculosis NOS'),('tuberculosis',1,'A11z.00',NULL,'Pulmonary tuberculosis NOS'),('tuberculosis',1,'A12..',NULL,'Other respiratory tuberculosis'),('tuberculosis',1,'A12..00',NULL,'Other respiratory tuberculosis'),('tuberculosis',1,'A120.',NULL,'Tuberculous pleurisy'),('tuberculosis',1,'A120.00',NULL,'Tuberculous pleurisy'),('tuberculosis',1,'A1201',NULL,'Tuberculous empyema'),('tuberculosis',1,'A120100',NULL,'Tuberculous empyema'),('tuberculosis',1,'A1202',NULL,'Tuberculous hydrothorax'),('tuberculosis',1,'A120200',NULL,'Tuberculous hydrothorax'),('tuberculosis',1,'A120z',NULL,'Tuberculous pleurisy NOS'),('tuberculosis',1,'A120z00',NULL,'Tuberculous pleurisy NOS'),('tuberculosis',1,'A121.',NULL,'Tuberculosis of intrathoracic lymph nodes'),('tuberculosis',1,'A121.00',NULL,'Tuberculosis of intrathoracic lymph nodes'),('tuberculosis',1,'A1210',NULL,'Tuberculosis of hilar lymph nodes'),('tuberculosis',1,'A121000',NULL,'Tuberculosis of hilar lymph nodes'),('tuberculosis',1,'A1211',NULL,'Tuberculosis of mediastinal lymph nodes'),('tuberculosis',1,'A121100',NULL,'Tuberculosis of mediastinal lymph nodes'),('tuberculosis',1,'A1212',NULL,'Tuberculosis of tracheobronchial lymph nodes'),('tuberculosis',1,'A121200',NULL,'Tuberculosis of tracheobronchial lymph nodes'),('tuberculosis',1,'A121z',NULL,'Tuberculosis of intrathoracic lymph nodes NOS'),('tuberculosis',1,'A121z00',NULL,'Tuberculosis of intrathoracic lymph nodes NOS'),('tuberculosis',1,'A122.',NULL,'Isolated tracheal or bronchial tuberculosis'),('tuberculosis',1,'A122.00',NULL,'Isolated tracheal or bronchial tuberculosis'),('tuberculosis',1,'A1220',NULL,'Isolated tracheal tuberculosis'),('tuberculosis',1,'A122000',NULL,'Isolated tracheal tuberculosis'),('tuberculosis',1,'A1221',NULL,'Isolated bronchial tuberculosis'),('tuberculosis',1,'A122100',NULL,'Isolated bronchial tuberculosis'),('tuberculosis',1,'A122z',NULL,'Isolated tracheal or bronchial tuberculosis NOS'),('tuberculosis',1,'A122z00',NULL,'Isolated tracheal or bronchial tuberculosis NOS'),('tuberculosis',1,'A123.',NULL,'Tuberculous laryngitis'),('tuberculosis',1,'A123.00',NULL,'Tuberculous laryngitis'),('tuberculosis',1,'A124.',NULL,'Respiratory tuberculosis, bacteriologically and histologically confirmed'),('tuberculosis',1,'A124.00',NULL,'Respiratory tuberculosis, bacteriologically and histologically confirmed'),('tuberculosis',1,'A1240',NULL,'Tuberculosis of lung, confirmed by sputum microscopy with or without culture'),('tuberculosis',1,'A124000',NULL,'Tuberculosis of lung, confirmed by sputum microscopy with or without culture'),('tuberculosis',1,'A1241',NULL,'Tuberculosis of lung, confirmed by culture only'),('tuberculosis',1,'A124100',NULL,'Tuberculosis of lung, confirmed by culture only'),('tuberculosis',1,'A1242',NULL,'Tuberculosis of lung, confirmed histologically'),('tuberculosis',1,'A124200',NULL,'Tuberculosis of lung, confirmed histologically'),('tuberculosis',1,'A1243',NULL,'Tuberculosis of lung, confirmed by unspecified means'),('tuberculosis',1,'A124300',NULL,'Tuberculosis of lung, confirmed by unspecified means'),('tuberculosis',1,'A1244',NULL,'Tuberculosis of intrathoracic lymph nodes, confirmed bacteriologically and histologically'),('tuberculosis',1,'A124400',NULL,'Tuberculosis of intrathoracic lymph nodes, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1245',NULL,'Tuberculosis of larynx, trachea and bronchus, confirmed bacteriologically and histologically'),('tuberculosis',1,'A124500',NULL,'Tuberculosis of larynx, trachea and bronchus, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1246',NULL,'Tuberculous pleurisy, confirmed bacteriologically and histologically'),('tuberculosis',1,'A124600',NULL,'Tuberculous pleurisy, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1247',NULL,'Primary respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'A124700',NULL,'Primary respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'A125.',NULL,'Respiratory tuberculosis, not confirmed bacteriologically or histologically'),('tuberculosis',1,'A125.00',NULL,'Respiratory tuberculosis, not confirmed bacteriologically or histologically'),('tuberculosis',1,'A1250',NULL,'Tuberculosis of lung, bacteriologically and histologically negative'),('tuberculosis',1,'A125000',NULL,'Tuberculosis of lung, bacteriologically and histologically negative'),('tuberculosis',1,'A1251',NULL,'Tuberculosis of lung, bacteriological and histological examination not done'),('tuberculosis',1,'A125100',NULL,'Tuberculosis of lung, bacteriological and histological examination not done'),('tuberculosis',1,'A1252',NULL,'Primary respiratory tuberculosis without mention of bacteriological or histological confirmation'),('tuberculosis',1,'A125200',NULL,'Primary respiratory tuberculosis without mention of bacteriological or histological confirmation'),('tuberculosis',1,'A12y.',NULL,'Other specified respiratory tuberculosis'),('tuberculosis',1,'A12y.00',NULL,'Other specified respiratory tuberculosis'),('tuberculosis',1,'A12y0',NULL,'Tuberculosis of mediastinum'),('tuberculosis',1,'A12y000',NULL,'Tuberculosis of mediastinum'),('tuberculosis',1,'A12y1',NULL,'Tuberculosis of nasopharynx'),('tuberculosis',1,'A12y100',NULL,'Tuberculosis of nasopharynx'),('tuberculosis',1,'A12y2',NULL,'Tuberculosis of nasal septum'),('tuberculosis',1,'A12y200',NULL,'Tuberculosis of nasal septum'),('tuberculosis',1,'A12y3',NULL,'Tuberculosis of nasal sinus'),('tuberculosis',1,'A12y300',NULL,'Tuberculosis of nasal sinus'),('tuberculosis',1,'A12yz',NULL,'Other specified respiratory tuberculosis NOS'),('tuberculosis',1,'A12yz00',NULL,'Other specified respiratory tuberculosis NOS'),('tuberculosis',1,'A14..',NULL,'Tuberculosis of intestines, peritoneum and mesenteric glands'),('tuberculosis',1,'A14..00',NULL,'Tuberculosis of intestines, peritoneum and mesenteric glands'),('tuberculosis',1,'A14y.',NULL,'Other gastrointestinal tract tuberculosis'),('tuberculosis',1,'A14y.00',NULL,'Other gastrointestinal tract tuberculosis'),('tuberculosis',1,'A14y5',NULL,'Tuberculosis of retroperitoneal lymph nodes'),('tuberculosis',1,'A14y500',NULL,'Tuberculosis of retroperitoneal lymph nodes'),('tuberculosis',1,'A14yz',NULL,'Other gastrointestinal tract tuberculosis NOS'),('tuberculosis',1,'A14yz00',NULL,'Other gastrointestinal tract tuberculosis NOS'),('tuberculosis',1,'A15..',NULL,'Tuberculous synovitis'),('tuberculosis',1,'A15..00',NULL,'Tuberculous synovitis'),('tuberculosis',1,'A15z.',NULL,'Tuberculosis of bones or joints NOS'),('tuberculosis',1,'A15z.00',NULL,'Tuberculosis of bones or joints NOS'),('tuberculosis',1,'A16..',NULL,'Tuberculosis of genitourinary system'),('tuberculosis',1,'A16..00',NULL,'Tuberculosis of genitourinary system'),('tuberculosis',1,'A163.',NULL,'Tuberculosis of other urinary organs'),('tuberculosis',1,'A163.00',NULL,'Tuberculosis of other urinary organs'),('tuberculosis',1,'A165.',NULL,'Tuberculosis of other male genital organs'),('tuberculosis',1,'A165.00',NULL,'Tuberculosis of other male genital organs'),('tuberculosis',1,'A165z',NULL,'Tuberculosis of other male genital organs NOS'),('tuberculosis',1,'A165z00',NULL,'Tuberculosis of other male genital organs NOS'),('tuberculosis',1,'A167.',NULL,'Tuberculosis of other female genital organs'),('tuberculosis',1,'A167.00',NULL,'Tuberculosis of other female genital organs'),('tuberculosis',1,'A167z',NULL,'Tuberculosis of other female genital organs NOS'),('tuberculosis',1,'A167z00',NULL,'Tuberculosis of other female genital organs NOS'),('tuberculosis',1,'A16z.',NULL,'Genitourinary tuberculosis NOS'),('tuberculosis',1,'A16z.00',NULL,'Genitourinary tuberculosis NOS'),('tuberculosis',1,'A17..',NULL,'Tuberculosis of other organs'),('tuberculosis',1,'A17..00',NULL,'Tuberculosis of other organs'),('tuberculosis',1,'A1702',NULL,'Tuberculosis - scrofuloderma'),('tuberculosis',1,'A170200',NULL,'Tuberculosis - scrofuloderma'),('tuberculosis',1,'A1703',NULL,'Tuberculosis - lupus NOS'),('tuberculosis',1,'A170300',NULL,'Tuberculosis - lupus NOS'),('tuberculosis',1,'A1706',NULL,'Tuberculosis lichenoides'),
('tuberculosis',1,'A170600',NULL,'Tuberculosis lichenoides'),('tuberculosis',1,'A1707',NULL,'Tuberculosis papulonecrotica'),('tuberculosis',1,'A170700',NULL,'Tuberculosis papulonecrotica'),('tuberculosis',1,'A1708',NULL,'Tuberculosis verrucosa cutis'),('tuberculosis',1,'A170800',NULL,'Tuberculosis verrucosa cutis'),('tuberculosis',1,'A170z',NULL,'Tuberculosis of skin and subcutaneous tissue NOS'),('tuberculosis',1,'A170z00',NULL,'Tuberculosis of skin and subcutaneous tissue NOS'),('tuberculosis',1,'A171.',NULL,'Tuberculosis with erythema nodosum hypersensitivity reaction'),('tuberculosis',1,'A171.00',NULL,'Tuberculosis with erythema nodosum hypersensitivity reaction'),('tuberculosis',1,'A171z',NULL,'Erythema nodosum with tuberculosis NOS'),('tuberculosis',1,'A171z00',NULL,'Erythema nodosum with tuberculosis NOS'),('tuberculosis',1,'A1720',NULL,'Scrofula - tuberculous cervical lymph nodes'),('tuberculosis',1,'A172000',NULL,'Scrofula - tuberculous cervical lymph nodes'),('tuberculosis',1,'A1721',NULL,'Scrofulous tuberculous abscess'),('tuberculosis',1,'A172100',NULL,'Scrofulous tuberculous abscess'),('tuberculosis',1,'A172z',NULL,'Tuberculosis of peripheral lymph nodes NOS'),('tuberculosis',1,'A172z00',NULL,'Tuberculosis of peripheral lymph nodes NOS'),('tuberculosis',1,'A173.',NULL,'Tuberculosis of eye'),('tuberculosis',1,'A173.00',NULL,'Tuberculosis of eye'),('tuberculosis',1,'A173z',NULL,'Tuberculosis of eye NOS'),('tuberculosis',1,'A173z00',NULL,'Tuberculosis of eye NOS'),('tuberculosis',1,'A174.',NULL,'Tuberculosis of ear'),('tuberculosis',1,'A174.00',NULL,'Tuberculosis of ear'),('tuberculosis',1,'A17y.',NULL,'Tuberculosis of other specified organs'),('tuberculosis',1,'A17y.00',NULL,'Tuberculosis of other specified organs'),('tuberculosis',1,'A17yz',NULL,'Tuberculosis of other specified organs NOS'),('tuberculosis',1,'A17yz00',NULL,'Tuberculosis of other specified organs NOS'),('tuberculosis',1,'A17z.',NULL,'Tuberculosis of other organs NOS'),('tuberculosis',1,'A17z.00',NULL,'Tuberculosis of other organs NOS'),('tuberculosis',1,'A18..',NULL,'Miliary tuberculosis'),('tuberculosis',1,'A18..00',NULL,'Miliary tuberculosis'),('tuberculosis',1,'A180.',NULL,'Acute miliary tuberculosis'),('tuberculosis',1,'A180.00',NULL,'Acute miliary tuberculosis'),('tuberculosis',1,'A1800',NULL,'Acute miliary tuberculosis of a single specified site'),('tuberculosis',1,'A180000',NULL,'Acute miliary tuberculosis of a single specified site'),('tuberculosis',1,'A1801',NULL,'Acute miliary tuberculosis of multiple sites'),('tuberculosis',1,'A180100',NULL,'Acute miliary tuberculosis of multiple sites'),('tuberculosis',1,'A18y.',NULL,'Other specified miliary tuberculosis'),('tuberculosis',1,'A18y.00',NULL,'Other specified miliary tuberculosis'),('tuberculosis',1,'A18z.',NULL,'Miliary tuberculosis NOS'),('tuberculosis',1,'A18z.00',NULL,'Miliary tuberculosis NOS'),('tuberculosis',1,'A1y..',NULL,'Other specified tuberculosis'),('tuberculosis',1,'A1y..00',NULL,'Other specified tuberculosis'),('tuberculosis',1,'A1z..',NULL,'Tuberculosis NOS'),('tuberculosis',1,'A1z..00',NULL,'Tuberculosis NOS'),('tuberculosis',1,'Ayu10',NULL,'[X]Other respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu1000',NULL,'[X]Other respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu11',NULL,'[X]Respiratory tuberculosis unspecified, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu1100',NULL,'[X]Respiratory tuberculosis unspecified, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu12',NULL,'[X]Other respiratory tuberculosis, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu1200',NULL,'[X]Other respiratory tuberculosis, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu13',NULL,'[X]Respiratory tuberculosis unspecified, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu1300',NULL,'[X]Respiratory tuberculosis unspecified, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu14',NULL,'[X]Other tuberculosis of nervous system'),('tuberculosis',1,'Ayu1400',NULL,'[X]Other tuberculosis of nervous system'),('tuberculosis',1,'Ayu15',NULL,'[X]Tuberculosis of nervous system, unspecified'),('tuberculosis',1,'Ayu1500',NULL,'[X]Tuberculosis of nervous system, unspecified'),('tuberculosis',1,'Ayu16',NULL,'[X]Tuberculosis of other specified organs'),('tuberculosis',1,'Ayu1600',NULL,'[X]Tuberculosis of other specified organs'),('tuberculosis',1,'Ayu17',NULL,'[X]Acute miliary tuberculosis, unspecified'),('tuberculosis',1,'Ayu1700',NULL,'[X]Acute miliary tuberculosis, unspecified'),('tuberculosis',1,'Ayu18',NULL,'[X]Other miliary tuberculosis'),('tuberculosis',1,'Ayu1800',NULL,'[X]Other miliary tuberculosis'),('tuberculosis',1,'Ayu19',NULL,'[X]Miliary tuberculosis, unspecified'),('tuberculosis',1,'Ayu1900',NULL,'[X]Miliary tuberculosis, unspecified'),('tuberculosis',1,'G5320',NULL,'Concatos disease'),('tuberculosis',1,'G532000',NULL,'Concatos disease'),('tuberculosis',1,'H510.',NULL,'Pleurisy without effusion or active tuberculosis'),('tuberculosis',1,'H510.00',NULL,'Pleurisy without effusion or active tuberculosis'),('tuberculosis',1,'H510z',NULL,'Pleurisy without effusion or active tuberculosis NOS'),('tuberculosis',1,'H510z00',NULL,'Pleurisy without effusion or active tuberculosis NOS'),('tuberculosis',1,'A1...',NULL,'Tuberculosis'),('tuberculosis',1,'A1...00',NULL,'Tuberculosis'),('tuberculosis',1,'A1200',NULL,'Tuberculosis of pleura'),('tuberculosis',1,'A120000',NULL,'Tuberculosis of pleura'),('tuberculosis',1,'A125X',NULL,'Respiratory tuberculosis unspecified, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'A125X00',NULL,'Respiratory tuberculosis unspecified, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'A13..',NULL,'Tuberculosis of meninges and central nervous system'),('tuberculosis',1,'A13..00',NULL,'Tuberculosis of meninges and central nervous system'),('tuberculosis',1,'A13y.',NULL,'Other specified tuberculosis of central nervous system'),('tuberculosis',1,'A13y.00',NULL,'Other specified tuberculosis of central nervous system'),('tuberculosis',1,'A13z.',NULL,'Tuberculosis of central nervous system NOS'),('tuberculosis',1,'A13z.00',NULL,'Tuberculosis of central nervous system NOS'),('tuberculosis',1,'A14z.',NULL,'Tuberculosis of gastrointestinal tract NOS'),('tuberculosis',1,'A14z.00',NULL,'Tuberculosis of gastrointestinal tract NOS'),('tuberculosis',1,'A15y.',NULL,'Tuberculosis of other specified joint'),('tuberculosis',1,'A15y.00',NULL,'Tuberculosis of other specified joint'),('tuberculosis',1,'A166.',NULL,'Tuberculous oophoritis or salpingitis'),('tuberculosis',1,'A166.00',NULL,'Tuberculous oophoritis or salpingitis'),('tuberculosis',1,'A168.',NULL,'Tuberculosis of urinary tract'),('tuberculosis',1,'A168.00',NULL,'Tuberculosis of urinary tract'),('tuberculosis',1,'A1700',NULL,'Tuberculosis - lupus exedens'),('tuberculosis',1,'A170000',NULL,'Tuberculosis - lupus exedens'),('tuberculosis',1,'A1701',NULL,'Tuberculosis - lupus vulgaris'),('tuberculosis',1,'A170100',NULL,'Tuberculosis - lupus vulgaris'),('tuberculosis',1,'A1704',NULL,'Tuberculosis colliquativa'),('tuberculosis',1,'A170400',NULL,'Tuberculosis colliquativa'),('tuberculosis',1,'A1711',NULL,'Tuberculous erythema nodosum'),('tuberculosis',1,'A171100',NULL,'Tuberculous erythema nodosum'),('tuberculosis',1,'A172.',NULL,'Tuberculosis of peripheral lymph nodes'),('tuberculosis',1,'A172.00',NULL,'Tuberculosis of peripheral lymph nodes'),('tuberculosis',1,'Ayu1.',NULL,'[X]Tuberculosis'),('tuberculosis',1,'Ayu1.00',NULL,'[X]Tuberculosis'),('tuberculosis',1,'Jyu93',NULL,'[X]Tuberculous disorders of intestine and mesentery'),('tuberculosis',1,'Jyu9300',NULL,'[X]Tuberculous disorders of intestine and mesentery'),('tuberculosis',1,'N018.',NULL,'Tuberculous arthritis'),('tuberculosis',1,'N018.00',NULL,'Tuberculous arthritis');
INSERT INTO #codesreadv2
VALUES ('covid-vaccination',1,'65F0.',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'65F0.00',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'65F01',NULL,'Administration of first dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'65F0100',NULL,'Administration of first dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'65F02',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'65F0200',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'65F06',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccination'),('covid-vaccination',1,'65F0600',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccination'),('covid-vaccination',1,'65F07',NULL,'Immunisation course to achieve immunity against SARS-CoV-2'),('covid-vaccination',1,'65F0700',NULL,'Immunisation course to achieve immunity against SARS-CoV-2'),('covid-vaccination',1,'65F08',NULL,'Immunisation course to maintain protection against SARS-CoV-2'),('covid-vaccination',1,'65F0800',NULL,'Immunisation course to maintain protection against SARS-CoV-2'),('covid-vaccination',1,'65F09',NULL,'Administration of third dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'65F0900',NULL,'Administration of third dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'65F0A',NULL,'Administration of fourth dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'65F0A00',NULL,'Administration of fourth dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'9bJ..',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech)'),('covid-vaccination',1,'9bJ..00',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech)');
INSERT INTO #codesreadv2
VALUES ('flu-vaccination',1,'65E..',NULL,'Influenza vaccination'),('flu-vaccination',1,'65E..00',NULL,'Influenza vaccination'),('flu-vaccination',1,'65E0.',NULL,'First pandemic influenza vaccination'),('flu-vaccination',1,'65E0.00',NULL,'First pandemic influenza vaccination'),('flu-vaccination',1,'65E00',NULL,'Administration of first intranasal pandemic influenza vaccination'),('flu-vaccination',1,'65E0000',NULL,'Administration of first intranasal pandemic influenza vaccination'),('flu-vaccination',1,'65E1.',NULL,'Second pandemic influenza vaccination'),('flu-vaccination',1,'65E1.00',NULL,'Second pandemic influenza vaccination'),('flu-vaccination',1,'65E10',NULL,'Administration of second intranasal pandemic influenza vaccination'),('flu-vaccination',1,'65E1000',NULL,'Administration of second intranasal pandemic influenza vaccination'),('flu-vaccination',1,'65E2.',NULL,'Influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2.00',NULL,'Influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E20',NULL,'Seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2000',NULL,'Seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E21',NULL,'First intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2100',NULL,'First intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E22',NULL,'Second intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2200',NULL,'Second intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E23',NULL,'Second intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2300',NULL,'Second intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E24',NULL,'First intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E2400',NULL,'First intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E3.',NULL,'First pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E3.00',NULL,'First pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E30',NULL,'First intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E3000',NULL,'First intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E4.',NULL,'Second pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E4.00',NULL,'Second pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E40',NULL,'Second intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E4000',NULL,'Second intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'65E5.',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65E5.00',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65E6.',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65E6.00',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65E7.',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65E7.00',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65E8.',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65E8.00',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65E9.',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65E9.00',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65EA.',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65EA.00',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'65EB.',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65EB.00',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65EC.',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65EC.00',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'65ED.',NULL,'Seasonal influenza vaccination'),('flu-vaccination',1,'65ED.00',NULL,'Seasonal influenza vaccination'),('flu-vaccination',1,'65ED0',NULL,'Seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED000',NULL,'Seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED1',NULL,'Administration of first intranasal seasonal influenza vaccination'),('flu-vaccination',1,'65ED100',NULL,'Administration of first intranasal seasonal influenza vaccination'),('flu-vaccination',1,'65ED2',NULL,'Seasonal influenza vaccination given while hospital inpatient'),('flu-vaccination',1,'65ED200',NULL,'Seasonal influenza vaccination given while hospital inpatient'),('flu-vaccination',1,'65ED3',NULL,'Administration of second intranasal seasonal influenza vaccination'),('flu-vaccination',1,'65ED300',NULL,'Administration of second intranasal seasonal influenza vaccination'),('flu-vaccination',1,'65ED4',NULL,'Administration of first inactivated seasonal influenza vaccination'),('flu-vaccination',1,'65ED400',NULL,'Administration of first inactivated seasonal influenza vaccination'),('flu-vaccination',1,'65ED5',NULL,'Administration of second inactivated seasonal influenza vaccination'),('flu-vaccination',1,'65ED500',NULL,'Administration of second inactivated seasonal influenza vaccination'),('flu-vaccination',1,'65ED6',NULL,'First intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED600',NULL,'First intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED7',NULL,'Second intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED700',NULL,'Second intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED8',NULL,'First inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED800',NULL,'First inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED9',NULL,'Second inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65ED900',NULL,'Second inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'65EE.',NULL,'Administration of intranasal influenza vaccination'),('flu-vaccination',1,'65EE.00',NULL,'Administration of intranasal influenza vaccination'),('flu-vaccination',1,'65EE0',NULL,'Administration of first intranasal influenza vaccination'),('flu-vaccination',1,'65EE000',NULL,'Administration of first intranasal influenza vaccination'),('flu-vaccination',1,'65EE1',NULL,'Administration of second intranasal influenza vaccination'),('flu-vaccination',1,'65EE100',NULL,'Administration of second intranasal influenza vaccination'),('flu-vaccination',1,'ZV048',NULL,'[V]Influenza vaccination'),('flu-vaccination',1,'ZV04800',NULL,'[V]Influenza vaccination');
INSERT INTO #codesreadv2
VALUES ('pneumococcal-vaccination',1,'65720',NULL,'Pneumococcal vaccination given'),('pneumococcal-vaccination',1,'6572000',NULL,'Pneumococcal vaccination given'),('pneumococcal-vaccination',1,'657R.',NULL,'Supplemental pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657R.00',NULL,'Supplemental pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657P.',NULL,'Pneumococcal vaccination given by other healthcare provider'),('pneumococcal-vaccination',1,'657P.00',NULL,'Pneumococcal vaccination given by other healthcare provider'),('pneumococcal-vaccination',1,'657N.',NULL,'Third pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657N.00',NULL,'Third pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657M.',NULL,'Second pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657M.00',NULL,'Second pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657L.',NULL,'First pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657L.00',NULL,'First pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'657K.',NULL,'Booster pneumococcal vaccination'),('pneumococcal-vaccination',1,'657K.00',NULL,'Booster pneumococcal vaccination'),('pneumococcal-vaccination',1,'6572.',NULL,'Pneumococcal vaccination'),('pneumococcal-vaccination',1,'6572.00',NULL,'Pneumococcal vaccination'),('pneumococcal-vaccination',1,'7L197',NULL,'Subcutaneous injection of Pneumovax II'),('pneumococcal-vaccination',1,'7L19700',NULL,'Subcutaneous injection of Pneumovax II'),('pneumococcal-vaccination',1,'n4b2.',NULL,'*PNEUMOVAX II injection 0.5mL'),('pneumococcal-vaccination',1,'n4b2.00',NULL,'*PNEUMOVAX II injection 0.5mL'),('pneumococcal-vaccination',1,'n4b7.',NULL,'PREVENAR 13 vaccine prefilled syringe 0.5mL'),('pneumococcal-vaccination',1,'n4b7.00',NULL,'PREVENAR 13 vaccine prefilled syringe 0.5mL');
INSERT INTO #codesreadv2
VALUES ('shingles-vaccination',1,'65FY.',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'65FY.00',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'65FY0',NULL,'Herpes zoster vaccination given by other health care provider'),('shingles-vaccination',1,'65FY000',NULL,'Herpes zoster vaccination given by other health care provider'),('shingles-vaccination',1,'n4v1.',NULL,'VARICELLA-ZOSTER live attenuated vaccine injection(pdr for recon)+solvent'),('shingles-vaccination',1,'n4v1.00',NULL,'VARICELLA-ZOSTER live attenuated vaccine injection(pdr for recon)+solvent'),('shingles-vaccination',1,'n4v4.',NULL,'ZOSTAVAX pdr+solvent for suspension for injection pfs 0.65mL'),('shingles-vaccination',1,'n4v4.00',NULL,'ZOSTAVAX pdr+solvent for suspension for injection pfs 0.65mL')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesreadv2;

IF OBJECT_ID('tempdb..#codesctv3') IS NOT NULL DROP TABLE #codesctv3;
CREATE TABLE #codesctv3 (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesctv3
VALUES ('sle',1,'F3710',NULL,'Polyneuropathy in disseminated lupus erythematosus'),('sle',1,'F3961',NULL,'Myopathy due to disseminated lupus erythematosus'),('sle',1,'F4D33',NULL,'Discoid lupus eyelid'),('sle',1,'H57y4',NULL,'Lung disease with systemic lupus erythematosus'),('sle',1,'K01x4',NULL,'(Nephr synd in system lupus erythemat) or (lupus nephritis]'),('sle',1,'M154.',NULL,'Lupus erythematosus'),('sle',1,'M1540',NULL,'Lupus erythematosus chronicus'),('sle',1,'M1541',NULL,'Discoid lupus erythematosus'),('sle',1,'M1542',NULL,'Lupus erythematosus migrans'),('sle',1,'M1543',NULL,'Lupus erythematosus nodularis'),('sle',1,'M1544',NULL,'Lupus erythematosus profundus'),('sle',1,'M1545',NULL,'Lupus erythematosus tumidus'),('sle',1,'M1546',NULL,'Lupus erythematosus unguium mutilans'),('sle',1,'M154z',NULL,'Lupus erythematosus NOS'),('sle',1,'Myu78',NULL,'[X]Other local lupus erythematosus'),('sle',1,'N000.',NULL,'Systemic lupus erythematosus'),('sle',1,'N0002',NULL,'Drug-induced systemic lupus erythematosus'),('sle',1,'N000z',NULL,'Systemic lupus erythematosus NOS'),('sle',1,'Nyu43',NULL,'[X]Other forms of systemic lupus erythematosus'),('sle',1,'X00Dx',NULL,'Cerebral lupus'),('sle',1,'X30Kn',NULL,'Lupus nephritis - WHO Class I'),('sle',1,'X30Ko',NULL,'Lupus nephritis - WHO Class II'),('sle',1,'X30Kp',NULL,'Lupus nephritis - WHO Class III'),('sle',1,'X30Kq',NULL,'Lupus nephritis - WHO Class IV'),('sle',1,'X30Kr',NULL,'Lupus nephritis - WHO Class V'),('sle',1,'X30Ks',NULL,'Lupus nephritis - WHO Class VI'),('sle',1,'X50Ew',NULL,'Lupus erythematosus and erythema multiforme-like syndrome'),('sle',1,'X50Ex',NULL,'Chronic discoid lupus erythematosus'),('sle',1,'X50Ez',NULL,'Chilblain lupus erythematosus'),('sle',1,'X704W',NULL,'Limited lupus erythematosus'),('sle',1,'X704X',NULL,'Systemic lupus erythematosus with organ/system involvement'),('sle',1,'X704a',NULL,'Lupus panniculitis'),('sle',1,'X704b',NULL,'Bullous systemic lupus erythematosus'),('sle',1,'X704c',NULL,'Systemic lupus erythematosus with multisystem involvement'),('sle',1,'X704d',NULL,'Cutaneous lupus erythematosus'),('sle',1,'X704g',NULL,'Neonatal lupus erythematosus'),('sle',1,'X704h',NULL,'Subacute cutaneous lupus erythematosus'),('sle',1,'XE0da',NULL,'Lupus nephritis'),('sle',1,'XM197',NULL,'[EDTA] Lupus erythematosus associated with renal failure'),('sle',1,'XaBE1',NULL,'Renal tubulo-interstitial disord in systemic lupus erythemat'),('sle',1,'XaC1J',NULL,'Systemic lupus erythematosus with pericarditis'),('sle',1,'X0046',NULL,'Chorea in systemic lupus erythematosus'),('sle',1,'X1038',NULL,'Lupus pneumonia'),('sle',1,'X705w',NULL,'Lupus vasculitis');
INSERT INTO #codesctv3
VALUES ('tuberculosis',1,'A1...',NULL,'Tuberculosis'),('tuberculosis',1,'A10..',NULL,'Primary tuberculous infection'),('tuberculosis',1,'A100.',NULL,'Primary tuberculous complex'),('tuberculosis',1,'A101.',NULL,'Tuberculous pleurisy in primary progressive tuberculosis'),('tuberculosis',1,'A10y.',NULL,'Other primary progressive tuberculosis'),('tuberculosis',1,'A10z.',NULL,'Primary tuberculous infection NOS'),('tuberculosis',1,'A11..',NULL,'Pulmonary tuberculosis'),('tuberculosis',1,'A110.',NULL,'Infiltrative lung tuberculosis'),('tuberculosis',1,'A111.',NULL,'Nodular lung tuberculosis'),('tuberculosis',1,'A113.',NULL,'Tuberculosis of bronchus'),('tuberculosis',1,'A115.',NULL,'Tuberculous bronchiectasis'),('tuberculosis',1,'A116.',NULL,'Tuberculous pneumonia'),('tuberculosis',1,'A117.',NULL,'Tuberculous pneumothorax'),('tuberculosis',1,'A11y.',NULL,'Other specified pulmonary tuberculosis'),('tuberculosis',1,'A11z.',NULL,'Pulmonary tuberculosis NOS'),('tuberculosis',1,'A12..',NULL,'Other respiratory tuberculosis'),('tuberculosis',1,'A120.',NULL,'Tuberculosis of pleura'),('tuberculosis',1,'A1201',NULL,'Tuberculous empyema (& pleural)'),('tuberculosis',1,'A1202',NULL,'Tuberculous hydrothorax'),('tuberculosis',1,'A120z',NULL,'Tuberculous pleurisy NOS'),('tuberculosis',1,'A121.',NULL,'Tuberculosis of intrathoracic lymph nodes'),('tuberculosis',1,'A1210',NULL,'Tuberculosis of hilar lymph nodes'),('tuberculosis',1,'A1211',NULL,'Tuberculosis of mediastinal lymph nodes'),('tuberculosis',1,'A1212',NULL,'Tuberculosis of tracheobronchial lymph nodes'),('tuberculosis',1,'A121z',NULL,'Tuberculosis of intrathoracic lymph nodes NOS'),('tuberculosis',1,'A122.',NULL,'Isolated tracheal or bronchial tuberculosis'),('tuberculosis',1,'A1220',NULL,'Isolated tracheal tuberculosis'),('tuberculosis',1,'A1221',NULL,'Isolated bronchial tuberculosis'),('tuberculosis',1,'A122z',NULL,'Isolated tracheal or bronchial tuberculosis NOS'),('tuberculosis',1,'A123.',NULL,'Laryngeal tuberculosis'),('tuberculosis',1,'A124.',NULL,'Respiratory tuberculosis, bacteriologically and histologically confirmed'),('tuberculosis',1,'A1240',NULL,'Tuberculosis of lung, confirmed by sputum microscopy with or without culture'),('tuberculosis',1,'A1241',NULL,'Tuberculosis of lung, confirmed by culture only'),('tuberculosis',1,'A1242',NULL,'Tuberculosis of lung, confirmed histologically'),('tuberculosis',1,'A1243',NULL,'Tuberculosis of lung, confirmed by unspecified means'),('tuberculosis',1,'A1244',NULL,'Tuberculosis of intrathoracic lymph nodes, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1245',NULL,'Tuberculosis of larynx, trachea and bronchus, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1246',NULL,'Tuberculous pleurisy, confirmed bacteriologically and histologically'),('tuberculosis',1,'A1247',NULL,'Primary respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'A125.',NULL,'Respiratory tuberculosis, not confirmed bacteriologically or histologically'),('tuberculosis',1,'A1250',NULL,'Tuberculosis of lung, bacteriologically and histologically negative'),('tuberculosis',1,'A1251',NULL,'Tuberculosis of lung, bacteriological and histological examination not done'),('tuberculosis',1,'A1252',NULL,'Primary respiratory tuberculosis without mention of bacteriological or histological confirmation'),('tuberculosis',1,'A12y.',NULL,'Other specified respiratory tuberculosis'),('tuberculosis',1,'A12y0',NULL,'Tuberculosis of mediastinum'),('tuberculosis',1,'A12y1',NULL,'Tuberculosis of nasopharynx'),('tuberculosis',1,'A12y2',NULL,'Tuberculosis of nasal septum'),('tuberculosis',1,'A12y3',NULL,'Tuberculosis of nasal sinus'),('tuberculosis',1,'A12yz',NULL,'Other specified respiratory tuberculosis NOS'),('tuberculosis',1,'A13..',NULL,'Tuberculosis of meninges and central nervous system'),('tuberculosis',1,'A13y.',NULL,'Other specified tuberculosis of central nervous system'),('tuberculosis',1,'A13z.',NULL,'Tuberculosis of central nervous system NOS'),('tuberculosis',1,'A14..',NULL,'Tuberculosis of intestines, peritoneum and mesenteric glands'),('tuberculosis',1,'A14y.',NULL,'Other gastrointestinal tract tuberculosis'),('tuberculosis',1,'A14y5',NULL,'Tuberculosis of retroperitoneal lymph nodes'),('tuberculosis',1,'A14yz',NULL,'Other gastrointestinal tract tuberculosis NOS'),('tuberculosis',1,'A14z.',NULL,'Tuberculosis of gastrointestinal tract NOS'),('tuberculosis',1,'A15y.',NULL,'Tuberculosis of other specified joint'),('tuberculosis',1,'A15z.',NULL,'Tuberculosis of bones or joints NOS'),('tuberculosis',1,'A16..',NULL,'Urogenital tuberculosis'),('tuberculosis',1,'A163.',NULL,'Tuberculosis of other urinary organs'),('tuberculosis',1,'A165.',NULL,'Tuberculosis of other male genital organs'),('tuberculosis',1,'A165z',NULL,'Tuberculosis of other male genital organs NOS'),('tuberculosis',1,'A166.',NULL,'Tuberculous oophoritis or salpingitis'),('tuberculosis',1,'A167.',NULL,'Tuberculosis of other female genital organs'),('tuberculosis',1,'A167z',NULL,'Tuberculosis of other female genital organs NOS'),('tuberculosis',1,'A16z.',NULL,'Genitourinary tuberculosis NOS'),('tuberculosis',1,'A17..',NULL,'Tuberculosis of other organs'),('tuberculosis',1,'A1700',NULL,'Lupus vulgaris'),('tuberculosis',1,'A1703',NULL,'Tuberculosis - lupus NOS'),('tuberculosis',1,'A1706',NULL,'Lichen scrofulosorum'),('tuberculosis',1,'A1707',NULL,'Tuberculosis papulonecrotica'),('tuberculosis',1,'A1708',NULL,'Tuberculosis verrucosa cutis'),('tuberculosis',1,'A170z',NULL,'Tuberculosis of skin and subcutaneous tissue NOS'),('tuberculosis',1,'A171.',NULL,'Tuberculous erythema nodosum'),('tuberculosis',1,'A171z',NULL,'Erythema nodosum with tuberculosis NOS'),('tuberculosis',1,'A1720',NULL,'Tuberculous cervical lymphadenitis'),('tuberculosis',1,'A1721',NULL,'Scrofulous tuberculous abscess'),('tuberculosis',1,'A172z',NULL,'Tuberculosis of peripheral lymph nodes NOS'),('tuberculosis',1,'A173.',NULL,'Ocular tuberculosis'),('tuberculosis',1,'A173z',NULL,'Tuberculosis of eye NOS'),('tuberculosis',1,'A174.',NULL,'Tuberculosis of ear'),('tuberculosis',1,'A17y.',NULL,'Tuberculosis of other specified organs'),('tuberculosis',1,'A17yz',NULL,'Tuberculosis of other specified organs NOS'),('tuberculosis',1,'A17z.',NULL,'Tuberculosis of other organs NOS'),('tuberculosis',1,'A18..',NULL,'Miliary tuberculosis'),('tuberculosis',1,'A180.',NULL,'Acute miliary tuberculosis'),('tuberculosis',1,'A1800',NULL,'Acute miliary tuberculosis of a single specified site'),('tuberculosis',1,'A1801',NULL,'Acute miliary tuberculosis of multiple sites'),('tuberculosis',1,'A18y.',NULL,'Other specified miliary tuberculosis'),('tuberculosis',1,'A18z.',NULL,'Miliary tuberculosis NOS'),('tuberculosis',1,'A1y..',NULL,'Other specified tuberculosis'),('tuberculosis',1,'A1z..',NULL,'Tuberculosis NOS'),('tuberculosis',1,'Ayu10',NULL,'[X]Other respiratory tuberculosis, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu11',NULL,'[X]Respiratory tuberculosis unspecified, confirmed bacteriologically and histologically'),('tuberculosis',1,'Ayu12',NULL,'[X]Other respiratory tuberculosis, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu13',NULL,'[X]Respiratory tuberculosis unspecified, without mention of bacteriological or histological confirmation'),('tuberculosis',1,'Ayu14',NULL,'[X]Other tuberculosis of nervous system'),('tuberculosis',1,'Ayu15',NULL,'[X]Tuberculosis of nervous system, unspecified'),('tuberculosis',1,'Ayu16',NULL,'[X]Tuberculosis of other specified organs'),('tuberculosis',1,'Ayu17',NULL,'[X]Acute miliary tuberculosis, unspecified'),('tuberculosis',1,'Ayu18',NULL,'[X]Other miliary tuberculosis'),('tuberculosis',1,'Ayu19',NULL,'[X]Miliary tuberculosis, unspecified'),('tuberculosis',1,'G5320',NULL,'Concatos disease'),('tuberculosis',1,'H510.',NULL,'Pleurisy without effusion or active tuberculosis'),('tuberculosis',1,'H510z',NULL,'Pleurisy without effusion or active tuberculosis NOS'),('tuberculosis',1,'Jyu93',NULL,'[X]Tuberculous disorders of intestine and mesentery'),('tuberculosis',1,'X70Gw',NULL,'Primary progressive tuberculosis'),('tuberculosis',1,'X70H0',NULL,'Tuberculosis of gastrointestinal tract'),('tuberculosis',1,'X70H8',NULL,'Tuberculosis of male genital organs'),('tuberculosis',1,'X70H9',NULL,'Tuberculosis of female genital organs'),('tuberculosis',1,'Xa1p4',NULL,'Urinary tuberculosis'),('tuberculosis',1,'Xa97Y',NULL,'Tuberculosis of trachea'),('tuberculosis',1,'XE0Qr',NULL,'Tuberculosis of bones and joints'),('tuberculosis',1,'XE0T4',NULL,'Tuberculosis of kidney with other genitourinary organ'),('tuberculosis',1,'XE2aj',NULL,'Tuberculosis of peripheral lymph nodes'),('tuberculosis',1,'XE2uC',NULL,'Tuberculosis of skin and subcutaneous tissue'),('tuberculosis',1,'XE2wL',NULL,'Tuberculous pleural empyema'),('tuberculosis',1,'XSCD2',NULL,'Tuberculosis of central nervous system');
INSERT INTO #codesctv3
VALUES ('covid-vaccination',1,'Y210d',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'Y29e7',NULL,'Administration of first dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'Y29e8',NULL,'Administration of second dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'Y2a0e',NULL,'SARS-2 Coronavirus vaccine'),('covid-vaccination',1,'Y2a0f',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech) part 1'),('covid-vaccination',1,'Y2a3a',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech) part 2'),('covid-vaccination',1,'65F06',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccination'),('covid-vaccination',1,'65F09',NULL,'Administration of third dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'65F0A',NULL,'Administration of fourth dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'9bJ..',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech)'),('covid-vaccination',1,'Y2a10',NULL,'COVID-19 Vac AstraZeneca (ChAdOx1 S recomb) 5x10000000000 viral particles/0.5ml dose sol for inj MDV part 1'),('covid-vaccination',1,'Y2a39',NULL,'COVID-19 Vac AstraZeneca (ChAdOx1 S recomb) 5x10000000000 viral particles/0.5ml dose sol for inj MDV part 2'),('covid-vaccination',1,'Y2b9d',NULL,'COVID-19 mRNA (nucleoside modified) Vaccine Moderna 0.1mg/0.5mL dose dispersion for injection multidose vials part 2'),('covid-vaccination',1,'Y2f45',NULL,'Administration of third dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'Y2f48',NULL,'Administration of fourth dose of SARS-CoV-2 vaccine'),('covid-vaccination',1,'Y2f57',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech) booster'),('covid-vaccination',1,'Y31cc',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) antigen vaccination'),('covid-vaccination',1,'Y31e6',NULL,'Administration of SARS-CoV-2 mRNA vaccine'),('covid-vaccination',1,'Y31e7',NULL,'Administration of first dose of SARS-CoV-2 mRNA vaccine'),('covid-vaccination',1,'Y31e8',NULL,'Administration of second dose of SARS-CoV-2 mRNA vaccine');
INSERT INTO #codesctv3
VALUES ('flu-vaccination',1,'65E..',NULL,'Influenza vaccination'),('flu-vaccination',1,'Xaa9G',NULL,'Administration of intranasal influenza vaccination'),('flu-vaccination',1,'Xaac1',NULL,'Administration of first intranasal pandemic influenza vaccination'),('flu-vaccination',1,'Xaac2',NULL,'Administration of second intranasal pandemic influenza vaccination'),('flu-vaccination',1,'Xaac3',NULL,'Administration of first intranasal seasonal influenza vaccination'),('flu-vaccination',1,'Xaac4',NULL,'Administration of second intranasal seasonal influenza vaccination'),('flu-vaccination',1,'Xaac5',NULL,'First intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'Xaac6',NULL,'Second intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'Xaac7',NULL,'First intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'Xaac8',NULL,'Second intranasal seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'XaaED',NULL,'Administration of first intranasal influenza vaccination'),('flu-vaccination',1,'XaaEF',NULL,'Administration of second intranasal influenza vaccination'),('flu-vaccination',1,'XaaZp',NULL,'Seasonal influenza vaccination given while hospital inpatient'),('flu-vaccination',1,'XabvT',NULL,'Second intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'Xac5J',NULL,'First intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'Xad9j',NULL,'Administration of first inactivated seasonal influenza vaccination'),('flu-vaccination',1,'Xad9k',NULL,'Administration of second inactivated seasonal influenza vaccination'),('flu-vaccination',1,'Xaeet',NULL,'First intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'Xaeeu',NULL,'Second intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'Xaeev',NULL,'First inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'Xaeew',NULL,'Second inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'XafhP',NULL,'Seasonal influenza vaccination given by midwife'),('flu-vaccination',1,'XafhQ',NULL,'First inactivated seasonal influenza vaccination given by midwife'),('flu-vaccination',1,'XafhR',NULL,'Second inactivated seasonal influenza vaccination given by midwife'),('flu-vaccination',1,'XaLK4',NULL,'Booster influenza vaccination'),('flu-vaccination',1,'XaLNG',NULL,'First pandemic influenza vaccination'),('flu-vaccination',1,'XaLNH',NULL,'Second pandemic influenza vaccination'),('flu-vaccination',1,'XaPwi',NULL,'First pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'XaPwj',NULL,'Second pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'XaPyT',NULL,'Influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'XaQhk',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'XaQhl',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'XaQhm',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'XaQhn',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'XaQho',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'XaQhp',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'XaQhq',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'XaQhr',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'XaZ0d',NULL,'Seasonal influenza vaccination'),('flu-vaccination',1,'XaZ0e',NULL,'Seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'XaZfY',NULL,'Seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'ZV048',NULL,'[V]Flu - influenza vaccination'),('flu-vaccination',1,'Y0c3f',NULL,'First influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'Y0c40',NULL,'Second influenza A (H1N1v) 2009 vaccination given');
INSERT INTO #codesctv3
VALUES ('pneumococcal-vaccination',1,'6572.',NULL,'Pneumococcal vaccination'),('pneumococcal-vaccination',1,'XaYvC',NULL,'Supplemental pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'XaLqu',NULL,'Third pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'XaLqt',NULL,'Second pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'XaLqs',NULL,'First pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'XaIeO',NULL,'Booster pneumococcal vaccination'),('pneumococcal-vaccination',1,'XaPyX',NULL,'Pneumococcal vaccination given by other healthcare provider'),('pneumococcal-vaccination',1,'XaCKa',NULL,'Pneumococcal vaccination given'),('pneumococcal-vaccination',1,'XaBZP',NULL,'Subcutaneous injection of Pneumovax II'),('pneumococcal-vaccination',1,'n4b2.',NULL,'Pneumovax II injection 0.5mL'),('pneumococcal-vaccination',1,'n4b7.',NULL,'PREVENAR 13 vaccine prefilled syringe 0.5mL'),('pneumococcal-vaccination',1,'x03kp',NULL,'Pnu-Imune vaccine injection');
INSERT INTO #codesctv3
VALUES ('shingles-vaccination',1,'Xaa9g',NULL,'Herpes zoster vaccination given by other health care provider'),('shingles-vaccination',1,'Xaa9g',NULL,'Herpes zoster vaccination given by other health care provider'),('shingles-vaccination',1,'XaZsM',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'XaZsM',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'XaZsM',NULL,'Shingles vaccination'),('shingles-vaccination',1,'n4v1.',NULL,'Varicella-zoster live attenuated vaccine injection (pdr for recon)+solvent'),('shingles-vaccination',1,'n4v4.',NULL,'ZOSTAVAX pdr+solvent for suspension for injection pfs 0.65mL')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesctv3;

IF OBJECT_ID('tempdb..#codessnomed') IS NOT NULL DROP TABLE #codessnomed;
CREATE TABLE #codessnomed (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codessnomed
VALUES ('sle',1,'11013005',NULL,'SLE glomerulonephritis syndrome, WHO class VI (disorder)'),('sle',1,'15084002',NULL,'Lupus erythematosus profundus (disorder)'),('sle',1,'193178008',NULL,'Polyneuropathy in disseminated lupus erythematosus (disorder)'),('sle',1,'193248005',NULL,'Myopathy due to disseminated lupus erythematosus (disorder)'),('sle',1,'196138005',NULL,'Lung disease with systemic lupus erythematosus (disorder)'),('sle',1,'200936003',NULL,'Lupus erythematosus (disorder)'),('sle',1,'200937007',NULL,'Lupus erythematosus chronicus (disorder)'),('sle',1,'200938002',NULL,'Discoid lupus erythematosus (disorder)'),('sle',1,'200939005',NULL,'Lupus erythematosus migrans (disorder)'),('sle',1,'200940007',NULL,'Lupus erythematosus nodularis (disorder)'),('sle',1,'200941006',NULL,'Lupus erythematosus tumidus (disorder)'),('sle',1,'200942004',NULL,'Lupus erythematosus unguium mutilans (disorder)'),('sle',1,'201436003',NULL,'Drug-induced systemic lupus erythematosus (disorder)'),('sle',1,'238926009',NULL,'Lupus erythematosus and erythema multiforme-like syndrome (disorder)'),('sle',1,'238927000',NULL,'Chronic discoid lupus erythematosus (disorder)'),('sle',1,'238928005',NULL,'Chilblain lupus erythematosus (disorder)'),('sle',1,'239886003',NULL,'Limited lupus erythematosus (disorder)'),('sle',1,'239887007',NULL,'Systemic lupus erythematosus with organ/system involvement (disorder)'),('sle',1,'239888002',NULL,'Lupus panniculitis (disorder)'),('sle',1,'239889005',NULL,'Bullous systemic lupus erythematosus (disorder)'),('sle',1,'239890001',NULL,'Systemic lupus erythematosus with multisystem involvement (disorder)'),('sle',1,'239891002',NULL,'Subacute cutaneous lupus erythematosus (disorder)'),('sle',1,'307755009',NULL,'Renal tubulo-interstitial disorder in systemic lupus erythematosus (disorder)'),('sle',1,'309762007',NULL,'Systemic lupus erythematosus with pericarditis (disorder)'),('sle',1,'36402006',NULL,'SLE glomerulonephritis syndrome, WHO class IV (disorder)'),('sle',1,'4676006',NULL,'SLE glomerulonephritis syndrome, WHO class II (disorder)'),('sle',1,'52042003',NULL,'SLE glomerulonephritis syndrome, WHO class V (disorder)'),('sle',1,'55464009',NULL,'Systemic lupus erythematosus (disorder)'),('sle',1,'68815009',NULL,'SLE glomerulonephritis syndrome (disorder)'),('sle',1,'7119001',NULL,'Cutaneous lupus erythematosus (disorder)'),('sle',1,'73286009',NULL,'SLE glomerulonephritis syndrome, WHO class I (disorder)'),('sle',1,'76521009',NULL,'SLE glomerulonephritis syndrome, WHO class III (disorder)'),('sle',1,'79291003',NULL,'Discoid lupus erythematosus of eyelid (disorder)'),('sle',1,'95609003',NULL,'Neonatal lupus erythematosus (disorder)'),('sle',1,'95644001',NULL,'Systemic lupus erythematosus encephalitis (disorder)'),('sle',1,'758321000000100',NULL,'Cerebral lupus'),('sle',1,'1144942002',NULL,'Neuropsychiatric disorder due to systemic lupus erythematosus (disorder)'),('sle',1,'403508004',NULL,'Lupus erythematosus-associated nailfold telangiectasia (disorder)'),('sle',1,'1220590003',NULL,'Familial chilblain lupus erythematosus (disorder)'),('sle',1,'239944008',NULL,'Lupus vasculitis (disorder)'),('sle',1,'1144973003',NULL,'Disorder of kidney due to systemic lupus erythematosus (disorder)'),('sle',1,'430961000124105',NULL,'Cheilitis due to lupus erythematosus (disorder)'),('sle',1,'403512005',NULL,'Lupus erythematosus-associated poikiloderma (disorder)'),('sle',1,'274553000',NULL,'[EDTA] Lupus erythematosus associated with renal failure (disorder)'),('sle',1,'590791000000108',NULL,'Lupus erythematosus NOS (disorder)'),('sle',1,'403511003',NULL,'Lupus erythematosus-associated necrotizing vasculitis (disorder)'),('sle',1,'593481000000109',NULL,'Systemic lupus erythematosus NOS (disorder)'),('sle',1,'1144921004',NULL,'Disorder of heart due to systemic lupus erythematosus (disorder)'),('sle',1,'403507009',NULL,'Lupus erythematosus-associated hypermelanosis (disorder)'),('sle',1,'233730002',NULL,'Lupus pneumonia (disorder)'),('sle',1,'25380002',NULL,'Pericarditis co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'1144970000',NULL,'Disorder of joint due to systemic lupus erythematosus (disorder)'),('sle',1,'95332009',NULL,'Rash of systemic lupus erythematosus (disorder)'),('sle',1,'403513000',NULL,'Lupus erythematosus-associated nail dystrophy (disorder)'),('sle',1,'77753005',NULL,'Lupus disease of the lung (disorder)'),('sle',1,'707301001',NULL,'Lupus erythematosus of oral mucous membrane (disorder)'),('sle',1,'724767000',NULL,'Chorea co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'1144923001',NULL,'Disorder of immune function due to systemic lupus erythematosus (disorder)'),('sle',1,'773333003',NULL,'Autosomal systemic lupus erythematosus (disorder)'),('sle',1,'201435004',NULL,'Systemic lupus erythematosus (disorder)'),('sle',1,'200944003',NULL,'Lupus erythematosus NOS (disorder)'),('sle',1,'905381000000108',NULL,'Systemic lupus erythematosus/Sjogrens overlap syndrome (disorder)'),('sle',1,'403488004',NULL,'Systemic lupus erythematosus of childhood (disorder)'),('sle',1,'201439005',NULL,'Systemic lupus erythematosus NOS (disorder)'),('sle',1,'156450004',NULL,'Systemic lupus erythematosus (disorder)'),('sle',1,'1263518006',NULL,'Meningitis due to systemic lupus erythematosus (disorder)'),('sle',1,'203784000',NULL,'[X]Other forms of systemic lupus erythematosus (disorder)'),('sle',1,'197608009',NULL,'(Nephrotic syndrome in systemic lupus erythematosus) or (lupus nephritis) (disorder)'),('sle',1,'403505001',NULL,'Lupus erythematosus-associated calcinosis (disorder)'),('sle',1,'201437007',NULL,'Systemic lupus erythematosus with organ/system involvement (disorder)'),('sle',1,'1263491001',NULL,'Myelitis due to systemic lupus erythematosus (disorder)'),('sle',1,'403509007',NULL,'Lupus erythematosus-associated vasculitis (disorder)'),('sle',1,'1144927000',NULL,'Disorder of gastrointestinal tract due to systemic lupus erythematosus (disorder)'),('sle',1,'95408003',NULL,'Systemic lupus erythematosus arthritis (disorder)'),('sle',1,'403503008',NULL,'Lupus erythematosus-associated anetoderma (disorder)'),('sle',1,'403510002',NULL,'Lupus erythematosus-associated urticarial vasculitis (disorder)'),('sle',1,'19682006',NULL,'Lupus hepatitis (disorder)'),('sle',1,'732960002',NULL,'Secondary autoimmune hemolytic anemia co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'402711009',NULL,'Lupus erythematosus overlap syndrome (disorder)'),('sle',1,'698694005',NULL,'Systemic lupus erythematosus in remission (disorder)'),('sle',1,'724781003',NULL,'Demyelination of central nervous system co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'295121000119101',NULL,'Nephrosis co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'403506000',NULL,'Lupus erythematosus-associated papulonodular mucinosis (disorder)'),('sle',1,'69746005',NULL,'Hemolytic anemia associated with systemic lupus erythematosus (disorder)'),('sle',1,'295111000119108',NULL,'Nephrotic syndrome co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'295101000119105',NULL,'Nephropathy co-occurrent and due to systemic lupus erythematosus (disorder)'),('sle',1,'197746009',NULL,'Renal tubulo-interstitial disorder in systemic lupus erythematosus (disorder)'),('sle',1,'308751000119106',NULL,'Glomerular disease due to systemic lupus erythematosus (disorder)'),('sle',1,'36471000',NULL,'Dilated cardiomyopathy due to systemic lupus erythematosus (disorder)'),('sle',1,'201438002',NULL,'Systemic lupus erythematosus with pericarditis (disorder)'),('sle',1,'417303004',NULL,'Retinal vasculitis due to systemic lupus erythematosus (disorder)'),('sle',1,'403487009',NULL,'Fulminating systemic lupus erythematosus (disorder)'),('sle',1,'409421000000100',NULL,'[X]Other forms of systemic lupus erythematosus (disorder)'),('sle',1,'1259517005',NULL,'Dementia due to systemic lupus erythematosus (disorder)'),('sle',1,'230307005',NULL,'Chorea due to systemic lupus erythematosus (disorder)'),('sle',1,'713225000',NULL,'Gingival disease due to lupus erythematosus (disorder)'),('sle',1,'403486000',NULL,'Acute systemic lupus erythematosus (disorder)'),('sle',1,'72181000119109',NULL,'Endocarditis due to systemic lupus erythematosus (disorder)'),('sle',1,'417161000000107',NULL,'Lupus erythematosus associated with renal failure - European Dialysis and Transplant Association (disorder)'),('sle',1,'80258006',NULL,'Drug-induced lupus erythematosus (disorder)'),('sle',1,'397856003',NULL,'Systemic lupus erythematosus-related syndrome (disorder)'),('sle',1,'402865003',NULL,'Systemic lupus erythematosus-associated antiphospholipid syndrome (disorder)');
INSERT INTO #codessnomed
VALUES ('tuberculosis',1,'10528009',NULL,'Lupus vulgaris (disorder)'),('tuberculosis',1,'10706006',NULL,'Tuberculosis of central nervous system (disorder)'),('tuberculosis',1,'111830007',NULL,'Tuberculosis of urinary organs (disorder)'),('tuberculosis',1,'111832004',NULL,'Primary progressive tuberculosis (disorder)'),('tuberculosis',1,'14527007',NULL,'Tuberculous empyema (disorder)'),('tuberculosis',1,'154283005',NULL,'Pulmonary tuberculosis'),('tuberculosis',1,'16409009',NULL,'Tuberculosis of retroperitoneal lymph nodes (disorder)'),('tuberculosis',1,'17653001',NULL,'Tuberculosis of bones AND/OR joints (disorder)'),('tuberculosis',1,'186172004',NULL,'Tuberculous pleurisy in primary progressive tuberculosis (disorder)'),('tuberculosis',1,'186175002',NULL,'Infiltrative lung tuberculosis (disorder)'),('tuberculosis',1,'186178000',NULL,'Tuberculosis of bronchus (disorder)'),('tuberculosis',1,'186182003',NULL,'Tuberculosis of pleura (disorder)'),('tuberculosis',1,'186192006',NULL,'Respiratory tuberculosis, bacteriologically and histologically confirmed (disorder)'),('tuberculosis',1,'186193001',NULL,'Tuberculosis of lung, confirmed by sputum microscopy with or without culture (disorder)'),('tuberculosis',1,'186194007',NULL,'Tuberculosis of lung, confirmed by culture only (disorder)'),('tuberculosis',1,'186195008',NULL,'Tuberculosis of lung, confirmed histologically (disorder)'),('tuberculosis',1,'186199002',NULL,'Tuberculosis of larynx, trachea and bronchus, confirmed bacteriologically and histologically (disorder)'),('tuberculosis',1,'186200004',NULL,'Tuberculous pleurisy, confirmed bacteriologically and histologically (disorder)'),('tuberculosis',1,'186201000',NULL,'Primary respiratory tuberculosis, confirmed bacteriologically and histologically (disorder)'),('tuberculosis',1,'186202007',NULL,'Respiratory tuberculosis, not confirmed bacteriologically or histologically (disorder)'),('tuberculosis',1,'186203002',NULL,'Tuberculosis of lung, bacteriologically and histologically negative (disorder)'),('tuberculosis',1,'186204008',NULL,'Tuberculosis of lung, bacteriological and histological examination not done (disorder)'),('tuberculosis',1,'186225008',NULL,'Tuberculosis of intestines, peritoneum and mesenteric glands (disorder)'),('tuberculosis',1,'186259007',NULL,'Scrofulous tuberculous abscess (disorder)'),('tuberculosis',1,'186269001',NULL,'Tuberculosis of ear (disorder)'),('tuberculosis',1,'186276006',NULL,'Acute miliary tuberculosis (disorder)'),('tuberculosis',1,'186278007',NULL,'Acute miliary tuberculosis of multiple sites (disorder)'),('tuberculosis',1,'190710003',NULL,'Tuberculous arthritis (disorder)'),('tuberculosis',1,'196076002',NULL,'Pleurisy without effusion or active tuberculosis (disorder)'),('tuberculosis',1,'23022004',NULL,'Tuberculous bronchiectasis (disorder)'),('tuberculosis',1,'240376003',NULL,'Tuberculosis of gastrointestinal tract (disorder)'),('tuberculosis',1,'240379005',NULL,'Tuberculosis of male genital organs (disorder)'),('tuberculosis',1,'24235005',NULL,'Tuberculous hydrothorax (disorder)'),('tuberculosis',1,'25738004',NULL,'Tuberculous synovitis (disorder)'),('tuberculosis',1,'25831001',NULL,'Tuberculosis of nasal septum (disorder)'),('tuberculosis',1,'271423008',NULL,'Tuberculosis of skin and subcutaneous tissue (disorder)'),('tuberculosis',1,'29731002',NULL,'Tuberculous pneumothorax (disorder)'),('tuberculosis',1,'33893009',NULL,'Tuberculosis verrucosa cutis (disorder)'),('tuberculosis',1,'37980001',NULL,'Concatos disease (disorder)'),('tuberculosis',1,'41156006',NULL,'Tuberculosis papulonecrotica (disorder)'),('tuberculosis',1,'4445009',NULL,'Tuberculosis of genitourinary system (disorder)'),('tuberculosis',1,'47604008',NULL,'Miliary tuberculosis (disorder)'),('tuberculosis',1,'49107007',NULL,'Tuberculosis of eye (disorder)'),('tuberculosis',1,'52721006',NULL,'Tuberculosis of nasal sinus (disorder)'),('tuberculosis',1,'54084005',NULL,'Cervical tuberculous lymphadenitis (disorder)'),('tuberculosis',1,'56498009',NULL,'Tuberculosis of nasopharynx (disorder)'),('tuberculosis',1,'56717001',NULL,'Tuberculosis (disorder)'),('tuberculosis',1,'58764007',NULL,'Tuberculous osteomyelitis (disorder)'),('tuberculosis',1,'63309002',NULL,'Primary tuberculosis (disorder)'),('tuberculosis',1,'700273003',NULL,'Isolated tracheobronchial tuberculosis (disorder)'),('tuberculosis',1,'70341005',NULL,'Tuberculous laryngitis (disorder)'),('tuberculosis',1,'74181004',NULL,'Tuberculosis of female genital organs (disorder)'),('tuberculosis',1,'74387008',NULL,'Tuberculosis of hilar lymph nodes (disorder)'),('tuberculosis',1,'74610006',NULL,'Tuberculous erythema nodosum (disorder)'),('tuberculosis',1,'77038006',NULL,'Tuberculosis of peripheral lymph nodes (disorder)'),('tuberculosis',1,'77668003',NULL,'Isolated tracheal tuberculosis (disorder)'),('tuberculosis',1,'78436002',NULL,'Tuberculosis of intrathoracic lymph nodes (disorder)'),('tuberculosis',1,'80003002',NULL,'Tuberculous pneumonia (disorder)'),('tuberculosis',1,'80010008',NULL,'Isolated bronchial tuberculosis (disorder)'),('tuberculosis',1,'80602006',NULL,'Nodular tuberculosis of lung (disorder)'),('tuberculosis',1,'82495004',NULL,'Tuberculosis of mediastinal lymph nodes (disorder)'),('tuberculosis',1,'82796002',NULL,'Scrofuloderma (disorder)'),('tuberculosis',1,'83784000',NULL,'Tuberculosis of mediastinum (disorder)'),('tuberculosis',1,'85692003',NULL,'Tuberculosis of tracheobronchial lymph nodes (disorder)'),('tuberculosis',1,'88356006',NULL,'Primary tuberculous complex (disorder)'),('tuberculosis',1,'9768003',NULL,'Tuberculosis cutis lichenoides (disorder)');
INSERT INTO #codessnomed
VALUES ('covid-vaccination',1,'1240491000000103',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'2807821000000115',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'90640007',NULL,'Coronavirus vaccination (procedure)'),('covid-vaccination',1,'1324691000000104',NULL,'Administration of second dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1324681000000101',NULL,'Administration of first dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'39330711000001103',NULL,'COVID-19 vaccine (product)'),('covid-vaccination',1,'41823011000001100',NULL,'Generic COVID-19 Vaccine Moderna (mRNA-1273.222) 50micrograms/0.5ml dose solution for injection vials (product)'),('covid-vaccination',1,'41822811000001103',NULL,'COVID-19 Vaccine Moderna (mRNA-1273.222) 50micrograms/0.5ml dose solution for injection vials (Moderna, Inc) (product)'),('covid-vaccination',1,'41823411000001109',NULL,'Generic COVID-19 Vaccine Moderna (mRNA-1283.222) 10micrograms/0.2ml dose solution for injection vials (product)'),('covid-vaccination',1,'41823211000001105',NULL,'COVID-19 Vaccine Moderna (mRNA-1283.222) 10micrograms/0.2ml dose solution for injection vials (Moderna, Inc) (product)'),('covid-vaccination',1,'42118311000001108',NULL,'Generic Comirnaty Omicron XBB.1.5 Children 6 months - 4 years COVID-19 mRNA Vaccine 3micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (product)'),('covid-vaccination',1,'42098911000001101',NULL,'Comirnaty Omicron XBB.1.5 Children 6 months - 4 years COVID-19 mRNA Vaccine 3micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'42118211000001100',NULL,'Generic Comirnaty Omicron XBB.1.5 Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.3ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'42098011000001100',NULL,'Comirnaty Omicron XBB.1.5 Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'39828011000001104',NULL,'Generic COVID-19 Vaccine Medicago (CoVLP) 3.75micrograms/0.5ml dose emulsion for injection multidose vials (product)'),('covid-vaccination',1,'39826711000001101',NULL,'COVID-19 Vaccine Medicago (CoVLP) 3.75micrograms/0.5ml dose emulsion for injection multidose vials (Medicago Inc) (product)'),('covid-vaccination',1,'40872611000001106',NULL,'Generic COVID-19 Vaccine Sanofi (CoV2 preS dTM bivalent D614+B.1.351 [recombinant adjuvanted]) 2.5micrograms/2.5micrograms/0.5ml dose emulsion for injection multidose vials (product)'),('covid-vaccination',1,'40872311000001101',NULL,'COVID-19 Vaccine Sanofi (CoV2 preS dTM bivalent D614+B.1.351 [recombinant adjuvanted]) 2.5micrograms/2.5micrograms/0.5ml dose emulsion for injection multidose vials (Sanofi) (product)'),('covid-vaccination',1,'40872511000001107',NULL,'Generic COVID-19 Vaccine VidPrevtyn Beta (CoV2 preS dTM monovalent B.1.351 [recombinant adjuvanted]) 5micrograms/0.5ml dose solution and emulsion for emulsion for injection multidose vials (product)'),('covid-vaccination',1,'40872011000001104',NULL,'COVID-19 Vaccine VidPrevtyn Beta (CoV2 preS dTM monovalent B.1.351 [recombinant adjuvanted]) 5micrograms/0.5ml dose solution and emulsion for emulsion for injection multidose vials (Sanofi) (product)'),('covid-vaccination',1,'40859611000001101',NULL,'Generic Comirnaty Original/Omicron BA.1 COVID-19 mRNA Vaccine 15micrograms/15micrograms/0.3ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'40851611000001102',NULL,'Comirnaty Original/Omicron BA.1 COVID-19 mRNA Vaccine 15micrograms/15micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'39375211000001103',NULL,'Generic COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5ml dose suspension for injection multidose vials (product)'),('covid-vaccination',1,'39373511000001104',NULL,'COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5ml dose suspension for injection multidose vials (Valneva UK Ltd) (product)'),('covid-vaccination',1,'41238811000001106',NULL,'Generic Comirnaty Original/Omicron BA.4-5 COVID-19 mRNA Vaccine 15micrograms/15micrograms/0.3ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'41239511000001102',NULL,'Comirnaty Original/Omicron BA.4-5 COVID-19 mRNA Vaccine 15micrograms/15micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'40813111000001102',NULL,'Generic COVID-19 Vaccine Spikevax 0 (Zero)/O (Omicron) 0.1mg/ml dispersion for injection multidose vials (product)'),('covid-vaccination',1,'40801911000001102',NULL,'COVID-19 Vaccine Spikevax 0 (Zero)/O (Omicron) 0.1mg/ml dispersion for injection multidose vials (Moderna, Inc) (product)'),('covid-vaccination',1,'40713711000001104',NULL,'Generic COVID-19 Vaccine Convidecia (Adenovirus Type 5 Vector [recombinant]) 40,000,000,000 viral particles/0.5ml dose solution for injection vials (product)'),('covid-vaccination',1,'40712911000001109',NULL,'COVID-19 Vaccine Convidecia (Adenovirus Type 5 Vector [recombinant]) 40,000,000,000 viral particles/0.5ml dose solution for injection vials (CanSino Biologics Inc) (product)'),('covid-vaccination',1,'41344311000001100',NULL,'Generic COVID-19 Vaccine Spikevax Original/Omicron BA.4/BA.5 dispersion for injection 0.1mg/ml multidose vials (product)'),('covid-vaccination',1,'41343811000001106',NULL,'COVID-19 Vaccine Spikevax Original/Omicron BA.4/BA.5 dispersion for injection 0.1mg/ml multidose vials (Moderna, Inc) (product)'),('covid-vaccination',1,'40520611000001105',NULL,'Generic COVID-19 Vaccine Moderna (mRNA-1273.529) 50micrograms/0.25ml dose solution for injection multidose vials (product)'),('covid-vaccination',1,'40520411000001107',NULL,'COVID-19 Vaccine Moderna (mRNA-1273.529) 50micrograms/0.25ml dose solution for injection multidose vials (Moderna, Inc) (product)'),('covid-vaccination',1,'42029111000001101',NULL,'Generic Spikevax XBB.1.5 COVID-19 mRNA Vaccine 0.1mg/1ml dispersion for injection multidose vials (product)'),('covid-vaccination',1,'42023311000001102',NULL,'Spikevax XBB.1.5 COVID-19 mRNA Vaccine 0.1mg/1ml dispersion for injection multidose vials (Moderna, Inc) (product)'),('covid-vaccination',1,'39116211000001106',NULL,'Generic COVID-19 Vaccine Vaxzevria (ChAdOx1 S [recombinant]) not less than 2.5x100,000,000 infectious units/0.5ml dose suspension for injection multidose vials (product)'),('covid-vaccination',1,'39114911000001105',NULL,'COVID-19 Vaccine Vaxzevria (ChAdOx1 S [recombinant]) not less than 2.5x100,000,000 infectious units/0.5ml dose suspension for injection multidose vials (AstraZeneca UK Ltd) (product)'),('covid-vaccination',1,'39326811000001106',NULL,'Generic Spikevax COVID-19 mRNA (nucleoside modified) Vaccine 0.1mg/0.5ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'39326911000001101',NULL,'Spikevax COVID-19 mRNA (nucleoside modified) Vaccine 0.1mg/0.5ml dose dispersion for injection multidose vials (Moderna, Inc) (product)'),('covid-vaccination',1,'39233911000001100',NULL,'Generic COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose suspension for injection multidose vials (product)'),('covid-vaccination',1,'39230211000001104',NULL,'COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose suspension for injection multidose vials (Janssen-Cilag Ltd) (product)'),('covid-vaccination',1,'39116111000001100',NULL,'Generic Comirnaty COVID-19 mRNA Vaccine 30micrograms/0.3ml dose concentrate for dispersion for injection multidose vials (product)'),('covid-vaccination',1,'39115611000001103',NULL,'Comirnaty COVID-19 mRNA Vaccine 30micrograms/0.3ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'40557211000001108',NULL,'Generic Comirnaty COVID-19 mRNA Vaccine ready to use 30micrograms/0.3ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'40556911000001102',NULL,'Comirnaty COVID-19 mRNA Vaccine ready to use 30micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'41179211000001100',NULL,'Generic Comirnaty Children 6 months - 4 years COVID-19 mRNA Vaccine 3micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (product)'),('covid-vaccination',1,'41178911000001101',NULL,'Comirnaty Children 6 months - 4 years COVID-19 mRNA Vaccine 3micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'40506711000001109',NULL,'Generic COVID-19 Vaccine Sanofi (CoV2 preS dTM monovalent D614 [recombinant]) 5micrograms/0.5ml dose suspension for injection multidose vials (product)'),('covid-vaccination',1,'40506311000001105',NULL,'COVID-19 Vaccine Sanofi (CoV2 preS dTM monovalent D614 [recombinant]) 5micrograms/0.5ml dose suspension for injection multidose vials (Sanofi) (product)'),('covid-vaccination',1,'40411511000001102',NULL,'Generic COVID-19 Vaccine AZD2816 AstraZeneca (ChAdOx1 nCOV-19) 3.5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (product)'),('covid-vaccination',1,'40402411000001109',NULL,'COVID-19 Vaccine AZD2816 AstraZeneca (ChAdOx1 nCOV-19) 3.5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (AstraZeneca AB) (product)'),('covid-vaccination',1,'40389011000001100',NULL,'Generic Comirnaty Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (product)'),('covid-vaccination',1,'40384611000001108',NULL,'Comirnaty Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd) (product)'),
('covid-vaccination',1,'40388611000001103',NULL,'Generic COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (product)'),('covid-vaccination',1,'40387411000001100',NULL,'COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Gamaleya NRCEM) (product)'),('covid-vaccination',1,'40388811000001104',NULL,'Generic COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (product)'),('covid-vaccination',1,'40387711000001106',NULL,'COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Gamaleya NRCEM) (product)'),('covid-vaccination',1,'40388711000001107',NULL,'Generic COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (product)'),('covid-vaccination',1,'40385711000001100',NULL,'COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (Gamaleya NRCEM) (product)'),('covid-vaccination',1,'40388911000001109',NULL,'Generic COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (product)'),('covid-vaccination',1,'40387111000001105',NULL,'COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (Gamaleya NRCEM) (product)'),('covid-vaccination',1,'40335311000001107',NULL,'Generic COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection multidose vials (product)'),('covid-vaccination',1,'40332311000001101',NULL,'COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection multidose vials (Bharat Biotech International Ltd) (product)'),('covid-vaccination',1,'40366311000001107',NULL,'Generic COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (product)'),('covid-vaccination',1,'40348011000001102',NULL,'COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Serum Institute of India) (product)'),('covid-vaccination',1,'40335411000001100',NULL,'Generic COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection vials (product)'),('covid-vaccination',1,'40332711000001102',NULL,'COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection vials (Bharat Biotech International Ltd) (product)'),('covid-vaccination',1,'40335611000001102',NULL,'Generic COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection vials (product)'),('covid-vaccination',1,'40331611000001100',NULL,'COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection vials (Beijing Institute of Biological Products) (product)'),('covid-vaccination',1,'40335511000001101',NULL,'Generic COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection pre-filled syringes (product)'),('covid-vaccination',1,'40331911000001106',NULL,'COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection pre-filled syringes (Beijing Institute of Biological Products) (product)'),('covid-vaccination',1,'40366411000001100',NULL,'Generic COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection vials (product)'),('covid-vaccination',1,'40362511000001102',NULL,'COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection vials (Serum Institute of India) (product)'),('covid-vaccination',1,'40329811000001103',NULL,'Generic CoronaVac COVID-19 Vaccine (adjuvanted) 600U/0.5ml dose suspension for injection vials (product)'),('covid-vaccination',1,'40306411000001101',NULL,'CoronaVac COVID-19 Vaccine (adjuvanted) 600U/0.5ml dose suspension for injection vials (Sinovac Life Sciences) (product)'),('covid-vaccination',1,'41779711000001103',NULL,'Generic COVID-19 Vaccine Bimervax (recombinant, adjuvanted) 40micrograms/0.5ml dose emulsion for injection multidose vials (product)'),('covid-vaccination',1,'41780111000001104',NULL,'COVID-19 Vaccine Bimervax (recombinant, adjuvanted) 40micrograms/0.5ml dose emulsion for injection multidose vials (Hipra Human Health S.L.U.) (product)'),('covid-vaccination',1,'42029211000001107',NULL,'Generic Comirnaty Omicron XBB.1.5 COVID-19 mRNA Vaccine 30micrograms/0.3ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'42020711000001107',NULL,'Comirnaty Omicron XBB.1.5 COVID-19 mRNA Vaccine 30micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd) (product)'),('covid-vaccination',1,'39478211000001100',NULL,'Generic COVID-19 Vaccine Nuvaxovid (recombinant, adjuvanted) 5micrograms/0.5ml dose dispersion for injection multidose vials (product)'),('covid-vaccination',1,'40483111000001109',NULL,'COVID-19 Vaccine Covovax (adjuvanted) 5micrograms/0.5ml dose suspension for injection multidose vials (Serum Institute of India) (product)'),('covid-vaccination',1,'39473011000001103',NULL,'COVID-19 Vaccine Nuvaxovid (recombinant, adjuvanted) 5micrograms/0.5ml dose dispersion for injection multidose vials (Novavax CZ a.s.) (product)'),('covid-vaccination',1,'40658411000001104',NULL,'Generic COVID-19 Vaccine Moderna (mRNA-1273.214) 50micrograms/0.5ml dose dispersion for injection vials (product)'),('covid-vaccination',1,'40658111000001109',NULL,'COVID-19 Vaccine Moderna (mRNA-1273.214) 50micrograms/0.5ml dose dispersion for injection vials (Moderna, Inc) (product)'),('covid-vaccination',1,'1156257007',NULL,'Administration of vaccine product against severe acute respiratory syndrome coronavirus 2 (procedure)'),('covid-vaccination',1,'1324681000000101',NULL,'Administration of first dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1363831000000108',NULL,'Administration of fifth dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1363861000000103',NULL,'Administration of third dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1363791000000101',NULL,'Administration of fourth dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1324691000000104',NULL,'Administration of second dose of severe acute respiratory syndrome coronavirus 2 vaccine (procedure)'),('covid-vaccination',1,'1193583000',NULL,'Administration of vaccine product containing only severe acute respiratory syndrome coronavirus 2 deoxyribonucleic acid plasmid encoding spike protein (procedure)'),('covid-vaccination',1,'1157107003',NULL,'Administration of vaccine product containing only recombinant non-replicating viral vector encoding severe acute respiratory syndrome coronavirus 2 spike protein (procedure)'),('covid-vaccination',1,'1157108008',NULL,'Administration of second dose vaccine product containing only recombinant non-replicating viral vector encoding severe acute respiratory syndrome coronavirus 2 spike protein (procedure)'),('covid-vaccination',1,'1119350007',NULL,'Administration of vaccine product containing only severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid (procedure)'),('covid-vaccination',1,'1144998002',NULL,'Administration of second dose of vaccine product containing only severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid (procedure)'),('covid-vaccination',1,'1144997007',NULL,'Administration of first dose of vaccine product containing only severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid (procedure)'),('covid-vaccination',1,'840534001',NULL,'Administration of vaccine product containing only severe acute respiratory syndrome coronavirus 2 antigen (procedure)'),('covid-vaccination',1,'1179496000',NULL,'Administration of vaccine product containing only severe acute respiratory syndrome coronavirus 2 virus-like particle antigen (procedure)'),('covid-vaccination',1,'1179497009',NULL,'Administration of second dose of vaccine product containing only severe acute respiratory syndrome coronavirus 2 virus-like particle antigen (procedure)'),('covid-vaccination',1,'1162645008',NULL,'Administration of vaccine product containing only severe acute respiratory syndrome coronavirus 2 recombinant spike protein antigen (procedure)'),('covid-vaccination',1,'1162646009',NULL,'Administration of second dose of vaccine product containing only severe acute respiratory syndrome coronavirus 2 recombinant spike protein antigen (procedure)'),('covid-vaccination',1,'1157196000',NULL,'Administration of vaccine product containing only inactivated whole severe acute respiratory syndrome coronavirus 2 antigen (procedure)'),('covid-vaccination',1,'1157197009',NULL,'Administration of second dose of vaccine product containing only inactivated whole severe acute respiratory syndrome coronavirus 2 antigen (procedure)'),('covid-vaccination',1,'1362591000000103',NULL,'Immunisation course to maintain protection against severe acute respiratory syndrome coronavirus 2 (regime/therapy)'),('covid-vaccination',1,'1324671000000103',NULL,'Immunisation course to achieve immunity against severe acute respiratory syndrome coronavirus 2 (regime/therapy)'),
('covid-vaccination',1,'1362611000000106',NULL,'Severe acute respiratory syndrome coronavirus 2 immunisation course done (situation)');
INSERT INTO #codessnomed
VALUES ('flu-vaccination',1,'1037311000000106',NULL,'First intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'1037331000000103',NULL,'Second intranasal seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'1037351000000105',NULL,'First inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'1037371000000101',NULL,'Second inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'1066171000000108',NULL,'Seasonal influenza vaccination given by midwife (situation)'),('flu-vaccination',1,'1066181000000105',NULL,'First inactivated seasonal influenza vaccination given by midwife (situation)'),('flu-vaccination',1,'1066191000000107',NULL,'Second inactivated seasonal influenza vaccination given by midwife (situation)'),('flu-vaccination',1,'1239861000000100',NULL,'Seasonal influenza vaccination given in school'),('flu-vaccination',1,'201391000000106',NULL,'Booster influenza vaccination'),('flu-vaccination',1,'202301000000106',NULL,'First pandemic flu vaccination'),('flu-vaccination',1,'202311000000108',NULL,'Second pandemic influenza vaccination'),('flu-vaccination',1,'325631000000101',NULL,'Annual influenza vaccination (finding)'),('flu-vaccination',1,'346524008',NULL,'Inactivated Influenza split virion vaccine'),('flu-vaccination',1,'346525009',NULL,'Inactivated Influenza surface antigen sub-unit vaccine'),('flu-vaccination',1,'348046004',NULL,'Influenza (split virion) vaccine injection suspension prefilled syringe'),('flu-vaccination',1,'348047008',NULL,'Inactivated Influenza surface antigen sub-unit vaccine prefilled syringe'),('flu-vaccination',1,'380741000000101',NULL,'First pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'380771000000107',NULL,'Second pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'396425006',NULL,'FLU - Influenza vaccine'),('flu-vaccination',1,'400564003',NULL,'Influenza virus vaccine trivalent 45mcg/0.5mL injection solution 5mL vial'),('flu-vaccination',1,'400788004',NULL,'Influenza virus vaccine triv 45mcg/0.5mL injection'),('flu-vaccination',1,'408752008',NULL,'Inactivated influenza split virion vaccine'),('flu-vaccination',1,'409269001',NULL,'Intranasal influenza live virus vaccine'),('flu-vaccination',1,'418707004',NULL,'Inactivated Influenza surface antigen virosome vaccine prefilled syringe'),('flu-vaccination',1,'419456007',NULL,'Influenza surface antigen vaccine'),('flu-vaccination',1,'419562000',NULL,'Inactivated Influenza surface antigen virosome vaccine'),('flu-vaccination',1,'419826009',NULL,'Influenza split virion vaccine'),('flu-vaccination',1,'426849008',NULL,'Influenza virus H5N1 vaccine'),('flu-vaccination',1,'427036009',NULL,'Influenza virus H5N1 vaccine'),('flu-vaccination',1,'427077008',NULL,'Influenza virus H5N1 vaccine injection solution 5mL multi-dose vial'),('flu-vaccination',1,'428771000',NULL,'Swine influenza virus vaccine'),('flu-vaccination',1,'430410002',NULL,'Product containing Influenza virus vaccine in nasal dosage form'),('flu-vaccination',1,'442315004',NULL,'Influenza A virus subtype H1N1 vaccine (substance)'),('flu-vaccination',1,'442333005',NULL,'Influenza A virus subtype H1N1 vaccination (procedure)'),('flu-vaccination',1,'443161002',NULL,'Influenza A virus subtype H1N1 monovalent vaccine 0.5mL injection solution'),('flu-vaccination',1,'443651005',NULL,'Influenza A virus subtype H1N1 vaccine'),('flu-vaccination',1,'448897007',NULL,'Inactivated Influenza split virion subtype H1N1v-like strain adjuvant vaccine'),('flu-vaccination',1,'451022006',NULL,'Inactivated Influenza split virion subtype H1N1v-like strain unadjuvanted vaccine'),('flu-vaccination',1,'46233009',NULL,'Influenza vaccine'),('flu-vaccination',1,'515281000000108',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'515291000000105',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'515301000000109',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'515321000000100',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given'),('flu-vaccination',1,'515331000000103',NULL,'CELVAPAN - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'515341000000107',NULL,'PANDEMRIX - first influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'515351000000105',NULL,'CELVAPAN - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'515361000000108',NULL,'PANDEMRIX - second influenza A (H1N1v) 2009 vaccination given by other healthcare provider'),('flu-vaccination',1,'73701000119109',NULL,'Influenza vaccination given'),('flu-vaccination',1,'81970008',NULL,'Swine influenza virus vaccine (product)'),('flu-vaccination',1,'822851000000102',NULL,'Seasonal influenza vaccination'),('flu-vaccination',1,'86198006',NULL,'Influenza vaccination (procedure)'),('flu-vaccination',1,'868241000000109',NULL,'Administration of intranasal influenza vaccination'),('flu-vaccination',1,'871751000000104',NULL,'Administration of first intranasal influenza vaccination'),('flu-vaccination',1,'871781000000105',NULL,'Administration of second intranasal influenza vaccination'),('flu-vaccination',1,'884821000000108',NULL,'Administration of first intranasal pandemic influenza vaccination'),('flu-vaccination',1,'884841000000101',NULL,'Administration of second intranasal pandemic influenza vaccination'),('flu-vaccination',1,'884861000000100',NULL,'Administration of first intranasal seasonal influenza vaccination'),('flu-vaccination',1,'884881000000109',NULL,'Administration of second intranasal seasonal influenza vaccination'),('flu-vaccination',1,'884901000000107',NULL,'First intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'884921000000103',NULL,'Second intranasal pandemic influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'945831000000105',NULL,'First intramuscular seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'955641000000103',NULL,'Influenza vaccination given by other healthcare provider (situation)'),('flu-vaccination',1,'955651000000100',NULL,'Seasonal influenza vaccination given by other healthcare provider (situation)'),('flu-vaccination',1,'955661000000102',NULL,'First intranasal seasonal influenza vaccination given by other healthcare provider (situation)'),('flu-vaccination',1,'955671000000109',NULL,'Second intramuscular seasonal influenza vaccination given by other healthcare provider (situation)'),('flu-vaccination',1,'955681000000106',NULL,'Second intranasal seasonal influenza vaccination given by other healthcare provider (situation)'),('flu-vaccination',1,'955691000000108',NULL,'Seasonal influenza vaccination given by pharmacist (situation)'),('flu-vaccination',1,'955701000000108',NULL,'Seasonal influenza vaccination given while hospital inpatient (situation)'),('flu-vaccination',1,'985151000000100',NULL,'Administration of first inactivated seasonal influenza vaccination'),('flu-vaccination',1,'985171000000109',NULL,'Administration of second inactivated seasonal influenza vaccination');
INSERT INTO #codessnomed
VALUES ('pneumococcal-vaccination',1,'12866006',NULL,'Pneumococcal vaccination (procedure)'),('pneumococcal-vaccination',1,'394678003',NULL,'Booster pneumococcal vaccination'),('pneumococcal-vaccination',1,'820741000000108',NULL,'Supplemental pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'247631000000101',NULL,'First pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'247641000000105',NULL,'Second pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'247651000000108',NULL,'Third pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'43961000119109',NULL,'Pneumococcal 7-valent conjugate vaccination given'),('pneumococcal-vaccination',1,'310578008',NULL,'Pneumococcal vaccination given (finding)'),('pneumococcal-vaccination',1,'382551000000109',NULL,'Pneumococcal vaccination given by other healthcare provider'),('pneumococcal-vaccination',1,'170337005',NULL,'Pneumococcal vaccination given'),('pneumococcal-vaccination',1,'871833000',NULL,'Subcutaneous injection of pneumococcal vaccine'),('pneumococcal-vaccination',1,'308753004',NULL,'Subcutaneous injection of Pneumovax II (procedure)'),('pneumococcal-vaccination',1,'34783011000001102',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (A A H Pharmaceuticals Ltd)'),('pneumococcal-vaccination',1,'35111211000001108',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (Alliance Healthcare (Distribution) Ltd)'),('pneumococcal-vaccination',1,'3017311000001106',NULL,'Pneumovax II vaccine solution for injection 0.5ml vials (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'3005011000001103',NULL,'Pneumovax II vaccine solution for injection 0.5ml pre-filled syringes (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'36461211000001108',NULL,'Pneumovax 23 solution for injection 0.5ml pre-filled syringes (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'3018111000001105',NULL,'Pnu-Imune vaccine solution for injection 0.5ml vials (Wyeth Pharmaceuticals)'),('pneumococcal-vaccination',1,'16649411000001104',NULL,'Prevenar 13 vaccine suspension for injection 0.5ml pre-filled syringes (Pfizer Ltd)'),('pneumococcal-vaccination',1,'3439311000001100',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials'),('pneumococcal-vaccination',1,'3439211000001108',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml pre-filled syringes'),('pneumococcal-vaccination',1,'3439111000001102',NULL,'Pneumococcal polysaccharide conjugated vaccine (adsorbed) suspension for injection 0.5ml vials'),('pneumococcal-vaccination',1,'10245211000001108',NULL,'Pneumococcal polysaccharide conjugated vaccine (adsorbed) suspension for injection 0.5ml pre-filled syringes'),('pneumococcal-vaccination',1,'27396511000001105',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'3003511000001107',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml pre-filled syringes'),('pneumococcal-vaccination',1,'1324631000000100',NULL,'Pneumococcal vaccination given by other healthcare provider (situation)'),('pneumococcal-vaccination',1,'1119367000',NULL,'Administration of vaccine product containing only Streptococcus pneumoniae Danish serotype 1, 2, 3, 4, 5, 6B, 7F, 8, 9N, 9V, 10A, 11A, 12F, 14, 15B, 17F, 18C, 19A, 19F, 20, 22F, 23F, and 33F capsular polysaccharide antigens (procedure)'),('pneumococcal-vaccination',1,'571631000119106',NULL,'Administration of pneumococcal polysaccharide 23 valent vaccine (procedure)');
INSERT INTO #codessnomed
VALUES ('shingles-vaccination',1,'722215002',NULL,'Administration of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'737081007',NULL,'Administration of vaccine product containing only Human alphaherpesvirus 3 antigen for chickenpox'),('shingles-vaccination',1,'859641000000109',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'868511000000106',NULL,'Herpes zoster vaccination given by other health care provider'),('shingles-vaccination',1,'1326101000000105',NULL,'Administration of first dose of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'1326111000000107',NULL,'Administration of second dose of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'20110511000001107',NULL,'Zostavax vaccine powder and solvent for suspension for injection 0.65ml pre-filled syringes (Merck Sharp & Dohme (UK) Ltd) (product)'),('shingles-vaccination',1,'4639911000001104',NULL,'Varicella vaccine (live) powder and solvent for solution for injection 0.5ml vials (product)'),('shingles-vaccination',1,'7990711000001108',NULL,'Varicella vaccine (live) powder and solvent for suspension for injection 0.5ml vials (product)'),('shingles-vaccination',1,'871899004',NULL,'Administration of vaccine product containing only live attenuated Human alphaherpesvirus 3 antigen via subcutaneous route (procedure)'),('shingles-vaccination',1,'871898007',NULL,'Administration of vaccine product containing only live attenuated Human alphaherpesvirus 3 antigen (procedure)')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codessnomed;

IF OBJECT_ID('tempdb..#codesemis') IS NOT NULL DROP TABLE #codesemis;
CREATE TABLE #codesemis (
  [concept] [varchar](255) NOT NULL,
  [version] INT NOT NULL,
	[code] [varchar](20) COLLATE Latin1_General_CS_AS NOT NULL,
	[term] [varchar](20) COLLATE Latin1_General_CS_AS NULL,
	[description] [varchar](255) NULL
) ON [PRIMARY];

INSERT INTO #codesemis
VALUES ('sle',1,'^ESCTBU514089',NULL,'Bullous systemic lupus erythematosus'),('sle',1,'^ESCTCD512809',NULL,'CDLE - Chronic discoid lupus erythematosus'),('sle',1,'^ESCTCE406029',NULL,'Cerebral systemic lupus erythematosus'),('sle',1,'^ESCTCH512808',NULL,'Chronic discoid lupus erythematosus'),('sle',1,'^ESCTCH512810',NULL,'Chilblain lupus erythematosus'),('sle',1,'^ESCTDI378949',NULL,'Discoid lupus erythematosus of eyelid'),('sle',1,'^ESCTDI378950',NULL,'Discoid lupus erythematosus eyelid'),('sle',1,'^ESCTDI378951',NULL,'Discoid lupus eyelid'),('sle',1,'^ESCTDL480563',NULL,'DLE - Discoid lupus erythematosus'),('sle',1,'^ESCTLE480559',NULL,'LE - Lupus erythematosus'),('sle',1,'^ESCTLE480564',NULL,'LE - Discoid lupus erythematosus'),('sle',1,'^ESCTLI514085',NULL,'Limited lupus erythematosus'),('sle',1,'^ESCTLU257360',NULL,'Lupus nephritis - WHO Class II'),('sle',1,'^ESCTLU267516',NULL,'Lupus with glomerular sclerosis'),('sle',1,'^ESCTLU267517',NULL,'Lupus nephritis - WHO Class VI'),('sle',1,'^ESCTLU273907',NULL,'Lupus profundus'),('sle',1,'^ESCTLU308669',NULL,'Lupus nephritis - WHO Class IV'),('sle',1,'^ESCTLU334360',NULL,'Lupus nephritis - WHO Class V'),('sle',1,'^ESCTLU369178',NULL,'Lupus nephritis - WHO Class I'),('sle',1,'^ESCTLU374466',NULL,'Lupus nephritis - WHO Class III'),('sle',1,'^ESCTLU406027',NULL,'Lupus encephalopathy'),('sle',1,'^ESCTLU480560',NULL,'Lupus'),('sle',1,'^ESCTLU512806',NULL,'Lupus erythematosus and erythema multiforme-like syndrome'),('sle',1,'^ESCTLU514088',NULL,'Lupus panniculitis'),('sle',1,'^ESCTME334359',NULL,'Membranous lupus glomerulonephritis'),('sle',1,'^ESCTNE405966',NULL,'Neonatal lupus'),('sle',1,'^ESCTRO512807',NULL,'Rowells syndrome'),('sle',1,'^ESCTSA514093',NULL,'SACLE - Subacute cutaneous lupus erythematosus'),('sle',1,'^ESCTSC514092',NULL,'SCLE - Subacute cutaneous lupus erythematosus'),('sle',1,'^ESCTSK514086',NULL,'Skin and joint lupus'),('sle',1,'^ESCTSL257358',NULL,'SLE glomerulonephritis syndrome, WHO class II'),('sle',1,'^ESCTSL257359',NULL,'SLE with mesangial proliferative glomerulonephritis'),('sle',1,'^ESCTSL267514',NULL,'SLE glomerulonephritis syndrome, WHO class VI'),('sle',1,'^ESCTSL267515',NULL,'SLE with advanced sclerosing glomerulonephritis'),('sle',1,'^ESCTSL308667',NULL,'SLE glomerulonephritis syndrome, WHO class IV'),('sle',1,'^ESCTSL308668',NULL,'SLE with diffuse proliferative glomerulonephritis'),('sle',1,'^ESCTSL334357',NULL,'SLE glomerulonephritis syndrome, WHO class V'),('sle',1,'^ESCTSL334358',NULL,'SLE with membranous glomerulonephritis'),('sle',1,'^ESCTSL340060',NULL,'SLE - Systemic lupus erythematosus'),('sle',1,'^ESCTSL361922',NULL,'SLE glomerulonephritis syndrome'),('sle',1,'^ESCTSL369176',NULL,'SLE glomerulonephritis syndrome, WHO class I'),('sle',1,'^ESCTSL369177',NULL,'SLE with normal kidneys'),('sle',1,'^ESCTSL374464',NULL,'SLE glomerulonephritis syndrome, WHO class III'),('sle',1,'^ESCTSL374465',NULL,'SLE with focal AND segmental proliferative glomerulonephritis'),('sle',1,'^ESCTSY257361',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class II'),('sle',1,'^ESCTSY257362',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class II'),('sle',1,'^ESCTSY257363',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class II'),('sle',1,'^ESCTSY267518',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class VI'),('sle',1,'^ESCTSY267519',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class VI'),('sle',1,'^ESCTSY267520',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class VI'),('sle',1,'^ESCTSY308670',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class IV'),('sle',1,'^ESCTSY308671',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class IV'),('sle',1,'^ESCTSY308672',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class IV'),('sle',1,'^ESCTSY334361',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class V'),('sle',1,'^ESCTSY334362',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class V'),('sle',1,'^ESCTSY334363',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class V'),('sle',1,'^ESCTSY361924',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome'),('sle',1,'^ESCTSY369179',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class I'),('sle',1,'^ESCTSY369180',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class I'),('sle',1,'^ESCTSY369181',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class I'),('sle',1,'^ESCTSY374467',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization (WHO) class III'),('sle',1,'^ESCTSY374468',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organisation (WHO) class III'),('sle',1,'^ESCTSY374469',NULL,'Systemic lupus erythematosus glomerulonephritis syndrome, World Health Organization class III'),('sle',1,'^ESCTSY514090',NULL,'Systemic lupus erythematosus with multisystem involvement'),('sle',1,'EMISNQSY6',NULL,'Systemic lupus erythematosus encephalitis'),('sle',1,'^ESCT1185132',NULL,'Pericarditis co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCT1352191',NULL,'Autosomal systemic lupus erythematosus'),('sle',1,'^ESCT1352192',NULL,'Autosomal SLE (systemic lupus erythematosus)'),('sle',1,'^ESCT1352193',NULL,'Familial systemic lupus erythematosus'),('sle',1,'^ESCT1406104',NULL,'Lupus-like syndrome'),('sle',1,'^ESCTAC668182',NULL,'Acute systemic lupus erythematosus'),('sle',1,'^ESCTAN668204',NULL,'Anetoderma secondary to lupus erythematosus'),('sle',1,'^ESCTBU405493',NULL,'Butterfly rash associated with systemic lupus'),('sle',1,'^ESCTCA668207',NULL,'Calcinosis secondary to lupus erythematosus'),('sle',1,'^ESCTCH500611',NULL,'Chorea in systemic lupus erythematosus'),('sle',1,'^ESCTCH786098',NULL,'Chorea co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTCH786099',NULL,'Chorea with systemic lupus erythematosus'),('sle',1,'^ESCTCH815523',NULL,'Cheilitis due to lupus erythematosus'),('sle',1,'^ESCTDE786120',NULL,'Demyelination of central nervous system co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTDE786121',NULL,'Demyelination with systemic lupus erythematosus'),('sle',1,'^ESCTDI308784',NULL,'Dilated cardiomyopathy secondary to systemic lupus erythematosus'),('sle',1,'^ESCTDR380552',NULL,'Drug-induced lupus erythematosus'),('sle',1,'^ESCTEN802262',NULL,'Endocarditis due to systemic lupus erythematosus'),('sle',1,'^ESCTFU668183',NULL,'Fulminating systemic lupus erythematosus'),('sle',1,'^ESCTGI770137',NULL,'Gingival disease co-occurrent and due to lupus erythematosus'),('sle',1,'^ESCTGL809990',NULL,'Glomerular disease due to systemic lupus erythematosus'),('sle',1,'^ESCTGL809991',NULL,'Glomerular disease due to SLE (systemic lupus erythematosus)'),('sle',1,'^ESCTHA795184',NULL,'Haemolytic anaemia associated with systemic lupus erythematosus'),('sle',1,'^ESCTHE795185',NULL,'Hemolytic anemia associated with systemic lupus erythematosus'),('sle',1,'^ESCTHY668210',NULL,'Hypermelanosis due to lupus erythematosus'),('sle',1,'^ESCTLU281251',NULL,'Lupus hepatitis'),('sle',1,'^ESCTLU281252',NULL,'Lupoid hepatitis'),('sle',1,'^ESCTLU376503',NULL,'Lupus disease of the lung'),('sle',1,'^ESCTLU505500',NULL,'Lupus pneumonia'),('sle',1,'^ESCTLU505501',NULL,'Lupoid pneumonia'),('sle',1,'^ESCTLU514173',NULL,'Lupus vasculitis'),('sle',1,'^ESCTLU514175',NULL,'Lupus erythematosus-associated vasculitis'),('sle',1,'^ESCTLU666906',NULL,'Lupus erythematosus overlap syndrome'),('sle',1,'^ESCTLU668203',NULL,'Lupus erythematosus-associated anetoderma'),('sle',1,'^ESCTLU668206',NULL,'Lupus erythematosus-associated calcinosis'),('sle',1,'^ESCTLU668208',NULL,'Lupus erythematosus-associated papulonodular mucinosis'),('sle',1,'^ESCTLU668209',NULL,'Lupus erythematosus-associated hypermelanosis'),('sle',1,'^ESCTLU668211',NULL,'Lupus erythematosus-associated nailfold telangiectasia'),('sle',1,'^ESCTLU668213',NULL,'Lupus erythematosus-associated urticarial vasculitis'),('sle',1,'^ESCTLU668215',NULL,'Lupus erythematosus-associated necrotising vasculitis'),('sle',1,'^ESCTLU668216',NULL,'Lupus erythematosus-associated necrotizing vasculitis'),('sle',1,'^ESCTLU668219',NULL,'Lupus erythematosus-associated poikiloderma'),('sle',1,'^ESCTLU668221',NULL,'Lupus erythematosus-associated nail dystrophy'),('sle',1,'^ESCTLU761502',NULL,'Lupus erythematosus of oral mucous membrane'),('sle',1,'^ESCTLU761503',NULL,'Lupus erythematosus of oral mucosa'),('sle',1,'^ESCTLU815524',NULL,'Lupus cheilitis'),('sle',1,'^ESCTNA668222',NULL,'Nail dystrophy due to lupus erythematosus'),('sle',1,'^ESCTNE668217',NULL,'Necrotising vasculitis due to lupus erythematosus'),('sle',1,'^ESCTNE668218',NULL,'Necrotizing vasculitis due to lupus erythematosus'),('sle',1,'^ESCTNE809113',NULL,'Nephropathy co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTNE809115',NULL,'Nephrotic syndrome co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTNE809116',NULL,'Nephrosis co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTNE809117',NULL,'Nephrosis with systemic lupus erythematosus'),('sle',1,'^ESCTPE290594',NULL,'Pericarditis secondary to systemic lupus erythematosus'),('sle',1,'^ESCTPO668220',NULL,'Poikiloderma due to lupus erythematosus'),('sle',1,'^ESCTRA405492',NULL,'Rash of systemic lupus erythematosus'),
('sle',1,'^ESCTRE690505',NULL,'Retinal vasculitis due to systemic lupus erythematosus'),('sle',1,'^ESCTSE795182',NULL,'Secondary autoimmune haemolytic anaemia co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTSE795183',NULL,'Secondary autoimmune hemolytic anemia co-occurrent and due to systemic lupus erythematosus'),('sle',1,'^ESCTSL659382',NULL,'SLE - Systemic lupus erythematosus-related syndrome'),('sle',1,'^ESCTSY405618',NULL,'Systemic lupus erythematosus arthritis'),('sle',1,'^ESCTSY659381',NULL,'Systemic lupus erythematosus-related syndrome'),('sle',1,'^ESCTSY667099',NULL,'Systemic lupus erythematosus-associated antiphospholipid syndrome'),('sle',1,'^ESCTSY668184',NULL,'Systemic lupus erythematosus of childhood'),('sle',1,'^ESCTSY751150',NULL,'Systemic lupus erythematosus in remission'),('sle',1,'^ESCTSY832077',NULL,'Systemic lupus erythematosus/Sjogrens overlap syndrome'),('sle',1,'^ESCTTE668212',NULL,'Telangiectasia of nailfolds due to lupus erythematosus'),('sle',1,'^ESCTUR668214',NULL,'Urticarial vasculitis due to lupus erythematosus'),('sle',1,'^ESCTVA514174',NULL,'Vasculitis due to lupus erythematosus');
INSERT INTO #codesemis
VALUES ('tuberculosis',1,'^ESCTAR475938',NULL,'Arthritis caused by Mycobacterium tuberculosis'),('tuberculosis',1,'^ESCTCE337727',NULL,'Cervical tuberculous lymphadenitis'),('tuberculosis',1,'^ESCTCO311162',NULL,'Concato disease'),('tuberculosis',1,'^ESCTGH393589',NULL,'Ghon tubercle'),('tuberculosis',1,'^ESCTGH393590',NULL,'Ghon complex'),('tuberculosis',1,'^ESCTIN474101',NULL,'Infiltrative tuberculosis of lung'),('tuberculosis',1,'^ESCTLA364390',NULL,'Laryngeal tuberculosis'),('tuberculosis',1,'^ESCTLI265565',NULL,'Lichen scrofulosorum'),('tuberculosis',1,'^ESCTLU266735',NULL,'Lupus exedens'),('tuberculosis',1,'^ESCTLV266737',NULL,'LV - Lupus vulgaris'),('tuberculosis',1,'^ESCTMT326982',NULL,'MTB - Miliary tuberculosis'),('tuberculosis',1,'^ESCTNO381104',NULL,'Nodular tuberculosis of lung'),('tuberculosis',1,'^ESCTOC329457',NULL,'Ocular tuberculosis'),('tuberculosis',1,'^ESCTPA316295',NULL,'Papulonecrotic tuberculid'),('tuberculosis',1,'^ESCTPA316296',NULL,'Papulonecrotic tuberculide'),('tuberculosis',1,'^ESCTPO286704',NULL,'Post-tuberculous bronchiectasis'),('tuberculosis',1,'^ESCTPR304534',NULL,'Prosectors wart'),('tuberculosis',1,'^ESCTPR311161',NULL,'Progressive malignant polyserositis'),('tuberculosis',1,'^ESCTPR352961',NULL,'Primary tuberculosis'),('tuberculosis',1,'^ESCTPR352963',NULL,'Primary (TB) tuberculosis'),('tuberculosis',1,'^ESCTPR474099',NULL,'Primary progressive tuberculosis with tuberculous pleurisy'),('tuberculosis',1,'^ESCTPT451460',NULL,'PTB - Pulmonary tuberculosis'),('tuberculosis',1,'^ESCTRE276024',NULL,'Retroperitoneal tuberculosis'),('tuberculosis',1,'^ESCTSC337728',NULL,'Scrofula'),('tuberculosis',1,'^ESCTSC384703',NULL,'Scrofuloderma'),('tuberculosis',1,'^ESCTTB256970',NULL,'TB - Urogenital tuberculosis'),('tuberculosis',1,'^ESCTTB342137',NULL,'TB - Tuberculosis'),('tuberculosis',1,'^ESCTTB420023',NULL,'TB - Urinary tuberculosis'),('tuberculosis',1,'^ESCTTB451461',NULL,'TB - Pulmonary tuberculosis'),('tuberculosis',1,'^ESCTTU256969',NULL,'Tuberculosis of genitourinary system'),('tuberculosis',1,'^ESCTTU265564',NULL,'Tuberculosis cutis lichenoides'),('tuberculosis',1,'^ESCTTU266736',NULL,'Tuberculosis cutis luposa'),('tuberculosis',1,'^ESCTTU266738',NULL,'Tuberculosis lupus exedens'),('tuberculosis',1,'^ESCTTU266739',NULL,'Tuberculosis luposa cutis'),('tuberculosis',1,'^ESCTTU273007',NULL,'Tuberculous pleural empyema'),('tuberculosis',1,'^ESCTTU278008',NULL,'Tuberculosis of bones and/or joints'),('tuberculosis',1,'^ESCTTU337729',NULL,'Tuberculosis of cervical lymph nodes'),('tuberculosis',1,'^ESCTTU345467',NULL,'Tuberculous osteomyelitis'),('tuberculosis',1,'^ESCTTU364389',NULL,'Tuberculosis of larynx'),('tuberculosis',1,'^ESCTTU364391',NULL,'Tuberculosis (TB) with laryngitis'),('tuberculosis',1,'^ESCTTU371263',NULL,'Tuberculosis with erythema nodosum AND hypersensitivity reaction'),('tuberculosis',1,'^ESCTTU371264',NULL,'Tuberculosis (TB) with erythema nodosum'),('tuberculosis',1,'^ESCTTU376360',NULL,'Tuberculosis of trachea'),('tuberculosis',1,'^ESCTTU384705',NULL,'Tuberculosis colliquativa cutis'),('tuberculosis',1,'^ESCTTU389296',NULL,'Tuberculous tracheobronchial adenopathy'),('tuberculosis',1,'^ESCTTU474106',NULL,'Tuberculous pleuritis'),('tuberculosis',1,'^ESCTTU475936',NULL,'Tuberculous arthropathy'),('tuberculosis',1,'^ESCTTU475937',NULL,'Tuberculous rheumatism'),('tuberculosis',1,'^ESCTUR256971',NULL,'Urogenital tuberculosis'),('tuberculosis',1,'^ESCTUR420022',NULL,'Urinary tuberculosis'),('tuberculosis',1,'^ESCTVE304532',NULL,'Verruca necrogenica'),('tuberculosis',1,'^ESCTWA304533',NULL,'Warty tuberculosis'),('tuberculosis',1,'EMISNQTU1',NULL,'Tuberculosis of urinary tract');
INSERT INTO #codesemis
VALUES ('covid-vaccination',1,'^ESCT1348323',NULL,'Administration of first dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'^ESCT1348324',NULL,'Administration of first dose of 2019-nCoV (novel coronavirus) vaccine'),('covid-vaccination',1,'COCO138186NEMIS',NULL,'COVID-19 mRNA Vaccine BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer-BioNTech) (Pfizer-BioNTech)'),('covid-vaccination',1,'^ESCT1348325',NULL,'Administration of second dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'^ESCT1348326',NULL,'Administration of second dose of 2019-nCoV (novel coronavirus) vaccine'),('covid-vaccination',1,'^ESCT1428354',NULL,'Administration of third dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'^ESCT1428342',NULL,'Administration of fourth dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'^ESCT1428348',NULL,'Administration of fifth dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'^ESCT1348298',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccination'),('covid-vaccination',1,'^ESCT1348301',NULL,'COVID-19 vaccination'),('covid-vaccination',1,'^ESCT1299050',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'^ESCT1301222',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccination'),('covid-vaccination',1,'CODI138564NEMIS',NULL,'Covid-19 mRna (nucleoside modified) Vaccine Moderna  Dispersion for injection  0.1 mg/0.5 ml dose, multidose vial'),('covid-vaccination',1,'TASO138184NEMIS',NULL,'Covid-19 Vaccine AstraZeneca (ChAdOx1 S recombinant)  Solution for injection  5x10 billion viral particle/0.5 ml multidose vial'),('covid-vaccination',1,'PCSDT18491_1375',NULL,'Administration of first dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'PCSDT18491_1376',NULL,'Administration of second dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'PCSDT18491_716',NULL,'Administration of second dose of SARS-CoV-2 vacc'),('covid-vaccination',1,'PCSDT18491_903',NULL,'Administration of first dose of SARS-CoV-2 vacccine'),('covid-vaccination',1,'PCSDT3370_2254',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'PCSDT3919_2185',NULL,'Administration of first dose of SARS-CoV-2 vacccine'),('covid-vaccination',1,'PCSDT3919_662',NULL,'Administration of second dose of SARS-CoV-2 vacc'),('covid-vaccination',1,'PCSDT4803_1723',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'PCSDT5823_2264',NULL,'Administration of second dose of SARS-CoV-2 vacc'),('covid-vaccination',1,'PCSDT5823_2757',NULL,'Administration of second dose of SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) vaccine'),('covid-vaccination',1,'PCSDT5823_2902',NULL,'Administration of first dose of SARS-CoV-2 vacccine'),('covid-vaccination',1,'^ESCT1348300',NULL,'Severe acute respiratory syndrome coronavirus 2 vaccination'),('covid-vaccination',1,'ASSO138368NEMIS',NULL,'COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose suspension for injection multidose vials (Janssen-Cilag Ltd)'),('covid-vaccination',1,'COCO141057NEMIS',NULL,'Comirnaty Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd)'),('covid-vaccination',1,'COSO141059NEMIS',NULL,'COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Serum Institute of India)'),('covid-vaccination',1,'COSU138776NEMIS',NULL,'COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5ml dose suspension for injection multidose vials (Valneva UK Ltd)'),('covid-vaccination',1,'COSU138943NEMIS',NULL,'COVID-19 Vaccine Novavax (adjuvanted) 5micrograms/0.5ml dose suspension for injection multidose vials (Baxter Oncology GmbH)'),('covid-vaccination',1,'COSU141008NEMIS',NULL,'CoronaVac COVID-19 Vaccine (adjuvanted) 600U/0.5ml dose suspension for injection vials (Sinovac Life Sciences)'),('covid-vaccination',1,'COSU141037NEMIS',NULL,'COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection vials (Beijing Institute of Biological Products)'),('covid-vaccination',1,'^ESCT1299051',NULL,'Wuhan 2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'^ESCT1299052',NULL,'2019 novel coronavirus vaccination'),('covid-vaccination',1,'^ESCT1348299',NULL,'2019 novel coronavirus vaccination'),('covid-vaccination',1,'^ESCT1348302',NULL,'2019-nCoV (novel coronavirus) vaccination'),('covid-vaccination',1,'^ESCT1402904',NULL,'COVID-19 Vaccine AstraZeneca (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (AstraZeneca UK Ltd)'),('covid-vaccination',1,'^ESCT1402911',NULL,'COVID-19 mRNA Vaccine Pfizer-BioNTech BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials (Pfizer Ltd)'),('covid-vaccination',1,'^ESCT1402916',NULL,'Generic COVID-19 mRNA Vaccine Pfizer-BioNTech BNT162b2 30micrograms/0.3ml dose concentrate for suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1402917',NULL,'Generic COVID-19 Vaccine AstraZeneca (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1403901',NULL,'Astute 100,000,000,000 (100 billion) viral particles/0.5ml dose solution for injection multidose vials (Janssen-Cilag Ltd)'),('covid-vaccination',1,'^ESCT1403935',NULL,'Generic Astute 100,000,000,000 (100 billion) viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1404735',NULL,'Generic COVID-19 mRNA (nucleoside modified) Vaccine Moderna 0.1mg/0.5mL dose dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1404736',NULL,'COVID-19 mRNA (nucleoside modified) Vaccine Moderna 0.1mg/0.5mL dose dispersion for injection multidose vials (Moderna, Inc)'),('covid-vaccination',1,'^ESCT1404768',NULL,'COVID-19 vaccine'),('covid-vaccination',1,'^ESCT1405128',NULL,'COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5mL dose suspension for injection multidose vials (Valneva UK Ltd)'),('covid-vaccination',1,'^ESCT1405145',NULL,'Generic COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5mL dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1416911',NULL,'Administration of SARS-CoV-2 mRNA vaccine'),('covid-vaccination',1,'^ESCT1416912',NULL,'COVID-19 mRNA vaccination'),('covid-vaccination',1,'^ESCT1416913',NULL,'COVID-19 mRNA immunisation'),('covid-vaccination',1,'^ESCT1416914',NULL,'2019-nCoV mRNA immunisation'),('covid-vaccination',1,'^ESCT1416915',NULL,'2019-nCoV mRNA vaccination'),('covid-vaccination',1,'^ESCT1416916',NULL,'SARS-CoV-2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1416917',NULL,'SARS-CoV-2 mRNA immunisation'),('covid-vaccination',1,'^ESCT1416918',NULL,'2019 novel coronavirus mRNA immunisation'),('covid-vaccination',1,'^ESCT1416919',NULL,'Severe acute respiratory syndrome coronavirus 2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1416920',NULL,'2019 novel coronavirus mRNA vaccination'),('covid-vaccination',1,'^ESCT1416921',NULL,'Administration of vaccine product containing only Severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid'),('covid-vaccination',1,'^ESCT1417030',NULL,'Administration of first dose of SARS-CoV-2 mRNA vaccine'),('covid-vaccination',1,'^ESCT1417031',NULL,'First 2019 novel coronavirus mRNA vaccination'),('covid-vaccination',1,'^ESCT1417032',NULL,'First 2019-nCoV mRNA vaccination'),('covid-vaccination',1,'^ESCT1417033',NULL,'First SARS-CoV-2 mRNA immunisation'),('covid-vaccination',1,'^ESCT1417034',NULL,'First COVID-19 mRNA vaccination'),('covid-vaccination',1,'^ESCT1417035',NULL,'First Severe acute respiratory syndrome coronavirus 2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1417036',NULL,'First COVID-19 mRNA immunisation'),('covid-vaccination',1,'^ESCT1417037',NULL,'First 2019 novel coronavirus mRNA immunisation'),('covid-vaccination',1,'^ESCT1417038',NULL,'Administration of first dose of vaccine product containing only Severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid'),('covid-vaccination',1,'^ESCT1417039',NULL,'First 2019-nCoV mRNA immunisation'),('covid-vaccination',1,'^ESCT1417040',NULL,'First SARS-CoV-2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1417041',NULL,'Administration of second dose of SARS-CoV-2 mRNA vaccine'),('covid-vaccination',1,'^ESCT1417042',NULL,'Second 2019-nCoV mRNA immunisation'),('covid-vaccination',1,'^ESCT1417043',NULL,'Second COVID-19 mRNA vaccination'),('covid-vaccination',1,'^ESCT1417044',NULL,'Second Severe acute respiratory syndrome coronavirus 2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1417045',NULL,'Second 2019-nCoV mRNA vaccination'),('covid-vaccination',1,'^ESCT1417046',NULL,'Administration of second dose of vaccine product containing only Severe acute respiratory syndrome coronavirus 2 messenger ribonucleic acid'),('covid-vaccination',1,'^ESCT1417047',NULL,'Second 2019 novel coronavirus mRNA immunisation'),('covid-vaccination',1,'^ESCT1417048',NULL,'Second 2019 novel coronavirus mRNA vaccination'),('covid-vaccination',1,'^ESCT1417049',NULL,'Second SARS-CoV-2 mRNA immunisation'),('covid-vaccination',1,'^ESCT1417050',NULL,'Second COVID-19 mRNA immunisation'),('covid-vaccination',1,'^ESCT1417051',NULL,'Second SARS-CoV-2 mRNA vaccination'),('covid-vaccination',1,'^ESCT1418812',NULL,'COVID-19 Vaccine Novavax (adjuvanted) 5micrograms/0.5ml dose suspension for injection multidose vials (Baxter Oncology GmbH)'),
('covid-vaccination',1,'^ESCT1418854',NULL,'Generic COVID-19 Vaccine Novavax (adjuvanted) 5micrograms/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1421492',NULL,'SARS-CoV-2 (severe acute respiratory syndrome coronavirus 2) antigen vaccination'),('covid-vaccination',1,'^ESCT1421493',NULL,'COVID-19 antigen immunisation'),('covid-vaccination',1,'^ESCT1421494',NULL,'2019 novel coronavirus antigen immunisation'),('covid-vaccination',1,'^ESCT1421495',NULL,'2019 novel coronavirus antigen vaccination'),('covid-vaccination',1,'^ESCT1421496',NULL,'COVID-19 antigen vaccination'),('covid-vaccination',1,'^ESCT1421497',NULL,'Severe acute respiratory syndrome coronavirus 2 antigen vaccination'),('covid-vaccination',1,'^ESCT1421498',NULL,'Administration of vaccine product containing only Severe acute respiratory syndrome coronavirus 2 antigen'),('covid-vaccination',1,'^ESCT1421499',NULL,'2019-nCoV (novel coronavirus) antigen vaccination'),('covid-vaccination',1,'^ESCT1423115',NULL,'Generic COVID-19 mRNA (nucleoside modified) Vaccine Moderna 0.1mg/0.5ml dose dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1423116',NULL,'COVID-19 mRNA (nucleoside modified) Vaccine Moderna 0.1mg/0.5ml dose dispersion for injection multidose vials (Moderna, Inc)'),('covid-vaccination',1,'^ESCT1423124',NULL,'COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5ml dose suspension for injection multidose vials (Valneva UK Ltd)'),('covid-vaccination',1,'^ESCT1423127',NULL,'Generic COVID-19 Vaccine Valneva (inactivated adjuvanted whole virus) 40antigen units/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1425452',NULL,'COVID-19 Vaccine Medicago (CoVLP) 3.75micrograms/0.5ml dose emulsion for injection multidose vials (Medicago Inc)'),('covid-vaccination',1,'^ESCT1425457',NULL,'Generic COVID-19 Vaccine Medicago (CoVLP) 3.75micrograms/0.5ml dose emulsion for injection multidose vials'),('covid-vaccination',1,'^ESCT1428110',NULL,'COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose solution for injection multidose vials (Janssen-Cilag Ltd)'),('covid-vaccination',1,'^ESCT1428113',NULL,'Generic COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1428343',NULL,'Administration of fourth dose of 2019-nCoV (novel coronavirus) vaccine'),('covid-vaccination',1,'^ESCT1428349',NULL,'Administration of fifth dose of 2019-nCoV (novel coronavirus) vaccine'),('covid-vaccination',1,'^ESCT1428355',NULL,'Administration of third dose of 2019-nCoV (novel coronavirus) vaccine'),('covid-vaccination',1,'^ESCT1431765',NULL,'COVID-19 Vaccine AstraZeneca (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose suspension for injection multidose vials (AstraZeneca UK Ltd)'),('covid-vaccination',1,'^ESCT1431769',NULL,'Comirnaty COVID-19 mRNA Vaccine 30micrograms/0.3ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd)'),('covid-vaccination',1,'^ESCT1431771',NULL,'Generic Comirnaty COVID-19 mRNA Vaccine 30micrograms/0.3ml dose concentrate for dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1431772',NULL,'Generic COVID-19 Vaccine AstraZeneca (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1431777',NULL,'COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose suspension for injection multidose vials (Janssen-Cilag Ltd)'),('covid-vaccination',1,'^ESCT1431780',NULL,'Generic COVID-19 Vaccine Janssen (Ad26.COV2-S [recombinant]) 0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1431786',NULL,'Generic Spikevax COVID-19 mRNA (nucleoside modified) Vaccine 0.1mg/0.5ml dose dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1431787',NULL,'Spikevax COVID-19 mRNA (nucleoside modified) Vaccine 0.1mg/0.5ml dose dispersion for injection multidose vials (Moderna, Inc)'),('covid-vaccination',1,'^ESCT1434508',NULL,'CoronaVac COVID-19 Vaccine (adjuvanted) 600U/0.5ml dose suspension for injection vials (Sinovac Life Sciences)'),('covid-vaccination',1,'^ESCT1434581',NULL,'Generic CoronaVac COVID-19 Vaccine (adjuvanted) 600U/0.5ml dose suspension for injection vials'),('covid-vaccination',1,'^ESCT1434594',NULL,'COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection vials (Beijing Institute of Biological Products)'),('covid-vaccination',1,'^ESCT1434597',NULL,'COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection pre-filled syringes (Beijing Institute of Biological Products)'),('covid-vaccination',1,'^ESCT1434601',NULL,'COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection multidose vials (Bharat Biotech International Ltd)'),('covid-vaccination',1,'^ESCT1434605',NULL,'COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection vials (Bharat Biotech International Ltd)'),('covid-vaccination',1,'^ESCT1434622',NULL,'Generic COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1434623',NULL,'Generic COVID-19 Vaccine Covaxin (NIV-2020-770 inactivated) 6micrograms/0.5ml dose suspension for injection vials'),('covid-vaccination',1,'^ESCT1434624',NULL,'Generic COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection pre-filled syringes'),('covid-vaccination',1,'^ESCT1434625',NULL,'Generic COVID-19 Vaccine Sinopharm BIBP (inactivated adjuvanted) 6.5U/0.5ml dose suspension for injection vials'),('covid-vaccination',1,'^ESCT1434687',NULL,'COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Serum Institute of India)'),('covid-vaccination',1,'^ESCT1434739',NULL,'COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection vials (Serum Institute of India)'),('covid-vaccination',1,'^ESCT1434769',NULL,'Generic COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1434770',NULL,'Generic COVID-19 Vaccine Covishield (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose solution for injection vials'),('covid-vaccination',1,'^ESCT1435624',NULL,'Comirnaty Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.2ml dose concentrate for dispersion for injection multidose vials (Pfizer Ltd)'),('covid-vaccination',1,'^ESCT1435629',NULL,'COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (Gamaleya NRCEM)'),('covid-vaccination',1,'^ESCT1435639',NULL,'COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials (Gamaleya NRCEM)'),('covid-vaccination',1,'^ESCT1435642',NULL,'COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Gamaleya NRCEM)'),('covid-vaccination',1,'^ESCT1435645',NULL,'COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (Gamaleya NRCEM)'),('covid-vaccination',1,'^ESCT1435654',NULL,'Generic COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1435655',NULL,'Generic COVID-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials'),('covid-vaccination',1,'^ESCT1435656',NULL,'Generic COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1435657',NULL,'Generic COVID-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles) 100,000,000,000 viral particles/0.5ml dose solution for injection vials'),('covid-vaccination',1,'^ESCT1435658',NULL,'Generic Comirnaty Children 5-11 years COVID-19 mRNA Vaccine 10micrograms/0.2ml dose concentrate for dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1435705',NULL,'COVID-19 Vaccine AZD2816 AstraZeneca (ChAdOx1 nCOV-19) 3.5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials (AstraZeneca AB)'),('covid-vaccination',1,'^ESCT1435707',NULL,'Generic COVID-19 Vaccine AZD2816 AstraZeneca (ChAdOx1 nCOV-19) 3.5x10,000,000,000 viral particles/0.5ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1436694',NULL,'COVID-19 Vaccine Covovax (adjuvanted) 5micrograms/0.5ml dose suspension for injection multidose vials (Serum Institute of India)'),('covid-vaccination',1,'^ESCT1439300',NULL,'COVID-19 Vaccine Vaxzevria (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose suspension for injection multidose vials (AstraZeneca UK Ltd)'),('covid-vaccination',1,'^ESCT1439303',NULL,'Generic COVID-19 Vaccine Vaxzevria (ChAdOx1 S [recombinant]) 5x10,000,000,000 viral particles/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1439638',NULL,'COVID-19 Vaccine Sanofi (CoV2 preS dTM monovalent D614 [recombinant]) 5micrograms/0.5ml dose suspension for injection multidose vials (Sanofi Pasteur)'),
('covid-vaccination',1,'^ESCT1439640',NULL,'Generic COVID-19 Vaccine Sanofi (CoV2 preS dTM monovalent D614 [recombinant]) 5micrograms/0.5ml dose suspension for injection multidose vials'),('covid-vaccination',1,'^ESCT1439753',NULL,'COVID-19 Vaccine Moderna (mRNA-1273.529) 50micrograms/0.25ml dose solution for injection multidose vials (Moderna, Inc)'),('covid-vaccination',1,'^ESCT1439755',NULL,'Generic COVID-19 Vaccine Moderna (mRNA-1273.529) 50micrograms/0.25ml dose solution for injection multidose vials'),('covid-vaccination',1,'^ESCT1440075',NULL,'Comirnaty COVID-19 mRNA Vaccine ready to use 30micrograms/0.3ml dose dispersion for injection multidose vials (Pfizer Ltd)'),('covid-vaccination',1,'^ESCT1440078',NULL,'Generic Comirnaty COVID-19 mRNA Vaccine ready to use 30micrograms/0.3ml dose dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCT1441243',NULL,'COVID-19 Vaccine Nuvaxovid (recombinant, adjuvanted) 5micrograms/0.5ml dose dispersion for injection multidose vials (Novavax CZ a.s.)'),('covid-vaccination',1,'^ESCT1441246',NULL,'Generic COVID-19 Vaccine Nuvaxovid (recombinant, adjuvanted) 5micrograms/0.5ml dose dispersion for injection multidose vials'),('covid-vaccination',1,'^ESCTCO397297',NULL,'Coronavirus vaccination'),('covid-vaccination',1,'COCO143126NEMIS',NULL,'Comirnaty Children 6 months - 4 years COVID-19 mRNA Vaccine  Concentrate For Dispersion For Injection  3 micrograms/0.2 ml dose, multidose vial'),('covid-vaccination',1,'COCO144437NEMIS',NULL,'Comirnaty Omicron XBB.1.5 Children 6 months - 4 years Covid-19 mRNA Vaccine  Concentrate For Dispersion For Injection  3 micrograms/0.2 ml dose, multidose vial'),('covid-vaccination',1,'CODI141709NEMIS',NULL,'Comirnaty Covid-19 mRNA Vaccine Ready to Use  Dispersion for injection  30 micrograms/0.3 ml, multidose vial'),('covid-vaccination',1,'CODI142225NEMIS',NULL,'Covid-19 Vaccine Spikevax 0 (Zero)/O (Omicron)  Dispersion for injection  0.1 mg/ml multidose vial'),('covid-vaccination',1,'CODI142339NEMIS',NULL,'Comirnaty Original/Omicron BA.1 Covid-19 mRNA Vaccine  Dispersion for injection  15 microgram + 15 microgram/0.3 ml, multidose vial'),('covid-vaccination',1,'CODI143144NEMIS',NULL,'Comirnaty Original/Omicron BA.4-5 COVID-19 mRNA Vaccine  Dispersion for injection  15 microgram + 15 microgram/0.3 ml, multidose vial'),('covid-vaccination',1,'CODI143381NEMIS',NULL,'Covid-19 Vaccine Spikevax Original/Omicron BA.4/BA.5  Dispersion for injection  0.1 mg/ml multidose vial'),('covid-vaccination',1,'CODI144358NEMIS',NULL,'Comirnaty Omicron XBB.1.5 Covid-19 mRNA Vaccine  Dispersion for injection  30 micrograms/0.3 ml dose, multidose vial'),('covid-vaccination',1,'CODI144435NEMIS',NULL,'Comirnaty Omicron XBB.1.5 Children 5-11 Years Covid-19 mRNA Vaccine  Dispersion for injection  10 micrograms/0.3 ml dose, multidose vial'),('covid-vaccination',1,'COEM139763NEMIS',NULL,'Covid-19 Vaccine Medicago (CoVlp)  Emulsion For Injection  3.75 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'COEM144188NEMIS',NULL,'Covid-19 Vaccine Bimervax (recombinant, adjuvanted)  Emulsion For Injection  40 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'COSO141060NEMIS',NULL,'Covid-19 Vaccine Covishield (ChAdOx1 S recombinant)  Solution for injection  5x10 billion viral particles/0.5 ml dose vial'),('covid-vaccination',1,'COSO141063NEMIS',NULL,'Covid-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles)  Solution for injection  100 billion viral particles/0.5 ml multidose vial'),('covid-vaccination',1,'COSO141064NEMIS',NULL,'Covid-19 Vaccine Sputnik V Component I (recombinant serotype 26 adenoviral particles)  Solution for injection  100 billion viral particles/0.5 ml dose vial'),('covid-vaccination',1,'COSO141065NEMIS',NULL,'Covid-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles)  Solution for injection  100 billion viral particles/0.5 ml multidose vial'),('covid-vaccination',1,'COSO141066NEMIS',NULL,'Covid-19 Vaccine Sputnik V Component II (recombinant serotype 5 adenoviral particles)  Solution for injection  100 billion viral particles/0.5 ml dose vial'),('covid-vaccination',1,'COSO141294NEMIS',NULL,'Covid-19 Vaccine AZD2816 AstraZeneca (ChAdOx1 nCOV-19)  Solution for injection  3.5x10billion viral particles/0.5ml multidose vial'),('covid-vaccination',1,'COSO141705NEMIS',NULL,'Covid-19 Vaccine Moderna (mRNA-1273.529)  Solution for injection  50 micrograms/0.25 ml, multidose vial'),('covid-vaccination',1,'COSO141940NEMIS',NULL,'Covid-19 Vaccine Moderna (mRNA-1273.214)  Dispersion for injection  50 micrograms/0.5 ml dose vial'),('covid-vaccination',1,'COSO142081NEMIS',NULL,'Covid-19 Vaccine Convidecia (Adenovirus Type 5 Vector recombinant)  Solution for injection  40 billion viral particles/0.5 ml dose vial'),('covid-vaccination',1,'COSO144193NEMIS',NULL,'Covid-19 Vaccine Moderna (mRNA-1273.222)  Solution for injection  50 micrograms/0.5 ml dose vial'),('covid-vaccination',1,'COSO144195NEMIS',NULL,'Covid-19 Vaccine Moderna (mRNA-1283.222)  Solution for injection  10 micrograms/0.2 ml dose vial'),('covid-vaccination',1,'COSU141036NEMIS',NULL,'Covid-19 Vaccine Sinopharm BIBP (inactivated adjuvanted)  Suspension For Injection  6.5 units/0.5 ml dose, pre-filled syringe'),('covid-vaccination',1,'COSU141068NEMIS',NULL,'Covid-19 Vaccine Covaxin (NIV-2020-770 inactivated)  Suspension For Injection  6 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'COSU141069NEMIS',NULL,'Covid-19 Vaccine Covaxin (NIV-2020-770 inactivated)  Suspension For Injection  6 micrograms/0.5 ml dose, vial'),('covid-vaccination',1,'COSU141317NEMIS',NULL,'Covid-19 Vaccine Covovax (adjuvanted)  Suspension For Injection  5 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'COSU141594NEMIS',NULL,'Covid-19 Vaccine Sanofi (CoV2 preS dTM monovalent D614 recombinant)  Suspension For Injection  5 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'COVA142363NEMIS',NULL,'Covid-19 Vaccine Sanofi (CoV2 preS dTM bivalent D614+B.1.351 recombinant adjuvanted)  Emulsion For Injection  2.5microgram + 2.5microgram/0.5ml, multidose vial'),('covid-vaccination',1,'COVA142365NEMIS',NULL,'Covid-19 Vaccine VidPrevtyn Beta (CoV2 preS dTM monovalent B.1.351 recombinant adjuv)  Emulsion For Injection  5 micrograms/0.5 ml dose, multidose vial'),('covid-vaccination',1,'SPDI144360NEMIS',NULL,'Spikevax XBB.1.5 Covid-19 mRNA Vaccine  Dispersion for injection  0.1 mg/1 ml, multidose vial');
INSERT INTO #codesemis
VALUES ('flu-vaccination',1,'^ESCT1300221',NULL,'Seasonal influenza vaccination given in school'),('flu-vaccination',1,'^ESCTFI843902',NULL,'First inactivated seasonal influenza vaccination given by midwife'),('flu-vaccination',1,'^ESCTIN802297',NULL,'Influenza vaccination given'),('flu-vaccination',1,'^ESCTSE843901',NULL,'Seasonal influenza vaccination given by midwife'),('flu-vaccination',1,'EMISNQAD138',NULL,'Administration of first quadrivalent (QIV) inactivated seasonal influenza vaccination'),('flu-vaccination',1,'EMISNQAD139',NULL,'Administration of first non adjuvanted trivalent (TIV) inactivated seasonal influenza vaccination'),('flu-vaccination',1,'EMISNQAD142',NULL,'Administration of adjuvanted trivalent (aTIV) inactivated seasonal influenza vaccination'),('flu-vaccination',1,'EMISNQAD144',NULL,'Administration of first quadrivalent (QIV) inactivated seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'EMISNQAD145',NULL,'Administration of first non adjuvanted trivalent (TIV) inactivated seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'EMISNQAD147',NULL,'Administration of adjuvanted trivalent (aTIV) inactivated seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'EMISNQAD148',NULL,'Administration of second quadrivalent (QIV) inactivated seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'EMISNQAD149',NULL,'Adjuvanted trivalent (aTIV) inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'EMISNQAD150',NULL,'Administration of second non adjuvanted trivalent (TIV) inactivated seasonal influenza vaccination given by other healthcare provider'),('flu-vaccination',1,'EMISNQAD151',NULL,'Administration of second quadrivalent (QIV) inactivated seasonal influenza vaccination'),('flu-vaccination',1,'EMISNQFI45',NULL,'First quadrivalent (QIV) inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'EMISNQFI46',NULL,'First non adjuvanted trivalent (TIV) inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'EMISNQIN160',NULL,'Intranasal influenza vaccination'),('flu-vaccination',1,'EMISNQSE164',NULL,'Second quadrivalent (QIV) inactivated seasonal influenza vaccination given by pharmacist'),('flu-vaccination',1,'PCSDT18434_779',NULL,'First intranasal seasonal influenza vacc given by pharmacist'),('flu-vaccination',1,'PCSDT18439_1184',NULL,'First intranasal seasonal influenza vacc given by pharmacist'),('flu-vaccination',1,'PCSDT18439_711',NULL,'Second intranasal seasonal influenza vacc givn by pharmacist'),('flu-vaccination',1,'PCSDT28849_483',NULL,'First intranasal seasonal influenza vacc given by pharmacist'),('flu-vaccination',1,'PCSDT7022_652',NULL,'First intranasal seasonal influenza vacc given by pharmacist'),('flu-vaccination',1,'^ESCTSE843903',NULL,'Second inactivated seasonal influenza vaccination given by midwife');
INSERT INTO #codesemis
VALUES ('pneumococcal-vaccination',1,'^ESCT1170545',NULL,'Pneumococcal 7-valent conjugate vaccination given'),('pneumococcal-vaccination',1,'^ESCT1389903',NULL,'Pneumococcal vaccination given'),('pneumococcal-vaccination',1,'^ESCT1397434',NULL,'Subcutaneous injection of pneumococcal vaccine'),('pneumococcal-vaccination',1,'^ESCT1405591',NULL,'Pneumococcal immunisation'),('pneumococcal-vaccination',1,'^ESCT1407979',NULL,'Pneumococcal booster vaccination'),('pneumococcal-vaccination',1,'^ESCT1407980',NULL,'Pneumococcal booster immunisation'),('pneumococcal-vaccination',1,'EMISNQFI7',NULL,'First pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'EMISNQSE15',NULL,'Second pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'EMISNQTH9',NULL,'Third pneumococcal conjugated vaccination'),('pneumococcal-vaccination',1,'^ESCT1405590',NULL,'Administration of pneumococcal vaccine'),('pneumococcal-vaccination',1,'^ESCT1405592',NULL,'Administration of vaccine product containing only Streptococcus pneumoniae antigen'),('pneumococcal-vaccination',1,'^ESCT1407978',NULL,'Administration of booster dose of pneumococcal vaccine'),('pneumococcal-vaccination',1,'^ESCT1407981',NULL,'Administration of booster dose of vaccine product containing only Streptococcus pneumoniae antigen'),('pneumococcal-vaccination',1,'^ESCTIM602223',NULL,'Immunization against bacterial disease'),('pneumococcal-vaccination',1,'EMISHA1',NULL,'Haemophilus influenza B vaccination'),('pneumococcal-vaccination',1,'EMISNQBO34',NULL,'Booster meningitis C vaccination'),('pneumococcal-vaccination',1,'EMISNQFI17',NULL,'First rMenB (recombinant meningococcal group B) vaccination'),('pneumococcal-vaccination',1,'EMISNQFO18',NULL,'Fourth rMenB (recombinant meningococcal group B) vaccination'),('pneumococcal-vaccination',1,'EMISNQRM2',NULL,'rMenB (recombinant meningococcal group B) vaccination'),('pneumococcal-vaccination',1,'EMISNQSE46',NULL,'Second rMenB (recombinant meningococcal group B) vaccination'),('pneumococcal-vaccination',1,'EMISNQTH21',NULL,'Third rMenB (recombinant meningococcal group B) vaccination'),('pneumococcal-vaccination',1,'EMISSI1',NULL,'Single haemophilus influenza B vaccination'),('pneumococcal-vaccination',1,'^ESCT1173890',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (A A H Pharmaceuticals Ltd)'),('pneumococcal-vaccination',1,'^ESCT1176746',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (Alliance Healthcare (Distribution) Ltd)'),('pneumococcal-vaccination',1,'^ESCT1179650',NULL,'Pneumovax II vaccine solution for injection 0.5ml pre-filled syringes (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'^ESCT1183555',NULL,'Pneumovax II vaccine solution for injection 0.5ml vials (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'^ESCT1249899',NULL,'Pneumovax 23 solution for injection 0.5ml pre-filled syringes (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'^ESCT1410058',NULL,'Pneumovax II vaccine solution for injection 0.5ml pre-filled syringes (Organon Pharma (UK) Ltd)'),('pneumococcal-vaccination',1,'^ESCT1410064',NULL,'Pneumovax II vaccine solution for injection 0.5ml vials (Organon Pharma (UK) Ltd)'),('pneumococcal-vaccination',1,'^ESCT1412154',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (Organon Pharma (UK) Ltd)'),('pneumococcal-vaccination',1,'^ESCT1412571',NULL,'Pneumovax 23 solution for injection 0.5ml pre-filled syringes (Merck Sharp & Dohme (UK) Ltd)'),('pneumococcal-vaccination',1,'^ESCTPN1094686',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials (Merck Sharp & Dohme Ltd)'),('pneumococcal-vaccination',1,'^ESCTPN858623',NULL,'Pneumovax II vaccine solution for injection 0.5ml pre-filled syringes (sanofi pasteur MSD Ltd)'),('pneumococcal-vaccination',1,'^ESCTPN858746',NULL,'Pneumovax II vaccine solution for injection 0.5ml vials (sanofi pasteur MSD Ltd)'),('pneumococcal-vaccination',1,'^ESCTPN858754',NULL,'Pnu-Imune vaccine solution for injection 0.5ml vials (Wyeth Pharmaceuticals)'),('pneumococcal-vaccination',1,'^ESCTPN861868',NULL,'Pneumococcal polysaccharide conjugated vaccine (adsorbed) suspension for injection 0.5ml vials'),('pneumococcal-vaccination',1,'^ESCTPN861869',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml pre-filled syringes'),('pneumococcal-vaccination',1,'^ESCTPN861870',NULL,'Pneumococcal polysaccharide vaccine solution for injection 0.5ml vials'),('pneumococcal-vaccination',1,'^ESCTPN927419',NULL,'Pneumococcal polysaccharide conjugated vaccine (adsorbed) suspension for injection 0.5ml pre-filled syringes'),('pneumococcal-vaccination',1,'^ESCTPR993974',NULL,'Prevenar 13 vaccine suspension for injection 0.5ml pre-filled syringes (Pfizer Ltd)'),('pneumococcal-vaccination',1,'PNIN9413BRIDL',NULL,'Pneumovax 11  Injection  25 micrograms/0.5 ml vial'),('pneumococcal-vaccination',1,'PNPR5193NEMIS',NULL,'Pneumovax 11  Pre-Filled Syringe  0.5 ml'),('pneumococcal-vaccination',1,'PNSO128492NEMIS',NULL,'Pneumovax 23  Solution for injection  0.5 ml pre-filled syringe'),('pneumococcal-vaccination',1,'PNVA30368EMIS',NULL,'Pnu-Imune  Vaccine  0.5 ml vial'),('pneumococcal-vaccination',1,'PRSU40435NEMIS',NULL,'Prevenar 13 Vaccine  Suspension For Injection  0.5 ml pre-filled syringe');
INSERT INTO #codesemis
VALUES ('shingles-vaccination',1,'^ESCT1167355',NULL,'Administration of varicella zoster vaccine'),('shingles-vaccination',1,'^ESCT1167356',NULL,'Administration of chickenpox vaccine'),('shingles-vaccination',1,'^ESCT1185651',NULL,'Administration of shingles vaccine'),('shingles-vaccination',1,'^ESCT1409061',NULL,'Administration of Varicella-zoster vaccine for shingles'),('shingles-vaccination',1,'^ESCT1409062',NULL,'Varicella-zoster immunisation for shingles'),('shingles-vaccination',1,'^ESCT1409063',NULL,'Administration of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'^ESCT1409064',NULL,'Varicella-zoster vaccination for shingles'),('shingles-vaccination',1,'^ESCT1409065',NULL,'Administration of vaccine product containing only Varicella-zoster virus antigen for shingles'),('shingles-vaccination',1,'^ESCT1409163',NULL,'Administration of Varicella-zoster vaccine for chickenpox'),('shingles-vaccination',1,'^ESCT1409164',NULL,'Administration of vaccine product containing only Varicella-zoster virus antigen for chickenpox'),('shingles-vaccination',1,'^ESCT1409165',NULL,'Administration of vaccine product containing only Human alphaherpesvirus 3 antigen for chickenpox'),('shingles-vaccination',1,'^ESCT1409166',NULL,'Varicella-zoster vaccination for chickenpox'),('shingles-vaccination',1,'^ESCT1409167',NULL,'Varicella-zoster immunisation for chickenpox'),('shingles-vaccination',1,'^ESCT1417622',NULL,'Administration of first dose of Varicella-zoster vaccine for shingles'),('shingles-vaccination',1,'^ESCT1417623',NULL,'Administration of first dose of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'^ESCT1417624',NULL,'Administration of first dose of shingles vaccine'),('shingles-vaccination',1,'^ESCT1417625',NULL,'Administration of second dose of Varicella-zoster vaccine for shingles'),('shingles-vaccination',1,'^ESCT1417626',NULL,'Administration of second dose of vaccine product containing only Human alphaherpesvirus 3 antigen for shingles'),('shingles-vaccination',1,'^ESCT1417627',NULL,'Administration of second dose of shingles vaccine'),('shingles-vaccination',1,'^ESCTAD782872',NULL,'Administration of herpes zoster vaccine'),('shingles-vaccination',1,'^ESCTCH782873',NULL,'Chickenpox vaccination'),('shingles-vaccination',1,'^ESCTVA782874',NULL,'Varicella vaccination'),('shingles-vaccination',1,'EMISNQHE68',NULL,'Herpes zoster vaccination'),('shingles-vaccination',1,'^ESCT1411505',NULL,'Zostavax vaccine powder and solvent for suspension for injection 0.65ml pre-filled syringes (Merck Sharp & Dohme (UK) Ltd)'),('shingles-vaccination',1,'^ESCTVA871593',NULL,'Varicella vaccine (live) powder and solvent for solution for injection 0.5ml vials'),('shingles-vaccination',1,'^ESCTVA902154',NULL,'Varicella vaccine (live) powder and solvent for suspension for injection 0.5ml vials'),('shingles-vaccination',1,'^ESCTVA871593',NULL,'Varicella vaccine (live) powder and solvent for solution for injection 0.5ml vials'),('shingles-vaccination',1,'^ESCTVA902154',NULL,'Varicella vaccine (live) powder and solvent for suspension for injection 0.5ml vials'),('shingles-vaccination',1,'^ESCTZO1025920',NULL,'Zostavax vaccine powder and solvent for suspension for injection 0.65ml pre-filled syringes (Merck Sharp & Dohme Ltd)'),('shingles-vaccination',1,'VAPO13759NEMIS',NULL,'Varicella-Zoster  Powder and solvent for solution for injection  0.5 ml vial'),('shingles-vaccination',1,'VAPO19997NEMIS',NULL,'Varicella-Zoster  Powder and solvent for suspension for injection  0.5 ml vial'),('shingles-vaccination',1,'ZOPO52946NEMIS',NULL,'Zostavax  Powder and solvent for injection  0.65 ml pre-filled syringe')

INSERT INTO #AllCodes
SELECT [concept], [version], [code], [description] from #codesemis;


IF OBJECT_ID('tempdb..#TempRefCodes') IS NOT NULL DROP TABLE #TempRefCodes;
CREATE TABLE #TempRefCodes (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, version INT NOT NULL, [description] VARCHAR(255));

-- Read v2 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcr.concept, dcr.[version], dcr.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesreadv2 dcr on dcr.code = rc.MainCode
WHERE CodingType='ReadCodeV2'
AND (dcr.term IS NULL OR dcr.term = rc.Term)
and PK_Reference_Coding_ID != -1;

-- CTV3 codes
INSERT INTO #TempRefCodes
SELECT PK_Reference_Coding_ID, dcc.concept, dcc.[version], dcc.[description]
FROM [SharedCare].[Reference_Coding] rc
INNER JOIN #codesctv3 dcc on dcc.code = rc.MainCode
WHERE CodingType='CTV3'
and PK_Reference_Coding_ID != -1;

-- EMIS codes with a FK Reference Coding ID
INSERT INTO #TempRefCodes
SELECT FK_Reference_Coding_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID != -1;

IF OBJECT_ID('tempdb..#TempSNOMEDRefCodes') IS NOT NULL DROP TABLE #TempSNOMEDRefCodes;
CREATE TABLE #TempSNOMEDRefCodes (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [version] INT NOT NULL, [description] VARCHAR(255));

-- SNOMED codes
INSERT INTO #TempSNOMEDRefCodes
SELECT PK_Reference_SnomedCT_ID, dcs.concept, dcs.[version], dcs.[description]
FROM SharedCare.Reference_SnomedCT rs
INNER JOIN #codessnomed dcs on dcs.code = rs.ConceptID;

-- EMIS codes with a FK SNOMED ID but without a FK Reference Coding ID
INSERT INTO #TempSNOMEDRefCodes
SELECT FK_Reference_SnomedCT_ID, ce.concept, ce.[version], ce.[description]
FROM [SharedCare].[Reference_Local_Code] rlc
INNER JOIN #codesemis ce on ce.code = rlc.LocalCode
WHERE FK_Reference_Coding_ID = -1
AND FK_Reference_SnomedCT_ID != -1;

-- De-duped tables
IF OBJECT_ID('tempdb..#CodeSets') IS NOT NULL DROP TABLE #CodeSets;
CREATE TABLE #CodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#SnomedSets') IS NOT NULL DROP TABLE #SnomedSets;
CREATE TABLE #SnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, concept VARCHAR(255) NOT NULL, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedCodeSets') IS NOT NULL DROP TABLE #VersionedCodeSets;
CREATE TABLE #VersionedCodeSets (FK_Reference_Coding_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

IF OBJECT_ID('tempdb..#VersionedSnomedSets') IS NOT NULL DROP TABLE #VersionedSnomedSets;
CREATE TABLE #VersionedSnomedSets (FK_Reference_SnomedCT_ID BIGINT NOT NULL, Concept VARCHAR(255), [Version] INT, [description] VARCHAR(255));

INSERT INTO #VersionedCodeSets
SELECT DISTINCT * FROM #TempRefCodes;

INSERT INTO #VersionedSnomedSets
SELECT DISTINCT * FROM #TempSNOMEDRefCodes;

INSERT INTO #CodeSets
SELECT FK_Reference_Coding_ID, c.concept, [description]
FROM #VersionedCodeSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedCodeSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

INSERT INTO #SnomedSets
SELECT FK_Reference_SnomedCT_ID, c.concept, [description]
FROM #VersionedSnomedSets c
INNER JOIN (
  SELECT concept, MAX(version) AS maxVersion FROM #VersionedSnomedSets
  GROUP BY concept)
sub ON sub.concept = c.concept AND c.version = sub.maxVersion;

--#endregion

-- >>> Following code sets injected: sle v1

------- EXCLUSIONS: PI wants to exclude the following: lupus pernio, neonatal lupus, drug-induced lupus, tuberculosis, cutaneous lupus without a corresponding 
------- systemic diagnosis, codes relating to a diagnostic test

------- lupus pernio, drug-induced lupus, and neonatal lupus code sets have been created - but prevalence suggests they are unused


-- >>> Following code sets injected: tuberculosis v1

-- table of sle coding events

IF OBJECT_ID('tempdb..#SLECodes') IS NOT NULL DROP TABLE #SLECodes;
SELECT FK_Patient_Link_ID, EventDate
INTO #SLECodes
FROM SharedCare.[GP_Events]
WHERE (
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'sle' AND Version = 1) OR
  FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'sle' AND Version = 1)
)
GROUP BY FK_Patient_Link_ID, EventDate

-- table of patients that meet the exclusion criteria: turberculosis, lupus pernio, drug-induced lupus, neonatal lupus

IF OBJECT_ID('tempdb..#Exclusions') IS NOT NULL DROP TABLE #Exclusions;
SELECT FK_Patient_Link_ID AS PatientId, EventDate
INTO #Exclusions
FROM SharedCare.[GP_Events]
WHERE (
  FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept = 'tuberculosis' AND Version = 1) OR
  FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept = 'tuberculosis' AND Version = 1)
)
GROUP BY FK_Patient_Link_ID, EventDate


-- create cohort of patients with an SLE diagnosis in the study period

IF OBJECT_ID('tempdb..#Cohort') IS NOT NULL DROP TABLE #Cohort;
SELECT
	 p.FK_Patient_Link_ID
	,yob.YearOfBirth
	,p.EthnicGroupDescription
	,p.DeathDate
INTO #Cohort
FROM #Patients p
LEFT OUTER JOIN #PatientYearOfBirth yob ON yob.FK_Patient_Link_ID = p.FK_Patient_Link_ID
WHERE 
	p.FK_Patient_Link_ID IN (SELECT DISTINCT FK_Patient_Link_ID FROM #SLECodes)
	AND p.FK_Patient_Link_ID NOT IN (SELECT DISTINCT p.FK_Patient_Link_ID FROM #Exclusions)
AND YEAR(@StartDate) - YearOfBirth > 18

---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------


-- >>> Following code sets injected: flu-vaccination v1/covid-vaccination v1/pneumococcal-vaccination v1/shingles-vaccination v1

-- TABLE OF ALL VACCINATIONS FOR THE COHORT

IF OBJECT_ID('tempdb..#Vaccinations') IS NOT NULL DROP TABLE #Vaccinations;
SELECT FK_Patient_Link_ID,
	EventDate = CAST(EventDate as DATE),
	[Concept] = CASE WHEN s.[concept] IS NOT NULL THEN s.[concept] ELSE c.[concept] END
INTO #Vaccinations
FROM SharedCare.GP_Events m
LEFT OUTER JOIN #VersionedSnomedSets s ON s.FK_Reference_SnomedCT_ID = m.FK_Reference_SnomedCT_ID
LEFT OUTER JOIN #VersionedCodeSets c ON c.FK_Reference_Coding_ID = m.FK_Reference_Coding_ID
WHERE m.FK_Patient_Link_ID IN (SELECT FK_Patient_Link_ID FROM #Cohort)
AND m.EventDate BETWEEN @StartDate AND @EndDate
AND (
	m.FK_Reference_SnomedCT_ID IN (SELECT FK_Reference_SnomedCT_ID FROM #VersionedSnomedSets WHERE Concept in ('flu-vaccination', 'covid-vaccination', 'pneumococcal-vaccination', 'shingles-vaccination')) OR
    m.FK_Reference_Coding_ID IN (SELECT FK_Reference_Coding_ID FROM #VersionedCodeSets WHERE Concept in ('flu-vaccination', 'covid-vaccination', 'pneumococcal-vaccination', 'shingles-vaccination'))
);


--bring together for final output
SELECT	DISTINCT PatientId = m.FK_Patient_Link_ID,   -- use distinct, assuming multiple codes for same concept, on same day, are the same vaccination
		EventDate,
		Concept
FROM #Vaccinations m