<style>@page {
  margin: 1.5cm;
  size: A4 portrait;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif,
    Apple Color Emoji, Segoe UI Emoji;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
  margin-bottom: 0;
}

body > :last-child {
  margin-bottom: -1px;
  overflow: hidden;
}

h1 {
  font-size: 2em;
}

h2 {
  font-size: 1.5em;
}

h3 {
  font-size: 1.25em;
}

h4 {
  font-size: 1em;
}

h1,
h2,
h3,
h4 {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 600;
  line-height: 1.25;
}

b,
strong {
  font-weight: 600;
}

p {
  text-align: justify;
}

table {
  break-inside: avoid;
  table-layout: auto;
  border-collapse: collapse;
  text-indent: 0;
  border-color: inherit;
  width: 100%;
}

th {
  background: #f3f4f4;
}

th,
td {
  padding: 5px;
  border: 1px solid black;
}

code {
  padding: 0.2em 0.4em;
  margin: 0;
  font-family: ui-monospace, SFMono-Regular, SF Mono, Consolas, Liberation Mono, Menlo, monospace;
  font-size: 85%;
  background-color: #f3f4f4;
  border-radius: 6px;
  white-space: nowrap;
}

pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f6f8fa;
  border-radius: 6px;
}

pre > code {
  word-wrap: normal;
  white-space: pre-wrap;
  background-color: #f6f8fa;
}
</style><p><em>This file is autogenerated. Please do not edit.</em></p>
<h1><em>TODO</em> - project title</h1>
<h2>Summary</h2>
<p><strong>TODO</strong> edit <code>about.md</code> to insert a brief lay summary of the work.</p>
<h2>Table of contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#methodology">Methodology</a></li>
<li><a href="#reusable-queries">Reusable queries</a></li>
<li><a href="#clinical-code-sets">Clinical code sets</a></li>
</ul>
<h2>Introduction</h2>
<p>The aim of this document is to provide full transparency for all parts of the data extraction process.
This includes:</p>
<ul>
<li>The methodology around how the data extraction process is managed and quality is maintained.</li>
<li>A full list of all queries used in the extraction, and their associated objectives and assumptions.</li>
<li>A full list of all clinical codes used for the extraction.</li>
</ul>
<h2>Methodology</h2>
<p>After each proposal is approved, a Research Data Engineer (RDE) works closely with the research team to establish precisely what data they require and in what format.
The RDE has access to the entire de-identified database and so builds up an expertise as to which projects are feasible and how best to extract the relevant data.
The RDE has access to a library of resusable SQL queries for common tasks, and sets of clinical codes for different phenotypes, built up from previous studies.
Prior to data extraction, the code is checked and signed off by another RDE.</p>
<h2>Reusable queries</h2>
<p>This project required the following reusable queries:</p>
<ul>
<li>GET practice and ccg for each patient</li>
<li>CCG lookup table</li>
<li>Index Multiple Deprivation</li>
<li>Lower level super output area</li>
<li>Sex</li>
<li>Classify secondary admissions</li>
<li>Secondary admissions and length of stay</li>
<li>Secondary discharges</li>
<li>Define Cohort for LH006: patients that had a dementia diagnosis</li>
<li>Year, month, week, and day of birth</li>
<li>Create table of patients who are registered with a GM GP</li>
</ul>
<p>Further details for each query can be found below.</p>
<h3>GET practice and ccg for each patient</h3>
<p>For each patient to get the practice id that they are registered to, and the CCG name that the practice belongs to.</p>
<p><em>Input</em></p>
<pre><code>Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
</code></pre>
<p><em>Output</em></p>
<pre><code>Two temp tables as follows:
 #PatientPractice (FK_Patient_Link_ID, GPPracticeCode)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
 #PatientPracticeAndCCG (FK_Patient_Link_ID, GPPracticeCode, CCG)
	- FK_Patient_Link_ID - unique patient id
	- GPPracticeCode - the nationally recognised practice id for the patient
	- CCG - the name of the patient's CCG
</code></pre>
<p><em>File</em>: <code>query-patient-practice-and-ccg.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-practice-and-ccg.sql">https://github.com/rw251/.../query-patient-practice-and-ccg.sql</a></p>
<hr>
<h3>CCG lookup table</h3>
<p>To provide lookup table for CCG names. The GMCR provides the CCG id (e.g. '00T', '01G') but not the CCG name. This table can be used in other queries when the output is required to be a ccg name rather than an id.</p>
<p><em>Input</em></p>
<pre><code>No pre-requisites
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #CCGLookup (CcgId, CcgName)
 	- CcgId - Nationally recognised ccg id
	- CcgName - Bolton, Stockport etc..
</code></pre>
<p><em>File</em>: <code>query-ccg-lookup.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-ccg-lookup.sql">https://github.com/rw251/.../query-ccg-lookup.sql</a></p>
<hr>
<h3>Index Multiple Deprivation</h3>
<p>To get the 2019 Index of Multiple Deprivation (IMD) decile for each patient.</p>
<p><em>Input</em></p>
<pre><code>Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #PatientIMDDecile (FK_Patient_Link_ID, IMD2019Decile1IsMostDeprived10IsLeastDeprived)
 	- FK_Patient_Link_ID - unique patient id
	- IMD2019Decile1IsMostDeprived10IsLeastDeprived - number 1 to 10 inclusive
</code></pre>
<p><em>File</em>: <code>query-patient-imd.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-imd.sql">https://github.com/rw251/.../query-patient-imd.sql</a></p>
<hr>
<h3>Lower level super output area</h3>
<p>To get the LSOA for each patient.</p>
<p><em>Assumptions</em></p>
<ul>
<li>Patient data is obtained from multiple sources. Where patients have multiple LSOAs we determine the LSOA as follows:</li>
<li>If the patients has an LSOA in their primary care data feed we use that as most likely to be up to date</li>
<li>If every LSOA for a paitent is the same, then we use that</li>
<li>If there is a single most recently updated LSOA in the database then we use that</li>
<li>Otherwise the patient's LSOA is considered unknown</li>
</ul>
<p><em>Input</em></p>
<pre><code>Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #PatientLSOA (FK_Patient_Link_ID, LSOA)
 	- FK_Patient_Link_ID - unique patient id
	- LSOA_Code - nationally recognised LSOA identifier
</code></pre>
<p><em>File</em>: <code>query-patient-lsoa.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-lsoa.sql">https://github.com/rw251/.../query-patient-lsoa.sql</a></p>
<hr>
<h3>Sex</h3>
<p>To get the Sex for each patient.</p>
<p><em>Assumptions</em></p>
<ul>
<li>Patient data is obtained from multiple sources. Where patients have multiple sexes we determine the sex as follows:</li>
<li>If the patients has a sex in their primary care data feed we use that as most likely to be up to date</li>
<li>If every sex for a patient is the same, then we use that</li>
<li>If there is a single most recently updated sex in the database then we use that</li>
<li>Otherwise the patient's sex is considered unknown</li>
</ul>
<p><em>Input</em></p>
<pre><code>Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #PatientSex (FK_Patient_Link_ID, Sex)
 	- FK_Patient_Link_ID - unique patient id
	- Sex - M/F
</code></pre>
<p><em>File</em>: <code>query-patient-sex.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-sex.sql">https://github.com/rw251/.../query-patient-sex.sql</a></p>
<hr>
<h3>Classify secondary admissions</h3>
<p>To categorise admissions to secondary care into 5 categories: Maternity, Unplanned, Planned, Transfer and Unknown.</p>
<p><em>Assumptions</em></p>
<ul>
<li>We assume patients can only have one admission per day. This is probably not true, but where we see multiple admissions it is more likely to be data duplication, or internal admissions, than an admission, discharge and another admission in the same day.</li>
<li>Where patients have multiple admissions we choose the &quot;highest&quot; category for admission with the categories ranked as follows: Maternity &gt; Unplanned &gt; Planned &gt; Transfer &gt; Unknown</li>
<li>We have used the following classifications based on the AdmissionTypeCode:
<ul>
<li>PLANNED: PL (ELECTIVE PLANNED), 11 (Elective - Waiting List), WL (ELECTIVE WL), 13 (Elective - Planned), 12 (Elective - Booked), BL (ELECTIVE BOOKED), D (NULL), Endoscopy (Endoscopy), OP (DIRECT OUTPAT CLINIC), Venesection (X36.2 Venesection), Colonoscopy (H22.9 Colonoscopy), Medical (Medical)</li>
<li>UNPLANNED: AE (AE.DEPT.OF PROVIDER), 21 (Emergency - Local A&amp;E), I (NULL), GP (GP OR LOCUM GP), 22 (Emergency - GP), 23 (Emergency - Bed Bureau), 28 (Emergency - Other (inc other provider A&amp;E)), 2D (Emergency - Other), 24 (Emergency - Clinic), EM (EMERGENCY OTHER), AI (ACUTE TO INTMED CARE), BB (EMERGENCY BED BUREAU), DO (EMERGENCY DOMICILE), 2A (A+E Department of another provider where the Patient has not been admitted), A+E (Admission	 A+E Admission), Emerg (GP	Emergency GP Patient)</li>
<li>MATERNITY: 31 (Maternity ante-partum), BH (BABY BORN IN HOSP), AN (MATERNITY ANTENATAL), 82 (Birth in this Health Care Provider), PN (MATERNITY POST NATAL), B (NULL), 32 (Maternity post-partum), BHOSP (Birth in this Health Care Provider)</li>
<li>TRANSFER: 81 (Transfer from other hosp (not A&amp;E)), TR (PLAN TRANS TO TRUST), ET (EM TRAN (OTHER PROV)), HospTran (Transfer from other NHS Hospital), T (TRANSFER), CentTrans (Transfer from CEN Site)</li>
<li>OTHER: Anything else not previously classified</li>
</ul>
</li>
</ul>
<p><em>Input</em></p>
<pre><code>No pre-requisites
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #AdmissionTypes (FK_Patient_Link_ID, AdmissionDate, AcuteProvider, AdmissionType)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
	- AdmissionType - One of: Maternity/Unplanned/Planned/Transfer/Unknown
</code></pre>
<p><em>File</em>: <code>query-classify-secondary-admissions.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-classify-secondary-admissions.sql">https://github.com/rw251/.../query-classify-secondary-admissions.sql</a></p>
<hr>
<h3>Secondary admissions and length of stay</h3>
<p>To obtain a table with every secondary care admission, along with the acute provider, the date of admission, the date of discharge, and the length of stay.</p>
<p><em>Input</em></p>
<pre><code>One parameter
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
</code></pre>
<p><em>Output</em></p>
<pre><code>Two temp table as follows:
 #Admissions (FK_Patient_Link_ID, AdmissionDate, AcuteProvider)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
  (Limited to one admission per person per hospital per day, because if a patient has 2 admissions
   on the same day to the same hopsital then it's most likely data duplication rather than two short
   hospital stays)
 #LengthOfStay (FK_Patient_Link_ID, AdmissionDate)
 	- FK_Patient_Link_ID - unique patient id
	- AdmissionDate - date of admission (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
	- DischargeDate - date of discharge (YYYY-MM-DD)
	- LengthOfStay - Number of days between admission and discharge. 1 = [0,1) days, 2 = [1,2) days, etc.
</code></pre>
<p><em>File</em>: <code>query-get-admissions-and-length-of-stay.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-admissions-and-length-of-stay.sql">https://github.com/rw251/.../query-get-admissions-and-length-of-stay.sql</a></p>
<hr>
<h3>Secondary discharges</h3>
<p>To obtain a table with every secondary care discharge, along with the acute provider, and the date of discharge.</p>
<p><em>Input</em></p>
<pre><code>One parameter
	-	all-patients: boolean - (true/false) if true, then all patients are included, otherwise only those in the pre-existing #Patients table.
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #Discharges (FK_Patient_Link_ID, DischargeDate, AcuteProvider)
 	- FK_Patient_Link_ID - unique patient id
	- DischargeDate - date of discharge (YYYY-MM-DD)
	- AcuteProvider - Bolton, SRFT, Stockport etc..
  (Limited to one discharge per person per hospital per day, because if a patient has 2 discharges
   on the same day to the same hopsital then it's most likely data duplication rather than two short
   hospital stays)
</code></pre>
<p><em>File</em>: <code>query-get-discharges.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-discharges.sql">https://github.com/rw251/.../query-get-discharges.sql</a></p>
<hr>
<h3>Define Cohort for LH006: patients that had a dementia diagnosis</h3>
<p>To build the cohort of patients needed for LH006. This reduces duplication of code in the template scripts.</p>
<p><em>Input</em></p>
<pre><code>none
</code></pre>
<p><em>Output</em></p>
<pre><code>Temp tables as follows:
 #Cohort
 #Patients (reduced to cohort only)
</code></pre>
<p><em>File</em>: <code>query-build-lh006-cohort.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-build-lh006-cohort.sql">https://github.com/rw251/.../query-build-lh006-cohort.sql</a></p>
<hr>
<h3>Year, month, week, and day of birth</h3>
<p>To get the date of birth for each patient, in various formats.</p>
<p><em>Assumptions</em></p>
<ul>
<li>Patient data is obtained from multiple sources. Where patients have multiple DateOfBirths we determine the DateOfBirth as follows:</li>
<li>If the patients has a DateOfBirth in their primary care data feed we use that as most likely to be up to date</li>
<li>If every DateOfBirth for a patient is the same, then we use that</li>
<li>If there is a single most recently updated DateOfBirth in the database then we use that</li>
<li>Otherwise we take the highest DateOfBirth for the patient that is not in the future</li>
</ul>
<p><em>Input</em></p>
<pre><code>Assumes there exists a temp table as follows:
 #Patients (FK_Patient_Link_ID)
  A distinct list of FK_Patient_Link_IDs for each patient in the cohort
</code></pre>
<p><em>Output</em></p>
<pre><code>A temp table as follows:
 #PatientWeekOfBirth (FK_Patient_Link_ID, WeekOfBirth)
 	- FK_Patient_Link_ID - unique patient id
  - DateOfBirthPID (yyyy-mm-dd)  **not to be provided to study teams
  - DayOfBirth (dd) (1 to 31)
	- WeekOfBirth (ww) (1 to 52)
  - MonthOfBirth (mm) (1 to 12)
  - YearOfBirth (yyyy)
</code></pre>
<p><em>File</em>: <code>query-patient-date-of-birth.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-patient-date-of-birth.sql">https://github.com/rw251/.../query-patient-date-of-birth.sql</a></p>
<hr>
<h3>Create table of patients who are registered with a GM GP</h3>
<p>undefined</p>
<p><em>Input</em></p>
<pre><code>undefined
</code></pre>
<p><em>Output</em></p>
<pre><code>undefined
</code></pre>
<p><em>File</em>: <code>query-get-possible-patients.sql</code></p>
<p><em>Link</em>: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/Reusable%20queries%20for%20data%20extraction/query-get-possible-patients.sql">https://github.com/rw251/.../query-get-possible-patients.sql</a></p>
<h2>Clinical code sets</h2>
<p>This project required the following clinical code sets:</p>
<ul>
<li>cancer v1</li>
<li>chronic-pain v1</li>
<li>opioid-analgesics v1</li>
<li>rheumatoid-arthritis v1</li>
<li>osteoarthritis v1</li>
<li>back-problems v2</li>
<li>neck-problems v1</li>
<li>post-herpetic-neuralgia v1</li>
<li>ankylosing-spondylitis v1</li>
<li>neuropathic-pain v1</li>
<li>chest-pain v1</li>
<li>psoriatic-arthritis v1</li>
<li>fibromyalgia v1</li>
</ul>
<p>Further details for each code set can be found below.</p>
<h3>Cancer</h3>
<p>Readv2 codes from code sets published by in:</p>
<p>Zhu Y, Edwards D, Mant J, Payne RA, Kiddle S. Characteristics, service use and mortality of clusters of multimorbid patients in England: A population-based study. BMC Med [Internet]. 2020 Apr 10 [cited 2021 Apr 14];18(1):78. Available from: https://bmcmedicine.biomedcentral.com/articles/10.1186/s12916-020-01543-8</p>
<p>The above paper used the definition of LTCs as first determined in:</p>
<p>Barnett K, Mercer SW, Norbury M, Watt G, Wyke S, Guthrie B. Epidemiology of multimorbidity and implications for health care, research, and medical education: A cross-sectional study. Lancet [Internet]. 2012 Jul 7 [cited 2021 Apr 14];380(9836):37–43. Available from: www.thelancet.com</p>
<p>CTV3 and SNOMED code sets from OpenSafely.</p>
<p>ICD10 codes have been provided and verified by the Christie team (004).</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set, as of 19th July 2021.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Concept</th>
<th style="text-align:center">Version</th>
<th style="text-align:center">System</th>
<th style="text-align:center">Patients</th>
<th style="text-align:center">PatientsWithConcept</th>
<th style="text-align:center">PatientsWithConceptFromCode</th>
<th style="text-align:center">PercentageOfPatients</th>
<th style="text-align:center">PercentageOfPatientsFromCode</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">cancer</td>
<td style="text-align:center">1</td>
<td style="text-align:center">EMIS</td>
<td style="text-align:center">2615750</td>
<td style="text-align:center">118723</td>
<td style="text-align:center">78901</td>
<td style="text-align:center">4.53877473000096</td>
<td style="text-align:center">3.01638153493262</td>
</tr>
<tr>
<td style="text-align:center">cancer</td>
<td style="text-align:center">1</td>
<td style="text-align:center">TPP</td>
<td style="text-align:center">211345</td>
<td style="text-align:center">9607</td>
<td style="text-align:center">7280</td>
<td style="text-align:center">4.5456481109087</td>
<td style="text-align:center">3.44460479311079</td>
</tr>
<tr>
<td style="text-align:center">cancer</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Vision</td>
<td style="text-align:center">336528</td>
<td style="text-align:center">16642</td>
<td style="text-align:center">11427</td>
<td style="text-align:center">4.94520515380592</td>
<td style="text-align:center">3.39555698188561</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-02-22</td>
<td>EMIS</td>
<td>2524209</td>
<td style="text-align:right">123626 (4.9%)</td>
<td style="text-align:right">123152 (4.88%)</td>
</tr>
<tr>
<td>2024-02-22</td>
<td>TPP</td>
<td>201752</td>
<td style="text-align:right">11008 (5.46%)</td>
<td style="text-align:right">8580 (4.25%)</td>
</tr>
<tr>
<td>2024-02-22</td>
<td>Vision</td>
<td>335007</td>
<td style="text-align:right">16786 (5.01%)</td>
<td style="text-align:right">16713 (4.99%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/cancer/1">https://github.com/rw251/.../conditions/cancer/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Chronic Pain</h3>
<p>SNOMED and Read codes from study team for SDE-LS-006, used in previous CPRD studies.</p>
<p>EMIS and CTV3 codes retrieved from reference lookup in Graphnet database.</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.</p>
<p>The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range <code>57.9% - 60.4%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-03</td>
<td>EMIS</td>
<td>2528256</td>
<td style="text-align:right">1462328 (57.8%)</td>
<td style="text-align:right">1462676 (57.9%)</td>
</tr>
<tr>
<td>2024-04-03</td>
<td>TPP</td>
<td>201811</td>
<td style="text-align:right">122547 (60.7%)</td>
<td style="text-align:right">121811 (60.4%)</td>
</tr>
<tr>
<td>2024-04-03</td>
<td>Vision</td>
<td>335377</td>
<td style="text-align:right">201681 (60.1%)</td>
<td style="text-align:right">201637 (60.1%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/chronic-pain/1">https://github.com/rw251/.../conditions/chronic-pain/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Opioid analgesics</h3>
<p>A prescription of any opioid analgesics.</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range from the code is <code>15.7% - 19.1%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2022-07-05</td>
<td>EMIS</td>
<td>2664831</td>
<td style="text-align:right">410584 (15.4%)</td>
<td style="text-align:right">429274 (16.1%)</td>
</tr>
<tr>
<td>2022-07-05</td>
<td>TPP</td>
<td>212907</td>
<td style="text-align:right">39459 (18.5%)</td>
<td style="text-align:right">40687 (19.1%)</td>
</tr>
<tr>
<td>2022-07-05</td>
<td>Vision</td>
<td>343146</td>
<td style="text-align:right">52274 (15.2%)</td>
<td style="text-align:right">53983 (15.7%)</td>
</tr>
</tbody>
</table>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/medications/opioid-analgesics/1">https://github.com/rw251/.../medications/opioid-analgesics/1</a></p>
<h3>Rheumatoid arthritis</h3>
<p>Any code indicating a diagnosis of rheumatoid arthritis.</p>
<ul>
<li>Does not include lupus</li>
<li>Does not include ankylosing spondylitis</li>
</ul>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>0.55% - 0.66%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2022-05-16</td>
<td>EMIS</td>
<td>2662570</td>
<td style="text-align:right">15603 (0.59%)</td>
<td style="text-align:right">15603 (0.59%)</td>
</tr>
<tr>
<td>2022-05-16</td>
<td>TPP</td>
<td>212696</td>
<td style="text-align:right">1130 (0.53%)</td>
<td style="text-align:right">1137 (0.53%)</td>
</tr>
<tr>
<td>2022-05-16</td>
<td>Vision</td>
<td>342344</td>
<td style="text-align:right">2126 (0.62%)</td>
<td style="text-align:right">2126 (0.62%)</td>
</tr>
<tr>
<td>2024-01-23</td>
<td>EMIS</td>
<td>2520311</td>
<td style="text-align:right">17971 (0.713%)</td>
<td style="text-align:right">13940 (0.553%)</td>
</tr>
<tr>
<td>2024-01-23</td>
<td>TPP</td>
<td>201513</td>
<td style="text-align:right">1591 (0.79%)</td>
<td style="text-align:right">1337 (0.663%)</td>
</tr>
<tr>
<td>2024-01-23</td>
<td>Vision</td>
<td>334747</td>
<td style="text-align:right">2488 (0.743%)</td>
<td style="text-align:right">1909 (0.57%)</td>
</tr>
</tbody>
</table>
<h4>Audit log</h4>
<ul>
<li>Find_missing_codes last run 2024-01-23</li>
</ul>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/rheumatoid-arthritis/1">https://github.com/rw251/.../conditions/rheumatoid-arthritis/1</a></p>
<h3>Osteoarthritis</h3>
<p>Code set for patients with a code related to osteoarthritis</p>
<p>Developed from https://www.opencodelists.org/codelist/opensafely/osteoarthritis/2020-06-04/#full-list</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system,
we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.
The prevalence range <code>% - %</code> suggests that this code set is well defined.</p>
<p>UPDATE:</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th>Patients from ID</th>
<th>Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2022-04-11</td>
<td>EMIS</td>
<td>2660237</td>
<td>1500 (0.06%)</td>
<td>1500 (0.06%)</td>
</tr>
<tr>
<td>2022-04-11</td>
<td>TPP</td>
<td>212647</td>
<td>212 (0.10%)</td>
<td>212 (0.10%)</td>
</tr>
<tr>
<td>2022-04-11</td>
<td>Vision</td>
<td>341912</td>
<td>169 (0.05%)</td>
<td>169 (0.05%)</td>
</tr>
</tbody>
</table>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/osteoarthritis/1">https://github.com/rw251/.../conditions/osteoarthritis/1</a></p>
<h3>Back problems (pain only)</h3>
<p>Read codes from: https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/6/codelist/back-pain/</p>
<p>this code set is for back pain only - for broader back problems, see version 1.</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.</p>
<p>The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range <code>27.9% - 29.6%</code> suggests this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-10</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">705600 (27.9%)</td>
<td style="text-align:right">705078 (27.9%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">59365 (29.4%)</td>
<td style="text-align:right">59364 (29.4%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">99170 (29.6%)</td>
<td style="text-align:right">99277 (29.6%)</td>
</tr>
</tbody>
</table>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/back-problems/2">https://github.com/rw251/.../conditions/back-problems/2</a></p>
<h3>Neck problems</h3>
<p>Any code indicating neck problems. SNOMED codes from: https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/174/codelist/res174-neck-diagnoses/</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>14.4% - 16%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-10</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">376021 (14.9%)</td>
<td style="text-align:right">375153 (14.8%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">33444 (16.6%)</td>
<td style="text-align:right">29081 (14.4%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">53983 (16.1%)</td>
<td style="text-align:right">53559 (16%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/neck-problems/1">https://github.com/rw251/.../conditions/neck-problems/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Post herpetic neuralgia codes</h3>
<p>Developed from https://getset.ga with inclusion terms and exclusion terms as below:</p>
<p>&quot;includeTerms&quot;: [
&quot;post-herpetic neuralgia&quot;,
&quot;post-zoster&quot;,
&quot;post-herpetic&quot;,
&quot;post zoster&quot;,
&quot;post herpetic&quot;
],
&quot;excludeTerms&quot;: [],</p>
<h2>Prevalence log</h2>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>0.18% - 0.24%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-10-12</td>
<td>EMIS</td>
<td>2470460</td>
<td style="text-align:right">5882 (0.24%)</td>
<td style="text-align:right">5886 (0.24%)</td>
</tr>
<tr>
<td>2023-10-12</td>
<td>TPP</td>
<td>200512</td>
<td style="text-align:right">374 (0.18%)</td>
<td style="text-align:right">374 (0.18%)</td>
</tr>
<tr>
<td>2023-10-12</td>
<td>Vision</td>
<td>332318</td>
<td style="text-align:right">695 (0.21%)</td>
<td style="text-align:right">692 (0.21%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/post-herpetic-neuralgia/1">https://github.com/rw251/.../conditions/post-herpetic-neuralgia/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Ankylosing Spondylitis</h3>
<p>A code indicating a diagnosis of ankylosing Spondylitis.</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>0.12% - 0.14%</code> suggests this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-01-19</td>
<td>EMIS</td>
<td>2519438</td>
<td style="text-align:right">3089 (0.123%)</td>
<td style="text-align:right">3090 (0.123%)</td>
</tr>
<tr>
<td>2024-01-19</td>
<td>TPP</td>
<td>201469</td>
<td style="text-align:right">269 (0.134%)</td>
<td style="text-align:right">267 (0.133%)</td>
</tr>
<tr>
<td>2024-01-19</td>
<td>Vision</td>
<td>334528</td>
<td style="text-align:right">470 (0.14%)</td>
<td style="text-align:right">470 (0.14%)</td>
</tr>
</tbody>
</table>
<h4>Audit log</h4>
<ul>
<li>Find_missing_codes last run 2024-01-19</li>
</ul>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/ankylosing-spondylitis/1">https://github.com/rw251/.../conditions/ankylosing-spondylitis/1</a></p>
<h3>Neuropathic pain</h3>
<p>Readcodes from: https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/176/codelist/res176-neuropathic-pain/</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set.</p>
<p>The discrepancy between the patients counted when using the IDs vs using the clinical codes is due to these being new codes which haven't all filtered through to the main Graphnet dictionary. The prevalence range <code>9.34% - 10.3%</code> is perhaps too wide to suggest that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-10</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">236155 (9.34%)</td>
<td style="text-align:right">236110 (9.34%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">20713 (10.3%)</td>
<td style="text-align:right">20721 (10.3%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">32262 (9.62%)</td>
<td style="text-align:right">32256 (9.62%)</td>
</tr>
</tbody>
</table>
<p>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/neuropathic-pain/1">https://github.com/rw251/.../conditions/neuropathic-pain/1</a></p>
<h3>Chest pain</h3>
<p>Any code indicating chest pain.</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>14.2% - 15.4%</code>  indicates that this code set is well defined.</p>
<p>update:</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-10</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">376475 (14.9%)</td>
<td style="text-align:right">376475 (14.9%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">28648 (14.2%)</td>
<td style="text-align:right">28648 (14.2%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">51659 (15.4%)</td>
<td style="text-align:right">51656 (15.4%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/chest-pain/1">https://github.com/rw251/.../conditions/chest-pain/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Psoriatic arthritis</h3>
<p>Any code indicating a diagnosis of psoriatic arthritis. Read codes from: https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/34/codelist/res34-psoriatic_arthritis/</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>0.19% - 0.23%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-10</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">4819 (0.191%)</td>
<td style="text-align:right">4819 (0.191%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">469 (0.232%)</td>
<td style="text-align:right">469 (0.232%)</td>
</tr>
<tr>
<td>2024-04-10</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">740 (0.221%)</td>
<td style="text-align:right">740 (0.221%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/psoriatic-arthritis/1">https://github.com/rw251/.../conditions/psoriatic-arthritis/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h3>Fibromyalgia</h3>
<p>This list contains any code indicating fibromyalgia or generalised pain. Read codes from: https://clinicalcodes.rss.mhs.man.ac.uk/medcodes/article/176/codelist/res176-fibromyalgia-and-generalized-pain-short/</p>
<h4>Prevalence log</h4>
<p>By examining the prevalence of codes (number of patients with the code in their record) broken down by clinical system, we can attempt to validate the clinical code sets and the reporting of the conditions. Here is a log for this code set. The prevalence range <code>2.19% - 2.76%</code> suggests that this code set is well defined.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Practice system</th>
<th>Population</th>
<th style="text-align:right">Patients from ID</th>
<th style="text-align:right">Patient from code</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-04-11</td>
<td>EMIS</td>
<td>2528955</td>
<td style="text-align:right">69969 (2.77%)</td>
<td style="text-align:right">69768 (2.76%)</td>
</tr>
<tr>
<td>2024-04-11</td>
<td>TPP</td>
<td>201791</td>
<td style="text-align:right">4422 (2.19%)</td>
<td style="text-align:right">2850 (1.41%)</td>
</tr>
<tr>
<td>2024-04-11</td>
<td>Vision</td>
<td>335318</td>
<td style="text-align:right">8841 (2.64%)</td>
<td style="text-align:right">8687 (2.59%)</td>
</tr>
<tr>
<td>LINK: <a href="https://github.com/rw251/gm-idcr/tree/master/shared/clinical-code-sets/conditions/fibromyalgia/1">https://github.com/rw251/.../conditions/fibromyalgia/1</a></td>
<td></td>
<td></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h1>Clinical code sets</h1>
<p>All code sets required for this analysis are available here: <a href="https://github.com/rw251/gm-idcr/tree/master/projects/SDE%20Lighthouse%2006%20-%20Chen/clinical-code-sets.csv">https://github.com/rw251/.../SDE Lighthouse 06 - Chen/clinical-code-sets.csv</a>. Individual lists for each concept can also be found by using the links above.</p>
